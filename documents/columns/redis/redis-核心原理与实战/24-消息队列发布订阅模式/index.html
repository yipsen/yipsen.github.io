<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
<meta name="X-UA-Compatible" , content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<link rel="icon" type="image/png" href="/%20/favicon.png">

<title>24 æ¶ˆæ¯é˜Ÿåˆ—â€”â€”å‘å¸ƒè®¢é˜…æ¨¡å¼ | Yipsen Ye</title>
<meta name="description" content="åœ¨ Redis ä¸­æä¾›äº†ä¸“é—¨çš„ç±»å‹ï¼šPublisherï¼ˆå‘å¸ƒè€…ï¼‰å’Œ Subscriberï¼ˆè®¢é˜…è€…ï¼‰æ¥å®ç°æ¶ˆæ¯é˜Ÿåˆ—ã€‚
åœ¨æ–‡ç« å¼€å§‹ä¹‹å‰ï¼Œå…ˆæ¥ä»‹ç»æ¶ˆæ¯é˜Ÿåˆ—ä¸­æœ‰å‡ ä¸ªåŸºç¡€æ¦‚å¿µï¼Œä»¥ä¾¿å¤§å®¶æ›´å¥½çš„ç†è§£æœ¬æ–‡çš„å†…å®¹ã€‚
é¦–å…ˆï¼Œå‘å¸ƒæ¶ˆæ¯çš„å«åšå‘å¸ƒæ–¹æˆ–å‘å¸ƒè€…ï¼Œä¹Ÿå°±æ˜¯æ¶ˆæ¯çš„ç”Ÿäº§è€…ï¼Œè€Œæ¥æ”¶æ¶ˆæ¯çš„å«åšæ¶ˆæ¯çš„è®¢é˜…æ–¹æˆ–è®¢é˜…è€…ï¼Œä¹Ÿå°±æ˜¯æ¶ˆè´¹è€…ï¼Œç”¨æ¥å¤„ç†ç”Ÿäº§è€…å‘å¸ƒçš„æ¶ˆæ¯ã€‚
é™¤äº†å‘å¸ƒå’Œå’Œè®¢é˜…è€…ï¼Œåœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼šchannel æ„ä¸ºé¢‘é“æˆ–é€šé“ï¼Œå¯ä»¥ç†è§£ä¸ºæŸä¸ªæ¶ˆæ¯é˜Ÿåˆ—çš„åç§°ï¼Œé¦–å…ˆæ¶ˆè´¹è€…å…ˆè¦è®¢é˜…æŸä¸ª channelï¼Œç„¶åå½“ç”Ÿäº§è€…æŠŠæ¶ˆæ¯å‘é€åˆ°è¿™ä¸ª channel ä¸­æ—¶ï¼Œæ¶ˆè´¹è€…å°±å¯ä»¥æ­£å¸¸æ¥æ”¶åˆ°æ¶ˆæ¯äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
æ™®é€šè®¢é˜…ä¸å‘å¸ƒ æ¶ˆæ¯é˜Ÿåˆ—æœ‰ä¸¤ä¸ªé‡è¦çš„è§’è‰²ï¼Œä¸€ä¸ªæ˜¯å‘é€è€…ï¼Œå¦ä¸€ä¸ªå°±æ˜¯è®¢é˜…è€…ï¼Œå¯¹åº”çš„å‘½ä»¤å¦‚ä¸‹ï¼š
 å‘å¸ƒæ¶ˆæ¯ï¼špublish channel &amp;ldquo;message&amp;rdquo; è®¢é˜…æ¶ˆæ¯ï¼šsubscribe channel  ä¸‹é¢æˆ‘ä»¬æ¥çœ‹å…·ä½“çš„å‘½ä»¤å®ç°ã€‚
è®¢é˜…æ¶ˆæ¯ 127.0.0.1:6379&amp;gt; subscribe channel #è®¢é˜…æ¶ˆæ¯channelReading messages...1) &amp;quot;subscribe&amp;quot;2) &amp;quot;channel&amp;quot;3) (integer) 1ç›¸å…³è¯­æ³•ï¼š
subscribe channel [channel ...]æ­¤å‘½ä»¤æ”¯æŒè®¢é˜…ä¸€ä¸ªæˆ–å¤šä¸ªé¢‘é“çš„å‘½ä»¤ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªè®¢é˜…è€…å¯ä»¥è®¢é˜…å¤šä¸ªé¢‘é“ã€‚ä¾‹å¦‚ï¼ŒæŸä¸ªå®¢æˆ·ç«¯è®¢é˜…äº†ä¸¤ä¸ªé¢‘é“ channel å’Œ channel2ï¼Œå½“ä¸¤ä¸ªå‘å¸ƒè€…åˆ†åˆ«æ¨é€æ¶ˆæ¯åï¼Œè®¢é˜…è€…çš„ä¿¡æ¯è¾“å‡ºå¦‚ä¸‹ï¼š
127.0.0.1:6379&amp;gt; subscribe channel channel2 #è®¢é˜… channel å’Œ channel2Reading messages... (press Ctrl-C to quit)1) &amp;quot;subscribe&amp;quot;2) &amp;quot;channel&amp;quot;3) (integer) 11) &amp;quot;subscribe&amp;quot;2) &amp;quot;channel2&amp;quot;3) (integer) 21) &amp;quot;message&amp;quot;2) &amp;quot;channel&amp;quot; # æ”¶åˆ° channel æ¶ˆæ¯3) &amp;quot;message 1.">
<meta name="author" content="">

<link rel="stylesheet" type="text/css" href="/styles/main.css">

</head>

<body id="page">
    <header>
        <div class="nav-logo">
    <a href="http://yipsen.github.io/">
        
        <span class="nav-title">Yipsen Ye</span>
    </a>
</div>
<nav class="navbar justify-content-end">
    <ul class="nav-list">
        
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/posts/">æ–‡ç« </a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/collections/">é™„è¡¨</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/about/">å…³äº</a>
        </li>
        
    </ul>
</nav>
    </header>
    <main id="content">
        
<div class="container"><aside>
    <div>
        
        
            
            
            <div class="post-category-icon"></div>
            <a href="/categories/redis%20%e6%a0%b8%e5%bf%83%e5%8e%9f%e7%90%86%e4%b8%8e%e5%ae%9e%e6%88%98/">Redis æ ¸å¿ƒåŸç†ä¸å®æˆ˜</a>
            <ul>
                
            </ul>
        
    </div>
</aside>

<style>
    aside {
        position: fixed;
        left: 20px;
        background: #ffdee3;
        border-radius: 6px;
        padding: 20px;
        padding-top: 60px;
        box-shadow: 5px 10px #888;
        list-style-type: none;
        display: none;
    }

    .post-category-icon {
        position: absolute;
        width: 80px;
        height: 80px;
        top: -40px;
        left: 50%;
        margin-left: -40px;
        text-align: center;
        font-size: 36px;
        content: 'J';
        background: #ffdee3;
        border-radius: 100%;
        border: 10px solid #fff;
        box-shadow: 5px 10px #888;
    }
</style><article class="post-block">
        <h1 class="post-title">24 æ¶ˆæ¯é˜Ÿåˆ—â€”â€”å‘å¸ƒè®¢é˜…æ¨¡å¼</h1>
        <div class="post-info">
            <div class="post-date"> 
                <span>2022-09-28 19:38:17</span>
            </div>
        </div>
        <div class="post-content">
            <p>åœ¨ Redis ä¸­æä¾›äº†ä¸“é—¨çš„ç±»å‹ï¼šPublisherï¼ˆå‘å¸ƒè€…ï¼‰å’Œ Subscriberï¼ˆè®¢é˜…è€…ï¼‰æ¥å®ç°æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p>
<p>åœ¨æ–‡ç« å¼€å§‹ä¹‹å‰ï¼Œå…ˆæ¥ä»‹ç»æ¶ˆæ¯é˜Ÿåˆ—ä¸­æœ‰å‡ ä¸ªåŸºç¡€æ¦‚å¿µï¼Œä»¥ä¾¿å¤§å®¶æ›´å¥½çš„ç†è§£æœ¬æ–‡çš„å†…å®¹ã€‚</p>
<p>é¦–å…ˆï¼Œå‘å¸ƒæ¶ˆæ¯çš„å«åšå‘å¸ƒæ–¹æˆ–å‘å¸ƒè€…ï¼Œä¹Ÿå°±æ˜¯æ¶ˆæ¯çš„ç”Ÿäº§è€…ï¼Œè€Œæ¥æ”¶æ¶ˆæ¯çš„å«åšæ¶ˆæ¯çš„è®¢é˜…æ–¹æˆ–è®¢é˜…è€…ï¼Œä¹Ÿå°±æ˜¯æ¶ˆè´¹è€…ï¼Œç”¨æ¥å¤„ç†ç”Ÿäº§è€…å‘å¸ƒçš„æ¶ˆæ¯ã€‚</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Redis%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/assets/33a25110-6905-11ea-a947-1f4a9107200f" alt="ç”Ÿäº§è€…-æ¶ˆè´¹è€…åŸºç¡€æ¦‚å¿µ-2.png"></p>
<p>é™¤äº†å‘å¸ƒå’Œå’Œè®¢é˜…è€…ï¼Œåœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼šchannel æ„ä¸ºé¢‘é“æˆ–é€šé“ï¼Œå¯ä»¥ç†è§£ä¸ºæŸä¸ªæ¶ˆæ¯é˜Ÿåˆ—çš„åç§°ï¼Œé¦–å…ˆæ¶ˆè´¹è€…å…ˆè¦è®¢é˜…æŸä¸ª channelï¼Œç„¶åå½“ç”Ÿäº§è€…æŠŠæ¶ˆæ¯å‘é€åˆ°è¿™ä¸ª channel ä¸­æ—¶ï¼Œæ¶ˆè´¹è€…å°±å¯ä»¥æ­£å¸¸æ¥æ”¶åˆ°æ¶ˆæ¯äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Redis%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/assets/643cf190-6905-11ea-9247-611fe26c272c" alt="é¢‘é“channel.png"></p>
<h3 id="æ™®é€šè®¢é˜…ä¸å‘å¸ƒ">æ™®é€šè®¢é˜…ä¸å‘å¸ƒ</h3>
<p>æ¶ˆæ¯é˜Ÿåˆ—æœ‰ä¸¤ä¸ªé‡è¦çš„è§’è‰²ï¼Œä¸€ä¸ªæ˜¯å‘é€è€…ï¼Œå¦ä¸€ä¸ªå°±æ˜¯è®¢é˜…è€…ï¼Œå¯¹åº”çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<ul>
<li>å‘å¸ƒæ¶ˆæ¯ï¼špublish channel &ldquo;message&rdquo;</li>
<li>è®¢é˜…æ¶ˆæ¯ï¼šsubscribe channel</li>
</ul>
<p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹å…·ä½“çš„å‘½ä»¤å®ç°ã€‚</p>
<h4 id="è®¢é˜…æ¶ˆæ¯"><strong>è®¢é˜…æ¶ˆæ¯</strong></h4>
<pre tabindex="0"><code>127.0.0.1:6379&gt; subscribe channel #è®¢é˜…æ¶ˆæ¯channel
Reading messages...
1) &quot;subscribe&quot;
2) &quot;channel&quot;
3) (integer) 1

</code></pre><p>ç›¸å…³è¯­æ³•ï¼š</p>
<pre tabindex="0"><code>subscribe channel [channel ...]

</code></pre><p>æ­¤å‘½ä»¤æ”¯æŒè®¢é˜…ä¸€ä¸ªæˆ–å¤šä¸ªé¢‘é“çš„å‘½ä»¤ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªè®¢é˜…è€…å¯ä»¥è®¢é˜…å¤šä¸ªé¢‘é“ã€‚ä¾‹å¦‚ï¼ŒæŸä¸ªå®¢æˆ·ç«¯è®¢é˜…äº†ä¸¤ä¸ªé¢‘é“ channel å’Œ channel2ï¼Œå½“ä¸¤ä¸ªå‘å¸ƒè€…åˆ†åˆ«æ¨é€æ¶ˆæ¯åï¼Œè®¢é˜…è€…çš„ä¿¡æ¯è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>127.0.0.1:6379&gt; subscribe channel channel2 #è®¢é˜… channel å’Œ channel2
Reading messages... (press Ctrl-C to quit)
1) &quot;subscribe&quot;
2) &quot;channel&quot;
3) (integer) 1
1) &quot;subscribe&quot;
2) &quot;channel2&quot;
3) (integer) 2
1) &quot;message&quot;
2) &quot;channel&quot; # æ”¶åˆ° channel æ¶ˆæ¯
3) &quot;message 1.&quot;
1) &quot;message&quot;
2) &quot;channel2&quot; # æ”¶åˆ° channel2 æ¶ˆæ¯
3) &quot;message 2.&quot;

</code></pre><p>å¯ä»¥çœ‹å‡ºæ­¤è®¢é˜…è€…å¯ä»¥æ”¶åˆ°æ¥è‡ªä¸¤ä¸ªé¢‘é“çš„æ¶ˆæ¯æ¨é€ã€‚</p>
<h4 id="å‘é€æ¶ˆæ¯"><strong>å‘é€æ¶ˆæ¯</strong></h4>
<pre tabindex="0"><code>127.0.0.1:6379&gt; publish channel &quot;hello,redis.&quot; #å‘å¸ƒæ¶ˆæ¯
(integer) 1

</code></pre><p>ç›¸å…³è¯­æ³•ï¼š</p>
<pre tabindex="0"><code>publish channel message

</code></pre><p>æœ€åçš„è¿”å›å€¼è¡¨ç¤ºæˆåŠŸå‘é€ç»™å‡ ä¸ªè®¢é˜…æ–¹ï¼Œ1 è¡¨ç¤ºæˆåŠŸå‘ç»™äº†ä¸€ä¸ªè®¢é˜…è€…ï¼Œè¿™ä¸ªæ•°å­—å¯ä»¥æ˜¯ 0~nï¼Œè¿™æ˜¯ç”±è®¢é˜…è€…çš„æ•°é‡å†³å®šçš„ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå½“æœ‰ä¸¤ä¸ªè®¢é˜…è€…æ—¶ï¼Œæ¨é€çš„ç»“æœä¸º 2ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºã€‚</p>
<p>è®¢é˜…è€…ä¸€ï¼š</p>
<pre tabindex="0"><code>127.0.0.1:6379&gt; subscribe channel
Reading messages... (press Ctrl-C to quit)
1) &quot;subscribe&quot;
2) &quot;channel&quot;
3) (integer) 1

</code></pre><p>è®¢é˜…è€…äºŒï¼š</p>
<pre tabindex="0"><code>127.0.0.1:6379&gt; subscribe channel
Reading messages... (press Ctrl-C to quit)
1) &quot;subscribe&quot;
2) &quot;channel&quot;
3) (integer) 1

</code></pre><p>å‘é€æ¶ˆæ¯ï¼š</p>
<pre tabindex="0"><code>127.0.0.1:6379&gt; publish channel &quot;message&quot;
(integer) 2

</code></pre><p>å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ¶ˆæ¯å·²æˆåŠŸå‘ç»™ä¸¤ä¸ªè®¢é˜…è€…ï¼Œç»“æœä¹Ÿå˜æˆ 2 äº†ã€‚</p>
<h3 id="ä¸»é¢˜è®¢é˜…">ä¸»é¢˜è®¢é˜…</h3>
<p>ä¸Šé¢ä»‹ç»äº†æ™®é€šçš„è®¢é˜…ä¸å‘å¸ƒæ¨¡å¼ï¼Œä½†å¦‚æœæˆ‘è¦è®¢é˜…æŸä¸€ä¸ªç±»å‹çš„æ¶ˆæ¯å°±ä¸é€‚ç”¨äº†ï¼Œä¾‹å¦‚æˆ‘è¦è®¢é˜…æ—¥å¿—ç±»çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå®ƒä»¬çš„å‘½åéƒ½æ˜¯ logXXXï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ä½¿ç”¨ Redis æä¾›çš„å¦ä¸€ä¸ªåŠŸèƒ½ Pattern Subscribe ä¸»é¢˜è®¢é˜…ï¼Œè¿™ç§æ–¹å¼å¯ä»¥ä½¿ç”¨ <code>*</code> æ¥åŒ¹é…å¤šä¸ªé¢‘é“ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Redis%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/assets/c071d520-6905-11ea-bfcb-156eb66fb883" alt="ä¸»é¢˜è®¢é˜…2.png"></p>
<p>ä¸»é¢˜æ¨¡å¼çš„å…·ä½“å®ç°ä»£ç å¦‚ä¸‹ï¼Œè®¢é˜…è€…ï¼š</p>
<pre tabindex="0"><code>127.0.0.1:6379&gt; psubscribe log_* #ä¸»é¢˜è®¢é˜… log_*
1) &quot;psubscribe&quot;
2) &quot;log_*&quot;
3) (integer) 1
1) &quot;pmessage&quot;
2) &quot;log_*&quot;
3) &quot;log_user&quot; #æ¥æ”¶åˆ°é¢‘é“ log_user çš„æ¶ˆæ¯æ¨é€
4) &quot;user message.&quot;
1) &quot;pmessage&quot;
2) &quot;log_*&quot;
3) &quot;log_sys&quot; #æ¥æ”¶åˆ°é¢‘é“ log_sys çš„æ¶ˆæ¯æ¨é€
4) &quot;sys message.&quot;
1) &quot;pmessage&quot;
2) &quot;log_*&quot;
3) &quot;log_db&quot; #æ¥æ”¶åˆ°é¢‘é“ log_db çš„æ¶ˆæ¯æ¨é€
4) &quot;db message&quot;

</code></pre><p>ä»ä¸Šé¢çš„è¿è¡Œç»“æœï¼Œå¯ä»¥çœ‹å‡ºä½¿ç”¨å‘½ä»¤ <code>psubscribe log_*</code> å¯ä»¥æ¥æ”¶åˆ°æ‰€æœ‰é¢‘é“åŒ…å« log_XXX çš„æ¶ˆæ¯ã€‚</p>
<p>ç›¸å…³è¯­æ³•ï¼š</p>
<pre tabindex="0"><code>psubscribe pattern [pattern ...]

</code></pre><p>ç”Ÿäº§è€…çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>127.0.0.1:6379&gt; publish log_user &quot;user message.&quot;
(integer) 1
127.0.0.1:6379&gt; publish log_sys &quot;sys message.&quot;
(integer) 1
127.0.0.1:6379&gt; publish log_db &quot;db message&quot;
(integer) 1

</code></pre><h3 id="ä»£ç å®æˆ˜">ä»£ç å®æˆ˜</h3>
<p>ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ Jedis å®ç°æ™®é€šçš„å‘å¸ƒè®¢é˜…æ¨¡å¼å’Œä¸»é¢˜è®¢é˜…çš„åŠŸèƒ½ã€‚</p>
<h4 id="æ™®é€šæ¨¡å¼"><strong>æ™®é€šæ¨¡å¼</strong></h4>
<p>æ¶ˆè´¹è€…ä»£ç å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>/**
 * æ¶ˆè´¹è€…
 */
public static void consumer() {
    Jedis jedis = new Jedis(&quot;127.0.0.1&quot;, 6379);
    // æ¥æ”¶å¹¶å¤„ç†æ¶ˆæ¯
    jedis.subscribe(new JedisPubSub() {
        @Override
        public void onMessage(String channel, String message) {
            // æ¥æ”¶æ¶ˆæ¯ï¼Œä¸šåŠ¡å¤„ç†
            System.out.println(&quot;é¢‘é“ &quot; + channel + &quot; æ”¶åˆ°æ¶ˆæ¯ï¼š&quot; + message);
        }
    }, &quot;channel&quot;);
}

</code></pre><p>ç”Ÿäº§è€…ä»£ç å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>/**
 * ç”Ÿäº§è€…
 */
public static void producer() {
    Jedis jedis = new Jedis(&quot;127.0.0.1&quot;, 6379);
    // æ¨é€æ¶ˆæ¯
    jedis.publish(&quot;channel&quot;, &quot;Hello, channel.&quot;);
}

</code></pre><p>å‘å¸ƒè€…å’Œè®¢é˜…è€…æ¨¡å¼è¿è¡Œï¼š</p>
<pre tabindex="0"><code>public static void main(String[] args) throws InterruptedException {
    // åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹ä½œä¸ºæ¶ˆè´¹è€…
    new Thread(() -&gt; consumer()).start();
    // æš‚åœ 0.5s ç­‰å¾…æ¶ˆè´¹è€…åˆå§‹åŒ–
    Thread.sleep(500);
    // ç”Ÿäº§è€…å‘é€æ¶ˆæ¯
    producer();
}

</code></pre><p>ä»¥ä¸Šä»£ç è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>é¢‘é“ channel æ”¶åˆ°æ¶ˆæ¯ï¼šHello, channel.

</code></pre><h4 id="ä¸»é¢˜è®¢é˜…æ¨¡å¼"><strong>ä¸»é¢˜è®¢é˜…æ¨¡å¼</strong></h4>
<p>ä¸»é¢˜è®¢é˜…æ¨¡å¼çš„ç”Ÿäº§è€…çš„ä»£ç æ˜¯ä¸€æ ·ï¼Œåªæœ‰æ¶ˆè´¹è€…çš„ä»£ç æ˜¯ä¸åŒçš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>/**
 * ä¸»é¢˜è®¢é˜…
 */
public static void pConsumer() {
    Jedis jedis = new Jedis(&quot;127.0.0.1&quot;, 6379);
    // ä¸»é¢˜è®¢é˜…
    jedis.psubscribe(new JedisPubSub() {
        @Override
        public void onPMessage(String pattern, String channel, String message) {
            // æ¥æ”¶æ¶ˆæ¯ï¼Œä¸šåŠ¡å¤„ç†
            System.out.println(pattern + &quot; ä¸»é¢˜ | é¢‘é“ &quot; + channel + &quot; æ”¶åˆ°æ¶ˆæ¯ï¼š&quot; + message);
        }
    }, &quot;channel*&quot;);
}

</code></pre><p>ä¸»é¢˜æ¨¡å¼è¿è¡Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>public static void main(String[] args) throws InterruptedException {
    // ä¸»é¢˜è®¢é˜…
    new Thread(() -&gt; pConsumer()).start();
    // æš‚åœ 0.5s ç­‰å¾…æ¶ˆè´¹è€…åˆå§‹åŒ–
    Thread.sleep(500);
    // ç”Ÿäº§è€…å‘é€æ¶ˆæ¯
    producer();
}

</code></pre><p>ä»¥ä¸Šä»£ç è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>channel* ä¸»é¢˜ | é¢‘é“ channel æ”¶åˆ°æ¶ˆæ¯ï¼šHello, channel.

</code></pre><h3 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</h3>
<p>å‘å¸ƒè®¢é˜…æ¨¡å¼å­˜åœ¨ä»¥ä¸‹ä¸¤ä¸ªç¼ºç‚¹ï¼š</p>
<ol>
<li>æ— æ³•æŒä¹…åŒ–ä¿å­˜æ¶ˆæ¯ï¼Œå¦‚æœ Redis æœåŠ¡å™¨å®•æœºæˆ–é‡å¯ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æ¶ˆæ¯å°†ä¼šä¸¢å¤±ï¼›</li>
<li>å‘å¸ƒè®¢é˜…æ¨¡å¼æ˜¯â€œå‘åæ—¢å¿˜â€çš„å·¥ä½œæ¨¡å¼ï¼Œå¦‚æœæœ‰è®¢é˜…è€…ç¦»çº¿é‡è¿ä¹‹åä¸èƒ½æ¶ˆè´¹ä¹‹å‰çš„å†å²æ¶ˆæ¯ã€‚</li>
</ol>
<p>ç„¶è€Œè¿™äº›ç¼ºç‚¹åœ¨ Redis 5.0 æ·»åŠ äº† Stream ç±»å‹ä¹‹åä¼šè¢«å½»åº•çš„è§£å†³ã€‚</p>
<p>é™¤äº†ä»¥ä¸Šç¼ºç‚¹å¤–ï¼Œå‘å¸ƒè®¢é˜…æ¨¡å¼è¿˜æœ‰å¦ä¸€ä¸ªéœ€è¦æ³¨æ„é—®é¢˜ï¼šå½“æ¶ˆè´¹ç«¯æœ‰ä¸€å®šçš„æ¶ˆæ¯ç§¯å‹æ—¶ï¼Œä¹Ÿå°±æ˜¯ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…æ¶ˆè´¹ä¸è¿‡æ¥æ—¶ï¼Œå¦‚æœè¶…è¿‡ 32M æˆ–è€…æ˜¯ 60s å†…æŒç»­ä¿æŒåœ¨ 8M ä»¥ä¸Šï¼Œæ¶ˆè´¹ç«¯ä¼šè¢«å¼ºè¡Œæ–­å¼€ï¼Œè¿™ä¸ªå‚æ•°æ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„ï¼Œé»˜è®¤å€¼æ˜¯ <code>client-output-buffer-limit pubsub 32mb 8mb 60</code>ã€‚</p>
<h3 id="å°ç»“">å°ç»“</h3>
<p>æœ¬æ–‡ä»‹ç»äº†æ¶ˆæ¯é˜Ÿåˆ—çš„å‡ ä¸ªåè¯ï¼Œç”Ÿäº§è€…ã€æ¶ˆè´¹è€…å¯¹åº”çš„å°±æ˜¯æ¶ˆæ¯çš„å‘é€è€…å’Œæ¥æ”¶è€…ï¼Œä¹Ÿä»‹ç»äº†å‘å¸ƒè®¢é˜…æ¨¡å¼çš„ä¸‰ä¸ªå‘½ä»¤ï¼š</p>
<ul>
<li>subscribe channel æ™®é€šè®¢é˜…</li>
<li>publish channel message æ¶ˆæ¯æ¨é€</li>
<li>psubscribe pattern ä¸»é¢˜è®¢é˜…</li>
</ul>
<p>ä½¿ç”¨å®ƒä»¬ä¹‹åå°±å¯ä»¥å®Œæˆå•ä¸ªé¢‘é“å’Œå¤šä¸ªé¢‘é“çš„æ¶ˆæ¯æ”¶å‘ï¼Œä½†å‘é€ä¸è®¢é˜…æ¨¡å¼ä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼Œæ¯”å¦‚â€œå‘åæ—¢å¿˜â€å’Œä¸èƒ½æŒä¹…åŒ–ç­‰é—®é¢˜ï¼Œç„¶è€Œè¿™äº›é—®é¢˜ä¼šç­‰åˆ° Stream ç±»å‹çš„å‡ºç°è€Œå¾—åˆ°è§£å†³ï¼Œå…³äºæ›´å¤š Stream çš„å†…å®¹åé¢æ–‡ç« ä¼šè¯¦ç»†ä»‹ç»ã€‚</p>

        </div>
    </article>
</div>
<div class="division-line"></div>
<div class="others">
    <div>æ ‡ç­¾ï¼šğŸ·ï¸<a class="post-tag" href="/tags/redis/">redis</a>&nbsp;</div>
    <div>åˆ†ç±»ï¼š ğŸ“’<a class="post-category" href="/categories/redis-%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/">Redis æ ¸å¿ƒåŸç†ä¸å®æˆ˜</a>&nbsp; </div>
</div>

    </main>
    <footer>
        <div id="pagination">
            
<div class="paginator">
    <div class="prev">
        
        <a href="http://yipsen.github.io/documents/columns/redis/redis-%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/23-%E5%86%85%E5%AD%98%E6%B7%98%E6%B1%B0%E6%9C%BA%E5%88%B6%E4%B8%8E%E7%AE%97%E6%B3%95/"><span>23 å†…å­˜æ·˜æ±°æœºåˆ¶ä¸ç®—æ³•</span></a>
    </div>
    <div class="next">
        
        <a href="http://yipsen.github.io/documents/columns/redis/redis-%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/25-%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E7%9A%84%E5%85%B6%E4%BB%96%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F/"><span>25 æ¶ˆæ¯é˜Ÿåˆ—çš„å…¶ä»–å®ç°æ–¹å¼</span></a>
    </div>
</div>

        </div>
        <div id="float">
            <ul class="float-button-bar">
    <li>
        <button class="float-button top" onclick="scrollToTop(this);">UP</button>
    </li>
    <li>
        <button class="float-button toggler" onclick="changeSkin(this);">DARK</button>
    </li>
</ul>
        </div>
        <div id="copyright" style="display: none;">
    
    
    <p>&copy; 2020 <a href="/"></a>, powered by Hugo and Qiao</p>
</div>
    </footer>
    
<script>
    const changeSkin = () => {
        document.getElementById('page').classList.toggle('night');
    }
    const scrollToTop = () => {
        window.scrollTo(0, 0);
    }
</script>
</body>

</html>