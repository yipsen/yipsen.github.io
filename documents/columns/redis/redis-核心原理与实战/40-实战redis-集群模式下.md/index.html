<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
<meta name="X-UA-Compatible" , content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<link rel="icon" type="image/png" href="/%20/favicon.png">

<title> | Yipsen Ye</title>
<meta name="description" content="ä¸Šç¯‡æ–‡ç« æˆ‘ä»¬è®²äº† Redis é›†ç¾¤çš„æ­å»ºä¸èŠ‚ç‚¹çš„åŠ¨æ€æ·»åŠ å’Œåˆ é™¤ï¼Œæˆ‘ä»¬è¿™é‡Œå†æ¥ç®€å•çš„å¤ä¹ ä¸€ä¸‹ï¼Œå…¶ä¸­ 30001~30006 æ˜¯æˆ‘ä»¬æœ€åˆæ­å»ºçš„é›†ç¾¤ï¼Œè€Œ 30007 å’Œ 30008 æ˜¯åé¢åŠ¨æ€æ·»åŠ çš„ä¸»ä»èŠ‚ç‚¹ï¼Œæˆ‘ä»¬ä½¿ç”¨ --cluster info å‘½ä»¤æ¥çœ‹ä¸€ä¸‹ä¸»èŠ‚ç‚¹å’Œæ§½ä½çš„åˆ†é…æƒ…å†µï¼Œæ‰§è¡Œä»£ç å¦‚ä¸‹ï¼š
$ redis-cli --cluster info 127.0.0.1:30001 127.0.0.1:30001 (887397e6...) -&amp;gt; 0 keys | 5461 slots | 1 slaves. 127.0.0.1:30007 (df019085...) -&amp;gt; 0 keys | 0 slots | 1 slaves. 127.0.0.1:30003 (f5958382...) -&amp;gt; 0 keys | 5461 slots | 1 slaves. 127.0.0.1:30002 (3da35c40...) -&amp;gt; 0 keys | 5462 slots | 1 slaves. [OK] 0 keys in 4 masters. 0.00 keys per slot on average.">
<meta name="author" content="">

<link rel="stylesheet" type="text/css" href="/styles/main.css">

</head>

<body id="page">
    <header>
        <div class="logo-link" style="width: 60px; color: #CA6924;">
    <a href="http://yipsen.github.io/">
        <img style="margin-bottom: -1rem;" src="/images/deer.svg" alt="logo">
        <span style="font-size: 0.5rem; color: #CA6924;">Yipsen Ye</span>
    </a>
</div>
<nav class="navbar justify-content-end">
    <ul class="nav-list">
        
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/posts/">æœ­è®°</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/collections/">é™„è¡¨</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/about/">å…³äº</a>
        </li>
        
    </ul>
</nav>
    </header>
    <main id="content">
        
<div class="container"><article class="post-block">
        <h1 class="post-title"></h1>
        <div class="post-info">
            <div> 
                <span class="post-date">ğŸ“…&nbsp;0001-01-01 00:00:00</span></div></div>
        <div class="post-content">
            <p>ä¸Šç¯‡æ–‡ç« æˆ‘ä»¬è®²äº† Redis é›†ç¾¤çš„æ­å»ºä¸èŠ‚ç‚¹çš„åŠ¨æ€æ·»åŠ å’Œåˆ é™¤ï¼Œæˆ‘ä»¬è¿™é‡Œå†æ¥ç®€å•çš„å¤ä¹ ä¸€ä¸‹ï¼Œå…¶ä¸­ 30001~30006 æ˜¯æˆ‘ä»¬æœ€åˆæ­å»ºçš„é›†ç¾¤ï¼Œè€Œ 30007 å’Œ 30008 æ˜¯åé¢åŠ¨æ€æ·»åŠ çš„ä¸»ä»èŠ‚ç‚¹ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>--cluster info</code> å‘½ä»¤æ¥çœ‹ä¸€ä¸‹ä¸»èŠ‚ç‚¹å’Œæ§½ä½çš„åˆ†é…æƒ…å†µï¼Œæ‰§è¡Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>$ redis-cli --cluster info 127.0.0.1:30001
127.0.0.1:30001 (887397e6...) -&gt; 0 keys | 5461 slots | 1 slaves.
127.0.0.1:30007 (df019085...) -&gt; 0 keys | 0 slots | 1 slaves.
127.0.0.1:30003 (f5958382...) -&gt; 0 keys | 5461 slots | 1 slaves.
127.0.0.1:30002 (3da35c40...) -&gt; 0 keys | 5462 slots | 1 slaves.
[OK] 0 keys in 4 masters.
0.00 keys per slot on average.

</code></pre><p>å¯ä»¥çœ‹å‡ºåŠ¨æ€æ·»åŠ çš„ä¸»èŠ‚ç‚¹ 30007 æœ‰ä¸€ä¸ªä»èŠ‚ç‚¹ï¼Œä½†å¹¶æ²¡æœ‰åˆ†é…ä»»ä½•æ§½ä½ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚çš„ï¼Œåªæ·»åŠ äº†èŠ‚ç‚¹ï¼Œä½†ä¸å¤„ç†ä»»ä½•æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é‡æ–°åˆ†ç‰‡ï¼Œè®©æ•°æ®å­˜å‚¨åœ¨æ‰€æœ‰çš„ä¸»èŠ‚ç‚¹ä¸Šï¼Œè¿™æ ·æ‰èƒ½å‘æŒ¥é›†ç¾¤çš„æœ€å¤§ä½œç”¨ã€‚</p>
<h3 id="é‡æ–°åˆ†ç‰‡">é‡æ–°åˆ†ç‰‡</h3>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ reshard å‘½ä»¤ï¼Œå¯¹æ§½ä½ï¼ˆslotsï¼‰è¿›è¡Œé‡æ–°åˆ†é…ï¼Œæ‰§è¡Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>$ redis-cli --cluster reshard 127.0.0.1:30007
&gt;&gt;&gt; Performing Cluster Check (using node 127.0.0.1:30007)
M: df0190853a53d8e078205d0e2fa56046f20362a7 127.0.0.1:30007
   slots:[0-1332],[5461-6794],[10923-12255] (4000 slots) master
   1 additional replica(s)
S: dc0702625743c48c75ea935c87813c4060547cef 127.0.0.1:30006
   slots: (0 slots) slave
   replicates 3da35c40c43b457a113b539259f17e7ed616d13d
M: 3da35c40c43b457a113b539259f17e7ed616d13d 127.0.0.1:30002
   slots:[6795-10922] (4128 slots) master
   1 additional replica(s)
S: 1a324d828430f61be6eaca7eb2a90728dd5049de 127.0.0.1:30004
   slots: (0 slots) slave
   replicates f5958382af41d4e1f5b0217c1413fe19f390b55f
S: 1d09d26fd755298709efe60278457eaa09cefc26 127.0.0.1:30008
   slots: (0 slots) slave
   replicates df0190853a53d8e078205d0e2fa56046f20362a7
S: abec9f98f9c01208ba77346959bc35e8e274b6a3 127.0.0.1:30005
   slots: (0 slots) slave
   replicates 887397e6fefe8ad19ea7569e99f5eb8a803e3785
M: f5958382af41d4e1f5b0217c1413fe19f390b55f 127.0.0.1:30003
   slots:[12256-16383] (4128 slots) master
   1 additional replica(s)
M: 887397e6fefe8ad19ea7569e99f5eb8a803e3785 127.0.0.1:30001
   slots:[1333-5460] (4128 slots) master
   1 additional replica(s)
[OK] All nodes agree about slots configuration.
&gt;&gt;&gt; Check for open slots...
&gt;&gt;&gt; Check slots coverage...
[OK] All 16384 slots covered.
How many slots do you want to move (from 1 to 16384)?

</code></pre><p>åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå®ƒä¼šè¯¢é—®ä½ æ‰“ç®—ç§»åŠ¨å¤šå°‘ä¸ªèŠ‚ç‚¹ï¼Œå–å€¼èŒƒå›´æ˜¯ 1 åˆ° 16384ï¼Œæˆ‘ä»¬è¿™é‡Œè¾“å…¥ 4000ï¼Œæ„æ€æ˜¯ç§»åŠ¨ 4000 ä¸ªæ§½ä½åˆ°æŸä¸ªä¸»èŠ‚ç‚¹ï¼Œè¾“å…¥å‘½ä»¤ä¹‹åï¼Œæ‰§è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>How many slots do you want to move (from 1 to 16384)? 4000
What is the receiving node ID?

</code></pre><p>æ¥ç€å®ƒä¼šè¯¢é—®ä½ éœ€è¦æŠŠè¿™äº›æ§½ä½åˆ†é…åˆ°å“ªä¸ªèŠ‚ç‚¹ä¸Šï¼Œè¯·è¾“å…¥èŠ‚ç‚¹ Idï¼Œæˆ‘ä»¬æŠŠä¸Šé¢ 30007 ç«¯å£çš„ Id è¾“å…¥è¿›å»ä¹‹åï¼Œæ•²å‡»å›è½¦ï¼Œæ‰§è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>How many slots do you want to move (from 1 to 16384)? 4000
What is the receiving node ID? df0190853a53d8e078205d0e2fa56046f20362a7
Please enter all the source node IDs.
  Type 'all' to use all the nodes as source nodes for the hash slots.
  Type 'done' once you entered all the source nodes IDs.
Source node #1:

</code></pre><p>æ­¤æ—¶å®ƒä¼šè¯¢é—®ä½ è¦ä»é‚£ä¸ªæºèŠ‚ç‚¹ä¸­è¿›è¡Œè½¬ç§»ï¼Œè¾“å…¥ <code>all</code> å‘½ä»¤è¡¨ç¤ºä»æ‰€æœ‰èŠ‚ç‚¹ä¸­éšæœºæŠ½å–ï¼Œæ‰§è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code># ......å¿½ç•¥å…¶ä»–
Moving slot 2656 from 887397e6fefe8ad19ea7569e99f5eb8a803e3785
Moving slot 2657 from 887397e6fefe8ad19ea7569e99f5eb8a803e3785
Moving slot 2658 from 887397e6fefe8ad19ea7569e99f5eb8a803e3785
Moving slot 2659 from 887397e6fefe8ad19ea7569e99f5eb8a803e3785
Moving slot 2660 from 887397e6fefe8ad19ea7569e99f5eb8a803e3785
Moving slot 2661 from 887397e6fefe8ad19ea7569e99f5eb8a803e3785
Moving slot 2662 from 887397e6fefe8ad19ea7569e99f5eb8a803e3785
Moving slot 2663 from 887397e6fefe8ad19ea7569e99f5eb8a803e3785
Moving slot 2664 from 887397e6fefe8ad19ea7569e99f5eb8a803e3785
Moving slot 2665 from 887397e6fefe8ad19ea7569e99f5eb8a803e3785
Do you want to proceed with the proposed reshard plan (yes/no)?

</code></pre><p>æ­¤æ—¶å®ƒä¼šæŠŠæ‰€æœ‰è¦è½¬ç§»çš„èŠ‚ç‚¹ä¿¡æ¯åˆ—ä¸¾å‡ºæ¥ï¼Œè®©ä½ ç¡®è®¤ï¼Œä½ åªéœ€è¦è¾“å…¥ <code>yes</code> å°±å¼€å§‹æ‰§è¡Œè½¬ç§»æ“ä½œäº†ã€‚</p>
<p>åœ¨æ‰§è¡Œå®Œè½¬ç§»ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>cluster slots</code> å‘½ä»¤æ¥æŸ¥çœ‹ä¸€ä¸‹æ§½ä½çš„ç›¸å…³ä¿¡æ¯ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>$ redis-cli -c -p 30001
127.0.0.1:30001&gt; cluster slots # æŸ¥çœ‹é›†ç¾¤æ§½ä½ä¿¡æ¯
1) 1) (integer) 0
   2) (integer) 1332
   3) 1) &quot;127.0.0.1&quot;
      2) (integer) 30007
      3) &quot;df0190853a53d8e078205d0e2fa56046f20362a7&quot;
   4) 1) &quot;127.0.0.1&quot;
      2) (integer) 30008
      3) &quot;1d09d26fd755298709efe60278457eaa09cefc26&quot;
2) 1) (integer) 5461
   2) (integer) 6794
   3) 1) &quot;127.0.0.1&quot;
      2) (integer) 30007
      3) &quot;df0190853a53d8e078205d0e2fa56046f20362a7&quot;
   4) 1) &quot;127.0.0.1&quot;
      2) (integer) 30008
      3) &quot;1d09d26fd755298709efe60278457eaa09cefc26&quot;
3) 1) (integer) 10923
   2) (integer) 12255
   3) 1) &quot;127.0.0.1&quot;
      2) (integer) 30007
      3) &quot;df0190853a53d8e078205d0e2fa56046f20362a7&quot;
   4) 1) &quot;127.0.0.1&quot;
      2) (integer) 30008
      3) &quot;1d09d26fd755298709efe60278457eaa09cefc26&quot;
4) 1) (integer) 12256
   2) (integer) 16383
   3) 1) &quot;127.0.0.1&quot;
      2) (integer) 30003
      3) &quot;f5958382af41d4e1f5b0217c1413fe19f390b55f&quot;
   4) 1) &quot;127.0.0.1&quot;
      2) (integer) 30004
      3) &quot;1a324d828430f61be6eaca7eb2a90728dd5049de&quot;
5) 1) (integer) 6795
   2) (integer) 10922
   3) 1) &quot;127.0.0.1&quot;
      2) (integer) 30002
      3) &quot;3da35c40c43b457a113b539259f17e7ed616d13d&quot;
   4) 1) &quot;127.0.0.1&quot;
      2) (integer) 30006
      3) &quot;dc0702625743c48c75ea935c87813c4060547cef&quot;
6) 1) (integer) 1333
   2) (integer) 5460
   3) 1) &quot;127.0.0.1&quot;
      2) (integer) 30001
      3) &quot;887397e6fefe8ad19ea7569e99f5eb8a803e3785&quot;
   4) 1) &quot;127.0.0.1&quot;
      2) (integer) 30005
      3) &quot;abec9f98f9c01208ba77346959bc35e8e274b6a3&quot;

</code></pre><p>ä»ç»“æœå¯ä»¥çœ‹å‡º 30007 åˆ†åˆ«ä»å…¶ä»–ä¸‰ä¸ªä¸»èŠ‚ç‚¹ä¸­æŠ½å–äº†ä¸€éƒ¨åˆ†æ§½ä½ï¼Œä½œä¸ºäº†è‡ªå·±çš„æ§½ä½ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼Œæ‰§è¡Œæ­¤è¿‡ç¨‹ä¸­å¦‚æœå‡ºç° <code>/usr/bin/env: ruby: No such file or directory</code> é”™è¯¯ï¼Œè¡¨æ˜å·¥å…·åœ¨æ‰§è¡Œçš„æ—¶å€™éœ€è¦ä¾èµ– Ruby ç¯å¢ƒï¼Œå¯ä½¿ç”¨å‘½ä»¤ <code>yum install ruby</code> å®‰è£… Ruby ç¯å¢ƒå³å¯ã€‚</p>
</blockquote>
<h3 id="æ§½ä½å®šä½ç®—æ³•">æ§½ä½å®šä½ç®—æ³•</h3>
<p>Redis é›†ç¾¤æ€»å…±çš„æ§½ä½æ•°æ˜¯ 16384 ä¸ªï¼Œæ¯ä¸€ä¸ªä¸»èŠ‚ç‚¹è´Ÿè´£ç»´æŠ¤ä¸€éƒ¨åˆ†æ§½ä»¥åŠæ§½æ‰€æ˜ å°„çš„é”®å€¼æ•°æ®ï¼ŒRedis é›†ç¾¤é»˜è®¤ä¼šå¯¹è¦å­˜å‚¨çš„ key å€¼ä½¿ç”¨ CRC16 ç®—æ³•è¿›è¡Œ hash å¾—åˆ°ä¸€ä¸ªæ•´æ•°å€¼ï¼Œç„¶åç”¨è¿™ä¸ªæ•´æ•°å€¼å¯¹ 16384 è¿›è¡Œå–æ¨¡æ¥å¾—åˆ°å…·ä½“æ§½ä½ï¼Œå…¬å¼ä¸ºï¼š</p>
<blockquote>
<p>slot = CRC16(key) % 16383</p>
</blockquote>
<h3 id="è´Ÿè½½å‡è¡¡">è´Ÿè½½å‡è¡¡</h3>
<p>åœ¨ Redis é›†ç¾¤è´Ÿè½½ä¸å‡è¡¡çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ rebalance å‘½ä»¤é‡æ–°åˆ†é…å„ä¸ªèŠ‚ç‚¹è´Ÿè´£çš„æ§½æ•°é‡ï¼Œä»è€Œä½¿å¾—å„ä¸ªèŠ‚ç‚¹çš„è´Ÿè½½å‹åŠ›è¶‹äºå¹³è¡¡ï¼Œä»è€Œæé«˜ Redis é›†ç¾¤çš„æ•´ä½“è¿è¡Œæ•ˆç‡ã€‚</p>
<p>rebalance å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>$ redis-cli --cluster rebalance 127.0.0.1:30007

</code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿è¾“å…¥ rebalance å‘½ä»¤ï¼Œä½†å®ƒå¯èƒ½ä¸ä¼šæ‰§è¡Œï¼Œå½“å®ƒè®¤ä¸ºæ²¡æœ‰å¿…è¦è¿›è¡Œåˆ†é…æ—¶ä¼šç›´æ¥é€€å‡ºï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>$ redis-cli --cluster rebalance 127.0.0.1:30007
&gt;&gt;&gt; Performing Cluster Check (using node 127.0.0.1:30007)
[OK] All nodes agree about slots configuration.
&gt;&gt;&gt; Check for open slots...
&gt;&gt;&gt; Check slots coverage...
[OK] All 16384 slots covered.
*** No rebalancing needed! All nodes are within the 2.00% threshold.

</code></pre><h3 id="ä»£ç å®æˆ˜">ä»£ç å®æˆ˜</h3>
<p>å‰é¢æˆ‘ä»¬è®²äº† Redis é›†ç¾¤æ­å»ºçš„ç›¸å…³åŠŸèƒ½ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ Java ä»£ç æ¥æ“ä½œä¸€ä¸‹ Redis é›†ç¾¤ï¼Œæœ¬æ–‡ä¾ç„¶ä½¿ç”¨ Jedis æ¥ä½œä¸ºå®¢æˆ·ç«¯è¿›è¡Œç›¸å…³çš„æ“ä½œï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>import redis.clients.jedis.HostAndPort;
import redis.clients.jedis.JedisCluster;
import java.util.HashSet;
import java.util.Set;

public class ClusterExample {
    public static void main(String[] args) {
        // é›†ç¾¤èŠ‚ç‚¹ä¿¡æ¯
        Set&lt;HostAndPort&gt; nodes = new HashSet&lt;&gt;();
        nodes.add(new HostAndPort(&quot;127.0.0.1&quot;, 30001));
        nodes.add(new HostAndPort(&quot;127.0.0.1&quot;, 30002));
        nodes.add(new HostAndPort(&quot;127.0.0.1&quot;, 30003));
        nodes.add(new HostAndPort(&quot;127.0.0.1&quot;, 30004));
        nodes.add(new HostAndPort(&quot;127.0.0.1&quot;, 30005));
        nodes.add(new HostAndPort(&quot;127.0.0.1&quot;, 30006));
        // åˆ›å»ºé›†ç¾¤è¿æ¥
        JedisCluster jedisCluster = new JedisCluster(nodes,
                10000,  // è¶…æ—¶æ—¶é—´
                10);    // æœ€å¤§å°è¯•é‡è¿æ¬¡æ•°
        // æ·»åŠ æ•°æ®
        String setResult = jedisCluster.set(&quot;lang&quot;, &quot;redis&quot;);
        // è¾“å‡ºç»“æœ
        System.out.println(&quot;æ·»åŠ ï¼š&quot; + setResult);
        // æŸ¥è¯¢ç»“æœ
        String getResult = jedisCluster.get(&quot;lang&quot;);
        // è¾“å‡ºç»“æœ
        System.out.println(&quot;æŸ¥è¯¢ï¼š&quot; + getResult);
    }
}

</code></pre><p>ä»¥ä¸Šç¨‹åºçš„æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>æ·»åŠ ï¼šOK
æŸ¥è¯¢ï¼šredis

</code></pre><p>æ­¤ç»“æœè¡¨æ˜ Redis é›†ç¾¤æ“ä½œæ­£å¸¸ï¼Œé™¤äº†ä½¿ç”¨çš„æ“ä½œå¯¹è±¡ä¸åŒä¹‹å¤–ï¼Œæ“ä½œçš„æ–¹æ³•åç§°éƒ½æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥å¯¹ç¨‹åºå‘˜æ¥è¯´æ¯”è¾ƒå‹å¥½ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡åœºæ™¯å»å†™ç›¸åº”çš„ä»£ç äº†ã€‚</p>
<h3 id="æ•…éšœ">æ•…éšœ</h3>
<p>åœ¨æ–‡ç« çš„æœ€åéƒ¨åˆ†ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ Redis é›†ç¾¤æ•…éšœç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼Œè¿™æ ·åœ¨æˆ‘ä»¬é‡åˆ°ä¸€äº›æ•…éšœé—®é¢˜æ—¶å°±ä¸ä¼šé‚£ä¹ˆæ…Œå¼ äº†ï¼Œå¹¶ä¸”èƒ½ä¸ºæˆ‘ä»¬å¤„ç†æ•…éšœæ—¶æä¾›ä¸€äº›å¸®åŠ©ã€‚</p>
<h4 id="æ•…éšœå‘ç°"><strong>æ•…éšœå‘ç°</strong></h4>
<p>æ•…éšœå‘ç°é‡Œé¢æœ‰ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼šç–‘ä¼¼ä¸‹çº¿ï¼ˆPFAIL-Possibly Failï¼‰å’Œç¡®å®šä¸‹çº¿ï¼ˆFailï¼‰ã€‚</p>
<p>é›†ç¾¤ä¸­çš„å¥åº·ç›‘æµ‹æ˜¯é€šè¿‡å®šæœŸå‘é›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹å‘é€ PING ä¿¡æ¯æ¥ç¡®è®¤çš„ï¼Œå¦‚æœå‘é€ PING æ¶ˆæ¯çš„èŠ‚ç‚¹åœ¨è§„å®šæ—¶é—´å†…ï¼Œæ²¡æœ‰æ”¶åˆ°è¿”å›çš„ PONG æ¶ˆæ¯ï¼Œé‚£ä¹ˆå¯¹æ–¹èŠ‚ç‚¹å°±ä¼šè¢«æ ‡è®°ä¸ºç–‘ä¼¼ä¸‹çº¿ã€‚</p>
<p>ä¸€ä¸ªèŠ‚ç‚¹å‘ç°æŸä¸ªèŠ‚ç‚¹ç–‘ä¼¼ä¸‹çº¿ï¼Œå®ƒä¼šå°†è¿™æ¡ä¿¡æ¯å‘æ•´ä¸ªé›†ç¾¤å¹¿æ’­ï¼Œå…¶å®ƒèŠ‚ç‚¹å°±ä¼šæ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯ï¼Œå¹¶ä¸”é€šè¿‡ PING çš„æ–¹å¼ç›‘æµ‹æŸèŠ‚ç‚¹æ˜¯å¦çœŸçš„ä¸‹çº¿äº†ã€‚å¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ”¶åˆ°æŸä¸ªèŠ‚ç‚¹ç–‘ä¼¼ä¸‹çº¿çš„æ•°é‡è¶…è¿‡é›†ç¾¤æ•°é‡çš„ä¸€åŠä»¥ä¸Šï¼Œå°±å¯ä»¥æ ‡è®°è¯¥èŠ‚ç‚¹ä¸ºç¡®å®šä¸‹çº¿çŠ¶æ€ï¼Œç„¶åå‘æ•´ä¸ªé›†ç¾¤å¹¿æ’­ï¼Œå¼ºè¿«å…¶å®ƒèŠ‚ç‚¹ä¹Ÿæ¥æ”¶è¯¥èŠ‚ç‚¹å·²ç»ä¸‹çº¿çš„äº‹å®ï¼Œå¹¶ç«‹å³å¯¹è¯¥å¤±è”èŠ‚ç‚¹è¿›è¡Œä¸»ä»åˆ‡æ¢ã€‚</p>
<p>è¿™å°±æ˜¯ç–‘ä¼¼ä¸‹çº¿å’Œç¡®è®¤ä¸‹çº¿çš„æ¦‚å¿µï¼Œè¿™ä¸ªæ¦‚å¿µå’Œå“¨å…µæ¨¡å¼é‡Œé¢çš„ä¸»è§‚ä¸‹çº¿å’Œå®¢è§‚ä¸‹çº¿çš„æ¦‚å¿µæ¯”è¾ƒç±»ä¼¼ã€‚</p>
<h4 id="æ•…éšœè½¬ç§»"><strong>æ•…éšœè½¬ç§»</strong></h4>
<p>å½“ä¸€ä¸ªèŠ‚ç‚¹è¢«é›†ç¾¤æ ‡è¯†ä¸ºç¡®è®¤ä¸‹çº¿ä¹‹åå°±å¯ä»¥æ‰§è¡Œæ•…éšœè½¬ç§»äº†ï¼Œæ•…éšœè½¬ç§»çš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>ä»ä¸‹çº¿çš„ä¸»èŠ‚ç‚¹çš„æ‰€æœ‰ä»èŠ‚ç‚¹ä¸­ï¼Œé€‰æ‹©ä¸€ä¸ªä»èŠ‚ç‚¹ï¼ˆé€‰æ‹©çš„æ–¹æ³•è¯¦è§ä¸‹é¢â€œæ–°ä¸»èŠ‚ç‚¹é€‰ä¸¾åŸåˆ™â€éƒ¨åˆ†ï¼‰ï¼›</li>
<li>ä»èŠ‚ç‚¹ä¼šæ‰§è¡Œ SLAVEOF NO ONE å‘½ä»¤ï¼Œå…³é—­è¿™ä¸ªä»èŠ‚ç‚¹çš„å¤åˆ¶åŠŸèƒ½ï¼Œå¹¶ä»ä»èŠ‚ç‚¹è½¬å˜å›ä¸»èŠ‚ç‚¹ï¼ŒåŸæ¥åŒæ­¥æ‰€å¾—çš„æ•°æ®é›†ä¸ä¼šè¢«ä¸¢å¼ƒï¼›</li>
<li>æ–°çš„ä¸»èŠ‚ç‚¹ä¼šæ’¤é”€æ‰€æœ‰å¯¹å·²ä¸‹çº¿ä¸»èŠ‚ç‚¹çš„æ§½æŒ‡æ´¾ï¼Œå¹¶å°†è¿™äº›æ§½å…¨éƒ¨æŒ‡æ´¾ç»™è‡ªå·±ï¼›</li>
<li>æ–°çš„ä¸»èŠ‚ç‚¹å‘é›†ç¾¤å¹¿æ’­ä¸€æ¡ PONG æ¶ˆæ¯ï¼Œè¿™æ¡ PONG æ¶ˆæ¯æ˜¯è®©é›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹çŸ¥é“æ­¤èŠ‚ç‚¹å·²ç»ç”±ä»èŠ‚ç‚¹å˜æˆäº†ä¸»èŠ‚ç‚¹ï¼Œå¹¶ä¸”è¿™ä¸ªä¸»èŠ‚ç‚¹å·²ç»æ¥ç®¡äº†åŸæœ¬ç”±å·²ä¸‹çº¿èŠ‚ç‚¹è´Ÿè´£å¤„ç†çš„æ§½ä½ä¿¡æ¯ï¼›</li>
<li>æ–°çš„ä¸»èŠ‚ç‚¹å¼€å§‹å¤„ç†ç›¸å…³çš„å‘½ä»¤è¯·æ±‚ï¼Œæ­¤æ•…éšœè½¬ç§»è¿‡ç¨‹å®Œæˆã€‚</li>
</ol>
<h4 id="æ–°ä¸»èŠ‚ç‚¹é€‰ä¸¾åŸåˆ™"><strong>æ–°ä¸»èŠ‚ç‚¹é€‰ä¸¾åŸåˆ™</strong></h4>
<p>æ–°ä¸»èŠ‚ç‚¹é€‰ä¸¾çš„æ–¹æ³•æ˜¯è¿™æ ·çš„ï¼š</p>
<ol>
<li>é›†ç¾¤çš„çºªå…ƒï¼ˆepochï¼‰æ˜¯ä¸€ä¸ªè‡ªå¢è®¡æ•°å™¨ï¼Œåˆå§‹å€¼ä¸º0ï¼›</li>
<li>è€Œæ¯ä¸ªä¸»èŠ‚ç‚¹éƒ½æœ‰ä¸€æ¬¡æŠ•ç¥¨çš„æœºä¼šï¼Œä¸»èŠ‚ç‚¹ä¼šæŠŠè¿™ä¸€ç¥¨æŠ•ç»™ç¬¬ä¸€ä¸ªè¦æ±‚æŠ•ç¥¨çš„ä»èŠ‚ç‚¹ï¼›</li>
<li>å½“ä»èŠ‚ç‚¹å‘ç°è‡ªå·±æ­£åœ¨å¤åˆ¶çš„ä¸»èŠ‚ç‚¹ç¡®è®¤ä¸‹çº¿ä¹‹åï¼Œå°±ä¼šå‘é›†ç¾¤å¹¿æ’­ä¸€æ¡æ¶ˆæ¯ï¼Œè¦æ±‚æ‰€æœ‰æœ‰æŠ•ç¥¨æƒçš„ä¸»èŠ‚ç‚¹ç»™æ­¤ä»èŠ‚ç‚¹æŠ•ç¥¨ï¼›</li>
<li>å¦‚æœæœ‰æŠ•ç¥¨æƒçš„ä¸»èŠ‚ç‚¹è¿˜æ²¡æœ‰ç»™å…¶ä»–äººæŠ•ç¥¨çš„æƒ…å†µä¸‹ï¼Œå®ƒä¼šå‘ç¬¬ä¸€ä¸ªè¦æ±‚æŠ•ç¥¨çš„ä»èŠ‚ç‚¹å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œè¡¨ç¤ºæŠŠè¿™ä¸€ç¥¨æŠ•ç»™è¿™ä¸ªä»èŠ‚ç‚¹ï¼›</li>
<li>å½“ä»èŠ‚ç‚¹æ”¶åˆ°æŠ•ç¥¨æ•°é‡å¤§äºé›†ç¾¤æ•°é‡çš„åŠæ•°ä»¥ä¸Šæ—¶ï¼Œè¿™ä¸ªä»èŠ‚ç‚¹å°±ä¼šå½“é€‰ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ã€‚</li>
</ol>
<p>åˆ°è¿™é‡Œæ•´ä¸ªæ–°ä¸»èŠ‚ç‚¹çš„é€‰æ‹©å°±å®Œæˆäº†ã€‚</p>
<h3 id="å°ç»“">å°ç»“</h3>
<p>æœ¬æ–‡ä»åŠ¨æ€æ–°å¢çš„ä¸»èŠ‚ç‚¹é€šè¿‡ reshard å‘½ä»¤é‡æ–°åˆ†é…æ§½ä½å¼€å§‹ï¼Œè®²äº†æ§½ä½å®šä½çš„ç®—æ³•ä»¥åŠè´Ÿè½½å‡è¡¡çš„å®ç°æ–¹æ³•ï¼Œè¿˜ä½¿ç”¨ä»£ç çš„æ–¹å¼æ¼”ç¤ºäº†å¦‚ä½•åœ¨ç¨‹åºä¸­æ“ä½œ Redis é›†ç¾¤ï¼Œæœ€åè®²äº† Redis é›†ç¾¤æ•…éšœå‘ç°ä»¥åŠæ•…éšœè½¬ç§»ã€æ–°ä¸»èŠ‚ç‚¹é€‰ä¸¾çš„æ•´ä¸ªæµç¨‹ï¼Œå¸Œæœ›å¯¹ä½ ç†è§£ Redis çš„é›†ç¾¤æœ‰å¸®åŠ©ã€‚</p>

        </div>
    </article>
</div>

    </main>
    <footer>
        <div id="pagination">
            
<div class="paginator">
    <div class="prev">
        
        <a href="/documents/columns/redis/redis-%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/41-%E6%A1%88%E4%BE%8Bredis-%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB%E5%92%8C%E7%9B%B8%E5%85%B3%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88.md/"><span></span></a>
    </div>
    <div class="next">
        
        <a href="/documents/columns/redis/redis-%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/39-%E5%AE%9E%E6%88%98redis-%E9%9B%86%E7%BE%A4%E6%A8%A1%E5%BC%8F%E4%B8%8A.md/"><span></span></a>
    </div>
</div>

        </div>
        <div class="toggler" onclick="toggleLight(this);">ğŸ’¡</div>
        <div id="copyright" style="display: none;">
    
    
    <p>&copy; 28280 <a href="/"></a>, powered by Hugo and Qiao</p>
</div>
    </footer>
    
<script>
    function toggleLight() {
        document.getElementById('page').classList.toggle('night');
    }
</script>
</body>

</html>