<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
<meta name="X-UA-Compatible" , content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<link rel="icon" type="image/png" href="/%20/favicon.png">

<title>33 å®æˆ˜ï¼šRedis æ€§èƒ½æµ‹è¯• | Yipsen Ye</title>
<meta name="description" content="ä¸ºä»€ä¹ˆéœ€è¦æ€§èƒ½æµ‹è¯•ï¼Ÿ æ€§èƒ½æµ‹è¯•çš„ä½¿ç”¨åœºæ™¯æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚ä»¥ä¸‹å‡ ä¸ªï¼š
 æŠ€æœ¯é€‰å‹ï¼Œæ¯”å¦‚æµ‹è¯• Memcached å’Œ Redisï¼› å¯¹æ¯”å•æœº Redis å’Œé›†ç¾¤ Redis çš„ååé‡ï¼› è¯„ä¼°ä¸åŒç±»å‹çš„å­˜å‚¨æ€§èƒ½ï¼Œä¾‹å¦‚é›†åˆå’Œæœ‰åºé›†åˆï¼› å¯¹æ¯”å¼€å¯æŒä¹…åŒ–å’Œå…³é—­æŒä¹…åŒ–çš„ååé‡ï¼› å¯¹æ¯”è°ƒä¼˜å’Œæœªè°ƒä¼˜çš„ååé‡ï¼› å¯¹æ¯”ä¸åŒ Redis ç‰ˆæœ¬çš„ååé‡ï¼Œä½œä¸ºæ˜¯å¦å‡çº§çš„ä¸€ä¸ªå‚è€ƒæ ‡å‡†ã€‚  ç­‰ç­‰ï¼Œè¯¸å¦‚æ­¤ç±»çš„æƒ…å†µï¼Œæˆ‘ä»¬éƒ½éœ€è¦è¿›è¡Œæ€§èƒ½æµ‹è¯•ã€‚
æ€§èƒ½æµ‹è¯•çš„å‡ ç§æ–¹å¼ æ—¢ç„¶æ€§èƒ½æµ‹è¯•ä½¿ç”¨åœºæ™¯é‚£ä¹ˆå¤šï¼Œé‚£è¦æ€ä¹ˆè¿›è¡Œæ€§èƒ½æµ‹è¯•å‘¢ï¼Ÿ
ç›®å‰æ¯”è¾ƒä¸»æµçš„æ€§èƒ½æµ‹è¯•åˆ†ä¸ºä¸¤ç§ï¼š
 ç¼–å†™ä»£ç æ¨¡æ‹Ÿå¹¶å‘è¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼› ä½¿ç”¨ redis-benchmark è¿›è¡Œæµ‹è¯•ã€‚  å› ä¸ºè‡ªå·±ç¼–å†™ä»£ç è¿›è¡Œæ€§èƒ½æµ‹è¯•çš„æ–¹å¼ä¸å¤Ÿçµæ´»ï¼Œä¸”å¾ˆéš¾çŸ­æ—¶é—´å†…æ¨¡æ‹Ÿå¤§é‡çš„å¹¶å‘æ•°ï¼Œæ‰€æœ‰ä½œè€…å¹¶ä¸å»ºè®®ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚å¹¸è¿çš„æ˜¯ Redis æœ¬èº«ç»™æˆ‘ä»¬æä¾›äº†æ€§èƒ½æµ‹è¯•å·¥å…· redis-benchmarkï¼ˆRedis åŸºå‡†æµ‹è¯•ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬æœ¬æ–‡é‡ç‚¹æ¥ä»‹ç» redis-benchmark çš„ä½¿ç”¨ã€‚
åŸºå‡†æµ‹è¯•å®æˆ˜ redis-benchmark ä½äº Redis çš„ src ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ./redis-benchmark -h æ¥æŸ¥çœ‹åŸºå‡†æµ‹è¯•çš„ä½¿ç”¨ï¼Œæ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š
Usage: redis-benchmark [-h &amp;lt;host&amp;gt;] [-p &amp;lt;port&amp;gt;] [-c &amp;lt;clients&amp;gt;] [-n &amp;lt;requests&amp;gt;] [-k &amp;lt;boolean&amp;gt;]-h &amp;lt;hostname&amp;gt; Server hostname (default 127.0.0.1)-p &amp;lt;port&amp;gt; Server port (default 6379)-s &amp;lt;socket&amp;gt; Server socket (overrides host and port)-a &amp;lt;password&amp;gt; Password for Redis Auth-c &amp;lt;clients&amp;gt; Number of parallel connections (default 50)-n &amp;lt;requests&amp;gt; Total number of requests (default 100000)-d &amp;lt;size&amp;gt; Data size of SET/GET value in bytes (default 3)--dbnum &amp;lt;db&amp;gt; SELECT the specified db number (default 0)-k &amp;lt;boolean&amp;gt; 1=keep alive 0=reconnect (default 1)-r &amp;lt;keyspacelen&amp;gt; Use random keys for SET/GET/INCR, random values for SADDUsing this option the benchmark will expand the string __rand_int__inside an argument with a 12 digits number in the specified rangefrom 0 to keyspacelen-1.">
<meta name="author" content="">

<link rel="stylesheet" type="text/css" href="/styles/main.css">

</head>

<body id="page">
    <header>
        <div class="nav-logo">
    <a href="http://yipsen.github.io/">
        
        <span class="nav-title">Yipsen Ye</span>
    </a>
</div>
<nav class="navbar justify-content-end">
    <ul class="nav-list">
        
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/posts/">æ–‡ç« </a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/collections/">é™„è¡¨</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/about/">å…³äº</a>
        </li>
        
    </ul>
</nav>
    </header>
    <main id="content">
        
<div class="container"><aside>
    <div>
        
        
            
            
            <div class="post-category-icon"></div>
            <a href="/categories/redis%20%e6%a0%b8%e5%bf%83%e5%8e%9f%e7%90%86%e4%b8%8e%e5%ae%9e%e6%88%98/">Redis æ ¸å¿ƒåŸç†ä¸å®æˆ˜</a>
            <ul>
                
            </ul>
        
    </div>
</aside>

<style>
    aside {
        position: fixed;
        left: 20px;
        background: #ffdee3;
        border-radius: 6px;
        padding: 20px;
        padding-top: 60px;
        box-shadow: 5px 10px #888;
        list-style-type: none;
        display: none;
    }

    .post-category-icon {
        position: absolute;
        width: 80px;
        height: 80px;
        top: -40px;
        left: 50%;
        margin-left: -40px;
        text-align: center;
        font-size: 36px;
        content: 'J';
        background: #ffdee3;
        border-radius: 100%;
        border: 10px solid #fff;
        box-shadow: 5px 10px #888;
    }
</style><article class="post-block">
        <h1 class="post-title">33 å®æˆ˜ï¼šRedis æ€§èƒ½æµ‹è¯•</h1>
        <div class="post-info">
            <div class="post-date"> 
                <span>2022-09-28 19:38:26</span>
            </div>
        </div>
        <div class="post-content">
            <h3 id="ä¸ºä»€ä¹ˆéœ€è¦æ€§èƒ½æµ‹è¯•">ä¸ºä»€ä¹ˆéœ€è¦æ€§èƒ½æµ‹è¯•ï¼Ÿ</h3>
<p>æ€§èƒ½æµ‹è¯•çš„ä½¿ç”¨åœºæ™¯æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚ä»¥ä¸‹å‡ ä¸ªï¼š</p>
<ol>
<li>æŠ€æœ¯é€‰å‹ï¼Œæ¯”å¦‚æµ‹è¯• Memcached å’Œ Redisï¼›</li>
<li>å¯¹æ¯”å•æœº Redis å’Œé›†ç¾¤ Redis çš„ååé‡ï¼›</li>
<li>è¯„ä¼°ä¸åŒç±»å‹çš„å­˜å‚¨æ€§èƒ½ï¼Œä¾‹å¦‚é›†åˆå’Œæœ‰åºé›†åˆï¼›</li>
<li>å¯¹æ¯”å¼€å¯æŒä¹…åŒ–å’Œå…³é—­æŒä¹…åŒ–çš„ååé‡ï¼›</li>
<li>å¯¹æ¯”è°ƒä¼˜å’Œæœªè°ƒä¼˜çš„ååé‡ï¼›</li>
<li>å¯¹æ¯”ä¸åŒ Redis ç‰ˆæœ¬çš„ååé‡ï¼Œä½œä¸ºæ˜¯å¦å‡çº§çš„ä¸€ä¸ªå‚è€ƒæ ‡å‡†ã€‚</li>
</ol>
<p>ç­‰ç­‰ï¼Œè¯¸å¦‚æ­¤ç±»çš„æƒ…å†µï¼Œæˆ‘ä»¬éƒ½éœ€è¦è¿›è¡Œæ€§èƒ½æµ‹è¯•ã€‚</p>
<h3 id="æ€§èƒ½æµ‹è¯•çš„å‡ ç§æ–¹å¼">æ€§èƒ½æµ‹è¯•çš„å‡ ç§æ–¹å¼</h3>
<p>æ—¢ç„¶æ€§èƒ½æµ‹è¯•ä½¿ç”¨åœºæ™¯é‚£ä¹ˆå¤šï¼Œé‚£è¦æ€ä¹ˆè¿›è¡Œæ€§èƒ½æµ‹è¯•å‘¢ï¼Ÿ</p>
<p>ç›®å‰æ¯”è¾ƒä¸»æµçš„æ€§èƒ½æµ‹è¯•åˆ†ä¸ºä¸¤ç§ï¼š</p>
<ol>
<li>ç¼–å†™ä»£ç æ¨¡æ‹Ÿå¹¶å‘è¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼›</li>
<li>ä½¿ç”¨ redis-benchmark è¿›è¡Œæµ‹è¯•ã€‚</li>
</ol>
<p>å› ä¸ºè‡ªå·±ç¼–å†™ä»£ç è¿›è¡Œæ€§èƒ½æµ‹è¯•çš„æ–¹å¼ä¸å¤Ÿçµæ´»ï¼Œä¸”å¾ˆéš¾çŸ­æ—¶é—´å†…æ¨¡æ‹Ÿå¤§é‡çš„å¹¶å‘æ•°ï¼Œæ‰€æœ‰ä½œè€…å¹¶ä¸å»ºè®®ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚å¹¸è¿çš„æ˜¯ Redis æœ¬èº«ç»™æˆ‘ä»¬æä¾›äº†æ€§èƒ½æµ‹è¯•å·¥å…· redis-benchmarkï¼ˆRedis åŸºå‡†æµ‹è¯•ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬æœ¬æ–‡é‡ç‚¹æ¥ä»‹ç» redis-benchmark çš„ä½¿ç”¨ã€‚</p>
<h3 id="åŸºå‡†æµ‹è¯•å®æˆ˜">åŸºå‡†æµ‹è¯•å®æˆ˜</h3>
<p>redis-benchmark ä½äº Redis çš„ src ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>./redis-benchmark -h</code> æ¥æŸ¥çœ‹åŸºå‡†æµ‹è¯•çš„ä½¿ç”¨ï¼Œæ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>Usage: redis-benchmark [-h &lt;host&gt;] [-p &lt;port&gt;] [-c &lt;clients&gt;] [-n &lt;requests&gt;] [-k &lt;boolean&gt;]

 -h &lt;hostname&gt;      Server hostname (default 127.0.0.1)
 -p &lt;port&gt;          Server port (default 6379)
 -s &lt;socket&gt;        Server socket (overrides host and port)
 -a &lt;password&gt;      Password for Redis Auth
 -c &lt;clients&gt;       Number of parallel connections (default 50)
 -n &lt;requests&gt;      Total number of requests (default 100000)
 -d &lt;size&gt;          Data size of SET/GET value in bytes (default 3)
 --dbnum &lt;db&gt;       SELECT the specified db number (default 0)
 -k &lt;boolean&gt;       1=keep alive 0=reconnect (default 1)
 -r &lt;keyspacelen&gt;   Use random keys for SET/GET/INCR, random values for SADD
  Using this option the benchmark will expand the string __rand_int__
  inside an argument with a 12 digits number in the specified range
  from 0 to keyspacelen-1. The substitution changes every time a command
  is executed. Default tests use this to hit random keys in the
  specified range.
 -P &lt;numreq&gt;        Pipeline &lt;numreq&gt; requests. Default 1 (no pipeline).
 -e                 If server replies with errors, show them on stdout.
                    (no more than 1 error per second is displayed)
 -q                 Quiet. Just show query/sec values
 --csv              Output in CSV format
 -l                 Loop. Run the tests forever
 -t &lt;tests&gt;         Only run the comma separated list of tests. The test
                    names are the same as the ones produced as output.
 -I                 Idle mode. Just open N idle connections and wait.

</code></pre><p>å¯ä»¥çœ‹å‡º redis-benchmark æ”¯æŒä»¥ä¸‹é€‰é¡¹ï¼š</p>
<ul>
<li><code>-h &lt;hostname&gt;</code>ï¼šæœåŠ¡å™¨çš„ä¸»æœºåï¼ˆé»˜è®¤å€¼ä¸º 127.0.0.1ï¼‰ã€‚</li>
<li><code>-p &lt;port&gt;</code>ï¼šæœåŠ¡å™¨çš„ç«¯å£å·ï¼ˆé»˜è®¤å€¼ä¸º 6379ï¼‰ã€‚</li>
<li><code>-s &lt;socket&gt;</code>ï¼šæœåŠ¡å™¨çš„å¥—æ¥å­—ï¼ˆä¼šè¦†ç›–ä¸»æœºåå’Œç«¯å£å·ï¼‰ã€‚</li>
<li><code>-a &lt;password&gt;</code>ï¼šç™»å½• Redis æ—¶è¿›è¡Œèº«ä»½éªŒè¯çš„å¯†ç ã€‚</li>
<li><code>-c &lt;clients&gt;</code>ï¼šå¹¶å‘çš„è¿æ¥æ•°é‡ï¼ˆé»˜è®¤å€¼ä¸º 50ï¼‰ã€‚</li>
<li><code>-n &lt;requests&gt;</code>ï¼šå‘å‡ºçš„è¯·æ±‚æ€»æ•°ï¼ˆé»˜è®¤å€¼ä¸º 100000ï¼‰ã€‚</li>
<li><code>-d &lt;size&gt;</code>ï¼šSET/GET å‘½ä»¤æ‰€æ“ä½œçš„å€¼çš„æ•°æ®å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ï¼ˆé»˜è®¤å€¼ä¸º 2ï¼‰ã€‚</li>
<li><code>â€“dbnum &lt;db&gt;</code>ï¼šé€‰æ‹©ç”¨äºæ€§èƒ½æµ‹è¯•çš„æ•°æ®åº“çš„ç¼–å·ï¼ˆé»˜è®¤å€¼ä¸º 0ï¼‰ã€‚</li>
<li><code>-k &lt;boolean&gt;</code>ï¼š1 = ä¿æŒè¿æ¥ï¼›0 = é‡æ–°è¿æ¥ï¼ˆé»˜è®¤å€¼ä¸º 1ï¼‰ã€‚</li>
<li><code>-r &lt;keyspacelen&gt;</code>ï¼šSET/GET/INCR å‘½ä»¤ä½¿ç”¨éšæœºé”®ï¼ŒSADD å‘½ä»¤ä½¿ç”¨éšæœºå€¼ã€‚é€šè¿‡è¿™ä¸ªé€‰é¡¹ï¼ŒåŸºå‡†æµ‹è¯•ä¼šå°†å‚æ•°ä¸­çš„ <code>__rand_int__</code> å­—ç¬¦ä¸²æ›¿æ¢ä¸ºä¸€ä¸ª 12 ä½çš„æ•´æ•°ï¼Œè¿™ä¸ªæ•´æ•°çš„å–å€¼èŒƒå›´ä» 0 åˆ° keyspacelen-1ã€‚æ¯æ¬¡æ‰§è¡Œä¸€æ¡å‘½ä»¤çš„æ—¶å€™ï¼Œç”¨äºæ›¿æ¢çš„æ•´æ•°å€¼éƒ½ä¼šæ”¹å˜ã€‚é€šè¿‡è¿™ä¸ªå‚æ•°ï¼Œé»˜è®¤çš„æµ‹è¯•æ–¹æ¡ˆä¼šåœ¨æŒ‡å®šèŒƒå›´ä¹‹å†…å°è¯•å‘½ä¸­éšæœºé”®ã€‚</li>
<li><code>-P &lt;numreq&gt;</code>ï¼šä½¿ç”¨ç®¡é“æœºåˆ¶å¤„ç† <code>&lt;numreq&gt;</code> æ¡ Redis è¯·æ±‚ã€‚é»˜è®¤å€¼ä¸º 1ï¼ˆä¸ä½¿ç”¨ç®¡é“æœºåˆ¶ï¼‰ã€‚</li>
<li><code>-q</code>ï¼šé™é»˜æµ‹è¯•ï¼Œåªæ˜¾ç¤º QPS çš„å€¼ã€‚</li>
<li><code>â€“csv</code>ï¼šå°†æµ‹è¯•ç»“æœè¾“å‡ºä¸º CSV æ ¼å¼çš„æ–‡ä»¶ã€‚</li>
<li><code>-l</code>ï¼šå¾ªç¯æµ‹è¯•ã€‚åŸºå‡†æµ‹è¯•ä¼šæ°¸è¿œè¿è¡Œä¸‹å»ã€‚</li>
<li><code>-t &lt;tests&gt;</code>ï¼šåŸºå‡†æµ‹è¯•åªä¼šè¿è¡Œåˆ—è¡¨ä¸­ç”¨é€—å·åˆ†éš”çš„å‘½ä»¤ã€‚æµ‹è¯•å‘½ä»¤çš„åç§°å’Œç»“æœè¾“å‡ºäº§ç”Ÿçš„åç§°ç›¸åŒã€‚</li>
<li><code>-I</code>ï¼šç©ºé—²æ¨¡å¼ï¼Œåªä¼šæ‰“å¼€ N ä¸ªç©ºé—²çš„è¿æ¥ï¼Œç„¶åç­‰å¾…ã€‚</li>
</ul>
<p>å¯ä»¥çœ‹å‡º redis-benchmark å¸¦çš„åŠŸèƒ½è¿˜æ˜¯æ¯”è¾ƒå…¨çš„ã€‚</p>
<h4 id="åŸºæœ¬ä½¿ç”¨"><strong>åŸºæœ¬ä½¿ç”¨</strong></h4>
<p>åœ¨å®‰è£… Redis æœåŠ¡ç«¯çš„æœºå™¨ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä¸å¸¦ä»»ä½•å‚æ•°ç›´æ¥æ‰§è¡Œ <code>./redis-benchmark</code> æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>[@iZ2ze0nc5n41zomzyqtksmZ:src]$ ./redis-benchmark
====== PING_INLINE ======
  100000 requests completed in 1.26 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.81% &lt;= 1 milliseconds
100.00% &lt;= 2 milliseconds
79302.14 requests per second

====== PING_BULK ======
  100000 requests completed in 1.29 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.83% &lt;= 1 milliseconds
100.00% &lt;= 1 milliseconds
77459.34 requests per second

====== SET ======
  100000 requests completed in 1.26 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.80% &lt;= 1 milliseconds
99.99% &lt;= 2 milliseconds
100.00% &lt;= 2 milliseconds
79239.30 requests per second

====== GET ======
  100000 requests completed in 1.19 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.72% &lt;= 1 milliseconds
99.95% &lt;= 15 milliseconds
100.00% &lt;= 16 milliseconds
100.00% &lt;= 16 milliseconds
84104.29 requests per second

====== INCR ======
  100000 requests completed in 1.17 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.86% &lt;= 1 milliseconds
100.00% &lt;= 1 milliseconds
85397.09 requests per second

====== LPUSH ======
  100000 requests completed in 1.22 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.79% &lt;= 1 milliseconds
100.00% &lt;= 1 milliseconds
82169.27 requests per second

====== RPUSH ======
  100000 requests completed in 1.22 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.71% &lt;= 1 milliseconds
100.00% &lt;= 1 milliseconds
81900.09 requests per second

====== LPOP ======
  100000 requests completed in 1.29 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.78% &lt;= 1 milliseconds
99.95% &lt;= 13 milliseconds
99.97% &lt;= 14 milliseconds
100.00% &lt;= 14 milliseconds
77399.38 requests per second

====== RPOP ======
  100000 requests completed in 1.25 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.82% &lt;= 1 milliseconds
100.00% &lt;= 1 milliseconds
80192.46 requests per second

====== SADD ======
  100000 requests completed in 1.25 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.74% &lt;= 1 milliseconds
100.00% &lt;= 1 milliseconds
80192.46 requests per second

====== HSET ======
  100000 requests completed in 1.21 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.86% &lt;= 1 milliseconds
100.00% &lt;= 1 milliseconds
82440.23 requests per second

====== SPOP ======
  100000 requests completed in 1.22 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.92% &lt;= 1 milliseconds
100.00% &lt;= 1 milliseconds
81699.35 requests per second

====== LPUSH (needed to benchmark LRANGE) ======
  100000 requests completed in 1.26 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.69% &lt;= 1 milliseconds
99.95% &lt;= 13 milliseconds
99.99% &lt;= 14 milliseconds
100.00% &lt;= 14 milliseconds
79176.56 requests per second

====== LRANGE_100 (first 100 elements) ======
  100000 requests completed in 1.25 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.57% &lt;= 1 milliseconds
99.98% &lt;= 2 milliseconds
100.00% &lt;= 2 milliseconds
80128.20 requests per second

====== LRANGE_300 (first 300 elements) ======
  100000 requests completed in 1.25 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.91% &lt;= 1 milliseconds
100.00% &lt;= 1 milliseconds
80064.05 requests per second

====== LRANGE_500 (first 450 elements) ======
  100000 requests completed in 1.30 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.78% &lt;= 1 milliseconds
100.00% &lt;= 1 milliseconds
76863.95 requests per second

====== LRANGE_600 (first 600 elements) ======
  100000 requests completed in 1.20 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.85% &lt;= 1 milliseconds
100.00% &lt;= 1 milliseconds
83263.95 requests per second

====== MSET (10 keys) ======
  100000 requests completed in 1.27 seconds
  50 parallel clients
  3 bytes payload
  keep alive: 1

99.65% &lt;= 1 milliseconds
100.00% &lt;= 1 milliseconds
78740.16 requests per second

</code></pre><p>å¯ä»¥çœ‹å‡ºä»¥ä¸Šéƒ½æ˜¯å¯¹å¸¸ç”¨çš„æ–¹æ³• Setã€Getã€Incr ç­‰è¿›è¡Œæµ‹è¯•ï¼ŒåŸºæœ¬èƒ½è¾¾åˆ°æ¯ç§’ 8W çš„å¤„ç†çº§åˆ«ã€‚</p>
<h4 id="ç²¾ç®€æµ‹è¯•"><strong>ç²¾ç®€æµ‹è¯•</strong></h4>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>./redis-benchmark -t set,get,incr -n 1000000 -q</code> å‘½ä»¤ï¼Œæ¥å¯¹ Redis æœåŠ¡å™¨è¿›è¡Œç²¾ç®€æµ‹è¯•ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>[@iZ2ze0nc5n41zomzyqtksmZ:src]$ ./redis-benchmark -t set,get,incr -n 1000000 -q
SET: 81726.05 requests per second
GET: 81466.40 requests per second
INCR: 82481.03 requests per second

</code></pre><p>å¯ä»¥çœ‹å‡ºä»¥ä¸Šæµ‹è¯•å±•ç¤ºçš„ç»“æœéå¸¸çš„ç²¾ç®€ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è®¾ç½®äº† <code>-q</code> å‚æ•°ï¼Œæ­¤é€‰é¡¹çš„æ„æ€æ˜¯è®¾ç½®è¾“å‡ºç»“æœä¸ºç²¾ç®€æ¨¡å¼ï¼Œå…¶ä¸­ <code>-t</code> è¡¨ç¤ºæŒ‡å®šæµ‹è¯•æŒ‡ä»¤ï¼Œ<code>-n</code> è®¾ç½®æ¯ä¸ªæŒ‡ä»¤æµ‹è¯• 100w æ¬¡ã€‚</p>
<h4 id="ç®¡é“æµ‹è¯•"><strong>ç®¡é“æµ‹è¯•</strong></h4>
<p>æœ¬è¯¾ç¨‹çš„å‰é¢ç« èŠ‚ä»‹ç»äº† Pipelineï¼ˆç®¡é“ï¼‰çš„çŸ¥è¯†ï¼Œå®ƒæ˜¯ç”¨äºå®¢æˆ·ç«¯æŠŠå‘½ä»¤æ‰¹é‡å‘ç»™æœåŠ¡å™¨ç«¯æ‰§è¡Œçš„ï¼Œä»¥æ­¤æ¥æé«˜ç¨‹åºçš„æ•´ä½“æ‰§è¡Œæ•ˆç‡ï¼Œé‚£æ¥ä¸‹æ¥æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ Pipeline çš„ååé‡èƒ½åˆ°è¾¾å¤šå°‘ï¼Œæ‰§è¡Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>[@iZ2ze0nc5n41zomzyqtksmZ:src]$ ./redis-benchmark -t set,get,incr -n 1000000 -q -P 10
SET: 628535.50 requests per second
GET: 654450.25 requests per second
INCR: 647249.19 requests per second

</code></pre><p>æˆ‘ä»¬å‘ç° Pipeline çš„æµ‹è¯•å¾ˆå¿«å°±æ‰§è¡Œå®Œäº†ï¼ŒåŒæ ·æ˜¯æ¯ä¸ªæŒ‡ä»¤æ‰§è¡Œ 100w æ¬¡ï¼Œå¯ä»¥çœ‹å‡º Pipeline çš„æ€§èƒ½å‡ ä¹æ˜¯æ™®é€šå‘½ä»¤çš„ 8 å€ï¼Œ <code>-P 10</code> è¡¨ç¤ºæ¯æ¬¡æ‰§è¡Œ 10 ä¸ª Redis å‘½ä»¤ã€‚</p>
<h3 id="åŸºå‡†æµ‹è¯•çš„å½±å“å…ƒç´ ">åŸºå‡†æµ‹è¯•çš„å½±å“å…ƒç´ </h3>
<p>ä¸ºä»€ä¹ˆæ¯æ¬¡æ‰§è¡Œ 10 ä¸ª Redis å‘½ä»¤ï¼ŒPipeline çš„æ•ˆç‡ä¸ºä»€ä¹ˆè¾¾ä¸åˆ°æ™®é€šå‘½ä»¤çš„ 10 å€å‘¢ï¼Ÿ</p>
<p>è¿™æ˜¯å› ä¸ºåŸºå‡†æµ‹è¯•ä¼šå—åˆ°å¾ˆå¤§å¤–éƒ¨å› ç´ çš„å½±å“ï¼Œä¾‹å¦‚ä»¥ä¸‹å‡ ä¸ªï¼š</p>
<ol>
<li>ç½‘ç»œå¸¦å®½å’Œç½‘ç»œå»¶è¿Ÿå¯èƒ½æ˜¯ Redis æ“ä½œæœ€å¤§çš„æ€§èƒ½ç“¶é¢ˆï¼Œæ¯”å¦‚æœ‰ 10w q/sï¼Œå¹³å‡æ¯ä¸ªè¯·æ±‚è´Ÿè´£ä¼ è¾“ 8 KB çš„å­—ç¬¦ï¼Œé‚£æˆ‘ä»¬éœ€è¦çš„ç†è®ºå¸¦å®½æ˜¯ 7.6 Gbits/sï¼Œå¦‚æœæœåŠ¡å™¨é…ç½®çš„æ˜¯ 1 Gbits/sï¼Œé‚£ä¹ˆä¸€å®šä¼šæœ‰å¾ˆå¤šä¿¡æ¯åœ¨æ’é˜Ÿç­‰å€™ä¼ è¾“ï¼Œå› æ­¤è¿è¡Œæ•ˆç‡å¯æƒ³è€ŒçŸ¥ï¼Œè¿™ä¹Ÿæ˜¯å¾ˆå¤š Redis ç”Ÿäº§åå¢ƒä¹‹æ‰€ä»¥æ•ˆç‡ä¸é«˜çš„åŸå› ï¼›</li>
<li>CPU å¯èƒ½æ˜¯ Redis è¿è¡Œçš„å¦ä¸€ä¸ªé‡è¦çš„å½±å“å› ç´ ï¼Œå¦‚æœ CPU çš„è®¡ç®—èƒ½åŠ›è·Ÿä¸ä¸Š Redis è¦æ±‚çš„è¯ï¼Œä¹Ÿä¼šå½±å“ Redis çš„è¿è¡Œæ•ˆç‡ï¼›</li>
<li>å¦‚æœ Redis è¿è¡Œåœ¨è™šæ‹Ÿè®¾å¤‡ä¸Šï¼Œæ€§èƒ½ä¹Ÿä¼šå—å½±å“ï¼Œå› ä¸ºæ™®é€šæ“ä½œåœ¨è™šæ‹Ÿè®¾å¤‡ä¸Šä¼šæœ‰é¢å¤–çš„æ¶ˆè€—ï¼›</li>
<li>æ™®é€šæ“ä½œå’Œæ‰¹é‡æ“ä½œï¼ˆPipelineï¼‰å¯¹ Redis çš„ååé‡ä¹Ÿæœ‰å¾ˆå¤§çš„å½±å“ã€‚</li>
</ol>
<h3 id="å°ç»“">å°ç»“</h3>
<p>æœ¬æ–‡ä»‹ç»äº† Redis è‡ªå¸¦çš„æ€§èƒ½æµ‹è¯•å·¥å…· redis-benchmark ä¹Ÿæ˜¯ Redis ä¸»æµçš„æ€§èƒ½æµ‹è¯•å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾æ¨¡æ‹ŸæŒ‡å®šå¹¶å‘é‡å’ŒæŒ‡å®šå‘½ä»¤çš„æµ‹è¯•æ¡ä»¶ï¼Œä¹Ÿå¯ä»¥æ¨¡æ‹Ÿç®¡é“æµ‹è¯•ã€‚æµ‹è¯•çš„ç»“æœå¯¹äºæˆ‘ä»¬åšæŠ€æœ¯é€‰å‹ã€ç‰ˆæœ¬é€‰æ‹©ä»¥åŠæ•°æ®ç±»å‹çš„é€‰æ‹©ä¸Šéƒ½æœ‰ä¸€å®šçš„æŒ‡å¯¼æ„ä¹‰ï¼Œä½†éœ€è¦æ³¨æ„ Redis çš„ååé‡è¿˜å—åˆ°å…¶ä»–å› ç´ çš„å½±å“ï¼Œä¾‹å¦‚å¸¦å®½ã€CPU ç­‰å› ç´ ã€‚</p>

        </div>
    </article>
</div>
<div class="division-line"></div>
<div class="others">
    <div>æ ‡ç­¾ï¼šğŸ·ï¸<a class="post-tag" href="/tags/redis/">redis</a>&nbsp;</div>
    <div>åˆ†ç±»ï¼š ğŸ“’<a class="post-category" href="/categories/redis-%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/">Redis æ ¸å¿ƒåŸç†ä¸å®æˆ˜</a>&nbsp; </div>
</div>

    </main>
    <footer>
        <div id="pagination">
            
<div class="paginator">
    <div class="prev">
        
        <a href="http://yipsen.github.io/documents/columns/redis/redis-%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/32-%E5%AE%9E%E6%88%98redisearch-%E9%AB%98%E6%80%A7%E8%83%BD%E7%9A%84%E5%85%A8%E6%96%87%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/"><span>32 å®æˆ˜ï¼šRediSearch é«˜æ€§èƒ½çš„å…¨æ–‡æœç´¢å¼•æ“</span></a>
    </div>
    <div class="next">
        
        <a href="http://yipsen.github.io/documents/columns/redis/redis-%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/34-%E5%AE%9E%E6%88%98redis-%E6%85%A2%E6%9F%A5%E8%AF%A2/"><span>34 å®æˆ˜ï¼šRedis æ…¢æŸ¥è¯¢</span></a>
    </div>
</div>

        </div>
        <div id="float">
            <ul class="float-button-bar">
    <li>
        <button class="float-button top" onclick="scrollToTop(this);">UP</button>
    </li>
    <li>
        <button class="float-button toggler" onclick="changeSkin(this);">DARK</button>
    </li>
</ul>
        </div>
        <div id="copyright" style="display: none;">
    
    
    <p>&copy; 2020 <a href="/"></a>, powered by Hugo and Qiao</p>
</div>
    </footer>
    
<script>
    const changeSkin = () => {
        document.getElementById('page').classList.toggle('night');
    }
    const scrollToTop = () => {
        window.scrollTo(0, 0);
    }
</script>
</body>

</html>