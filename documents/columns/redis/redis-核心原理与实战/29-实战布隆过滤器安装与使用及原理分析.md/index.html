<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
<meta name="X-UA-Compatible" , content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<link rel="icon" type="image/png" href="/%20/favicon.png">

<title> | Yipsen Ye</title>
<meta name="description" content="æˆ‘ä»¬å‰é¢æœ‰è®²åˆ°è¿‡ HyperLogLog å¯ä»¥ç”¨æ¥åšåŸºæ•°ç»Ÿè®¡ï¼Œä½†å®ƒæ²¡æä¾›åˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦å­˜åœ¨çš„æŸ¥è¯¢æ–¹æ³•ï¼Œé‚£æˆ‘ä»¬å¦‚ä½•æ‰èƒ½æŸ¥è¯¢ä¸€ä¸ªå€¼æ˜¯å¦å­˜åœ¨äºæµ·é‡æ•°æ®ä¹‹ä¸­å‘¢ï¼Ÿ
å¦‚æœä½¿ç”¨ä¼ ç»Ÿçš„æ–¹å¼ï¼Œä¾‹å¦‚ SQL ä¸­çš„ä¼ ç»ŸæŸ¥è¯¢ï¼Œå› ä¸ºæ•°æ®é‡å¤ªå¤šï¼ŒæŸ¥è¯¢æ•ˆç‡åˆä½æœ‰å ç”¨ç³»ç»Ÿçš„èµ„æºï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¼˜ç§€çš„ç®—æ³•å’ŒåŠŸèƒ½æ¥å®ç°è¿™ä¸ªéœ€æ±‚ï¼Œè¿™æ˜¯æˆ‘ä»¬ä»Šå¤©è¦è®²çš„â€”â€”å¸ƒéš†è¿‡æ»¤å™¨ã€‚
å¼€å¯å¸ƒéš†è¿‡æ»¤å™¨ åœ¨ Redis ä¸­ä¸èƒ½ç›´æ¥ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ Redis 4.0 ç‰ˆæœ¬ä¹‹åæä¾›çš„ modulesï¼ˆæ‰©å±•æ¨¡å—ï¼‰çš„æ–¹å¼å¼•å…¥ï¼Œæœ¬æ–‡æä¾›ä¸¤ç§æ–¹å¼çš„å¼€å¯æ–¹å¼ã€‚
æ–¹å¼ä¸€ï¼šç¼–è¯‘æ–¹å¼ 1. ä¸‹è½½å¹¶å®‰è£…å¸ƒéš†è¿‡æ»¤å™¨
git clone https://github.com/RedisLabsModules/redisbloom.git cd redisbloom make # ç¼–è¯‘redisbloom ç¼–è¯‘æ­£å¸¸æ‰§è¡Œå®Œï¼Œä¼šåœ¨æ ¹ç›®å½•ç”Ÿæˆä¸€ä¸ª redisbloom.so æ–‡ä»¶ã€‚
2. å¯åŠ¨ Redis æœåŠ¡å™¨
&amp;gt; ./src/redis-server redis.conf --loadmodule ./src/modules/RedisBloom-master/redisbloom.so å…¶ä¸­ --loadmodule ä¸ºåŠ è½½æ‰©å±•æ¨¡å—çš„æ„æ€ï¼Œåé¢è·Ÿçš„æ˜¯ redisbloom.so æ–‡ä»¶çš„ç›®å½•ã€‚
æ–¹å¼äºŒï¼šDocker æ–¹å¼ docker pull redislabs/rebloom &amp;amp;nbsp;# æ‹‰å–é•œåƒ docker run -p6379:6379 redislabs/rebloom &amp;amp;nbsp;# è¿è¡Œå®¹å™¨ å¯åŠ¨éªŒè¯ æœåŠ¡å¯åŠ¨ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­å¸ƒéš†è¿‡æ»¤å™¨æ˜¯å¦æ­£å¸¸å¼€å¯ï¼Œæ­¤æ—¶æˆ‘ä»¬åªéœ€ä½¿ç”¨ redis-cli è¿æ¥åˆ°æœåŠ¡ç«¯ï¼Œè¾“å…¥ bf.add çœ‹æœ‰æ²¡æœ‰å‘½ä»¤æç¤ºï¼Œå°±å¯ä»¥åˆ¤æ–­æ˜¯å¦æ­£å¸¸å¯åŠ¨äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
å¦‚æœæœ‰å‘½ä»¤æç¤ºåˆ™è¡¨å Redis æœåŠ¡å™¨å·²ç»å¼€å¯äº†å¸ƒéš†è¿‡æ»¤å™¨ã€‚
å¸ƒéš†è¿‡æ»¤å™¨çš„ä½¿ç”¨ å¸ƒéš†è¿‡æ»¤å™¨çš„å‘½ä»¤ä¸æ˜¯å¾ˆå¤šï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªï¼š
 bf.addï¼šæ·»åŠ å…ƒç´  bf.existsï¼šåˆ¤æ–­æŸä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨ bf.maddï¼šæ·»åŠ å¤šä¸ªå…ƒç´  bf.">
<meta name="author" content="">

<link rel="stylesheet" type="text/css" href="/styles/main.css">

</head>

<body id="page">
    <header>
        <div class="logo-link" style="width: 60px; color: #CA6924;">
    <a href="http://yipsen.github.io/">
        <img style="margin-bottom: -1rem;" src="/images/deer.svg" alt="logo">
        <span style="font-size: 0.5rem; color: #CA6924;">Yipsen Ye</span>
    </a>
</div>
<nav class="navbar justify-content-end">
    <ul class="nav-list">
        
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/posts/">æœ­è®°</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/collections/">é™„è¡¨</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/about/">å…³äº</a>
        </li>
        
    </ul>
</nav>
    </header>
    <main id="content">
        
<div class="container"><article class="post-block">
        <h1 class="post-title"></h1>
        <div class="post-info">
            <div> 
                <span class="post-date">ğŸ“…&nbsp;0001-01-01 00:00:00</span></div></div>
        <div class="post-content">
            <p>æˆ‘ä»¬å‰é¢æœ‰è®²åˆ°è¿‡ HyperLogLog å¯ä»¥ç”¨æ¥åšåŸºæ•°ç»Ÿè®¡ï¼Œä½†å®ƒæ²¡æä¾›åˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦å­˜åœ¨çš„æŸ¥è¯¢æ–¹æ³•ï¼Œé‚£æˆ‘ä»¬å¦‚ä½•æ‰èƒ½æŸ¥è¯¢ä¸€ä¸ªå€¼æ˜¯å¦å­˜åœ¨äºæµ·é‡æ•°æ®ä¹‹ä¸­å‘¢ï¼Ÿ</p>
<p>å¦‚æœä½¿ç”¨ä¼ ç»Ÿçš„æ–¹å¼ï¼Œä¾‹å¦‚ SQL ä¸­çš„ä¼ ç»ŸæŸ¥è¯¢ï¼Œå› ä¸ºæ•°æ®é‡å¤ªå¤šï¼ŒæŸ¥è¯¢æ•ˆç‡åˆä½æœ‰å ç”¨ç³»ç»Ÿçš„èµ„æºï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¼˜ç§€çš„ç®—æ³•å’ŒåŠŸèƒ½æ¥å®ç°è¿™ä¸ªéœ€æ±‚ï¼Œè¿™æ˜¯æˆ‘ä»¬ä»Šå¤©è¦è®²çš„â€”â€”å¸ƒéš†è¿‡æ»¤å™¨ã€‚</p>
<h3 id="å¼€å¯å¸ƒéš†è¿‡æ»¤å™¨">å¼€å¯å¸ƒéš†è¿‡æ»¤å™¨</h3>
<p>åœ¨ Redis ä¸­ä¸èƒ½ç›´æ¥ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ Redis 4.0 ç‰ˆæœ¬ä¹‹åæä¾›çš„ modulesï¼ˆæ‰©å±•æ¨¡å—ï¼‰çš„æ–¹å¼å¼•å…¥ï¼Œæœ¬æ–‡æä¾›ä¸¤ç§æ–¹å¼çš„å¼€å¯æ–¹å¼ã€‚</p>
<h4 id="æ–¹å¼ä¸€ç¼–è¯‘æ–¹å¼"><strong>æ–¹å¼ä¸€ï¼šç¼–è¯‘æ–¹å¼</strong></h4>
<p><strong>1. ä¸‹è½½å¹¶å®‰è£…å¸ƒéš†è¿‡æ»¤å™¨</strong></p>
<pre tabindex="0"><code>git clone https://github.com/RedisLabsModules/redisbloom.git
cd redisbloom
make # ç¼–è¯‘redisbloom

</code></pre><p>ç¼–è¯‘æ­£å¸¸æ‰§è¡Œå®Œï¼Œä¼šåœ¨æ ¹ç›®å½•ç”Ÿæˆä¸€ä¸ª redisbloom.so æ–‡ä»¶ã€‚</p>
<p><strong>2. å¯åŠ¨ Redis æœåŠ¡å™¨</strong></p>
<pre tabindex="0"><code>&gt; ./src/redis-server redis.conf --loadmodule ./src/modules/RedisBloom-master/redisbloom.so

</code></pre><p>å…¶ä¸­ <code>--loadmodule</code> ä¸ºåŠ è½½æ‰©å±•æ¨¡å—çš„æ„æ€ï¼Œåé¢è·Ÿçš„æ˜¯ redisbloom.so æ–‡ä»¶çš„ç›®å½•ã€‚</p>
<h4 id="æ–¹å¼äºŒdocker-æ–¹å¼"><strong>æ–¹å¼äºŒï¼šDocker æ–¹å¼</strong></h4>
<pre tabindex="0"><code>docker pull redislabs/rebloom &amp;nbsp;# æ‹‰å–é•œåƒ
docker run -p6379:6379 redislabs/rebloom &amp;nbsp;# è¿è¡Œå®¹å™¨

</code></pre><h4 id="å¯åŠ¨éªŒè¯"><strong>å¯åŠ¨éªŒè¯</strong></h4>
<p>æœåŠ¡å¯åŠ¨ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­å¸ƒéš†è¿‡æ»¤å™¨æ˜¯å¦æ­£å¸¸å¼€å¯ï¼Œæ­¤æ—¶æˆ‘ä»¬åªéœ€ä½¿ç”¨ redis-cli è¿æ¥åˆ°æœåŠ¡ç«¯ï¼Œè¾“å…¥ bf.add çœ‹æœ‰æ²¡æœ‰å‘½ä»¤æç¤ºï¼Œå°±å¯ä»¥åˆ¤æ–­æ˜¯å¦æ­£å¸¸å¯åŠ¨äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Redis%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/assets/5b01dac0-75b5-11ea-b264-6326f7cc0e82" alt="image.png"></p>
<p>å¦‚æœæœ‰å‘½ä»¤æç¤ºåˆ™è¡¨å Redis æœåŠ¡å™¨å·²ç»å¼€å¯äº†å¸ƒéš†è¿‡æ»¤å™¨ã€‚</p>
<h3 id="å¸ƒéš†è¿‡æ»¤å™¨çš„ä½¿ç”¨">å¸ƒéš†è¿‡æ»¤å™¨çš„ä½¿ç”¨</h3>
<p>å¸ƒéš†è¿‡æ»¤å™¨çš„å‘½ä»¤ä¸æ˜¯å¾ˆå¤šï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªï¼š</p>
<ol>
<li>bf.addï¼šæ·»åŠ å…ƒç´ </li>
<li>bf.existsï¼šåˆ¤æ–­æŸä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨</li>
<li>bf.maddï¼šæ·»åŠ å¤šä¸ªå…ƒç´ </li>
<li>bf.mexistsï¼šåˆ¤æ–­å¤šä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨</li>
<li>bf.reserveï¼š<strong>è®¾ç½®å¸ƒéš†è¿‡æ»¤å™¨çš„å‡†ç¡®ç‡</strong></li>
</ol>
<p>å…·ä½“ä½¿ç”¨å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>127.0.0.1:6379&gt; bf.add user xiaoming
(integer) 1
127.0.0.1:6379&gt; bf.add user xiaohong
(integer) 1
127.0.0.1:6379&gt; bf.add user laowang
(integer) 1
127.0.0.1:6379&gt; bf.exists user laowang
(integer) 1
127.0.0.1:6379&gt; bf.exists user lao
(integer) 0
127.0.0.1:6379&gt; bf.madd user huahua feifei
1) (integer) 1
2) (integer) 1
127.0.0.1:6379&gt; bf.mexists user feifei laomiao
1) (integer) 1
2) (integer) 0

</code></pre><p>å¯ä»¥çœ‹å‡ºä»¥ä¸Šç»“æœæ²¡æœ‰ä»»ä½•è¯¯å·®ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹å‡†ç¡®ç‡ bf.reserve çš„ä½¿ç”¨ï¼š</p>
<pre tabindex="0"><code>127.0.0.1:6379&gt; bf.reserve user 0.01 200
(error) ERR item exists #å·²ç»å­˜çš„ key è®¾ç½®ä¼šæŠ¥é”™
127.0.0.1:6379&gt; bf.reserve userlist 0.9 10
OK

</code></pre><p>å¯ä»¥çœ‹å‡ºæ­¤å‘½ä»¤å¿…é¡»åœ¨å…ƒç´ åˆšå¼€å§‹æ‰§è¡Œï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼Œå®ƒæœ‰ä¸‰ä¸ªå‚æ•°ï¼škeyã€error_rate å’Œ initial_sizeã€‚</p>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li>error_rateï¼šå…è®¸å¸ƒéš†è¿‡æ»¤å™¨çš„é”™è¯¯ç‡ï¼Œè¿™ä¸ªå€¼è¶Šä½è¿‡æ»¤å™¨å ç”¨ç©ºé—´ä¹Ÿå°±è¶Šå¤§ï¼Œä»¥ä¸ºæ­¤å€¼å†³å®šäº†ä½æ•°ç»„çš„å¤§å°ï¼Œä½æ•°ç»„æ˜¯ç”¨æ¥å­˜å‚¨ç»“æœçš„ï¼Œå®ƒçš„ç©ºé—´å ç”¨çš„è¶Šå¤§ï¼ˆå­˜å‚¨çš„ä¿¡æ¯è¶Šå¤šï¼‰ï¼Œé”™è¯¯ç‡å°±è¶Šä½ï¼Œå®ƒçš„é»˜è®¤å€¼æ˜¯ 0.01ã€‚</li>
<li>initial_sizeï¼šå¸ƒéš†è¿‡æ»¤å™¨å­˜å‚¨çš„å…ƒç´ å¤§å°ï¼Œå®é™…å­˜å‚¨çš„å€¼å¤§äºæ­¤å€¼ï¼Œå‡†ç¡®ç‡å°±ä¼šé™ä½ï¼Œå®ƒçš„é»˜è®¤å€¼æ˜¯ 100ã€‚</li>
</ul>
<p>åé¢åŸç†éƒ¨åˆ†ä¼šè®²åˆ° error_rate å’Œ initial_size å¯¹å‡†ç¡®ç‡å½±å“çš„å…·ä½“åŸå› ã€‚</p>
<h3 id="ä»£ç å®æˆ˜">ä»£ç å®æˆ˜</h3>
<p>ä¸‹é¢æˆ‘ä»¬ç”¨ Java å®¢æˆ·ç«¯æ¥å®ç°å¸ƒéš†è¿‡æ»¤å™¨çš„æ“ä½œï¼Œå› ä¸º Jedis æ²¡æœ‰ç›´æ¥æ“ä½œå¸ƒéš†è¿‡æ»¤å™¨çš„æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ Jedis æ“ä½œ Lua è„šæœ¬çš„æ–¹å¼æ¥å®ç°å¸ƒéš†è¿‡æ»¤å™¨ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>import redis.clients.jedis.Jedis;
import utils.JedisUtils;

import java.util.Arrays;

public class BloomExample {
    private static final String _KEY = &quot;user&quot;;

    public static void main(String[] args) {
        Jedis jedis = JedisUtils.getJedis();
        for (int i = 1; i &lt; 10001; i++) {
            bfAdd(jedis, _KEY, &quot;user_&quot; + i);
            boolean exists = bfExists(jedis, _KEY, &quot;user_&quot; + i);
            if (!exists) {
                System.out.println(&quot;æœªæ‰¾åˆ°æ•°æ® i=&quot; + i);
                break;
            }
        }
        System.out.println(&quot;æ‰§è¡Œå®Œæˆ&quot;);
    }
    /**
     * æ·»åŠ å…ƒç´ 
     * @param jedis Redis å®¢æˆ·ç«¯
     * @param key   key
     * @param value value
     * @return boolean
     */
    public static boolean bfAdd(Jedis jedis, String key, String value) {
        String luaStr = &quot;return redis.call('bf.add', KEYS[1], KEYS[2])&quot;;
        Object result = jedis.eval(luaStr, Arrays.asList(key, value),
                Arrays.asList());
        if (result.equals(1L)) {
            return true;
        }
        return false;
    }
    /**
     * æŸ¥è¯¢å…ƒç´ æ˜¯å¦å­˜åœ¨
     * @param jedis Redis å®¢æˆ·ç«¯
     * @param key   key
     * @param value value
     * @return boolean
     */
    public static boolean bfExists(Jedis jedis, String key, String value) {
        String luaStr = &quot;return redis.call('bf.exists', KEYS[1], KEYS[2])&quot;;
        Object result = jedis.eval(luaStr, Arrays.asList(key, value),
                Arrays.asList());
        if (result.equals(1L)) {
            return true;
        }
        return false;
    }
}

</code></pre><p>ä½†æˆ‘ä»¬å‘ç°æ‰§è¡Œäº†åŠå¤©ï¼Œæ‰§è¡Œçš„ç»“æœç«Ÿç„¶æ˜¯ï¼š</p>
<pre tabindex="0"><code>æ‰§è¡Œå®Œæˆ

</code></pre><p>æ²¡æœ‰ä»»ä½•è¯¯å·®ï¼Œå¥‡æ€ªäº†ï¼Œäºæ˜¯æˆ‘ä»¬åœ¨å¾ªç¯æ¬¡æ•°åé¢åˆåŠ äº†ä¸€ä¸ª 0ï¼Œæ‰§è¡Œäº†å¤§åŠå¤©ä¹‹åï¼Œå‘ç°ä¾æ—§æ˜¯ç›¸åŒçš„ç»“æœï¼Œä¾æ—§æ²¡æœ‰ä»»ä½•è¯¯å·®ã€‚</p>
<p>è¿™æ˜¯å› ä¸º<strong>å¯¹äºå¸ƒéš†è¿‡æ»¤å™¨æ¥è¯´ï¼Œå®ƒè¯´æ²¡æœ‰çš„å€¼ä¸€å®šæ²¡æœ‰ï¼Œå®ƒè¯´æœ‰çš„å€¼æœ‰å¯èƒ½æ²¡æœ‰</strong>ã€‚</p>
<p>äºæ˜¯æˆ‘ä»¬æŠŠç¨‹åºæ”¹ä¸€ä¸‹ï¼Œé‡æ–°æ¢ä¸€ä¸ª key å€¼ï¼ŒæŠŠæ¡ä»¶æ”¹ä¸ºæŸ¥è¯¢å­˜åœ¨çš„æ•°æ®ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>import redis.clients.jedis.Jedis;
import utils.JedisUtils;

import java.util.Arrays;

public class BloomExample {
    private static final String _KEY = &quot;userlist&quot;;

    public static void main(String[] args) {
        Jedis jedis = JedisUtils.getJedis();
        for (int i = 1; i &lt; 100001; i++) {
            bfAdd(jedis, _KEY, &quot;user_&quot; + i);
            boolean exists = bfExists(jedis, _KEY, &quot;user_&quot; + (i + 1));
            if (exists) {
                System.out.println(&quot;æ‰¾åˆ°äº†&quot; + i);
                break;
            }
        }
        System.out.println(&quot;æ‰§è¡Œå®Œæˆ&quot;);
    }

    /**
     * æ·»åŠ å…ƒç´ 
     * @param jedis Redis å®¢æˆ·ç«¯
     * @param key   key
     * @param value value
     * @return boolean
     */
    public static boolean bfAdd(Jedis jedis, String key, String value) {
        String luaStr = &quot;return redis.call('bf.add', KEYS[1], KEYS[2])&quot;;
        Object result = jedis.eval(luaStr, Arrays.asList(key, value),
                Arrays.asList());
        if (result.equals(1L)) {
            return true;
        }
        return false;
    }

    /**
     * æŸ¥è¯¢å…ƒç´ æ˜¯å¦å­˜åœ¨
     * @param jedis Redis å®¢æˆ·ç«¯
     * @param key   key
     * @param value value
     * @return boolean
     */
    public static boolean bfExists(Jedis jedis, String key, String value) {
        String luaStr = &quot;return redis.call('bf.exists', KEYS[1], KEYS[2])&quot;;
        Object result = jedis.eval(luaStr, Arrays.asList(key, value),
                Arrays.asList());
        if (result.equals(1L)) {
            return true;
        }
        return false;
    }
}

</code></pre><p>è¿™æ¬¡æˆ‘ä»¬å‘ç°æ‰§è¡Œä¸ä¸€ä¼šå°±å‡ºç°äº†å¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<pre tabindex="0"><code>æ‰¾åˆ°äº†344
æ‰§è¡Œå®Œæˆ

</code></pre><p>è¯´æ˜å¾ªç¯æ‰§è¡Œäº†ä¸€ä¼šä¹‹åå°±å‡ºç°è¯¯å·®äº†ï¼Œä»£ç æ‰§è¡Œä¹Ÿç¬¦åˆå¸ƒéš†è¿‡æ»¤å™¨çš„é¢„æœŸã€‚</p>
<h3 id="åŸç†">åŸç†</h3>
<p>ä¸Šé¢æˆ‘ä»¬å­¦ä¼šäº†å¸ƒéš†è¿‡æ»¤å™¨çš„ä½¿ç”¨ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹ä¸‹å®ƒçš„å®ç°åŸç†ã€‚</p>
<p>Redis å¸ƒéš†è¿‡æ»¤å™¨çš„å®ç°ï¼Œä¾é çš„æ˜¯å®ƒæ•°æ®ç»“æ„ä¸­çš„ä¸€ä¸ªä½æ•°ç»„ï¼Œæ¯æ¬¡å­˜å‚¨é”®å€¼çš„æ—¶å€™ï¼Œä¸æ˜¯ç›´æ¥æŠŠæ•°æ®å­˜å‚¨åœ¨æ•°æ®ç»“æ„ä¸­ï¼Œå› ä¸ºè¿™æ ·å¤ªå ç©ºé—´äº†ï¼Œå®ƒæ˜¯åˆ©ç”¨å‡ ä¸ªä¸åŒçš„æ— åå“ˆå¸Œå‡½æ•°ï¼ŒæŠŠæ­¤å…ƒç´ çš„ hash å€¼å‡åŒ€çš„å­˜å‚¨åœ¨ä½æ•°ç»„ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡æ·»åŠ æ—¶ä¼šé€šè¿‡å‡ ä¸ªæ— åå“ˆå¸Œå‡½æ•°ç®—å‡ºå®ƒçš„ä½ç½®ï¼ŒæŠŠè¿™äº›ä½ç½®è®¾ç½®æˆ 1 å°±å®Œæˆäº†æ·»åŠ æ“ä½œã€‚</p>
<p>å½“è¿›è¡Œå…ƒç´ åˆ¤æ–­æ—¶ï¼ŒæŸ¥è¯¢æ­¤å…ƒç´ çš„å‡ ä¸ªå“ˆå¸Œä½ç½®ä¸Šçš„å€¼æ˜¯å¦ä¸º 1ï¼Œå¦‚æœå…¨éƒ¨ä¸º 1ï¼Œåˆ™è¡¨ç¤ºæ­¤å€¼å­˜åœ¨ï¼Œå¦‚æœæœ‰ä¸€ä¸ªå€¼ä¸º 0ï¼Œåˆ™è¡¨ç¤ºä¸å­˜åœ¨ã€‚å› ä¸ºæ­¤ä½ç½®æ˜¯é€šè¿‡ hash è®¡ç®—å¾—æ¥çš„ï¼Œæ‰€ä»¥å³ä½¿è¿™ä¸ªä½ç½®æ˜¯ 1ï¼Œå¹¶ä¸èƒ½ç¡®å®šæ˜¯é‚£ä¸ªå…ƒç´ æŠŠå®ƒæ ‡è¯†ä¸º 1 çš„ï¼Œå› æ­¤<strong>å¸ƒéš†è¿‡æ»¤å™¨æŸ¥è¯¢æ­¤å€¼å­˜åœ¨æ—¶ï¼Œæ­¤å€¼ä¸ä¸€å®šå­˜åœ¨ï¼Œä½†æŸ¥è¯¢æ­¤å€¼ä¸å­˜åœ¨æ—¶ï¼Œæ­¤å€¼ä¸€å®šä¸å­˜åœ¨</strong>ã€‚</p>
<p>å¹¶ä¸”å½“ä½æ•°ç»„å­˜å‚¨å€¼æ¯”è¾ƒç¨€ç–çš„æ—¶å€™ï¼ŒæŸ¥è¯¢çš„å‡†ç¡®ç‡è¶Šé«˜ï¼Œè€Œå½“ä½æ•°ç»„å­˜å‚¨çš„å€¼è¶Šæ¥è¶Šå¤šæ—¶ï¼Œè¯¯å·®ä¹Ÿä¼šå¢å¤§ã€‚</p>
<p>ä½æ•°ç»„å’Œ key ä¹‹é—´çš„å…³ç³»ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Redis%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/assets/c4f5b9b0-75b5-11ea-b61a-45f5a80e7f1b" alt="image.png"></p>
<h3 id="å¸ƒéš†è¿‡æ»¤å™¨ä½¿ç”¨åœºæ™¯">å¸ƒéš†è¿‡æ»¤å™¨ä½¿ç”¨åœºæ™¯</h3>
<p>å®ƒçš„ç»å…¸ä½¿ç”¨åœºæ™¯åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªï¼š</p>
<ul>
<li>åƒåœ¾é‚®ä»¶è¿‡æ»¤</li>
<li>çˆ¬è™«é‡Œçš„ URL å»é‡</li>
<li>åˆ¤æ–­ä¸€ä¸ªå…ƒç´ åœ¨äº¿çº§æ•°æ®ä¸­æ˜¯å¦å­˜åœ¨</li>
</ul>
<p>å¸ƒéš†è¿‡æ»¤å™¨åœ¨æ•°æ®åº“é¢†åŸŸçš„ä½¿ç”¨ä¹Ÿæ¯”è¾ƒå¹¿æ³›ï¼Œä¾‹å¦‚ï¼šHBaseã€Cassandraã€LevelDBã€RocksDB å†…éƒ¨éƒ½æœ‰ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨ã€‚</p>
<h3 id="å°ç»“">å°ç»“</h3>
<p>é€šè¿‡æœ¬æ–‡æˆ‘ä»¬çŸ¥é“å¯ä»¥ä½¿ç”¨ Redis 4.0 ä¹‹åæä¾›çš„ modules æ–¹å¼æ¥å¼€å¯å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå¹¶å­¦ä¹ äº†å¸ƒéš†è¿‡æ»¤å™¨çš„ä¸‰ä¸ªé‡è¦æ“ä½œæ–¹æ³• bf.add æ·»åŠ å…ƒç´ ã€bf.exists æŸ¥è¯¢å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼Œè¿˜æœ‰ bf.reserve è®¾ç½®å¸ƒéš†è¿‡æ»¤å™¨çš„å‡†ç¡®ç‡ï¼Œå…¶ä¸­ bf.reserve æœ‰ 2 ä¸ªé‡è¦çš„å‚æ•°ï¼šé”™è¯¯ç‡å’Œæ•°ç»„å¤§å°ï¼Œé”™è¯¯ç‡è®¾ç½®çš„è¶Šä½ï¼Œæ•°ç»„è®¾ç½®çš„è¶Šå¤§ï¼Œéœ€è¦å­˜å‚¨çš„ç©ºé—´å°±è¶Šå¤§ï¼Œç›¸å¯¹æ¥è¯´æŸ¥è¯¢çš„é”™è¯¯ç‡ä¹Ÿè¶Šä½ï¼Œéœ€è¦å¦‚ä½•è®¾ç½®éœ€è¦ä½¿ç”¨è€…æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚æˆ‘ä»¬ä¹ŸçŸ¥é“å¸ƒéš†è¿‡æ»¤å™¨çš„ç‰¹ç‚¹ï¼šå½“å®ƒæŸ¥è¯¢æœ‰æ•°æ®æ—¶ï¼Œæ­¤æ•°æ®ä¸ä¸€å®šçœŸçš„å­˜åœ¨ï¼Œå½“å®ƒæŸ¥è¯¢æ²¡æœ‰æ­¤æ•°æ®æ—¶ï¼Œæ­¤æ•°æ®ä¸€å®šä¸å­˜åœ¨ã€‚</p>

        </div>
    </article>
</div>

    </main>
    <footer>
        <div id="pagination">
            
<div class="paginator">
    <div class="prev">
        
        <a href="/documents/columns/redis/redis-%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/30-%E5%AE%8C%E6%95%B4%E6%A1%88%E4%BE%8B%E5%AE%9E%E7%8E%B0%E5%BB%B6%E8%BF%9F%E9%98%9F%E5%88%97%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95.md/"><span></span></a>
    </div>
    <div class="next">
        
        <a href="/documents/columns/redis/redis-%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/28-%E5%AE%9E%E6%88%98%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E8%AF%A6%E8%A7%A3%E4%B8%8E%E4%BB%A3%E7%A0%81.md/"><span></span></a>
    </div>
</div>

        </div>
        <div class="toggler" onclick="toggleLight(this);">ğŸ’¡</div>
        <div id="copyright" style="display: none;">
    
    
    <p>&copy; 28280 <a href="/"></a>, powered by Hugo and Qiao</p>
</div>
    </footer>
    
<script>
    function toggleLight() {
        document.getElementById('page').classList.toggle('night');
    }
</script>
</body>

</html>