<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
<meta name="X-UA-Compatible" , content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<link rel="icon" type="image/png" href="/%20/favicon.png">

<title> | Yipsen Ye</title>
<meta name="description" content="ä¸Šä¸€ç¯‡æˆ‘ä»¬ä»‹ç»äº† Redis Sentinel çš„æ­å»ºå’Œè¿è¡ŒåŸç†ï¼Œæœ¬æ–‡æˆ‘ä»¬é‡ç‚¹æ¥çœ‹ä¸‹ Sentinel çš„å‘½ä»¤æ“ä½œå’Œä»£ç å®æˆ˜ã€‚
Sentinel å‘½ä»¤æ“ä½œ è¦ä½¿ç”¨ Sentinel å®ç°è¦è¿æ¥åˆ° Sentinel æœåŠ¡å™¨ï¼Œå’Œè¿æ¥ Redis æœåŠ¡ç›¸åŒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ redis-cli æ¥è¿æ¥ Sentinelï¼Œå¦‚ä¸‹å‘½ä»¤æ‰€ç¤ºï¼š
[@iZ2ze0nc5n41zomzyqtksmZ:~]$ redis-cli -h 127.0.0.1 -p 26379 -a pwd654321 127.0.0.1:26379&amp;gt; ping PONG å…¶ä¸­ï¼š
 -h åé¢è¾“å…¥çš„æ˜¯ Sentinel çš„ IPï¼› -p åé¢è¾“å…¥çš„æ˜¯ Sentinel çš„ç«¯å£ï¼Œé»˜è®¤æ˜¯ 26379ï¼› -a åé¢è¾“å…¥çš„æ˜¯å¯†ç ã€‚  Sentinel çš„ç«¯å£å·å¯ä»¥åœ¨ sentinel.conf é‡Œé¢é…ç½®ï¼Œé€šè¿‡ port é€‰é¡¹è®¾ç½®ã€‚
æ³¨æ„ï¼šSentinel å¯ä»¥ç›‘è§†å¤šå°ä¸»èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯åªèƒ½ç›‘è§†ä¸€å°æœåŠ¡å™¨ã€‚æƒ³è¦ç›‘è§†å¤šå°ä¸»èŠ‚ç‚¹åªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®å¤šä¸ª sentinel monitor master-name ip port quorum å³å¯ï¼Œæˆ‘ä»¬é€šè¿‡ master-name æ¥åŒºåˆ†ä¸åŒçš„ä¸»èŠ‚ç‚¹ã€‚
æŸ¥è¯¢æ‰€æœ‰è¢«ç›‘æ§çš„ä¸»æœåŠ¡å™¨ä¿¡æ¯ 127.0.0.1:26379&amp;gt; sentinel masters 1) 1) &amp;quot;name&amp;quot; 2) &amp;quot;mymaster&amp;quot; 3) &amp;quot;ip&amp;quot; 4) &amp;quot;127.">
<meta name="author" content="">

<link rel="stylesheet" type="text/css" href="/styles/main.css">

</head>

<body id="page">
    <header>
        <div class="logo-link" style="width: 60px; color: #CA6924;">
    <a href="http://yipsen.github.io/">
        <img style="margin-bottom: -1rem;" src="/images/deer.svg" alt="logo">
        <span style="font-size: 0.5rem; color: #CA6924;">Yipsen Ye</span>
    </a>
</div>
<nav class="navbar justify-content-end">
    <ul class="nav-list">
        
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/posts/">æœ­è®°</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/collections/">é™„è¡¨</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/about/">å…³äº</a>
        </li>
        
    </ul>
</nav>
    </header>
    <main id="content">
        
<div class="container"><article class="post-block">
        <h1 class="post-title"></h1>
        <div class="post-info">
            <div> 
                <span class="post-date">ğŸ“…&nbsp;0001-01-01 00:00:00</span></div></div>
        <div class="post-content">
            <p>ä¸Šä¸€ç¯‡æˆ‘ä»¬ä»‹ç»äº† Redis Sentinel çš„æ­å»ºå’Œè¿è¡ŒåŸç†ï¼Œæœ¬æ–‡æˆ‘ä»¬é‡ç‚¹æ¥çœ‹ä¸‹ Sentinel çš„å‘½ä»¤æ“ä½œå’Œä»£ç å®æˆ˜ã€‚</p>
<h3 id="sentinel-å‘½ä»¤æ“ä½œ">Sentinel å‘½ä»¤æ“ä½œ</h3>
<p>è¦ä½¿ç”¨ Sentinel å®ç°è¦è¿æ¥åˆ° Sentinel æœåŠ¡å™¨ï¼Œå’Œè¿æ¥ Redis æœåŠ¡ç›¸åŒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ redis-cli æ¥è¿æ¥ Sentinelï¼Œå¦‚ä¸‹å‘½ä»¤æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>[@iZ2ze0nc5n41zomzyqtksmZ:~]$ redis-cli -h 127.0.0.1 -p 26379 -a pwd654321
127.0.0.1:26379&gt; ping
PONG

</code></pre><p>å…¶ä¸­ï¼š</p>
<ul>
<li>-h åé¢è¾“å…¥çš„æ˜¯ Sentinel çš„ IPï¼›</li>
<li>-p åé¢è¾“å…¥çš„æ˜¯ Sentinel çš„ç«¯å£ï¼Œé»˜è®¤æ˜¯ 26379ï¼›</li>
<li>-a åé¢è¾“å…¥çš„æ˜¯å¯†ç ã€‚</li>
</ul>
<p>Sentinel çš„ç«¯å£å·å¯ä»¥åœ¨ sentinel.conf é‡Œé¢é…ç½®ï¼Œé€šè¿‡ port é€‰é¡¹è®¾ç½®ã€‚</p>
<p>æ³¨æ„ï¼š<strong>Sentinel å¯ä»¥ç›‘è§†å¤šå°ä¸»èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯åªèƒ½ç›‘è§†ä¸€å°æœåŠ¡å™¨</strong>ã€‚æƒ³è¦ç›‘è§†å¤šå°ä¸»èŠ‚ç‚¹åªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®å¤šä¸ª <code>sentinel monitor master-name ip port quorum</code> å³å¯ï¼Œæˆ‘ä»¬é€šè¿‡ master-name æ¥åŒºåˆ†ä¸åŒçš„ä¸»èŠ‚ç‚¹ã€‚</p>
<h4 id="æŸ¥è¯¢æ‰€æœ‰è¢«ç›‘æ§çš„ä¸»æœåŠ¡å™¨ä¿¡æ¯"><strong>æŸ¥è¯¢æ‰€æœ‰è¢«ç›‘æ§çš„ä¸»æœåŠ¡å™¨ä¿¡æ¯</strong></h4>
<pre tabindex="0"><code>127.0.0.1:26379&gt; sentinel masters
1)  1) &quot;name&quot;
    2) &quot;mymaster&quot;
    3) &quot;ip&quot;
    4) &quot;127.0.0.1&quot;
    5) &quot;port&quot;
    6) &quot;6377&quot;
    7) &quot;runid&quot;
    8) &quot;eb3552c6fc8974f91466c4ada90fe23ef30fd89c&quot;
    9) &quot;flags&quot;
   10) &quot;master&quot;
   11) &quot;link-pending-commands&quot;
   12) &quot;0&quot;
   13) &quot;link-refcount&quot;
   14) &quot;1&quot;
   15) &quot;last-ping-sent&quot;
   16) &quot;0&quot;
   17) &quot;last-ok-ping-reply&quot;
   18) &quot;400&quot;
   19) &quot;last-ping-reply&quot;
   20) &quot;400&quot;
   21) &quot;down-after-milliseconds&quot;
   22) &quot;30000&quot;
   23) &quot;info-refresh&quot;
   24) &quot;5731&quot;
   25) &quot;role-reported&quot;
   26) &quot;master&quot;
   27) &quot;role-reported-time&quot;
   28) &quot;75963321&quot;
   29) &quot;config-epoch&quot;
   30) &quot;7&quot;
   31) &quot;num-slaves&quot;
   32) &quot;2&quot;
   33) &quot;num-other-sentinels&quot;
   34) &quot;1&quot;
   35) &quot;quorum&quot;
   36) &quot;2&quot;
   37) &quot;failover-timeout&quot;
   38) &quot;180000&quot;
   39) &quot;parallel-syncs&quot;
   40) &quot;1&quot;

</code></pre><p>ç›¸å…³è¯­æ³•ï¼š</p>
<pre tabindex="0"><code>sentinel masters

</code></pre><p>å› ä¸ºæˆ‘ä»¬é…ç½®çš„ Sentinel åªç›‘è§†äº†ä¸€å°ä¸»æœåŠ¡å™¨ï¼Œæ‰€ä»¥åªæœ‰ä¸€å°æœåŠ¡å™¨çš„ä¿¡æ¯ã€‚</p>
<h4 id="æŸ¥è¯¢æŸä¸ªä¸»èŠ‚ç‚¹çš„ä¿¡æ¯"><strong>æŸ¥è¯¢æŸä¸ªä¸»èŠ‚ç‚¹çš„ä¿¡æ¯</strong></h4>
<pre tabindex="0"><code>127.0.0.1:26379&gt; sentinel master mymaster
 1) &quot;name&quot;
 2) &quot;mymaster&quot;
 3) &quot;ip&quot;
 4) &quot;127.0.0.1&quot;
 5) &quot;port&quot;
 6) &quot;6377&quot;
 7) &quot;runid&quot;
 8) &quot;eb3552c6fc8974f91466c4ada90fe23ef30fd89c&quot;
 9) &quot;flags&quot;
10) &quot;master&quot;
11) &quot;link-pending-commands&quot;
12) &quot;0&quot;
13) &quot;link-refcount&quot;
14) &quot;1&quot;
15) &quot;last-ping-sent&quot;
16) &quot;0&quot;
17) &quot;last-ok-ping-reply&quot;
18) &quot;250&quot;
19) &quot;last-ping-reply&quot;
20) &quot;250&quot;
21) &quot;down-after-milliseconds&quot;
22) &quot;30000&quot;
23) &quot;info-refresh&quot;
24) &quot;8191&quot;
25) &quot;role-reported&quot;
26) &quot;master&quot;
27) &quot;role-reported-time&quot;
28) &quot;76096303&quot;
29) &quot;config-epoch&quot;
30) &quot;7&quot;
31) &quot;num-slaves&quot;
32) &quot;2&quot;
33) &quot;num-other-sentinels&quot;
34) &quot;1&quot;
35) &quot;quorum&quot;
36) &quot;2&quot;
37) &quot;failover-timeout&quot;
38) &quot;180000&quot;
39) &quot;parallel-syncs&quot;
40) &quot;1&quot;

</code></pre><p>ç›¸å…³è¯­æ³•ï¼š</p>
<pre tabindex="0"><code>sentinel master master-name

</code></pre><h4 id="æŸ¥çœ‹æŸä¸ªä¸»èŠ‚ç‚¹çš„-ip-å’Œç«¯å£"><strong>æŸ¥çœ‹æŸä¸ªä¸»èŠ‚ç‚¹çš„ IP å’Œç«¯å£</strong></h4>
<pre tabindex="0"><code>127.0.0.1:26379&gt; sentinel get-master-addr-by-name mymaster
1) &quot;127.0.0.1&quot;
2) &quot;6377&quot;

</code></pre><p>ç›¸å…³è¯­æ³•ï¼š</p>
<pre tabindex="0"><code>sentinel get-master-addr-by-name master-name

</code></pre><h4 id="æŸ¥è¯¢ä»èŠ‚ç‚¹çš„ä¿¡æ¯"><strong>æŸ¥è¯¢ä»èŠ‚ç‚¹çš„ä¿¡æ¯</strong></h4>
<pre tabindex="0"><code>127.0.0.1:26379&gt; sentinel slaves mymaster #è·å–æ–¹å¼ä¸€
1)  1) &quot;name&quot;
    2) &quot;127.0.0.1:6379&quot;
    3) &quot;ip&quot;
    4) &quot;127.0.0.1&quot;
    5) &quot;port&quot;
    6) &quot;6379&quot;
    7) &quot;runid&quot;
    8) &quot;14734d6065d745d89f115ca4735e7eeeeaa1a59b&quot;
    9) &quot;flags&quot;
   10) &quot;slave&quot;
   11) &quot;link-pending-commands&quot;
   12) &quot;0&quot;
   13) &quot;link-refcount&quot;
   14) &quot;1&quot;
   15) &quot;last-ping-sent&quot;
   16) &quot;0&quot;
   17) &quot;last-ok-ping-reply&quot;
   18) &quot;389&quot;
   19) &quot;last-ping-reply&quot;
   20) &quot;389&quot;
   21) &quot;down-after-milliseconds&quot;
   22) &quot;30000&quot;
   23) &quot;info-refresh&quot;
   24) &quot;390&quot;
   25) &quot;role-reported&quot;
   26) &quot;slave&quot;
   27) &quot;role-reported-time&quot;
   28) &quot;982798&quot;
   29) &quot;master-link-down-time&quot;
   30) &quot;1582192784000&quot;
   31) &quot;master-link-status&quot;
   32) &quot;err&quot;
   33) &quot;master-host&quot;
   34) &quot;127.0.0.1&quot;
   35) &quot;master-port&quot;
   36) &quot;6377&quot;
   37) &quot;slave-priority&quot;
   38) &quot;100&quot;
   39) &quot;slave-repl-offset&quot;
   40) &quot;1&quot;
2)  1) &quot;name&quot;
    2) &quot;127.0.0.1:6378&quot;
    3) &quot;ip&quot;
    4) &quot;127.0.0.1&quot;
    5) &quot;port&quot;
    6) &quot;6378&quot;
    7) &quot;runid&quot;
    8) &quot;f9d69479ace6c9eb4a6dffa58ebc1ddf3de456e0&quot;
    9) &quot;flags&quot;
   10) &quot;slave&quot;
   11) &quot;link-pending-commands&quot;
   12) &quot;0&quot;
   13) &quot;link-refcount&quot;
   14) &quot;1&quot;
   15) &quot;last-ping-sent&quot;
   16) &quot;0&quot;
   17) &quot;last-ok-ping-reply&quot;
   18) &quot;390&quot;
   19) &quot;last-ping-reply&quot;
   20) &quot;390&quot;
   21) &quot;down-after-milliseconds&quot;
   22) &quot;30000&quot;
   23) &quot;info-refresh&quot;
   24) &quot;4004&quot;
   25) &quot;role-reported&quot;
   26) &quot;slave&quot;
   27) &quot;role-reported-time&quot;
   28) &quot;76212633&quot;
   29) &quot;master-link-down-time&quot;
   30) &quot;0&quot;
   31) &quot;master-link-status&quot;
   32) &quot;ok&quot;
   33) &quot;master-host&quot;
   34) &quot;127.0.0.1&quot;
   35) &quot;master-port&quot;
   36) &quot;6377&quot;
   37) &quot;slave-priority&quot;
   38) &quot;100&quot;
   39) &quot;slave-repl-offset&quot;
   40) &quot;10811245&quot;
127.0.0.1:26379&gt; sentinel replicas mymaster #è·å–æ–¹å¼äºŒ
1)  1) &quot;name&quot;
    2) &quot;127.0.0.1:6379&quot;
    3) &quot;ip&quot;
    4) &quot;127.0.0.1&quot;
    5) &quot;port&quot;
    6) &quot;6379&quot;
    7) &quot;runid&quot;
    8) &quot;14734d6065d745d89f115ca4735e7eeeeaa1a59b&quot;
    9) &quot;flags&quot;
   10) &quot;slave&quot;
   11) &quot;link-pending-commands&quot;
   12) &quot;0&quot;
   13) &quot;link-refcount&quot;
   14) &quot;1&quot;
   15) &quot;last-ping-sent&quot;
   16) &quot;0&quot;
   17) &quot;last-ok-ping-reply&quot;
   18) &quot;100&quot;
   19) &quot;last-ping-reply&quot;
   20) &quot;100&quot;
   21) &quot;down-after-milliseconds&quot;
   22) &quot;30000&quot;
   23) &quot;info-refresh&quot;
   24) &quot;100&quot;
   25) &quot;role-reported&quot;
   26) &quot;slave&quot;
   27) &quot;role-reported-time&quot;
   28) &quot;1071687&quot;
   29) &quot;master-link-down-time&quot;
   30) &quot;1582192873000&quot;
   31) &quot;master-link-status&quot;
   32) &quot;err&quot;
   33) &quot;master-host&quot;
   34) &quot;127.0.0.1&quot;
   35) &quot;master-port&quot;
   36) &quot;6377&quot;
   37) &quot;slave-priority&quot;
   38) &quot;100&quot;
   39) &quot;slave-repl-offset&quot;
   40) &quot;1&quot;
2)  1) &quot;name&quot;
    2) &quot;127.0.0.1:6378&quot;
    3) &quot;ip&quot;
    4) &quot;127.0.0.1&quot;
    5) &quot;port&quot;
    6) &quot;6378&quot;
    7) &quot;runid&quot;
    8) &quot;f9d69479ace6c9eb4a6dffa58ebc1ddf3de456e0&quot;
    9) &quot;flags&quot;
   10) &quot;slave&quot;
   11) &quot;link-pending-commands&quot;
   12) &quot;0&quot;
   13) &quot;link-refcount&quot;
   14) &quot;1&quot;
   15) &quot;last-ping-sent&quot;
   16) &quot;0&quot;
   17) &quot;last-ok-ping-reply&quot;
   18) &quot;100&quot;
   19) &quot;last-ping-reply&quot;
   20) &quot;100&quot;
   21) &quot;down-after-milliseconds&quot;
   22) &quot;30000&quot;
   23) &quot;info-refresh&quot;
   24) &quot;2496&quot;
   25) &quot;role-reported&quot;
   26) &quot;slave&quot;
   27) &quot;role-reported-time&quot;
   28) &quot;76301522&quot;
   29) &quot;master-link-down-time&quot;
   30) &quot;0&quot;
   31) &quot;master-link-status&quot;
   32) &quot;ok&quot;
   33) &quot;master-host&quot;
   34) &quot;127.0.0.1&quot;
   35) &quot;master-port&quot;
   36) &quot;6377&quot;
   37) &quot;slave-priority&quot;
   38) &quot;100&quot;
   39) &quot;slave-repl-offset&quot;
   40) &quot;10823208&quot;

</code></pre><p>ç›¸å…³è¯­æ³•ï¼š</p>
<pre tabindex="0"><code>sentinel replicas mymaster

</code></pre><p>æˆ–</p>
<pre tabindex="0"><code>sentinel slaves master-name

</code></pre><h4 id="æŸ¥è¯¢-sentinel-é›†ç¾¤ä¸­çš„å…¶ä»–-sentinel-ä¿¡æ¯"><strong>æŸ¥è¯¢ Sentinel é›†ç¾¤ä¸­çš„å…¶ä»– Sentinel ä¿¡æ¯</strong></h4>
<pre tabindex="0"><code>127.0.0.1:26379&gt; sentinel sentinels mymaster
1)  1) &quot;name&quot;
    2) &quot;6455f2f74614a71ce0a63398b2e48d6cd1cf0d06&quot;
    3) &quot;ip&quot;
    4) &quot;127.0.0.1&quot;
    5) &quot;port&quot;
    6) &quot;26377&quot;
    7) &quot;runid&quot;
    8) &quot;6455f2f74614a71ce0a63398b2e48d6cd1cf0d06&quot;
    9) &quot;flags&quot;
   10) &quot;sentinel&quot;
   11) &quot;link-pending-commands&quot;
   12) &quot;0&quot;
   13) &quot;link-refcount&quot;
   14) &quot;1&quot;
   15) &quot;last-ping-sent&quot;
   16) &quot;0&quot;
   17) &quot;last-ok-ping-reply&quot;
   18) &quot;571&quot;
   19) &quot;last-ping-reply&quot;
   20) &quot;571&quot;
   21) &quot;down-after-milliseconds&quot;
   22) &quot;30000&quot;
   23) &quot;last-hello-message&quot;
   24) &quot;1043&quot;
   25) &quot;voted-leader&quot;
   26) &quot;?&quot;
   27) &quot;voted-leader-epoch&quot;
   28) &quot;0&quot;

</code></pre><p>ç›¸å…³è¯­æ³•ï¼š</p>
<pre tabindex="0"><code>sentinel sentinels master-name

</code></pre><h4 id="æ£€æŸ¥å¯ç”¨-sentinel-çš„æ•°é‡"><strong>æ£€æŸ¥å¯ç”¨ Sentinel çš„æ•°é‡</strong></h4>
<pre tabindex="0"><code>127.0.0.1:26379&gt; sentinel ckquorum mymaster
OK 2 usable Sentinels. Quorum and failover authorization can be reached

</code></pre><p>æœ‰ä¸¤ä¸ªå¯ç”¨çš„ Sentinelï¼Œå¯ç”¨å®Œæˆä»²è£å’Œæ•…éšœè½¬ç§»æˆæƒã€‚</p>
<p>ç›¸å…³è¯­æ³•ï¼š</p>
<pre tabindex="0"><code>sentinel ckquorum master-name

</code></pre><h4 id="å¼ºåˆ¶æ•…éšœè½¬ç§»"><strong>å¼ºåˆ¶æ•…éšœè½¬ç§»</strong></h4>
<pre tabindex="0"><code>127.0.0.1:26379&gt; sentinel failover mymaster
OK

</code></pre><p>ç›¸å…³è¯­æ³•ï¼š</p>
<pre tabindex="0"><code>sentinel failover master-name

</code></pre><h3 id="åœ¨çº¿ä¿®æ”¹é…ç½®ä¿¡æ¯">åœ¨çº¿ä¿®æ”¹é…ç½®ä¿¡æ¯</h3>
<p>åœ¨ Redis 2.8.4 ä¹‹å‰å¦‚æœéœ€è¦ä¿®æ”¹ Sentinel çš„é…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚æ·»åŠ æˆ–åˆ é™¤ä¸€ä¸ªç›‘è§†ä¸»èŠ‚ç‚¹ï¼Œéœ€è¦å…ˆåœæ­¢ Sentinel æœåŠ¡ï¼Œå†æ‰¾åˆ°é…ç½®æ–‡ä»¶ä¿®æ”¹ä¹‹åï¼Œé‡æ–°å¯åŠ¨ Sentinel æ‰è¡Œï¼Œè¿™æ ·å°±ç»™æˆ‘ä»¬å¸¦æ¥äº†å¾ˆå¤šçš„ä¸ä¾¿ï¼Œå°¤å…¶æ˜¯ç”Ÿäº§ç¯å¢ƒçš„ Sentinelï¼Œæ­£å¸¸æƒ…å†µä¸‹å¦‚æœæ˜¯éè‡´å‘½é—®é¢˜æˆ‘ä»¬æ˜¯ä¸èƒ½æ‰‹åŠ¨åœæ­¢æœåŠ¡çš„ï¼Œå¹¸è¿çš„æ˜¯ Redis 2.8.4 ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä¸åœæœºåœ¨çº¿ä¿®æ”¹é…ç½®æ–‡ä»¶äº†ï¼Œä¿®æ”¹å‘½ä»¤æœ‰ä»¥ä¸‹å‡ ä¸ªã€‚</p>
<h4 id="å¢åŠ ç›‘è§†ä¸»èŠ‚ç‚¹"><strong>å¢åŠ ç›‘è§†ä¸»èŠ‚ç‚¹</strong></h4>
<p>ä½¿ç”¨ <code>sentinel monitor mymaster IP Port Quorum</code> å‘½ä»¤æ¥æ·»åŠ ç›‘è§†ä¸»èŠ‚ç‚¹ï¼Œå¦‚ä¸‹å‘½ä»¤æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>127.0.0.1:26379&gt; sentinel monitor mymaster 127.0.0.1 6379 2
OK

</code></pre><p>OK è¡¨ç¤ºæ·»åŠ ç›‘è§†ä¸»èŠ‚ç‚¹æˆåŠŸã€‚</p>
<h4 id="ç§»é™¤ä¸»èŠ‚ç‚¹çš„ç›‘è§†"><strong>ç§»é™¤ä¸»èŠ‚ç‚¹çš„ç›‘è§†</strong></h4>
<p>ä½¿ç”¨ <code>sentinel remove master-name</code> å‘½ä»¤æ¥å®ç°ç§»é™¤ä¸»èŠ‚ç‚¹çš„ç›‘è§†ï¼Œå¦‚ä¸‹å‘½ä»¤æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>127.0.0.1:26379&gt; sentinel remove mymaster
OK

</code></pre><p>OK è¡¨ç¤ºæ“ä½œæˆåŠŸã€‚</p>
<h4 id="ä¿®æ”¹-quorum-å‚æ•°"><strong>ä¿®æ”¹ quorum å‚æ•°</strong></h4>
<p>ä½¿ç”¨ <code>sentinel set master-name quorum n</code> æ¥ä¿®æ”¹ quorum å‚æ•°ï¼Œå¦‚ä¸‹å‘½ä»¤æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>127.0.0.1:26379&gt; sentinel set mymaster quorum 1
OK

</code></pre><p>quorum å‚æ•°ç”¨æ¥è¡¨ç¤ºç¡®è®¤ä¸»èŠ‚ç‚¹ä¸‹çº¿çš„ Sentinel æ•°é‡ï¼Œå¦‚æœ quorum è®¾ç½®ä¸º 1 è¡¨ç¤ºåªè¦æœ‰ä¸€å° Sentinel ç¡®è®¤ä¸»è§‚ä¸‹çº¿åï¼Œè¿™ä¸ªä¸»èŠ‚ç‚¹å°±å®¢è§‚ï¼ˆçœŸæ­£åœ°ï¼‰ä¸‹çº¿äº†ã€‚</p>
<blockquote>
<p>å°è´´å£«ï¼šä»¥ä¸Šæ‰€æœ‰å¯¹é…ç½®æ–‡ä»¶çš„ä¿®æ”¹ï¼Œéƒ½ä¼šè‡ªåŠ¨è¢«åˆ·æ–°åˆ°ç‰©ç†é…ç½®æ–‡ä»¶ sentinel.conf ä¸­ã€‚</p>
</blockquote>
<h3 id="ä»£ç å®æˆ˜">ä»£ç å®æˆ˜</h3>
<p>æœ¬æ–‡æˆ‘ä»¬é€šè¿‡ Java ä»£ç æ¥å®ç°ï¼Œé€šè¿‡ Sentinel è¿æ¥ä¿¡æ¯è·å–ç›¸å…³ Redis å®¢æˆ·ç«¯ï¼Œå†è¿›è¡Œç›¸å…³ Redis æ“ä½œï¼Œè¿™æ · Sentinel å°±ä¼šå¸®æˆ‘ä»¬åšå®¹ç¾æ¢å¤ï¼Œæˆ‘ä»¬å°±ä¸ç”¨æ‹…å¿ƒæ“ä½œæŸä¸€ä¸ª Redis æœåŠ¡å™¨ç«¯ï¼Œå› ä¸ºæœåŠ¡å™¨æŒ‚äº†ä¹‹åå°±ä¼šå¯¼è‡´ç¨‹åºä¸å¯ç”¨äº†ï¼Œå…·ä½“å®ç°ä»£ç å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>import redis.clients.jedis.Jedis;
import redis.clients.jedis.JedisSentinelPool;
import utils.Config;

import java.util.HashSet;
import java.util.Set;

public class SentinelExample {
    // master name
    private static String _MASTER_NAME = &quot;mymaster&quot;;

    public static void main(String[] args) {
        // Sentinel é…ç½®ä¿¡æ¯
        Set&lt;String&gt; set = new HashSet&lt;&gt;();
        // è¿æ¥ä¿¡æ¯ ip:port
        set.add(&quot;127.0.0.1:26379&quot;);
        // åˆ›å»º Sentinel è¿æ¥æ± 
        JedisSentinelPool jedisSentinel = new JedisSentinelPool(_MASTER_NAME,
                set, Config.REDIS_AUTH);
        // è·å– Redis å®¢æˆ·ç«¯
        Jedis jedis = jedisSentinel.getResource();
        // è®¾ç½®å…ƒç´ 
        String setRes = jedis.set(&quot;key&quot;, &quot;Hello, redis.&quot;);
        System.out.println(setRes);
        // è·å–å…ƒç´ 
        System.out.println(jedis.get(&quot;key&quot;));
    }
}

</code></pre><p>ä»¥ä¸Šç¨‹åºæ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>OK
Hello, redis.

</code></pre><h3 id="å°ç»“">å°ç»“</h3>
<p>æœ¬æ–‡æˆ‘ä»¬è®²äº† Sentinel ç›¸å…³çš„å‘½ä»¤æ“ä½œï¼Œä¸»è¦æ˜¯ç”¨äºæŸ¥è¯¢ç›¸å…³ä¸»ä»èŠ‚ç‚¹å’Œå…¶ä»– Sentinel ä¿¡æ¯çš„ï¼Œè¿˜å¯ä»¥æ‰§è¡Œå¼ºåˆ¶æ•…éšœè½¬ç§»ç­‰ï¼Œæˆ‘ä»¬è¿˜è®²äº† 2.8.4 æä¾›çš„åœ¨çº¿ä¿®æ”¹ Sentinel å‚æ•°çš„ä¸‰ä¸ªæ–¹æ³•ï¼Œæ–¹ä¾¿æˆ‘ä»¬æ›´å¥½çš„ä½¿ç”¨ Sentinelï¼Œæœ€åç”¨ä»£ç å®ç°äº†é€šè¿‡ Sentinel è·å–ä¸»èŠ‚ç‚¹å¹¶è¿›è¡Œ Redis æœåŠ¡å™¨æ“ä½œçš„å®ä¾‹ï¼Œè¿™æ ·å°±è®²å®Œæ•´ä¸ª Sentinel çš„ä»‹ç»å’Œåº”ç”¨ã€‚</p>

        </div>
    </article>
</div>

    </main>
    <footer>
        <div id="pagination">
            
<div class="paginator">
    <div class="prev">
        
        <a href="/documents/columns/redis/redis-%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/39-%E5%AE%9E%E6%88%98redis-%E9%9B%86%E7%BE%A4%E6%A8%A1%E5%BC%8F%E4%B8%8A.md/"><span></span></a>
    </div>
    <div class="next">
        
        <a href="/documents/columns/redis/redis-%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/37-%E5%AE%9E%E6%88%98redis%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F%E4%B8%8A.md/"><span></span></a>
    </div>
</div>

        </div>
        <div class="toggler" onclick="toggleLight(this);">ğŸ’¡</div>
        <div id="copyright" style="display: none;">
    
    
    <p>&copy; 27270 <a href="/"></a>, powered by Hugo and Qiao</p>
</div>
    </footer>
    
<script>
    function toggleLight() {
        document.getElementById('page').classList.toggle('night');
    }
</script>
</body>

</html>