<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
<meta name="X-UA-Compatible" , content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<link rel="icon" type="image/png" href="/%20/favicon.png">

<title>15 Service å±‚å¼•æµæŠ€æœ¯å®è·µ | Yipsen Ye</title>
<meta name="description" content="Kubernetes å¼•å…¥çš„ Service å±‚ç»™é›†ç¾¤å¸¦æ¥äº†ä¸¤æ ·ç‰¹æ€§ï¼šç¬¬ä¸€æ˜¯ ClusterIPï¼Œé€šè¿‡é›†ç¾¤ DNS åˆ†é…çš„æœåŠ¡åˆ«åï¼ŒæœåŠ¡å¯ä»¥è·å¾—ä¸€ä¸ªç¨³å®šçš„æœåŠ¡åå­—ï¼Œä¾‹å¦‚ï¼šfoo.bar.svc.cluster.localã€‚ç¬¬äºŒæ˜¯åå‘ä»£ç†ï¼Œé€šè¿‡ iptables/IPVS/eBPF ç­‰å„ç§ç½‘ç»œæ•°æ®è½¬æ¢æŠ€æœ¯æŠŠæµé‡è´Ÿè½½åˆ°ä¸Šæ¸¸çš„ Pod å®¹å™¨ç»„ä¸­ã€‚åˆ°è¿™é‡Œï¼Œå…¶å® Service å±‚çš„åŸºæœ¬æŠ€æœ¯å·²ç»ç»™å¤§å®¶ä»‹ç»äº†ï¼Œä½†æ˜¯ä»å®è·µçš„è§’åº¦å†æ¬¡åˆ†æï¼Œå‘ç°å…¶ä¸­è¿˜æœ‰å¾ˆå¤šæœ€æ–°çš„è¿›å±•éœ€è¦ç»™å¤§å®¶è®²è§£ä»¥ä¸‹ï¼Œå¹¶ä»ä¸­æˆ‘ä»¬èƒ½æ€»ç»“å‡ºæŠ€æœ¯å‘å±•è¿‡ç¨‹ä¸­å¦‚ä½•ä¼˜åŒ–çš„ç­–ç•¥æ€»ç»“ã€‚
Ingress çš„è¯¯è§£ï¼Ÿ åœ¨ç¤¾åŒºæ–‡æ¡£ä¸­ä»‹ç»çš„ Ingress èµ„æºï¼Œæˆ‘ä»¬çŸ¥é“å®ƒæ˜¯åº”å¯¹ HTTP(S) Web æµé‡å¼•å…¥åˆ°é›†ç¾¤çš„åœºæ™¯åˆ›å»ºçš„èµ„æºå¯¹è±¡ã€‚ä¸€èˆ¬ä»‹ç»ä¸­æˆ‘ä»¬ä¼šè¯´å®ƒä¸æ”¯æŒ L4 å±‚çš„å¼•æµã€‚å¦‚æœæƒ³æ”¯æŒå…¶å®ƒç½‘ç»œåè®®ï¼Œæœ€å¥½ç”¨ Service çš„å¦å¤–ä¸¤ç§å½¢å¼ ServiceType=NodePort æˆ–è€… ServiceType=LoadBalancer æ¨¡å¼æ¥æ”¯æŒã€‚
é¦–å…ˆï¼ŒIngress èµ„æºå¯¹è±¡èƒ½ä¸èƒ½æ”¯æŒ L4 å±‚ï¼Œå¹¶ä¸æ˜¯å®Œå…¨ç”±è¿™ä¸ªèµ„æºå¯¹è±¡èƒ½æŠŠæ§ï¼ŒçœŸæ­£æ‰¿è½½å¼•æµèƒ½åŠ›çš„æ˜¯ç‹¬ç«‹éƒ¨ç½²çš„ Ingress-Nginx å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯ Nginx æ‰èƒ½å†³å®šã€‚æˆ‘ä»¬çŸ¥é“ Nginx æœ¬èº«å°±æ˜¯æ”¯æŒ L4 å±‚çš„ã€‚æ‰€ä»¥ï¼ŒIngress é€šè¿‡å˜ç›¸å¢åŠ å‚æ•°çš„æ–¹å¼å¯ä»¥æä¾›æ”¯æŒï¼š
apiVersion: v1kind: ConfigMapmetadata:name: tcp-servicesnamespace: defaultdata:27017: &amp;quot;default/tcp-svc:27017&amp;quot;---apiVersion: flux.weave.works/v1beta1kind: HelmReleasemetadata:name: nginx-ingressnamespace: defaultspec:releaseName: nginx-ingresschart:repository: https://kubernetes-charts.storage.googleapis.com name: nginx-ingressversion: 1.">
<meta name="author" content="">

<link rel="stylesheet" type="text/css" href="/styles/main.css">

</head>

<body id="page">
    <header>
        <div class="logo-link" style="width: 60px; color: #CA6924;">
    <a href="http://yipsen.github.io/">
        <img style="margin-bottom: -1rem;" src="/images/deer.svg" alt="logo">
        <span style="font-size: 0.5rem; color: #CA6924;">Yipsen Ye</span>
    </a>
</div>
<nav class="navbar justify-content-end">
    <ul class="nav-list">
        
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/posts/">æœ­è®°</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/collections/">é™„è¡¨</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/about/">å…³äº</a>
        </li>
        
    </ul>
</nav>
    </header>
    <main id="content">
        
<div class="container"><aside>
    <div>
        
        
            
            
            <div class="post-category-icon"></div>
            <a href="/categories/kubernetes%e5%ae%9e%e8%b7%b5%e5%85%a5%e9%97%a8%e6%8c%87%e5%8d%97/">Kuberneteså®è·µå…¥é—¨æŒ‡å—</a>
            <ul>
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/00-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E4%BB%AC%E8%A6%81%E5%AD%A6%E4%B9%A0-kubernetes-%E6%8A%80%E6%9C%AF/">00 ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦å­¦ä¹  Kubernetes æŠ€æœ¯</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/01-%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86-kubernetes-%E7%9A%84%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6/">01 é‡æ–°è®¤è¯† Kubernetes çš„æ ¸å¿ƒç»„ä»¶</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/02-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3-kubernets-%E7%9A%84%E7%BC%96%E6%8E%92%E5%AF%B9%E8%B1%A1/">02 æ·±å…¥ç†è§£ Kubernets çš„ç¼–æ’å¯¹è±¡</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/03-devops-%E5%9C%BA%E6%99%AF%E4%B8%8B%E8%90%BD%E5%9C%B0-k8s-%E7%9A%84%E5%9B%B0%E9%9A%BE%E5%88%86%E6%9E%90/">03 DevOps åœºæ™¯ä¸‹è½åœ° K8s çš„å›°éš¾åˆ†æ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/04-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%E4%B8%8B%E8%90%BD%E5%9C%B0-k8s-%E7%9A%84%E5%9B%B0%E9%9A%BE%E5%88%86%E6%9E%90/">04 å¾®æœåŠ¡åº”ç”¨åœºæ™¯ä¸‹è½åœ° K8s çš„å›°éš¾åˆ†æ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/05-%E8%A7%A3%E5%86%B3-k8s-%E8%90%BD%E5%9C%B0%E9%9A%BE%E9%A2%98%E7%9A%84%E6%96%B9%E6%B3%95%E8%AE%BA%E6%8F%90%E7%82%BC/">05 è§£å†³ K8s è½åœ°éš¾é¢˜çš„æ–¹æ³•è®ºæç‚¼</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/06-%E7%BB%83%E4%B9%A0%E7%AF%87k8s-%E6%A0%B8%E5%BF%83%E5%AE%9E%E8%B7%B5%E7%9F%A5%E8%AF%86%E6%8E%8C%E6%8F%A1/">06 ç»ƒä¹ ç¯‡ï¼šK8s æ ¸å¿ƒå®è·µçŸ¥è¯†æŒæ¡</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/07-%E5%AE%B9%E5%99%A8%E5%BC%95%E6%93%8E-containerd-%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">07 å®¹å™¨å¼•æ“ containerd è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/08-k8s-%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85%E5%B7%A5%E5%85%B7-kubeadm-%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">08 K8s é›†ç¾¤å®‰è£…å·¥å…· kubeadm çš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/09-%E5%8D%97%E5%8C%97%E5%90%91%E6%B5%81%E9%87%8F%E7%BB%84%E4%BB%B6-ipvs-%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">09 å—åŒ—å‘æµé‡ç»„ä»¶ IPVS çš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/10-%E4%B8%9C%E8%A5%BF%E5%90%91%E6%B5%81%E9%87%8F%E7%BB%84%E4%BB%B6-calico-%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">10 ä¸œè¥¿å‘æµé‡ç»„ä»¶ Calico çš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/11-%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0-dns-%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">11 æœåŠ¡å‘ç° DNS çš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/12-%E7%BB%83%E4%B9%A0%E7%AF%87k8s-%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E6%B5%8B%E9%AA%8C/">12 ç»ƒä¹ ç¯‡ï¼šK8s é›†ç¾¤é…ç½®æµ‹éªŒ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/13-%E7%90%86%E8%A7%A3%E5%AF%B9%E6%96%B9%E6%9A%B4%E9%9C%B2%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%AF%B9%E8%B1%A1-ingress-%E5%92%8C-service/">13 ç†è§£å¯¹æ–¹æš´éœ²æœåŠ¡çš„å¯¹è±¡ Ingress å’Œ Service</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/14-%E5%BA%94%E7%94%A8%E7%BD%91%E5%85%B3-openresty-%E5%AF%B9%E6%8E%A5-k8s-%E5%AE%9E%E8%B7%B5/">14 åº”ç”¨ç½‘å…³ OpenResty å¯¹æ¥ K8s å®è·µ</a></li>
                
                
                
                    <li>15 Service å±‚å¼•æµæŠ€æœ¯å®è·µ</li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/16-cilium-%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">16 Cilium å®¹å™¨ç½‘ç»œçš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/17-%E5%BA%94%E7%94%A8%E6%B5%81%E9%87%8F%E7%9A%84%E4%BC%98%E9%9B%85%E6%97%A0%E6%8D%9F%E5%88%87%E6%8D%A2%E5%AE%9E%E8%B7%B5/">17 åº”ç”¨æµé‡çš„ä¼˜é›…æ— æŸåˆ‡æ¢å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/18-%E7%BB%83%E4%B9%A0%E7%AF%87%E5%BA%94%E7%94%A8%E6%B5%81%E9%87%8F%E6%97%A0%E6%8D%9F%E5%88%87%E6%8D%A2%E6%8A%80%E6%9C%AF%E6%B5%8B%E9%AA%8C/">18 ç»ƒä¹ ç¯‡ï¼šåº”ç”¨æµé‡æ— æŸåˆ‡æ¢æŠ€æœ¯æµ‹éªŒ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/19-%E4%BD%BF%E7%94%A8-rook-%E6%9E%84%E5%BB%BA%E7%94%9F%E4%BA%A7%E5%8F%AF%E7%94%A8%E5%AD%98%E5%82%A8%E7%8E%AF%E5%A2%83%E5%AE%9E%E8%B7%B5/">19 ä½¿ç”¨ Rook æ„å»ºç”Ÿäº§å¯ç”¨å­˜å‚¨ç¯å¢ƒå®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/20-%E6%9C%89%E7%8A%B6%E6%80%81%E5%BA%94%E7%94%A8%E7%9A%84%E9%BB%98%E8%AE%A4%E7%89%B9%E6%80%A7%E8%90%BD%E5%9C%B0%E5%88%86%E6%9E%90/">20 æœ‰çŠ¶æ€åº”ç”¨çš„é»˜è®¤ç‰¹æ€§è½åœ°åˆ†æ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/21-%E6%A1%88%E4%BE%8B%E5%88%86%E5%B8%83%E5%BC%8F-mysql-%E9%9B%86%E7%BE%A4%E5%B7%A5%E5%85%B7-vitess-%E5%AE%9E%E8%B7%B5%E5%88%86%E6%9E%90/">21 æ¡ˆä¾‹ï¼šåˆ†å¸ƒå¼ MySQL é›†ç¾¤å·¥å…· Vitess å®è·µåˆ†æ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/22-%E5%AD%98%E5%82%A8%E5%AF%B9%E8%B1%A1-pvpvcstorage-classes-%E7%9A%84%E7%AE%A1%E7%90%86%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">22 å­˜å‚¨å¯¹è±¡ PVã€PVCã€Storage Classes çš„ç®¡ç†è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/23-k8s-%E9%9B%86%E7%BE%A4%E4%B8%AD%E5%AD%98%E5%82%A8%E5%AF%B9%E8%B1%A1%E7%81%BE%E5%A4%87%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">23 K8s é›†ç¾¤ä¸­å­˜å‚¨å¯¹è±¡ç¾å¤‡çš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/24-%E7%BB%83%E4%B9%A0%E7%AF%87k8s-%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E6%B5%8B%E9%AA%8C/">24 ç»ƒä¹ ç¯‡ï¼šK8s é›†ç¾¤é…ç½®æµ‹éªŒ</a></li>
                
                
            </ul>
        
    </div>
</aside>

<style>
    aside {
        position: fixed;
        left: 20px;
        background: #ffdee3;
        border-radius: 6px;
        padding: 20px;
        padding-top: 60px;
        box-shadow: 5px 10px #888;
        list-style-type: none;
        display: none;
    }

    .post-category-icon {
        position: absolute;
        width: 80px;
        height: 80px;
        top: -40px;
        left: 50%;
        margin-left: -40px;
        text-align: center;
        font-size: 36px;
        content: 'J';
        background: #ffdee3;
        border-radius: 100%;
        border: 10px solid #fff;
        box-shadow: 5px 10px #888;
    }
</style><article class="post-block">
        <h1 class="post-title">15 Service å±‚å¼•æµæŠ€æœ¯å®è·µ</h1>
        <div class="post-info">
            <div> 
                <span class="post-date">ğŸ“…&nbsp;2021-12-22 01:48:21</span>ğŸ·ï¸&nbsp;<a class="post-tag" href="/tags/kubernetes/">kubernetes</a></div><div class="post-category">
                
                ğŸ“š&nbsp;<a href="/categories/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/">Kuberneteså®è·µå…¥é—¨æŒ‡å—</a>
                
            </div></div>
        <div class="post-content">
            <p>Kubernetes å¼•å…¥çš„ Service å±‚ç»™é›†ç¾¤å¸¦æ¥äº†ä¸¤æ ·ç‰¹æ€§ï¼šç¬¬ä¸€æ˜¯ ClusterIPï¼Œé€šè¿‡é›†ç¾¤ DNS åˆ†é…çš„æœåŠ¡åˆ«åï¼ŒæœåŠ¡å¯ä»¥è·å¾—ä¸€ä¸ªç¨³å®šçš„æœåŠ¡åå­—ï¼Œä¾‹å¦‚ï¼šfoo.bar.svc.cluster.localã€‚ç¬¬äºŒæ˜¯åå‘ä»£ç†ï¼Œé€šè¿‡ iptables/IPVS/eBPF ç­‰å„ç§ç½‘ç»œæ•°æ®è½¬æ¢æŠ€æœ¯æŠŠæµé‡è´Ÿè½½åˆ°ä¸Šæ¸¸çš„ Pod å®¹å™¨ç»„ä¸­ã€‚åˆ°è¿™é‡Œï¼Œå…¶å® Service å±‚çš„åŸºæœ¬æŠ€æœ¯å·²ç»ç»™å¤§å®¶ä»‹ç»äº†ï¼Œä½†æ˜¯ä»å®è·µçš„è§’åº¦å†æ¬¡åˆ†æï¼Œå‘ç°å…¶ä¸­è¿˜æœ‰å¾ˆå¤šæœ€æ–°çš„è¿›å±•éœ€è¦ç»™å¤§å®¶è®²è§£ä»¥ä¸‹ï¼Œå¹¶ä»ä¸­æˆ‘ä»¬èƒ½æ€»ç»“å‡ºæŠ€æœ¯å‘å±•è¿‡ç¨‹ä¸­å¦‚ä½•ä¼˜åŒ–çš„ç­–ç•¥æ€»ç»“ã€‚</p>
<h3 id="ingress-çš„è¯¯è§£">Ingress çš„è¯¯è§£ï¼Ÿ</h3>
<p>åœ¨ç¤¾åŒºæ–‡æ¡£ä¸­ä»‹ç»çš„ Ingress èµ„æºï¼Œæˆ‘ä»¬çŸ¥é“å®ƒæ˜¯åº”å¯¹ HTTP(S) Web æµé‡å¼•å…¥åˆ°é›†ç¾¤çš„åœºæ™¯åˆ›å»ºçš„èµ„æºå¯¹è±¡ã€‚ä¸€èˆ¬ä»‹ç»ä¸­æˆ‘ä»¬ä¼šè¯´å®ƒä¸æ”¯æŒ L4 å±‚çš„å¼•æµã€‚å¦‚æœæƒ³æ”¯æŒå…¶å®ƒç½‘ç»œåè®®ï¼Œæœ€å¥½ç”¨ Service çš„å¦å¤–ä¸¤ç§å½¢å¼ <code>ServiceType=NodePort</code> æˆ–è€… <code>ServiceType=LoadBalancer</code> æ¨¡å¼æ¥æ”¯æŒã€‚</p>
<p>é¦–å…ˆï¼ŒIngress èµ„æºå¯¹è±¡èƒ½ä¸èƒ½æ”¯æŒ L4 å±‚ï¼Œå¹¶ä¸æ˜¯å®Œå…¨ç”±è¿™ä¸ªèµ„æºå¯¹è±¡èƒ½æŠŠæ§ï¼ŒçœŸæ­£æ‰¿è½½å¼•æµèƒ½åŠ›çš„æ˜¯ç‹¬ç«‹éƒ¨ç½²çš„ Ingress-Nginx å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯ Nginx æ‰èƒ½å†³å®šã€‚æˆ‘ä»¬çŸ¥é“ Nginx æœ¬èº«å°±æ˜¯æ”¯æŒ L4 å±‚çš„ã€‚æ‰€ä»¥ï¼ŒIngress é€šè¿‡å˜ç›¸å¢åŠ å‚æ•°çš„æ–¹å¼å¯ä»¥æä¾›æ”¯æŒï¼š</p>
<pre tabindex="0"><code>apiVersion: v1
kind: ConfigMap
metadata:
  name: tcp-services
  namespace: default
data:
  27017: &quot;default/tcp-svc:27017&quot;
---
apiVersion: flux.weave.works/v1beta1
kind: HelmRelease
metadata:
  name: nginx-ingress
  namespace: default
spec:
  releaseName: nginx-ingress
  chart:
    repository: https://kubernetes-charts.storage.googleapis.com 
    name: nginx-ingress
    version: 1.6.10
  values:
    tcp:
      27017: &quot;default/tcp-svc:27017&quot;

</code></pre><p>åŒç†ï¼ŒUDP åè®®ä¹Ÿå¯ä»¥æ”¯æŒï¼Œåœ¨æ­¤ä¸å†èµ˜è¿°ã€‚ä»å®è·µè§’åº¦æ¥è®²ï¼Œè¿™ç§ä¾èµ– Nginx çš„åœ¨å…¶å®ƒ Ingress æ§åˆ¶å™¨ä¸­ä¼šæœ‰ä¸åŒçš„æ”¯æŒï¼Œä½ éœ€è¦è¯¦ç»†æŸ¥é˜…å¼€å‘æ–‡æ¡£æ¥ç¡®è®¤ã€‚</p>
<p>å¦å¤–ï¼ŒIngress-Nginx åœ¨ä»‹ç»ä¸­éƒ½æ˜¯ç›´æ¥é€šè¿‡ Service æ¥æŠŠæµé‡è´Ÿè½½å‡è¡¡åˆ° Pod å®¹å™¨ç»„ï¼Œè¿å¾ˆå¤šæ¶æ„å›¾éƒ½æ˜¯è¿™ä¹ˆç”»çš„ï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Kubernetes%20%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/assets/54191580-f89f-11ea-983a-f5723f270458.jpg" alt="img"></p>
<p>åœ¨å·¥ç¨‹ä»£ç å®ç°ä¸Šé»˜è®¤ Ingress-Nginx æ˜¯ä¸ç»è¿‡ Serviceï¼Œä¹Ÿä¸ç»è¿‡ kube-proxy è®¿é—® Podï¼Œè€Œä¸”é€šè¿‡ Service æ‰¾åˆ°å¯¹åº”çš„ Endpointï¼Œç„¶åç›´æ¥æŠŠè¯·æ±‚åˆ†å‘åˆ°å¯¹åº”çš„ Pod IP å’Œç«¯å£ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯è§„é¿äº† Service è¿™å±‚çš„ DNAT è½¬æ¢ï¼Œç¼ºç‚¹å°±æ˜¯æ²¡æœ‰äº†åå‘ä»£ç†èƒ½åŠ›ï¼Œæ¥å…¥æµé‡æœåŠ¡ä¹Ÿä¸æ˜¯é«˜å¯ç”¨çš„ SLAã€‚ä¸ºäº†èƒ½æŠŠ Service è¿™å±‚åå‘ä»£ç†èƒ½åŠ›é‡æ–°å¯ç”¨ï¼Œå¯ä»¥åŠ å…¥æ³¨è§£å‚æ•°ï¼š</p>
<pre tabindex="0"><code>nginx.ingress.kubernetes.io/service-upstream: &quot;true&quot;

</code></pre><p>é€šè¿‡è¿™ä¸ªæ³¨è§£ç‰¹æ€§ï¼Œå°±å¯ä»¥è®© Nginx ç›´æ¥ä½¿ç”¨ä¸Šæ¸¸çš„ Service ClusterIP ä½œä¸ºä¸Šæ¸¸å…¥å£ã€‚è¿™ç§ç‰¹æ€§çš„å¢å¼ºæœ‰å¾ˆå¤šï¼Œå¦‚æœä½ æœ‰å…´è¶£ï¼Œå¯ä»¥å¤šåˆ°<a href="https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/">æ³¨è§£ç‰¹æ€§çš„æ¸…å•</a>è¿™é‡ŒæŸ¥é˜…ã€‚å¦å¤–ï¼Œå¦‚æœä½ æ˜¯ Golang ç¨‹åºå‘˜ï¼Œè¿˜èƒ½æ‰©å±•æ–°æ³¨è§£å‚æ•°å¹¶ä¸æ–­çš„ç»™ Nginx åŠ å…¥æ–°ç‰¹æ€§ï¼Œè¯·å‚è€ƒ<a href="https://medium.com/better-programming/creating-a-custom-annotation-for-the-kubernetes-ingress-nginx-controller-444e9d486192">æ¡ˆä¾‹å…¥é—¨</a>ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p>
<h3 id="service-çš„è¯¯è§£">Service çš„è¯¯è§£ï¼Ÿ</h3>
<p>åœ¨ç¤¾åŒºæ–‡æ¡£ä¸­æè¿° Pod å‘å¸ƒåˆ°é›†ç¾¤ä¸­ï¼Œæ˜ç¡®è¯´æ˜¯æ— æ³•ç›´æ¥å¯¹å¤–æä¾›æœåŠ¡çš„ã€‚æ‰€ä»¥æ‰å¼•å…¥äº† Service èµ„æºå¯¹è±¡æ¥æš´éœ²æœåŠ¡ã€‚ä½†æ˜¯éšç€å®è·µæ¡ˆä¾‹çš„å¢åŠ ï¼ŒPod ä¹Ÿæ˜¯å¯ä»¥ç›´æ¥ç»‘å®šä¸»æœºç«¯å£çš„ï¼Œè¯·çœ‹å¦‚ä¸‹æ¡ˆä¾‹ï¼š</p>
<pre tabindex="0"><code>apiVersion: v1
kind: Pod
metadata:
  name: nginx
spec:
  hostNetwork: true
  dnsPolicy: ClusterFirstWithHostNet
  containers:
    - name: nginx
      image: nginx
      ports:
        - containerPort: 8080

</code></pre><p>å¯¹äºä»¥ hostNetwork æ–¹å¼è¿è¡Œçš„ Pod éœ€è¦æ˜¾å¼è®¾ç½®å…¶ DNS ç­–ç•¥ ClusterFirstWithHostNetï¼Œåªæœ‰è¿™æ · Pod æ‰ä¼šèµ°é›†ç¾¤ DNS æŸ¥è¯¢æœåŠ¡ã€‚è¿™ä¸ªèŒƒä¾‹ä¹Ÿæé†’äº†æˆ‘ä»¬ Service IP å¹¶ä¸æ˜¯å”¯ä¸€å¼•æµçš„æ–¹æ¡ˆï¼Œä¸€å®šè¦ç»“åˆå®é™…åœºæ™¯æ¥åº”ç”¨ Kubernetes çš„ç‰¹æ€§ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨æ¥åˆ¨æä¸‹ Service IPï¼Œå®ƒæ˜¯ç”± iptables åˆ›å»ºçš„è™šæ‹Ÿ IP åœ°å€ã€‚æ ¹æ® iptables å®šä¹‰è§„åˆ™ï¼Œç»Ÿç§°è¿™ç±» IP ä¸º DNAT æ¨¡å¼ï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Kubernetes%20%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/assets/68015df0-f89f-11ea-9926-2b08df6c26e2.jpg" alt="service-dnat-ip"></p>
<p>é€šè¿‡ kube-proxy ç”Ÿæˆçš„ iptables è§„åˆ™ï¼ˆæœ€æ–°ç‰ˆæœ¬é‡‡ç”¨ IPVS æ¨¡å—ç”Ÿæˆä»£ç†è§„åˆ™ï¼Œè¿™é‡Œä¸åœ¨èµ˜è¿°ï¼ŒåŸç†ç±»ä¼¼ï¼‰ï¼Œæ¯å½“ä¸€ä¸ªæ•°æ®åŒ…çš„ç›®çš„åœ°æ˜¯æœåŠ¡ IP æ—¶ï¼Œå®ƒå°±ä¼šè¢« DNAT åŒ–ï¼ˆDNAT = ç›®çš„åœ°ç½‘ç»œåœ°å€è½¬æ¢ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ç›®çš„åœ° IP ä»æœåŠ¡ IP å˜æˆäº† iptables éšæœºé€‰æ‹©çš„ä¸€ä¸ªç«¯ç‚¹ Pod IPã€‚è¿™æ ·å¯ä»¥ä¿è¯è´Ÿè½½æµé‡å¯ä»¥åœ¨åç«¯ Pod ä¸­å‡åŒ€åˆ†å¸ƒã€‚å½“ DNAT å‘ç”Ÿæ—¶ï¼Œè¿™äº›ä¿¡æ¯ä¼šè¢«å­˜å‚¨åœ¨ conntrack å³ Linux è¿æ¥è·Ÿè¸ªè¡¨ä¸­ï¼ˆå­˜å‚¨ 5 å…ƒç»„æ•°æ®è®°å½•é›†ï¼šåè®®ã€srcIPã€srcPortã€dstIPã€dstPortï¼‰ã€‚å½“æ•°æ®å›å¤å›æ¥çš„æ—¶å€™ï¼Œå°±å¯ä»¥å–æ¶ˆ DNATï¼Œä¹Ÿå°±æ˜¯æŠŠæº IP ä» Pod IP æ”¹æˆ Service IPã€‚è¿™æ ·ä¸€æ¥ï¼Œå®¢æˆ·ç«¯å°±ä¸éœ€è¦çŸ¥é“åé¢çš„æ•°æ®åŒ…æµæ˜¯å¦‚ä½•å¤„ç†çš„ã€‚</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Kubernetes%20%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/assets/7ca72a00-f89f-11ea-bdae-77091ca4470c.jpg" alt="13-3-dnat-5-tuple"></p>
<p>å¯¹äºä» Pod å‘èµ·å¹¶å‡ºç«™çš„æ•°æ®æµé‡ï¼Œä¹Ÿæ˜¯éœ€è¦ NAT è½¬æ¢çš„ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒèŠ‚ç‚¹å¯ä»¥åŒæ—¶æ‹¥æœ‰ç§æœ‰è™šæ‹Ÿ IP å’Œå…¬æœ‰ IPã€‚åœ¨èŠ‚ç‚¹ä¸å¤–éƒ¨ IP çš„æ­£å¸¸é€šä¿¡ä¸­ï¼Œå¯¹äºå‡ºç«™æ•°æ®åŒ…ï¼Œæº IP ç”±èŠ‚ç‚¹çš„ç§æœ‰è™šæ‹Ÿ IP å˜ä¸ºå…¶å…¬æœ‰ IPï¼Œå¯¹äºå…¥ç«™æ•°æ®åŒ…çš„å›å¤åˆ™åè¿‡æ¥ã€‚ä½†æ˜¯å½“è¿æ¥åˆ°å¤–éƒ¨ IP æ˜¯ç”± Pod å‘èµ·æ—¶ï¼Œæº IP æ˜¯ Pod çš„ IPï¼Œkube-proxy ä¼šå¤šåŠ ä¸€äº› iptables è§„åˆ™ï¼Œåš SNATï¼ˆSource Network Address Translationï¼‰ä¹Ÿå°±æ˜¯ IP MASQUERADEã€‚SNAT è§„åˆ™å‘Šè¯‰å†…æ ¸å‡ºç«™æ•°æ®åŒ…éœ€è¦ä½¿ç”¨èŠ‚ç‚¹çš„å¤–ç½‘ IP æ¥ä»£æ›¿æº Pod çš„ IPã€‚ç³»ç»Ÿè¿˜éœ€è¦ä¿ç•™ä¸€ä¸ª conntrack æ¡ç›®æ¥è§£é™¤ SNAT çš„å›å¤ã€‚</p>
<p>æ³¨æ„è¿™é‡Œçš„æ€§èƒ½é—®é¢˜ï¼Œç”±äºé›†ç¾¤å®¹å™¨è§„æ¨¡çš„å¢åŠ ï¼Œconntrack ä¼šæš´å¢ï¼Œåç”±åä¸ºå®¹å™¨å›¢é˜Ÿå¼•å…¥çš„ IPVS æ–¹æ¡ˆä¹Ÿæ˜¯åœ¨åšå¤§è§„æ¨¡å®¹å™¨è´Ÿè½½çš„å‹æµ‹ä¸­å‘ç°è¿™ä¸ªç“¶é¢ˆï¼Œå¹¶æå‡ºå¼•å…¥ IPVS æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åœ¨ç¬”è€…å®é™…åº”ç”¨ä¸­å‘ç°ï¼Œiptables æ–¹æ¡ˆåœ¨å°è§„æ¨¡é›†ç¾¤åœºæ™¯ä¸‹æ€§èƒ½å’Œ IPVS æŒå¹³ï¼Œæ‰€ä»¥ IPVS æ–¹æ¡ˆä»æœ¬è´¨ä¸Šæ¥è®²è¿˜åªæ˜¯ä¸€ä¸ªä¸´æ—¶æ–¹æ¡ˆï¼Œå®ƒåªè§£å†³äº†å…¥ç«™æµé‡æ•°æ®åŒ…çš„ DNAT è½¬æ¢ï¼ŒSNAT è½¬æ¢è¿˜æ˜¯éœ€è¦ iptables æ¥ç»´æŠ¤ã€‚å» iptables åŒ–ç›¸ä¿¡åœ¨ä¸ä¹…çš„å°†æ¥ä¼šè¢« eBPF æŠ€æœ¯å–ä»£ï¼Œå¹¶æœ€ç»ˆå®ç°æœ€ä¼˜çš„æµé‡å¼•æµè®¾è®¡æ–¹æ¡ˆã€‚</p>
<h3 id="ingress-çš„é«˜çº§ç­–ç•¥">Ingress çš„é«˜çº§ç­–ç•¥</h3>
<p>Ingress å¼•å…¥åï¼Œå®ƒçš„ç”¨é€”åœ¨è¢«ä¸æ–­æ‰©å¤§ï¼Œè¿™é‡Œæˆ‘æ€»ç»“ä¸‹å¯èƒ½çš„åº”ç”¨æ¡ˆä¾‹ï¼ŒæœŸæœ›åœ¨éœ€è¦çš„æ—¶å€™å¯ä»¥å¿«é€Ÿåº”ç”¨ã€‚</p>
<p><strong>Ingress è§„åˆ™æ±‡èšèƒ½åŠ›æ¡ˆä¾‹</strong></p>
<pre tabindex="0"><code>apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: &lt;ingress-name&gt;
spec:
  rules:
  - host: &lt;yourchoice1&gt;.&lt;cluster-id&gt;.k8s.gigantic.io
    http:
      paths:
      - path: /
        backend:
          serviceName: &lt;service1-name&gt;
          servicePort: &lt;service1-port&gt;
  - host: &lt;yourchoice2&gt;.&lt;cluster-id&gt;.k8s.gigantic.io
    http:
      paths:
      - path: /
        backend:
          serviceName: &lt;service2-name&gt;
          servicePort: &lt;service2-port&gt;

</code></pre><p><strong>è¯·æ±‚åœ°å€åˆ†æµæ¡ˆä¾‹</strong></p>
<pre tabindex="0"><code>apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: &lt;ingress-name&gt;
spec:
  rules:
  - host: &lt;yourchoice&gt;.&lt;cluster-id&gt;.k8s.gigantic.io
    http:
      paths:
      - path: /foo
        backend:
          serviceName: &lt;service1-name&gt;
          servicePort: &lt;service1-port&gt;
      - path: /bar
        backend:
          serviceName: &lt;service2-name&gt;
          servicePort: &lt;service2-port&gt;

</code></pre><p><strong>SSL ç›´é€šæ¡ˆä¾‹</strong></p>
<pre tabindex="0"><code>apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: &lt;ingress-name&gt;
  annotations:
    nginx.ingress.kubernetes.io/ssl-passthrough: &quot;true&quot;
spec:
   tls:
   - hosts:
     - &lt;yourchoice&gt;.&lt;cluster-id&gt;.k8s.gigantic.io
  rules:
  - host: &lt;yourchoice&gt;.&lt;cluster-id&gt;.k8s.gigantic.io
    http:
      paths:
      - path: /
        backend:
          serviceName: &lt;service-name&gt;
          servicePort: &lt;service-port&gt;

</code></pre><p><strong>SSL ç»ˆç»“æ¡ˆä¾‹</strong></p>
<pre tabindex="0"><code>apiVersion: v1
kind: Secret
type: kubernetes.io/tls
metadata:
  name: mytlssecret
data:
  tls.crt: &lt;base64 encoded cert&gt;
  tls.key: &lt;base64 encoded key&gt;
---
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: &lt;ingress-name&gt;
spec:
   tls:
   - hosts:
     - &lt;yourchoice&gt;.&lt;cluster-id&gt;.k8s.gigantic.io
     secretName: mytlssecret
  rules:
  - host: &lt;yourchoice&gt;.&lt;cluster-id&gt;.k8s.gigantic.io
    http:
      paths:
      - path: /
        backend:
          serviceName: &lt;service-name&gt;
          servicePort: &lt;service-port&gt;

</code></pre><p><strong>CORS è·¨ç«™è¯·æ±‚æ¡ˆä¾‹</strong></p>
<p>è¦åœ¨ Ingress è§„åˆ™ä¸­å¯ç”¨è·¨æºèµ„æºå…±äº«ï¼ˆCORSï¼‰ï¼Œè¯·æ·»åŠ æ³¨é‡Šï¼š</p>
<pre tabindex="0"><code>ingress.kubernetes.io/enable-cors: &quot;true&quot;

</code></pre><p><strong>é‡å†™è·¯ç”±åœ°å€æ¡ˆä¾‹</strong></p>
<pre tabindex="0"><code>apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: &lt;ingress-name&gt;
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
  - host: &lt;yourchoice&gt;.&lt;cluster-id&gt;.k8s.gigantic.io
    http:
      paths:
      - path: /foo
        backend:
          serviceName: &lt;service-name&gt;
          servicePort: &lt;service1port&gt;

</code></pre><p><strong>è¯·æ±‚æµé‡é™åˆ¶æ¡ˆä¾‹</strong></p>
<pre tabindex="0"><code>nginx.ingress.kubernetes.io/limit-connectionsï¼šä¸€ä¸ª IP åœ°å€å…è®¸çš„å¹¶å‘è¿æ¥æ•°

nginx.ingress.kubernetes.io/limit-rpsï¼šæ¯ç§’ä»ç»™å®š IP æ¥å—çš„è¿æ¥æ•°

</code></pre><p>åœ¨ä¸€ä¸ª Ingress è§„åˆ™ä¸­åŒæ—¶æŒ‡å®šè¿™ä¸¤ä¸ªæ³¨è§£ï¼Œlimit-rps ä¼˜å…ˆã€‚</p>
<p><strong>åç«¯æ”¯æŒæ¥å…¥ SSL æ¡ˆä¾‹</strong></p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒNginx ä½¿ç”¨ HTTP æ¥åˆ°è¾¾æœåŠ¡ã€‚åœ¨ Ingress è§„åˆ™ä¸­æ·»åŠ æ³¨è§£ï¼š</p>
<pre tabindex="0"><code>nginx.ingress.kubernetes.io/secure-backends: &quot;true&quot;

</code></pre><p>åœ¨ Ingress è§„åˆ™ä¸­æŠŠåè®®æ”¹ä¸º HTTPSã€‚</p>
<p><strong>ç™½åå•æ¡ˆä¾‹</strong></p>
<p>ä½ å¯ä»¥é€šè¿‡ï¼š</p>
<pre tabindex="0"><code>nginx.ingress.kubernetes.io/whitelist-source-range

</code></pre><p>æ³¨è§£æ¥æŒ‡å®šå…è®¸çš„å®¢æˆ·ç«¯ IP æºèŒƒå›´ï¼Œè¯¥å€¼æ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„ CIDRs åˆ—è¡¨ï¼Œä¾‹å¦‚ 10.0.0.0/24,172.10.0.1ã€‚</p>
<p><strong>Session Affinity å’Œ Cookie affinity</strong></p>
<p>æ³¨è§£ï¼š</p>
<pre tabindex="0"><code>nginx.ingress.kubernetes.io/affinity

</code></pre><p>åœ¨ Ingress çš„æ‰€æœ‰ä¸Šè¡Œä¸­å¯ç”¨å¹¶è®¾ç½®äº²å’ŒåŠ›ç±»å‹ã€‚è¿™æ ·ä¸€æ¥ï¼Œè¯·æ±‚å°†å§‹ç»ˆè¢«æŒ‡å‘åŒä¸€ä¸ªä¸Šæ¸¸æœåŠ¡èŠ‚ç‚¹ã€‚</p>
<p>å¦‚æœä½ ä½¿ç”¨ cookie ç±»å‹ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨æ³¨è§£ï¼š</p>
<pre tabindex="0"><code>nginx.ingress.kubernetes.io/session-cookie-name

</code></pre><p>æ¥æŒ‡å®šç”¨äºè·¯ç”±è¯·æ±‚çš„ cookie çš„åç§°ã€‚é»˜è®¤æƒ…å†µä¸‹æ˜¯åˆ›å»ºä¸€ä¸ªåä¸º route çš„ cookieã€‚</p>
<pre tabindex="0"><code>annotation nginx.ingress.kubernetes.io/session-cookie-hash

</code></pre><p>å®šä¹‰äº†å°†ä½¿ç”¨å“ªç§ç®—æ³•å¯¹ä½¿ç”¨çš„ä¸Šæ¸¸è¿›è¡Œå“ˆå¸Œã€‚é»˜è®¤å€¼æ˜¯ MD5ï¼Œå¯èƒ½çš„å€¼æ˜¯ MD5ã€SHA1 å’Œ Indexã€‚Index é€‰é¡¹ä¸è¿›è¡Œå“ˆå¸Œï¼Œè€Œæ˜¯ä½¿ç”¨å†…å­˜ä¸­çš„ç´¢å¼•ï¼Œå®ƒæ›´å¿«ï¼Œå¼€é”€æ›´çŸ­ã€‚</p>
<p>æ³¨æ„æ­¤ Index å’Œä¸Šæ¸¸æœåŠ¡èŠ‚ç‚¹åˆ—è¡¨çš„åŒ¹é…è§„åˆ™æ˜¯ä¸ä¸€è‡´çš„ã€‚å› æ­¤åœ¨æœåŠ¡é‡æ–°åŠ è½½æ—¶ï¼Œå¦‚æœä¸Šæ¸¸æœåŠ¡èŠ‚ç‚¹ Pod å‘ç”Ÿäº†å˜åŒ–ï¼Œç´¢å¼•å€¼ä¸èƒ½ä¿è¯ä¸ä¹‹å‰çš„æœåŠ¡èŠ‚ç‚¹ Pod ä¸€è‡´ã€‚è¯·è°¨æ…ä½¿ç”¨ï¼Œåªæœ‰åœ¨éœ€è¦çš„æƒ…å†µä¸‹æ‰ä½¿ç”¨æ­¤ index ç®—æ³•ã€‚</p>
<h3 id="æ€»ç»“">æ€»ç»“</h3>
<p>Service å±‚æ¥å…¥å¼•æµæŠ€æœ¯ï¼Œä¸»è¦çš„èƒ½åŠ›å°±æ˜¯éœ€è¦æŠŠæµé‡å‡†ç¡®æ— è¯¯çš„å¼•å…¥åˆ°æœåŠ¡ Pod ä¸­ï¼Œå½“æˆ‘ä»¬éœ€è¦å¼¹æ€§ã€é«˜å¯ç”¨æ—¶ï¼Œåªèƒ½é€šè¿‡å¢åŠ ä¸€å±‚æœåŠ¡åå‘ä»£ç†çš„å†—ä½™è®¾è®¡æ‰èƒ½ä¿è¯æµé‡å¼•å…¥çš„å¯é æ€§ã€‚è¿™ç§å†—ä½™è®¾è®¡æœ‰ä¸‰ç§é€‰æ‹©ï¼šIngressã€NodePortã€LoadBalancerï¼Œç›®å‰çœ‹ä¸‰ç§é€‰æ‹©éƒ½æ— æ³•èƒ½é€‚åº”æ‰€æœ‰ä¸šåŠ¡åœºæ™¯ï¼Œé‰´äºå¯¹ Ingress å·²ç»åœ¨ 1.19 æœ€æ–°ç‰ˆæœ¬ä¸­å‡çº§åˆ° GAï¼Œä»å¼•å…¥æµé‡çš„è§„èŒƒæ€§è§’åº¦ï¼Œé¦–é€‰è¿˜æ˜¯ Ingressï¼Œå› ä¸ºå®ƒçš„ ingress-controller èƒ½åŠ›é€šè¿‡æ³¨è§£å¯ä»¥æ— é™æ”¾å¤§ï¼Œç¬”è€…é¢„æµ‹åœ¨æœªæ¥çš„å‘å±•è¶‹åŠ¿ä¸‹ï¼ŒService èƒ½åŠ›ä¼šè¢« Ingress æ¥ç®¡ï¼Œå¤§å®¶å†ä¹Ÿä¸ç”¨æ“å¿ƒ NodePort äº†ã€‚</p>

        </div>
    </article>
</div>

    </main>
    <footer>
        <div id="pagination">
            
<div class="paginator">
    <div class="prev">
        
        <a href="/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/14-%E5%BA%94%E7%94%A8%E7%BD%91%E5%85%B3-openresty-%E5%AF%B9%E6%8E%A5-k8s-%E5%AE%9E%E8%B7%B5/"><span>14 åº”ç”¨ç½‘å…³ OpenResty å¯¹æ¥ K8s å®è·µ</span></a>
    </div>
    <div class="next">
        
        <a href="/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/16-cilium-%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/"><span>16 Cilium å®¹å™¨ç½‘ç»œçš„è½åœ°å®è·µ</span></a>
    </div>
</div>

        </div>
        <div class="toggler" onclick="toggleLight(this);">ğŸ’¡</div>
        <div id="copyright" style="display: none;">
    
    
    <p>&copy; 27270 <a href="/"></a>, powered by Hugo and Qiao</p>
</div>
    </footer>
    
<script>
    function toggleLight() {
        document.getElementById('page').classList.toggle('night');
    }
</script>
</body>

</html>