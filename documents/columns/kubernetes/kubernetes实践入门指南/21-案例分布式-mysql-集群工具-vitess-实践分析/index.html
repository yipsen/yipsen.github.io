<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
<meta name="X-UA-Compatible" , content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<link rel="icon" type="image/png" href="/%20/favicon.png">

<title>21 æ¡ˆä¾‹ï¼šåˆ†å¸ƒå¼ MySQL é›†ç¾¤å·¥å…· Vitess å®è·µåˆ†æ | Yipsen Ye</title>
<meta name="description" content="å¯¹äº Kubernetes çš„æœ‰çŠ¶æ€åº”ç”¨éƒ¨ç½²æ¥è¯´ï¼Œå½“ç„¶æœ€æœ‰æŒ‘æˆ˜çš„ä¾‹å­å°±æ˜¯æ‹¿ MySQL é›†ç¾¤éƒ¨ç½²æœ€ä¸ºç»å…¸ã€‚åœ¨è¿‘ 10 å¹´çš„æ•°æ®åº“æµè¡Œåº¦æ¥è®²ï¼Œæ¯ä¸€ä¸ªå¼€å‘è€…æ¥è§¦åˆ°æœ€å¤šçš„å°±æ˜¯ MySQL æ•°æ®åº“äº†ã€‚å‡ ä¹äººäººéƒ½çŸ¥é“ MySQL Master/Slave æ–¹å¼çš„é›†ç¾¤æ­å»ºæ–¹å¼ï¼Œå…¶æ¶æ„çš„å¤æ‚åº¦å¯æƒ³è€ŒçŸ¥ã€‚å½“æˆ‘ä»¬æŠ€æœ¯æŠŠ MySQL é›†ç¾¤æ­å»ºåˆ° Kubernetes é›†ç¾¤çš„æ—¶å€™å°±ä¸å¾—ä¸è€ƒè™‘å¦‚ä½•åˆ©ç”¨äº‘åŸç”Ÿç‰¹æ€§æŠŠé›†ç¾¤æ­å»ºèµ·æ¥ã€‚è¿™é‡Œç¬”è€…å¹¶ä¸æƒ³å»åˆ†æå¦‚ä½•å¾’æ‰‹åˆ†è§£å®‰è£… MySQL é›†ç¾¤çš„ YAMLï¼Œè€Œæ˜¯é€šè¿‡æœ‰è¿‡æˆåŠŸè¿ç§»äº‘åŸç”Ÿé›†ç¾¤å·¥å…· Vitess æ¥æ€»ç»“çœŸå®çš„å®è·µè¿‡ç¨‹ã€‚
Vitess å·¥å…·ä»‹ç» Vitess å·ç§°å¯ä»¥æ°´å¹³æ‰©å±• MySQL æ•°æ®åº“é›†ç¾¤ç®¡ç†å·¥å…·ã€‚æœ€æ—©è¢«æˆ‘ä»¬ç†ŸçŸ¥çš„æ–°é—»å°±æ˜¯äº¬ä¸œåœ¨ 618 å¤§ä¿ƒä¸­å…¨é¢é‡‡ç”¨äº‘åŸç”ŸæŠ€æœ¯ï¼Œå…¶ä¸­æ•°æ®åº“åˆ†ç‰‡é›†ç¾¤ç®¡ç†è¿™å—å°±æ˜¯é‡‡ç”¨çš„ Vitessã€‚æ¥ä¸‹æ¥æˆ‘ä»¬é¦–å…ˆå¿«é€Ÿä½“éªŒä¸€ä¸‹åœ¨ Kubernetes ä¸‹ä½¿ç”¨ Vitess çš„è¿‡ç¨‹ã€‚
åˆå§‹åŒ–ç¯å¢ƒ é‡‡ç”¨å•æœºéƒ¨ç½²ï¼Œåœ¨ AWS ä¸Šå¯åŠ¨ä¸€å°å†…å­˜å¤§äº 8G çš„è™šæ‹Ÿæœºï¼Œé€šè¿‡å®‰è£… K3s å¿«é€Ÿæ„å»ºä¸€å¥— Kubernetes ç¯å¢ƒã€‚
# åˆå§‹åŒ– Kubernetes å•æœºé›†ç¾¤curl https://releases.rancher.com/install-docker/19.03.sh | shcurl -sfL https://get.k3s.io | sh -# ä¸‹è½½ kubectlcurl -LO https://storage.googleapis.com/kubernetes-release/release/v1.14.9/bin/linux/amd64/kubectl# å®‰è£… MySQL å®¢æˆ·ç«¯apt install mysql-client# ä¸‹è½½å®‰è£…å®¢æˆ·ç«¯ vtctlclient æœ€æ–°ç‰ˆæœ¬ï¼šwget https://github.">
<meta name="author" content="">

<link rel="stylesheet" type="text/css" href="/styles/main.css">

</head>

<body id="page">
    <header>
        <div class="logo-link" style="width: 60px; color: #CA6924;">
    <a href="http://yipsen.github.io/">
        <img style="margin-bottom: -1rem;" src="/images/deer.svg" alt="logo">
        <span style="font-size: 0.5rem; color: #CA6924;">Yipsen Ye</span>
    </a>
</div>
<nav class="navbar justify-content-end">
    <ul class="nav-list">
        
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/posts/">æœ­è®°</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/collections/">é™„è¡¨</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/about/">å…³äº</a>
        </li>
        
    </ul>
</nav>
    </header>
    <main id="content">
        
<div class="container"><aside>
    <div>
        
        
            
            
            <div class="post-category-icon"></div>
            <a href="/categories/kubernetes%e5%ae%9e%e8%b7%b5%e5%85%a5%e9%97%a8%e6%8c%87%e5%8d%97/">Kuberneteså®è·µå…¥é—¨æŒ‡å—</a>
            <ul>
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/00-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E4%BB%AC%E8%A6%81%E5%AD%A6%E4%B9%A0-kubernetes-%E6%8A%80%E6%9C%AF/">00 ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦å­¦ä¹  Kubernetes æŠ€æœ¯</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/01-%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86-kubernetes-%E7%9A%84%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6/">01 é‡æ–°è®¤è¯† Kubernetes çš„æ ¸å¿ƒç»„ä»¶</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/02-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3-kubernets-%E7%9A%84%E7%BC%96%E6%8E%92%E5%AF%B9%E8%B1%A1/">02 æ·±å…¥ç†è§£ Kubernets çš„ç¼–æ’å¯¹è±¡</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/03-devops-%E5%9C%BA%E6%99%AF%E4%B8%8B%E8%90%BD%E5%9C%B0-k8s-%E7%9A%84%E5%9B%B0%E9%9A%BE%E5%88%86%E6%9E%90/">03 DevOps åœºæ™¯ä¸‹è½åœ° K8s çš„å›°éš¾åˆ†æ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/04-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%E4%B8%8B%E8%90%BD%E5%9C%B0-k8s-%E7%9A%84%E5%9B%B0%E9%9A%BE%E5%88%86%E6%9E%90/">04 å¾®æœåŠ¡åº”ç”¨åœºæ™¯ä¸‹è½åœ° K8s çš„å›°éš¾åˆ†æ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/05-%E8%A7%A3%E5%86%B3-k8s-%E8%90%BD%E5%9C%B0%E9%9A%BE%E9%A2%98%E7%9A%84%E6%96%B9%E6%B3%95%E8%AE%BA%E6%8F%90%E7%82%BC/">05 è§£å†³ K8s è½åœ°éš¾é¢˜çš„æ–¹æ³•è®ºæç‚¼</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/06-%E7%BB%83%E4%B9%A0%E7%AF%87k8s-%E6%A0%B8%E5%BF%83%E5%AE%9E%E8%B7%B5%E7%9F%A5%E8%AF%86%E6%8E%8C%E6%8F%A1/">06 ç»ƒä¹ ç¯‡ï¼šK8s æ ¸å¿ƒå®è·µçŸ¥è¯†æŒæ¡</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/07-%E5%AE%B9%E5%99%A8%E5%BC%95%E6%93%8E-containerd-%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">07 å®¹å™¨å¼•æ“ containerd è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/08-k8s-%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85%E5%B7%A5%E5%85%B7-kubeadm-%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">08 K8s é›†ç¾¤å®‰è£…å·¥å…· kubeadm çš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/09-%E5%8D%97%E5%8C%97%E5%90%91%E6%B5%81%E9%87%8F%E7%BB%84%E4%BB%B6-ipvs-%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">09 å—åŒ—å‘æµé‡ç»„ä»¶ IPVS çš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/10-%E4%B8%9C%E8%A5%BF%E5%90%91%E6%B5%81%E9%87%8F%E7%BB%84%E4%BB%B6-calico-%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">10 ä¸œè¥¿å‘æµé‡ç»„ä»¶ Calico çš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/11-%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0-dns-%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">11 æœåŠ¡å‘ç° DNS çš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/12-%E7%BB%83%E4%B9%A0%E7%AF%87k8s-%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E6%B5%8B%E9%AA%8C/">12 ç»ƒä¹ ç¯‡ï¼šK8s é›†ç¾¤é…ç½®æµ‹éªŒ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/13-%E7%90%86%E8%A7%A3%E5%AF%B9%E6%96%B9%E6%9A%B4%E9%9C%B2%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%AF%B9%E8%B1%A1-ingress-%E5%92%8C-service/">13 ç†è§£å¯¹æ–¹æš´éœ²æœåŠ¡çš„å¯¹è±¡ Ingress å’Œ Service</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/14-%E5%BA%94%E7%94%A8%E7%BD%91%E5%85%B3-openresty-%E5%AF%B9%E6%8E%A5-k8s-%E5%AE%9E%E8%B7%B5/">14 åº”ç”¨ç½‘å…³ OpenResty å¯¹æ¥ K8s å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/15-service-%E5%B1%82%E5%BC%95%E6%B5%81%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5/">15 Service å±‚å¼•æµæŠ€æœ¯å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/16-cilium-%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">16 Cilium å®¹å™¨ç½‘ç»œçš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/17-%E5%BA%94%E7%94%A8%E6%B5%81%E9%87%8F%E7%9A%84%E4%BC%98%E9%9B%85%E6%97%A0%E6%8D%9F%E5%88%87%E6%8D%A2%E5%AE%9E%E8%B7%B5/">17 åº”ç”¨æµé‡çš„ä¼˜é›…æ— æŸåˆ‡æ¢å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/18-%E7%BB%83%E4%B9%A0%E7%AF%87%E5%BA%94%E7%94%A8%E6%B5%81%E9%87%8F%E6%97%A0%E6%8D%9F%E5%88%87%E6%8D%A2%E6%8A%80%E6%9C%AF%E6%B5%8B%E9%AA%8C/">18 ç»ƒä¹ ç¯‡ï¼šåº”ç”¨æµé‡æ— æŸåˆ‡æ¢æŠ€æœ¯æµ‹éªŒ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/19-%E4%BD%BF%E7%94%A8-rook-%E6%9E%84%E5%BB%BA%E7%94%9F%E4%BA%A7%E5%8F%AF%E7%94%A8%E5%AD%98%E5%82%A8%E7%8E%AF%E5%A2%83%E5%AE%9E%E8%B7%B5/">19 ä½¿ç”¨ Rook æ„å»ºç”Ÿäº§å¯ç”¨å­˜å‚¨ç¯å¢ƒå®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/20-%E6%9C%89%E7%8A%B6%E6%80%81%E5%BA%94%E7%94%A8%E7%9A%84%E9%BB%98%E8%AE%A4%E7%89%B9%E6%80%A7%E8%90%BD%E5%9C%B0%E5%88%86%E6%9E%90/">20 æœ‰çŠ¶æ€åº”ç”¨çš„é»˜è®¤ç‰¹æ€§è½åœ°åˆ†æ</a></li>
                
                
                
                    <li>21 æ¡ˆä¾‹ï¼šåˆ†å¸ƒå¼ MySQL é›†ç¾¤å·¥å…· Vitess å®è·µåˆ†æ</li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/22-%E5%AD%98%E5%82%A8%E5%AF%B9%E8%B1%A1-pvpvcstorage-classes-%E7%9A%84%E7%AE%A1%E7%90%86%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">22 å­˜å‚¨å¯¹è±¡ PVã€PVCã€Storage Classes çš„ç®¡ç†è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/23-k8s-%E9%9B%86%E7%BE%A4%E4%B8%AD%E5%AD%98%E5%82%A8%E5%AF%B9%E8%B1%A1%E7%81%BE%E5%A4%87%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">23 K8s é›†ç¾¤ä¸­å­˜å‚¨å¯¹è±¡ç¾å¤‡çš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/24-%E7%BB%83%E4%B9%A0%E7%AF%87k8s-%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E6%B5%8B%E9%AA%8C/">24 ç»ƒä¹ ç¯‡ï¼šK8s é›†ç¾¤é…ç½®æµ‹éªŒ</a></li>
                
                
            </ul>
        
    </div>
</aside>

<style>
    aside {
        position: fixed;
        left: 20px;
        background: #ffdee3;
        border-radius: 6px;
        padding: 20px;
        padding-top: 60px;
        box-shadow: 5px 10px #888;
        list-style-type: none;
        display: none;
    }

    .post-category-icon {
        position: absolute;
        width: 80px;
        height: 80px;
        top: -40px;
        left: 50%;
        margin-left: -40px;
        text-align: center;
        font-size: 36px;
        content: 'J';
        background: #ffdee3;
        border-radius: 100%;
        border: 10px solid #fff;
        box-shadow: 5px 10px #888;
    }
</style><article class="post-block">
        <h1 class="post-title">21 æ¡ˆä¾‹ï¼šåˆ†å¸ƒå¼ MySQL é›†ç¾¤å·¥å…· Vitess å®è·µåˆ†æ</h1>
        <div class="post-info">
            <div> 
                <span class="post-date">ğŸ“…&nbsp;2021-12-22 01:48:27</span>ğŸ·ï¸&nbsp;<a class="post-tag" href="/tags/kubernetes/">kubernetes</a></div><div class="post-category">
                
                ğŸ“š&nbsp;<a href="/categories/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/">Kuberneteså®è·µå…¥é—¨æŒ‡å—</a>
                
            </div></div>
        <div class="post-content">
            <p>å¯¹äº Kubernetes çš„æœ‰çŠ¶æ€åº”ç”¨éƒ¨ç½²æ¥è¯´ï¼Œå½“ç„¶æœ€æœ‰æŒ‘æˆ˜çš„ä¾‹å­å°±æ˜¯æ‹¿ MySQL é›†ç¾¤éƒ¨ç½²æœ€ä¸ºç»å…¸ã€‚åœ¨è¿‘ 10 å¹´çš„æ•°æ®åº“æµè¡Œåº¦æ¥è®²ï¼Œæ¯ä¸€ä¸ªå¼€å‘è€…æ¥è§¦åˆ°æœ€å¤šçš„å°±æ˜¯ MySQL æ•°æ®åº“äº†ã€‚å‡ ä¹äººäººéƒ½çŸ¥é“ MySQL Master/Slave æ–¹å¼çš„é›†ç¾¤æ­å»ºæ–¹å¼ï¼Œå…¶æ¶æ„çš„å¤æ‚åº¦å¯æƒ³è€ŒçŸ¥ã€‚å½“æˆ‘ä»¬æŠ€æœ¯æŠŠ MySQL é›†ç¾¤æ­å»ºåˆ° Kubernetes é›†ç¾¤çš„æ—¶å€™å°±ä¸å¾—ä¸è€ƒè™‘å¦‚ä½•åˆ©ç”¨äº‘åŸç”Ÿç‰¹æ€§æŠŠé›†ç¾¤æ­å»ºèµ·æ¥ã€‚è¿™é‡Œç¬”è€…å¹¶ä¸æƒ³å»åˆ†æå¦‚ä½•å¾’æ‰‹åˆ†è§£å®‰è£… MySQL é›†ç¾¤çš„ YAMLï¼Œè€Œæ˜¯é€šè¿‡æœ‰è¿‡æˆåŠŸè¿ç§»äº‘åŸç”Ÿé›†ç¾¤å·¥å…· Vitess æ¥æ€»ç»“çœŸå®çš„å®è·µè¿‡ç¨‹ã€‚</p>
<h3 id="vitess-å·¥å…·ä»‹ç»">Vitess å·¥å…·ä»‹ç»</h3>
<p>Vitess å·ç§°å¯ä»¥æ°´å¹³æ‰©å±• MySQL æ•°æ®åº“é›†ç¾¤ç®¡ç†å·¥å…·ã€‚æœ€æ—©è¢«æˆ‘ä»¬ç†ŸçŸ¥çš„æ–°é—»å°±æ˜¯äº¬ä¸œåœ¨ 618 å¤§ä¿ƒä¸­å…¨é¢é‡‡ç”¨äº‘åŸç”ŸæŠ€æœ¯ï¼Œå…¶ä¸­æ•°æ®åº“åˆ†ç‰‡é›†ç¾¤ç®¡ç†è¿™å—å°±æ˜¯é‡‡ç”¨çš„ Vitessã€‚æ¥ä¸‹æ¥æˆ‘ä»¬é¦–å…ˆå¿«é€Ÿä½“éªŒä¸€ä¸‹åœ¨ Kubernetes ä¸‹ä½¿ç”¨ Vitess çš„è¿‡ç¨‹ã€‚</p>
<h4 id="åˆå§‹åŒ–ç¯å¢ƒ"><strong>åˆå§‹åŒ–ç¯å¢ƒ</strong></h4>
<p>é‡‡ç”¨å•æœºéƒ¨ç½²ï¼Œåœ¨ AWS ä¸Šå¯åŠ¨ä¸€å°å†…å­˜å¤§äº 8G çš„è™šæ‹Ÿæœºï¼Œé€šè¿‡å®‰è£… K3s å¿«é€Ÿæ„å»ºä¸€å¥— Kubernetes ç¯å¢ƒã€‚</p>
<pre tabindex="0"><code># åˆå§‹åŒ– Kubernetes å•æœºé›†ç¾¤
curl https://releases.rancher.com/install-docker/19.03.sh | sh
curl -sfL https://get.k3s.io | sh -

# ä¸‹è½½ kubectl
curl -LO https://storage.googleapis.com/kubernetes-release/release/v1.14.9/bin/linux/amd64/kubectl
# å®‰è£… MySQL å®¢æˆ·ç«¯
apt install mysql-client

# ä¸‹è½½å®‰è£…å®¢æˆ·ç«¯ vtctlclient æœ€æ–°ç‰ˆæœ¬ï¼š
wget https://github.com/vitessio/vitess/releases/download/v8.0.0/vitess-8.0.0-7e09d0c.tar.gz
tar zxvf vitess-8.0.0-7e09d0c.tar.gz &amp;&amp; cp vitess-8.0.0-7e09d0c/bin/vtctlclient /usr/local/bin/

# ä¸‹è½½ vitess operator ä¾‹å­
git clone https://github.com/vitessio/vitess.git
cd vitess/examples/operator
k3s kubectl apply -f operator.yaml

root@ip-172-31-27-203:~/vitess/examples/operator# k3s kubectl get po
NAME                               READY   STATUS    RESTARTS   AGE                                                                                                               
vitess-operator-784458658c-mzhzx   1/1     Running   0          59s 

# åˆå§‹åŒ–é›†ç¾¤
root@ip-172-31-27-203:~/vitess/examples/operator# k3s kubectl apply -f 101_initial_cluster.yaml
vitesscluster.planetscale.com/example created
secret/example-cluster-config created

root@ip-172-31-27-203:~/vitess/examples/operator# k3s kubectl get pods
NAME                                             READY   STATUS    RESTARTS   AGE
vitess-operator-784458658c-mzhzx                 1/1     Running   0          3m38s
example-etcd-faf13de3-2                          1/1     Running   0          111s
example-etcd-faf13de3-1                          1/1     Running   0          111s
example-etcd-faf13de3-3                          1/1     Running   0          111s
example-zone1-vtctld-1d4dcad0-68484d7b88-428dc   1/1     Running   2          111s
example-zone1-vtgate-bc6cde92-c6499cf87-w86rz    1/1     Running   2          111s
example-vttablet-zone1-2469782763-bfadd780       3/3     Running   2          111s
example-vttablet-zone1-2548885007-46a852d0       3/3     Running   2          111s

</code></pre><p>ä¸ºäº†æ–¹ä¾¿è¿æ¥ Vitess è¿™ä¸ª proxyï¼Œéœ€è¦åˆå§‹åŒ–ä¸€ä¸‹ç«¯å£è½¬å‘çš„ç¯å¢ƒï¼š</p>
<pre tabindex="0"><code>./pf.sh &amp;
alias vtctlclient=&quot;vtctlclient -server=localhost:15999&quot;
alias mysql=&quot;mysql -h 127.0.0.1 -P 15306 -u user&quot;

</code></pre><p>åŠ è½½æ•°æ®åº“è¡¨ç»“æ„ï¼š</p>
<pre tabindex="0"><code>vtctlclient ApplySchema -sql=&quot;$(cat create_commerce_schema.sql)&quot; commerce
vtctlclient ApplyVSchema -vschema=&quot;$(cat vschema_commerce_initial.json)&quot; commerce

</code></pre><p>é€šè¿‡ MySQL è¿æ¥ Vitess Proxy è®¿é—® MySQL Serverï¼š</p>
<pre tabindex="0"><code>~/vitess/examples/operator$ mysql
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 3
Server version: 5.7.9-Vitess MySQL Community Server (GPL)

Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt; show databases;
+-----------+
| Databases |
+-----------+
| commerce  |
+-----------+
1 row in set (0.00 sec)

</code></pre><p>è‡³æ­¤ï¼Œæˆ‘ä»¬çš„ä½“éªŒå’Œå®‰è£…ä¸€å¥—æœ¬åœ°çš„ MySQL Server æ˜¯ä¸€æ ·çš„ã€‚è¿™ç§é€æ˜çš„ä½“éªŒå€¼å¾—æˆ‘ä»¬æ¥ä¸‹æ¥æŒç»­æŒ–æ˜æ›´é«˜çº§çš„ç‰¹æ€§ã€‚</p>
<p>ä¸‹å›¾è¯´æ˜äº† Vitess çš„ç»„ä»¶æ¶æ„ï¼Œæˆ‘ä»¬éœ€è¦ç†Ÿæ‚‰è¿™äº›æœ¯è¯­ï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Kubernetes%20%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/assets/36be7e60-2cc7-11eb-90f6-fbd19bda6e6e" alt="18-1-vitess-arch33"></p>
<p><strong>Topology</strong></p>
<p>æ‹“æ‰‘æœåŠ¡æ˜¯ä¸€ä¸ªå…ƒæ•°æ®å­˜å‚¨å¯¹è±¡ï¼ŒåŒ…å«æœ‰å…³æ­£åœ¨è¿è¡Œçš„æœåŠ¡å™¨ã€åˆ†ç‰‡æ–¹æ¡ˆå’Œå¤åˆ¶å…³ç³»å›¾çš„ä¿¡æ¯ã€‚æ‹“æ‰‘ç”±ä¸€è‡´æ€§çš„æ•°æ®å­˜å‚¨æ”¯æŒï¼Œé»˜è®¤æ”¯æŒ etcd2 æ’ä»¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ vtctlï¼ˆå‘½ä»¤è¡Œï¼‰å’Œ vtctldï¼ˆwebï¼‰æŸ¥çœ‹æ‹“æ‰‘ä¿¡æ¯ã€‚</p>
<p><strong>VTGate</strong></p>
<p>VTGate æ˜¯ä¸€ä¸ªè½»å‹ä»£ç†æœåŠ¡å™¨ï¼Œå®ƒå°†æµé‡è·¯ç”±åˆ°æ­£ç¡®çš„ VTTabletï¼Œå¹¶å°†åˆå¹¶çš„ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚åº”ç”¨ç¨‹åºå‘ VTGate å‘èµ·æŸ¥è¯¢ã€‚å®¢æˆ·ç«¯ä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ï¼Œå®ƒåªéœ€è¦èƒ½å¤Ÿæ‰¾åˆ° VTGate å®ä¾‹å°±èƒ½ä½¿ Vitessã€‚</p>
<p><strong>VTTablet</strong></p>
<p>VTTablet æ˜¯ä¸€ä¸ªä½äº MySQL æ•°æ®åº“å‰é¢çš„ä»£ç†æœåŠ¡å™¨ï¼Œæ‰§è¡Œçš„ä»»åŠ¡è¯•å›¾æœ€å¤§åŒ–ååé‡ï¼ŒåŒæ—¶ä¿æŠ¤ MySQL ä¸å—æœ‰å®³æŸ¥è¯¢çš„å½±å“ã€‚å®ƒçš„ç‰¹æ€§åŒ…æ‹¬è¿æ¥æ± ã€æŸ¥è¯¢é‡å†™å’Œé‡ç”¨é‡å¤æ•°æ®ã€‚</p>
<p><strong>Keyspace</strong></p>
<p>å…³é”®ç©ºé—´æ˜¯ä¸€ä¸ªé€»è¾‘æ•°æ®åº“ã€‚å¦‚æœä½¿ç”¨ Shardingï¼Œä¸€ä¸ª keyspace æ˜ å°„åˆ°å¤šä¸ª MySQL æ•°æ®åº“ï¼›å¦‚æœä¸ä½¿ç”¨ Shardingï¼Œä¸€ä¸ª keyspace ç›´æ¥æ˜ å°„åˆ°ä¸€ä¸ª MySQL æ•°æ®åº“åã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œä»åº”ç”¨ç¨‹åºçš„è§’åº¦æ¥çœ‹ï¼Œä¸€ä¸ªå…³é”®ç©ºé—´éƒ½æ˜¯ä½œä¸ºä¸€ä¸ªå•ä¸€çš„æ•°æ®åº“å‡ºç°çš„ã€‚</p>
<p>ä»ä¸€ä¸ªå…³é”®ç©ºé—´è¯»å–æ•°æ®å°±åƒä» MySQL æ•°æ®åº“è¯»å–æ•°æ®ä¸€æ ·ã€‚ç„¶è€Œï¼Œæ ¹æ®è¯»å–æ“ä½œçš„ä¸€è‡´æ€§è¦æ±‚ï¼ŒVitess å¯èƒ½ä¼šä»ä¸»æ•°æ®åº“æˆ–å‰¯æœ¬ä¸­è·å–æ•°æ®ã€‚é€šè¿‡å°†æ¯ä¸ªæŸ¥è¯¢è·¯ç”±åˆ°é€‚å½“çš„æ•°æ®åº“ï¼ŒVitess å…è®¸ä½ çš„ä»£ç ç»“æ„åŒ–ï¼Œå°±åƒä»ä¸€ä¸ª MySQL æ•°æ®åº“ä¸­è¯»å–ä¸€æ ·ã€‚</p>
<h3 id="vitess-é«˜çº§ç‰¹æ€§ä»‹ç»">Vitess é«˜çº§ç‰¹æ€§ä»‹ç»</h3>
<p>Sharding æ˜¯ä¸€ç§æ°´å¹³åˆ†åŒºæ•°æ®åº“çš„æ–¹æ³•ï¼Œç”¨äºåœ¨ä¸¤ä¸ªæˆ–å¤šä¸ªæ•°æ®åº“æœåŠ¡å™¨ä¸Šå­˜å‚¨æ•°æ®ã€‚ä¸‹é¢æˆ‘ä»¬è®²è§£ Vitess ä¸­çš„ Sharding å¦‚ä½•å·¥ä½œä»¥åŠ Vitess æ”¯æŒçš„ Sharding ç±»å‹ã€‚</p>
<p>Vitess ä¸­çš„ keyspace å¯ä»¥æ˜¯åˆ†ç‰‡çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯éç¢ç‰‡åŒ–çš„ï¼Œéåˆ†ç‰‡åŒ–çš„ keyspace å¯ä»¥ç›´æ¥æ˜ å°„åˆ° MySQL æ•°æ®åº“ã€‚å¦‚æœæ˜¯åˆ†ç‰‡çš„ï¼Œkeyspace çš„è¡Œè¢«åˆ†å‰²åˆ°ç›¸åŒæ¨¡å¼çš„ä¸åŒæ•°æ®åº“ä¸­ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªåº”ç”¨ç¨‹åºçš„ &ldquo;User&rdquo; keyspace è¢«åˆ†å‰²æˆä¸¤ä¸ªåˆ†ç‰‡ï¼Œé‚£ä¹ˆæ¯ä¸ªåˆ†ç‰‡åŒ…å«äº†è¯¥åº”ç”¨ç¨‹åºå¤§çº¦ä¸€åŠç”¨æˆ·çš„è®°å½•ã€‚åŒæ ·ï¼Œæ¯ä¸ªç”¨æˆ·çš„ä¿¡æ¯ä¹Ÿåªå­˜å‚¨åœ¨ä¸€ä¸ª Shard ä¸­ã€‚</p>
<p>è¯·æ³¨æ„ï¼ŒSharding ä¸ï¼ˆMySQLï¼‰å¤åˆ¶æ˜¯æ­£äº¤çš„ã€‚ä¸€ä¸ª Vitess Shard é€šå¸¸åŒ…å«ä¸€ä¸ª MySQL ä¸»ç¨‹åºå’Œè®¸å¤š MySQL å‰¯æœ¬ã€‚ä¸»ç¨‹åºå¤„ç†å†™æ“ä½œï¼Œè€Œå‰¯æœ¬åˆ™å¤„ç†åªè¯»æµé‡ã€æ‰¹å¤„ç†æ“ä½œå’Œå…¶ä»–ä»»åŠ¡ã€‚é™¤äº†ä¸€äº›å¤åˆ¶æ»åå¤–ï¼ŒShard å†…çš„æ¯ä¸ª MySQL å®ä¾‹éƒ½åº”è¯¥æœ‰ç›¸åŒçš„æ•°æ®ã€‚</p>
<p>éœ€æ±‚</p>
<p>åŠ¨ä½œ</p>
<p>ç»Ÿä¸€å¢åŠ è¯»å®¹é‡</p>
<p>å¢åŠ å‰¯æœ¬æˆ–åˆ†ç‰‡</p>
<p>ç»Ÿä¸€å¢åŠ å†™å®¹é‡</p>
<p>åˆ†ç‰‡ shards</p>
<p>å›æ”¶è¿‡å‰©çš„èµ„æº</p>
<p>åˆå¹¶ shards æˆ– keyspaces</p>
<p>å¢åŠ åœ°ç†å¤šæ ·æ€§</p>
<p>å¢åŠ æ–°çš„åˆ†åŒºå’Œå‰¯æœ¬</p>
<p>çƒ­è¡¨å¤„ç†</p>
<p>å¯¹äºåªè¯»çƒ­è¡¨ï¼Œå¤šåŠ å‰¯æœ¬æˆ–åˆ†ç‰‡ï¼›å¯¹äºå†™è¡¨ï¼Œç›´æ¥åˆ†ç‰‡</p>
<p>åº”ç”¨æ–°çš„ VSchema ä¼šæŒ‡ç¤º Vitess é”®ç©ºé—´æ˜¯åˆ†ç‰‡çš„ï¼Œè¿™å¯èƒ½ä¼šé˜»æ­¢ä¸€äº›å¤æ‚çš„æŸ¥è¯¢ã€‚åœ¨è¿›è¡Œè¿™ä¸€æ­¥ä¹‹å‰ï¼Œæœ€å¥½å…ˆéªŒè¯ä¸€ä¸‹ã€‚å¦‚æœä½ ç¡®å®æ³¨æ„åˆ°æŸäº›æŸ¥è¯¢å¼€å§‹å¤±è´¥ï¼Œä½ æ€»æ˜¯å¯ä»¥é€šè¿‡æ¢å¤æ—§çš„ VSchema æ¥æš‚æ—¶æ¢å¤ã€‚ç¡®ä¿åœ¨è¿›å…¥ Reshard è¿‡ç¨‹ä¹‹å‰ä¿®å¤äº†æ‰€æœ‰çš„æŸ¥è¯¢ã€‚</p>
<pre tabindex="0"><code>vtctlclient ApplySchema -sql=&quot;$(cat create_commerce_seq.sql)&quot; commerce
vtctlclient ApplyVSchema -vschema=&quot;$(cat vschema_commerce_seq.json)&quot; commerce
vtctlclient ApplySchema -sql=&quot;$(cat create_customer_sharded.sql)&quot; customer
vtctlclient ApplyVSchema -vschema=&quot;$(cat vschema_customer_sharded.json)&quot; customer    

</code></pre><p>åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œä½ å·²ç»æœ€ç»ˆç¡®å®šäº†ä½ çš„åˆ†ç‰‡ VSchemaï¼Œå¹¶å®¡æ ¸äº†æ‰€æœ‰çš„æŸ¥è¯¢ï¼Œä»¥ç¡®ä¿å®ƒä»¬ä»ç„¶æœ‰æ•ˆã€‚ç°åœ¨æ˜¯æ—¶å€™é‡æ–°åˆ†ç‰‡äº†ã€‚</p>
<p>é‡æ–° Sharding çš„è¿‡ç¨‹æ˜¯é€šè¿‡å°†ç°æœ‰çš„ shard åˆ†å‰²æˆæ›´å°çš„ shardã€‚è¿™ç§ç±»å‹çš„é‡æ–° Sharding æ˜¯æœ€é€‚åˆ Vitess çš„ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½å¸Œæœ›å¼•å…¥ä¸€ä¸ªæ–°çš„åˆ†ç‰‡ï¼Œå¹¶åœ¨æœ€è¿‘åˆ›å»ºçš„åˆ†ç‰‡ä¸­æ·»åŠ æ–°è¡Œã€‚åœ¨ Vitess ä¸­ï¼Œå¯ä»¥é€šè¿‡æ‹†åˆ† Shard çš„æ–¹å¼æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p>
<pre tabindex="0"><code>kubectl apply -f 302_new_shards.yaml

killall kubectl
./pf.sh &amp;

# With Operator on Start the Reshard
vtctlclient Reshard customer.cust2cust '-' '-80,80-'

</code></pre><p>åœ¨ Reshard å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ VDiff æ¥æ£€æŸ¥æ•°æ®çš„å®Œæ•´æ€§ï¼Œç¡®ä¿æˆ‘ä»¬çš„æºå’Œç›®æ ‡åˆ†ç‰‡æ˜¯ä¸€è‡´çš„ã€‚</p>
<pre tabindex="0"><code>vtctlclient VDiff customer.cust2cust
# è¿”å›å¦‚ä¸‹å†…å®¹
Summary for customer: {ProcessedRows:5 MatchingRows:5 MismatchedRows:0 ExtraRowsSource:0 ExtraRowsTarget:0}
Summary for corder: {ProcessedRows:5 MatchingRows:5 MismatchedRows:0 ExtraRowsSource:0 ExtraRowsTarget:0}

</code></pre><p>æ‰‹å·¥åˆ‡æ¢è¯»ã€å†™æ“ä½œåˆ°æ–°åˆ†ç‰‡ã€‚ç¡®ä¿æ•°æ®åº“æ­£å¸¸æ‰§è¡Œï¼š</p>
<pre tabindex="0"><code>vtctlclient SwitchReads -tablet_type=rdonly customer.cust2cust
vtctlclient SwitchReads -tablet_type=replica customer.cust2cust

vtctlclient SwitchWrites customer.cust2cust

mysql --table &lt; ../common/select_customer-80_data.sql
Using customer/-80
Customer
+-------------+--------------------+
| customer_id | email              |
+-------------+--------------------+
|           1 | alice@domain.com   |
|           2 | bob@domain.com     |
|           3 | charlie@domain.com |
|           5 | eve@domain.com     |
+-------------+--------------------+
COrder
+----------+-------------+----------+-------+
| order_id | customer_id | sku      | price |
+----------+-------------+----------+-------+
|        1 |           1 | SKU-1001 |   100 |
|        2 |           2 | SKU-1002 |    30 |
|        3 |           3 | SKU-1002 |    30 |
|        5 |           5 | SKU-1002 |    30 |
+----------+-------------+----------+-------+

mysql --table &lt; ../common/select_customer80-_data.sql
Using customer/80-
Customer
+-------------+----------------+
| customer_id | email          |
+-------------+----------------+
|           4 | dan@domain.com |
+-------------+----------------+
COrder
+----------+-------------+----------+-------+
| order_id | customer_id | sku      | price |
+----------+-------------+----------+-------+
|        4 |           4 | SKU-1002 |    30 |
+----------+-------------+----------+-------+

</code></pre><h3 id="æ€»ç»“">æ€»ç»“</h3>
<p>åº”ç”¨ Vitess Operator ä¹‹åï¼Œæ”¶è·æœ€å¤§çš„å°±æ˜¯å®Œå…¨ä¸ç”¨æ“å¿ƒ MySQL å¤åˆ¶é›†ç¾¤çš„æ¶æ„è®¾è®¡ï¼Œç”± Vitess Operator æ¥ç®¡ç†é«˜å¯ç”¨å’Œæ•°æ®åº“çš„åˆ†ç‰‡ï¼ŒæŠŠå¤æ‚çš„åˆ†å¸ƒå¼éƒ¨ç½²çš„è¿ç»´é—®é¢˜å±è”½äº†ä¸€å¤§åŠã€‚å½“ç„¶ï¼Œä½œä¸ºè¿ç»´äººå‘˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå› ä¸º Vitess æ˜¯ä¸€ä¸ª Proxyï¼Œå®ƒå’Œ MySQL åŸç”Ÿæ¥å£çš„åè®®è¿˜æ˜¯æœ‰ä¸€äº›ä¸ä¸€æ ·çš„åœ°æ–¹ï¼Œéœ€è¦é€‚é…ã€‚å› ä¸ºäº¬ä¸œåœ¨ 618 å¤§ä¿ƒä¸­é‡‡ç”¨äº† Vitess æŠ€æœ¯æ¥æ”¯æ’‘æ•°æ®åº“é›†ç¾¤ï¼Œè®©æˆ‘ä»¬å¯ä»¥æ”¾å¿ƒå¤§èƒ†åœ°ä½¿ç”¨å®ƒã€‚</p>
<h3 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h3>
<ul>
<li><a href="https://vitess.io/zh/docs/get-started/kubernetes/">https://vitess.io/zh/docs/get-started/kubernetes/</a></li>
</ul>

        </div>
    </article>
</div>

    </main>
    <footer>
        <div id="pagination">
            
<div class="paginator">
    <div class="prev">
        
        <a href="/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/20-%E6%9C%89%E7%8A%B6%E6%80%81%E5%BA%94%E7%94%A8%E7%9A%84%E9%BB%98%E8%AE%A4%E7%89%B9%E6%80%A7%E8%90%BD%E5%9C%B0%E5%88%86%E6%9E%90/"><span>20 æœ‰çŠ¶æ€åº”ç”¨çš„é»˜è®¤ç‰¹æ€§è½åœ°åˆ†æ</span></a>
    </div>
    <div class="next">
        
        <a href="/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/22-%E5%AD%98%E5%82%A8%E5%AF%B9%E8%B1%A1-pvpvcstorage-classes-%E7%9A%84%E7%AE%A1%E7%90%86%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/"><span>22 å­˜å‚¨å¯¹è±¡ PVã€PVCã€Storage Classes çš„ç®¡ç†è½åœ°å®è·µ</span></a>
    </div>
</div>

        </div>
        <div class="toggler" onclick="toggleLight(this);">ğŸ’¡</div>
        <div id="copyright" style="display: none;">
    
    
    <p>&copy; 28280 <a href="/"></a>, powered by Hugo and Qiao</p>
</div>
    </footer>
    
<script>
    function toggleLight() {
        document.getElementById('page').classList.toggle('night');
    }
</script>
</body>

</html>