<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
<meta name="X-UA-Compatible" , content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<link rel="icon" type="image/png" href="/%20/favicon.png">

<title>06 ç»ƒä¹ ç¯‡ï¼šK8s æ ¸å¿ƒå®è·µçŸ¥è¯†æŒæ¡ | Yipsen Ye</title>
<meta name="description" content="ç»è¿‡å‰é¢ç« èŠ‚çš„ä»‹ç»ï¼Œæˆ‘ä»¬æŠŠ Kubernetes çš„æ ¸å¿ƒç»„ä»¶ã€åº”ç”¨ç¼–æ’è½åœ° Kubernetesã€DevOps åœºæ™¯è½åœ° Kubernetesã€å¾®æœåŠ¡åœºæ™¯è½åœ° Kubernetes ç­‰ä¸»è¦çš„çŸ¥è¯†ç‚¹ç»™å¤§å®¶è®²è§£äº†ä¸€éã€‚è€ƒè™‘åˆ°è¯»è€…ä»æ‹¿æ¥çŸ¥è¯†çš„è§’åº¦çœ‹æ€»è§‰å¾—æµ…ï¼Œä¸å¦‚é€šè¿‡ä¸€ç¯‡å®æˆ˜è®²è§£æ¥ç†Ÿç»ƒæŒæ¡ Kubernetes çš„ä¸»è¦æŠ€æœ¯èƒ½åŠ›ã€‚
å¾ˆå¤šè¯»è€…åœ¨å®‰è£…é«˜å¯ç”¨çš„ Kubernetes çš„é›†ç¾¤å¼€å§‹çš„æ—¶å€™å°±ä¼šé‡åˆ°å¾ˆå¤šæŒ«æŠ˜ï¼Œè™½ç„¶ç½‘ä¸Šå¯ä»¥å‚è€ƒçš„èµ„æ–™éå¸¸å¤šï¼Œä½†çœŸæ­£å®¹æ˜“ä¸Šæ‰‹å¹¶èƒ½å®Œæ•´æä¾›è¿ç»­æ€§çš„é¡¹ç›®è¿˜æ²¡æœ‰çœŸæ­£çš„å®˜æ–¹æ¨èã€‚è™½ç„¶ç”¨æˆ·é‡åˆ°ç¢°å£åä¼šå¾ˆç–¼ï¼Œä½†å‚è€ƒ CNCF åŸºé‡‘ä¼šæä¾›çš„è®¤è¯ Kubernetes ç®¡ç†å‘˜çš„çŸ¥è¯†èŒƒå›´é‡Œé¢ï¼Œå®‰è£…é›†ç¾¤çš„çŸ¥è¯†åè€Œå¹¶ä¸æ˜¯é‡ç‚¹ï¼Œå®é™…è€ƒå¯Ÿçš„æ˜¯ç”¨ kubectl è¿™ä¸ªå‘½ä»¤è¡Œå·¥å…·æ¥æŠŠé›†ç¾¤ç†Ÿç»ƒç”¨èµ·æ¥ã€‚è¿™ä¸ªçŸ¥è¯†è¯¯åŒºæ”¾å¾ˆå¤šå…¥é—¨ç”¨æˆ·æŠŠç²¾åŠ›æ”¾åœ¨äº†å¹¶ä¸æ˜¯æœ€é‡è¦çš„çŸ¥è¯†ç‚¹ä¸Šã€‚æ¯•ç«Ÿå’±ä»¬ä¸šåŠ¡åœºæ™¯ä¸­æœ€é‡è¦çš„æ˜¯è§£å†³çŸ¥é“å¦‚ä½•ä½¿ç”¨ï¼Œè€Œä¸æ˜¯æ¢ç©¶å®ƒåº•å±‚çš„æŠ€æœ¯å®ç°ã€‚
åˆ‡è®°ï¼Œæˆ‘ä»¬éœ€è¦æŠŠä¸»è¦ç²¾åŠ›æ”¾åœ¨ 80% çš„å¦‚ä½•ä½¿ç”¨ Kubernetes çš„çŸ¥è¯†é¢ä¸Šæ›´èƒ½å¸¦æ¥ä¸šç»©ï¼Œ20% çš„åº•å±‚æŠ€æœ¯å®ç°ç›¸å…³çš„çŸ¥è¯†æ¶‰åŠé¢å¹¿éœ€è¦æ…¢æ…¢ä½“ä¼šå’Œå­¦ä¹ ï¼Œå¹¶ä¸”å’Œå‰é¢çš„ Kubernetes çš„ä½¿ç”¨æ–¹é¢çš„çŸ¥è¯†ä¹Ÿæ˜¯ç›¸å¾—æ˜ å½°ï¼Œä¸ç†Ÿæ‚‰å¾ˆéš¾ç†è§£åº•å±‚æŠ€æœ¯å®ç°èƒ½å¸¦æ¥çš„æ”¶ç›Šã€‚
ç»ƒä¹ -1ï¼šä½¿ç”¨å‘½ä»¤è¡Œè¿è¡Œ Pod å®¹å™¨ ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…· Kubectl æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š
â¯ kubectl run --image=nginx nginx-appkubectl run --generator=deployment/apps.v1 is DEPRECATED and will be removed in a future version. Use kubectl run --generator=run-pod/v1 or kubectl create instead.deployment.apps/nginx-app createdè¿è¡ŒæˆåŠŸåï¼Œå°±è¦çœ‹çœ‹æœ‰æ²¡æœ‰è¿è¡Œèµ·æ¥ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š
â¯ kubectl get po -o wideNAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATESnginx-app-d65f68dd5-rv4wz 1/1 Running 0 3m41s 10.">
<meta name="author" content="">

<link rel="stylesheet" type="text/css" href="/styles/main.css">

</head>

<body id="page">
    <header>
        <div class="logo-link" style="width: 60px; color: #CA6924;">
    <a href="http://yipsen.github.io/">
        <img style="margin-bottom: -1rem;" src="/images/deer.svg" alt="logo">
        <span style="font-size: 0.5rem; color: #CA6924;">Yipsen Ye</span>
    </a>
</div>
<nav class="navbar justify-content-end">
    <ul class="nav-list">
        
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/posts/">æœ­è®°</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/collections/">é™„è¡¨</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/about/">å…³äº</a>
        </li>
        
    </ul>
</nav>
    </header>
    <main id="content">
        
<div class="container"><aside>
    <div>
        
        
            
            
            <div class="post-category-icon"></div>
            <a href="/categories/kubernetes%e5%ae%9e%e8%b7%b5%e5%85%a5%e9%97%a8%e6%8c%87%e5%8d%97/">Kuberneteså®è·µå…¥é—¨æŒ‡å—</a>
            <ul>
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/00-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E4%BB%AC%E8%A6%81%E5%AD%A6%E4%B9%A0-kubernetes-%E6%8A%80%E6%9C%AF/">00 ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦å­¦ä¹  Kubernetes æŠ€æœ¯</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/01-%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86-kubernetes-%E7%9A%84%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6/">01 é‡æ–°è®¤è¯† Kubernetes çš„æ ¸å¿ƒç»„ä»¶</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/02-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3-kubernets-%E7%9A%84%E7%BC%96%E6%8E%92%E5%AF%B9%E8%B1%A1/">02 æ·±å…¥ç†è§£ Kubernets çš„ç¼–æ’å¯¹è±¡</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/03-devops-%E5%9C%BA%E6%99%AF%E4%B8%8B%E8%90%BD%E5%9C%B0-k8s-%E7%9A%84%E5%9B%B0%E9%9A%BE%E5%88%86%E6%9E%90/">03 DevOps åœºæ™¯ä¸‹è½åœ° K8s çš„å›°éš¾åˆ†æ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/04-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%E4%B8%8B%E8%90%BD%E5%9C%B0-k8s-%E7%9A%84%E5%9B%B0%E9%9A%BE%E5%88%86%E6%9E%90/">04 å¾®æœåŠ¡åº”ç”¨åœºæ™¯ä¸‹è½åœ° K8s çš„å›°éš¾åˆ†æ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/05-%E8%A7%A3%E5%86%B3-k8s-%E8%90%BD%E5%9C%B0%E9%9A%BE%E9%A2%98%E7%9A%84%E6%96%B9%E6%B3%95%E8%AE%BA%E6%8F%90%E7%82%BC/">05 è§£å†³ K8s è½åœ°éš¾é¢˜çš„æ–¹æ³•è®ºæç‚¼</a></li>
                
                
                
                    <li>06 ç»ƒä¹ ç¯‡ï¼šK8s æ ¸å¿ƒå®è·µçŸ¥è¯†æŒæ¡</li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/07-%E5%AE%B9%E5%99%A8%E5%BC%95%E6%93%8E-containerd-%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">07 å®¹å™¨å¼•æ“ containerd è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/08-k8s-%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85%E5%B7%A5%E5%85%B7-kubeadm-%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">08 K8s é›†ç¾¤å®‰è£…å·¥å…· kubeadm çš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/09-%E5%8D%97%E5%8C%97%E5%90%91%E6%B5%81%E9%87%8F%E7%BB%84%E4%BB%B6-ipvs-%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">09 å—åŒ—å‘æµé‡ç»„ä»¶ IPVS çš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/10-%E4%B8%9C%E8%A5%BF%E5%90%91%E6%B5%81%E9%87%8F%E7%BB%84%E4%BB%B6-calico-%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">10 ä¸œè¥¿å‘æµé‡ç»„ä»¶ Calico çš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/11-%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0-dns-%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">11 æœåŠ¡å‘ç° DNS çš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/12-%E7%BB%83%E4%B9%A0%E7%AF%87k8s-%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E6%B5%8B%E9%AA%8C/">12 ç»ƒä¹ ç¯‡ï¼šK8s é›†ç¾¤é…ç½®æµ‹éªŒ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/13-%E7%90%86%E8%A7%A3%E5%AF%B9%E6%96%B9%E6%9A%B4%E9%9C%B2%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%AF%B9%E8%B1%A1-ingress-%E5%92%8C-service/">13 ç†è§£å¯¹æ–¹æš´éœ²æœåŠ¡çš„å¯¹è±¡ Ingress å’Œ Service</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/14-%E5%BA%94%E7%94%A8%E7%BD%91%E5%85%B3-openresty-%E5%AF%B9%E6%8E%A5-k8s-%E5%AE%9E%E8%B7%B5/">14 åº”ç”¨ç½‘å…³ OpenResty å¯¹æ¥ K8s å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/15-service-%E5%B1%82%E5%BC%95%E6%B5%81%E6%8A%80%E6%9C%AF%E5%AE%9E%E8%B7%B5/">15 Service å±‚å¼•æµæŠ€æœ¯å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/16-cilium-%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">16 Cilium å®¹å™¨ç½‘ç»œçš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/17-%E5%BA%94%E7%94%A8%E6%B5%81%E9%87%8F%E7%9A%84%E4%BC%98%E9%9B%85%E6%97%A0%E6%8D%9F%E5%88%87%E6%8D%A2%E5%AE%9E%E8%B7%B5/">17 åº”ç”¨æµé‡çš„ä¼˜é›…æ— æŸåˆ‡æ¢å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/18-%E7%BB%83%E4%B9%A0%E7%AF%87%E5%BA%94%E7%94%A8%E6%B5%81%E9%87%8F%E6%97%A0%E6%8D%9F%E5%88%87%E6%8D%A2%E6%8A%80%E6%9C%AF%E6%B5%8B%E9%AA%8C/">18 ç»ƒä¹ ç¯‡ï¼šåº”ç”¨æµé‡æ— æŸåˆ‡æ¢æŠ€æœ¯æµ‹éªŒ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/19-%E4%BD%BF%E7%94%A8-rook-%E6%9E%84%E5%BB%BA%E7%94%9F%E4%BA%A7%E5%8F%AF%E7%94%A8%E5%AD%98%E5%82%A8%E7%8E%AF%E5%A2%83%E5%AE%9E%E8%B7%B5/">19 ä½¿ç”¨ Rook æ„å»ºç”Ÿäº§å¯ç”¨å­˜å‚¨ç¯å¢ƒå®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/20-%E6%9C%89%E7%8A%B6%E6%80%81%E5%BA%94%E7%94%A8%E7%9A%84%E9%BB%98%E8%AE%A4%E7%89%B9%E6%80%A7%E8%90%BD%E5%9C%B0%E5%88%86%E6%9E%90/">20 æœ‰çŠ¶æ€åº”ç”¨çš„é»˜è®¤ç‰¹æ€§è½åœ°åˆ†æ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/21-%E6%A1%88%E4%BE%8B%E5%88%86%E5%B8%83%E5%BC%8F-mysql-%E9%9B%86%E7%BE%A4%E5%B7%A5%E5%85%B7-vitess-%E5%AE%9E%E8%B7%B5%E5%88%86%E6%9E%90/">21 æ¡ˆä¾‹ï¼šåˆ†å¸ƒå¼ MySQL é›†ç¾¤å·¥å…· Vitess å®è·µåˆ†æ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/22-%E5%AD%98%E5%82%A8%E5%AF%B9%E8%B1%A1-pvpvcstorage-classes-%E7%9A%84%E7%AE%A1%E7%90%86%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">22 å­˜å‚¨å¯¹è±¡ PVã€PVCã€Storage Classes çš„ç®¡ç†è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/23-k8s-%E9%9B%86%E7%BE%A4%E4%B8%AD%E5%AD%98%E5%82%A8%E5%AF%B9%E8%B1%A1%E7%81%BE%E5%A4%87%E7%9A%84%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/">23 K8s é›†ç¾¤ä¸­å­˜å‚¨å¯¹è±¡ç¾å¤‡çš„è½åœ°å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/24-%E7%BB%83%E4%B9%A0%E7%AF%87k8s-%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E6%B5%8B%E9%AA%8C/">24 ç»ƒä¹ ç¯‡ï¼šK8s é›†ç¾¤é…ç½®æµ‹éªŒ</a></li>
                
                
            </ul>
        
    </div>
</aside>

<style>
    aside {
        position: fixed;
        left: 20px;
        background: #ffdee3;
        border-radius: 6px;
        padding: 20px;
        padding-top: 60px;
        box-shadow: 5px 10px #888;
        list-style-type: none;
        display: none;
    }

    .post-category-icon {
        position: absolute;
        width: 80px;
        height: 80px;
        top: -40px;
        left: 50%;
        margin-left: -40px;
        text-align: center;
        font-size: 36px;
        content: 'J';
        background: #ffdee3;
        border-radius: 100%;
        border: 10px solid #fff;
        box-shadow: 5px 10px #888;
    }
</style><article class="post-block">
        <h1 class="post-title">06 ç»ƒä¹ ç¯‡ï¼šK8s æ ¸å¿ƒå®è·µçŸ¥è¯†æŒæ¡</h1>
        <div class="post-info">
            <div> 
                <span class="post-date">ğŸ“…&nbsp;2021-12-22 01:48:12</span>ğŸ·ï¸&nbsp;<a class="post-tag" href="/tags/kubernetes/">kubernetes</a></div><div class="post-category">
                
                ğŸ“š&nbsp;<a href="/categories/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/">Kuberneteså®è·µå…¥é—¨æŒ‡å—</a>
                
            </div></div>
        <div class="post-content">
            <p>ç»è¿‡å‰é¢ç« èŠ‚çš„ä»‹ç»ï¼Œæˆ‘ä»¬æŠŠ Kubernetes çš„æ ¸å¿ƒç»„ä»¶ã€åº”ç”¨ç¼–æ’è½åœ° Kubernetesã€DevOps åœºæ™¯è½åœ° Kubernetesã€å¾®æœåŠ¡åœºæ™¯è½åœ° Kubernetes ç­‰ä¸»è¦çš„çŸ¥è¯†ç‚¹ç»™å¤§å®¶è®²è§£äº†ä¸€éã€‚è€ƒè™‘åˆ°è¯»è€…ä»æ‹¿æ¥çŸ¥è¯†çš„è§’åº¦çœ‹æ€»è§‰å¾—æµ…ï¼Œä¸å¦‚é€šè¿‡ä¸€ç¯‡å®æˆ˜è®²è§£æ¥ç†Ÿç»ƒæŒæ¡ Kubernetes çš„ä¸»è¦æŠ€æœ¯èƒ½åŠ›ã€‚</p>
<p>å¾ˆå¤šè¯»è€…åœ¨å®‰è£…é«˜å¯ç”¨çš„ Kubernetes çš„é›†ç¾¤å¼€å§‹çš„æ—¶å€™å°±ä¼šé‡åˆ°å¾ˆå¤šæŒ«æŠ˜ï¼Œè™½ç„¶ç½‘ä¸Šå¯ä»¥å‚è€ƒçš„èµ„æ–™éå¸¸å¤šï¼Œä½†çœŸæ­£å®¹æ˜“ä¸Šæ‰‹å¹¶èƒ½å®Œæ•´æä¾›è¿ç»­æ€§çš„é¡¹ç›®è¿˜æ²¡æœ‰çœŸæ­£çš„å®˜æ–¹æ¨èã€‚è™½ç„¶ç”¨æˆ·é‡åˆ°ç¢°å£åä¼šå¾ˆç–¼ï¼Œä½†å‚è€ƒ CNCF åŸºé‡‘ä¼šæä¾›çš„è®¤è¯ Kubernetes ç®¡ç†å‘˜çš„çŸ¥è¯†èŒƒå›´é‡Œé¢ï¼Œå®‰è£…é›†ç¾¤çš„çŸ¥è¯†åè€Œå¹¶ä¸æ˜¯é‡ç‚¹ï¼Œå®é™…è€ƒå¯Ÿçš„æ˜¯ç”¨ kubectl è¿™ä¸ªå‘½ä»¤è¡Œå·¥å…·æ¥æŠŠé›†ç¾¤ç†Ÿç»ƒç”¨èµ·æ¥ã€‚è¿™ä¸ªçŸ¥è¯†è¯¯åŒºæ”¾å¾ˆå¤šå…¥é—¨ç”¨æˆ·æŠŠç²¾åŠ›æ”¾åœ¨äº†å¹¶ä¸æ˜¯æœ€é‡è¦çš„çŸ¥è¯†ç‚¹ä¸Šã€‚æ¯•ç«Ÿå’±ä»¬ä¸šåŠ¡åœºæ™¯ä¸­æœ€é‡è¦çš„æ˜¯è§£å†³çŸ¥é“å¦‚ä½•ä½¿ç”¨ï¼Œè€Œä¸æ˜¯æ¢ç©¶å®ƒåº•å±‚çš„æŠ€æœ¯å®ç°ã€‚</p>
<p>åˆ‡è®°ï¼Œæˆ‘ä»¬éœ€è¦æŠŠä¸»è¦ç²¾åŠ›æ”¾åœ¨ 80% çš„å¦‚ä½•ä½¿ç”¨ Kubernetes çš„çŸ¥è¯†é¢ä¸Šæ›´èƒ½å¸¦æ¥ä¸šç»©ï¼Œ20% çš„åº•å±‚æŠ€æœ¯å®ç°ç›¸å…³çš„çŸ¥è¯†æ¶‰åŠé¢å¹¿éœ€è¦æ…¢æ…¢ä½“ä¼šå’Œå­¦ä¹ ï¼Œå¹¶ä¸”å’Œå‰é¢çš„ Kubernetes çš„ä½¿ç”¨æ–¹é¢çš„çŸ¥è¯†ä¹Ÿæ˜¯ç›¸å¾—æ˜ å½°ï¼Œä¸ç†Ÿæ‚‰å¾ˆéš¾ç†è§£åº•å±‚æŠ€æœ¯å®ç°èƒ½å¸¦æ¥çš„æ”¶ç›Šã€‚</p>
<h3 id="ç»ƒä¹ -1ä½¿ç”¨å‘½ä»¤è¡Œè¿è¡Œ-pod-å®¹å™¨">ç»ƒä¹ -1ï¼šä½¿ç”¨å‘½ä»¤è¡Œè¿è¡Œ Pod å®¹å™¨</h3>
<p>ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…· Kubectl æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<pre tabindex="0"><code>â¯ kubectl run --image=nginx nginx-app
kubectl run --generator=deployment/apps.v1 is DEPRECATED and will be removed in a future version. Use kubectl run --generator=run-pod/v1 or kubectl create instead.
deployment.apps/nginx-app created

</code></pre><p>è¿è¡ŒæˆåŠŸåï¼Œå°±è¦çœ‹çœ‹æœ‰æ²¡æœ‰è¿è¡Œèµ·æ¥ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<pre tabindex="0"><code>â¯ kubectl get po -o wide
NAME                        READY   STATUS    RESTARTS   AGE     IP            NODE                                                 NOMINATED NODE   READINESS GATES
nginx-app-d65f68dd5-rv4wz   1/1     Running   0          3m41s   10.4.47.234   gke-us-central1-cloud-okteto-com-pro-a09dced8-jxp8   &lt;none&gt;           &lt;none&gt;

</code></pre><p>ä¸ºäº†æ›´æ¸…æ¥šåœ°ç†è§£ Pod è¿è¡Œçš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬è¿˜ç»å¸¸ä¼šè¿è¡Œå¦‚ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹ï¼š</p>
<pre tabindex="0"><code>â¯ kubectl describe po nginx-app-d65
Name:               nginx-app-d65f68dd5-rv4wz
Namespace:          xiaods
Priority:           0    
PriorityClassName:  &lt;none&gt;
Node:               gke-us-central1-cloud-okteto-com-pro-a09dced8-jxp8/10.128.0.133
Start Time:         Sat, 02 May 2020 13:28:15 +0800     
Labels:             pod-template-hash=d65f68dd5
                    run=nginx-app
Annotations:        cni.projectcalico.org/podIP: 10.4.47.234/32
                    container.apparmor.security.beta.kubernetes.io/nginx-app: runtime/default
                    kubernetes.io/egress-bandwidth: 5M          
                    kubernetes.io/ingress-bandwidth: 5M           
                    kubernetes.io/limit-ranger: LimitRanger plugin set: cpu, memory request for container nginx-app; cpu, memory limit for container nginx-app
                    kubernetes.io/psp: cloud-okteto-enterprise-restrictive
                    seccomp.security.alpha.kubernetes.io/pod: runtime/default                                                                                                     
Status:             Running                                                                                                                                                       
IP:                 10.4.47.234                                                                                                                                                   Controlled By:      ReplicaSet/nginx-app-d65f68dd5
......çœç•¥è‹¥å¹²ä»£ç ......

Events:
  Type    Reason     Age    From                                                         Message
  ----    ------     ----   ----                                                         -------
  Normal  Scheduled  5m19s  default-scheduler                                            Successfully assigned xiaods/nginx-app-d65f68dd5-rv4wz to gke-us-central1-cloud-okteto-co
m-pro-a09dced8-jxp8
  Normal  Pulling    5m17s  kubelet, gke-us-central1-cloud-okteto-com-pro-a09dced8-jxp8  Pulling image &quot;nginx&quot;
  Normal  Pulled     5m17s  kubelet, gke-us-central1-cloud-okteto-com-pro-a09dced8-jxp8  Successfully pulled image &quot;nginx&quot;
  Normal  Created    5m17s  kubelet, gke-us-central1-cloud-okteto-com-pro-a09dced8-jxp8  Created container nginx-app
  Normal  Started    5m16s  kubelet, gke-us-central1-cloud-okteto-com-pro-a09dced8-jxp8  Started container nginx-app

</code></pre><p>å¦‚ä¸Šé¢è¿”å›çš„ç»“æœä¸­ï¼ŒEvents é¡¹çš„äº‹ä»¶æ—¥å¿—ä¿¡æ¯æ˜¯æˆ‘ä»¬å¿«é€Ÿå®šä½ Pod è¿è¡Œæƒ…å†µçš„æœ€é‡è¦çš„ä¿¡æ¯ï¼Œå¯ä»¥å¿«é€Ÿäº†è§£ Pod ç”Ÿå‘½å‘¨æœŸçš„è¿è¡Œè¿‡ç¨‹ã€‚</p>
<p>**ä½œè€…å»ºè®®ï¼š**kubectl æœ‰å¾ˆå¤šå‘½ä»¤å‚æ•°å¾ˆå¤šï¼Œè¯·åŠ¡å¿…å‚è€ƒ Kubernetes Docs ç½‘ç«™æä¾›çš„ <a href="https://kubernetes.io/docs/reference/kubectl/cheatsheet/">Kubectl Cheat Sheet</a>ï¼Œæ­£å¥½å¯ä»¥ä½œä¸ºç»ƒä¹ é¢˜æ¥ç†Ÿç»ƒä½ éœ€è¦çš„å‘½ä»¤è¡ŒæŠ€èƒ½ã€‚</p>
<h3 id="ç»ƒä¹ -2ç»™ç»„å†…æ¯ä¸€ä½æˆå‘˜åˆ†é…ç‹¬ç«‹ç‹¬æœ‰èµ„æº">ç»ƒä¹ -2ï¼šç»™ç»„å†…æ¯ä¸€ä½æˆå‘˜åˆ†é…ç‹¬ç«‹ç‹¬æœ‰èµ„æº</h3>
<p>é…ç½®å®‰è£…å®Œæˆ Kubernetes é›†ç¾¤åï¼Œç³»ç»Ÿä¼šç»™æˆ‘ä»¬æä¾›ä¸€ä¸ª Kubeconfig æ–‡ä»¶ï¼Œé‡Œé¢é»˜è®¤é…ç½®äº†ä¸€ä¸ª cluster-admin è´¦å·æ¥å…¨å±€ç®¡ç†æ‰€æœ‰é›†ç¾¤èµ„æºï¼Œå¹¶ä¸”å®ƒæ˜¯è¶…çº§ç®¡ç†å‘˜æƒé™ã€‚è¿™ä¸ªè´¦å·å’Œé›†ç¾¤ç›´æ¥æ˜¯é€šè¿‡ä¼ä¸šè¯ä¹¦çš„è®¤è¯æ–¹å¼æ¥è¿›å…¥ç³»ç»Ÿçš„ï¼Œæˆ‘ä»¬æ²¡åŠæ³•åƒä¼ ç»Ÿä¸šåŠ¡ç³»ç»Ÿä¸€æ ·ç®€å•åœ°æ›´æ”¹å¯†ç æ¥é¿å…æ–‡ä»¶å…¬ç”¨çš„å®‰å…¨åˆ†é™©ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬éœ€è¦ç»™æ¯ä¸€ä½å¼€å‘æä¾›ä¸€ä¸ªç‹¬ç«‹çš„è´¦å·å’Œå‘½åèµ„æºç©ºé—´æ¥éš”ç¦»èµ„æºçš„ä½¿ç”¨ã€‚kubeconfig æ–‡ä»¶ä¸€èˆ¬é…ç½®å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>apiVersion: v1
kind: Config
preferences: {}

clusters:
- cluster:
  name: development
- cluster:
  name: scratch

users:
- name: developer
- name: experimenter

contexts:
- context:
  name: dev-frontend
- context:
  name: dev-storage
- context:
  name: exp-scratch

</code></pre><p>å½“æˆ‘ä»¬è¦æŠŠä¸€ä¸ªç”¨æˆ·åŠ å…¥é…ç½®ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š</p>
<pre tabindex="0"><code>kubectl config --kubeconfig=config-demo set-credentials developer --client-certificate=fake-cert-file --client-key=fake-key-seefile

</code></pre><p>å¦‚æœè¦åˆ é™¤ç”¨æˆ·ï¼Œå¯ä»¥è¿è¡Œï¼š</p>
<pre tabindex="0"><code>kubectl --kubeconfig=config-demo config unset users.&lt;name&gt;

</code></pre><p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜è¦åœ¨é›†ç¾¤é‡Œé¢ç»™è¿™ä¸ªç”¨æˆ·è´¦å·æä¾› RBAC çš„é…ç½®ï¼Œé‚£ä¸ªè¿‡ç¨‹ç›¸å½“å¤æ‚ï¼Œå…¶å®å¹¶ä¸é€‚åˆåœ¨å®é™…å·¥ä½œä¸­é‡‡ç”¨ã€‚æ—¢ç„¶è¿™ä¸ªé…ç½®ç¹çï¼Œæˆ‘ä»¬æœ‰æ²¡æœ‰ç°æˆçš„å·¥å…·æ¥å¸®åŠ©æˆ‘ä»¬å®ç°å¤šç”¨æˆ·çš„é…ç½®å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„ï¼Œå®ƒå°±æ˜¯ Kiosk å¤šç§Ÿæˆ·ç®¡ç†å¥—ä»¶ï¼š</p>
<pre tabindex="0"><code># å®‰è£… Kiosk
# Install kiosk with helm v3
kubectl create namespace kiosk
helm install kiosk --repo https://charts.devspace.sh/ kiosk --namespace kiosk --atomic

$ kubectl get pod -n kiosk

NAME                     READY   STATUS    RESTARTS   AGE
kiosk-58887d6cf6-nm4qc   2/2     Running   0          1h

# é…ç½®ç”¨æˆ·è´¦å·å’Œæƒé™
kubectl apply -f https://raw.githubusercontent.com/kiosk-sh/kiosk/master/examples/account.yaml

# View your own accounts as regular account user
kubectl get accounts --as=john

# View the details of one of your accounts as regular account user
kubectl get account johns-account -o yaml --as=john

</code></pre><p>ç‰¹åˆ«æ³¨æ„ Kubernetes æä¾›äº†å¤šç§ç”¨æˆ·ç±»å‹ï¼Œå¸¸è§çš„ç±»å‹æœ‰ï¼š X509 è¯ä¹¦ç”¨æˆ·å’Œ Service Account Tokensã€‚ç›®å‰ä¸»æµçš„ç”¨æˆ·ç®¡ç†æ–¹å¼å€¾å‘äºå¯ä»¥åŠ¨æ€ç”Ÿæˆ Token çš„ ServiceAccount æ¨¡å¼ï¼š</p>
<pre tabindex="0"><code>USER_NAME=&quot;john&quot;
kubectl -n kiosk create serviceaccount $USER_NAME

# ä¸º john ç”¨æˆ·é…ç½® kubeconfig æ–‡ä»¶
KUBECONFIG_PATH=&quot;$HOME/.kube/config-kiosk&quot;

kubectl config view --minify --raw &gt;$KUBECONFIG_PATH
export KUBECONFIG=$KUBECONFIG_PATH

CURRENT_CONTEXT=$(kubectl config current-context)
kubectl config rename-context $CURRENT_CONTEXT kiosk-admin

CLUSTER_NAME=$(kubectl config view -o jsonpath=&quot;{.clusters[].name}&quot;)
ADMIN_USER=$(kubectl config view -o jsonpath=&quot;{.users[].name}&quot;)

SA_NAME=$(kubectl -n kiosk get serviceaccount $USER_NAME -o jsonpath=&quot;{.secrets[0].name}&quot;)
SA_TOKEN=$(kubectl -n kiosk get secret $SA_NAME -o jsonpath=&quot;{.data.token}&quot; | base64 -d)

kubectl config set-credentials $USER_NAME --token=$SA_TOKEN
kubectl config set-context kiosk-user --cluster=$CLUSTER_NAME --user=$USER_NAME
kubectl config use-context kiosk-user

# Optional: delete admin context and user
kubectl config unset contexts.kiosk-admin
kubectl config unset users.$ADMIN_USER

export KUBECONFIG=&quot;&quot;

# If not already set, then:
KUBECONFIG_PATH=&quot;$HOME/.kube/config-kiosk&quot;

export KUBECONFIG=$KUBECONFIG_PATH

kubectl ...

</code></pre><p><strong>ç¬”è€…å»ºè®®</strong>ï¼šç»è¿‡è®²è§£ç›¸ä¿¡è¯»è€…å¯¹è¿™ä¸€å—ä¼šæœ‰ä¸€ä¸ªæ›´åŠ æ·±åˆ»çš„ç†è§£ã€‚æˆ‘ä»¬é€šè¿‡ Kiosk é—´æ¥ç®€åŒ–äº†ç”¨æˆ·ç®¡ç†çš„è¿ç»´æˆæœ¬ï¼Œæ¨èä½¿ç”¨ã€‚</p>
<h3 id="ç»ƒä¹ -3é€šè¿‡ç¼–æ’ç­–ç•¥å®ç°åº”ç”¨çš„ç°åº¦è“ç»¿å›æ»šå‘å¸ƒ">ç»ƒä¹ -3ï¼šé€šè¿‡ç¼–æ’ç­–ç•¥å®ç°åº”ç”¨çš„ç°åº¦ã€è“ç»¿ã€å›æ»šå‘å¸ƒ</h3>
<p>å½“å‰å­¦ä¹  Kubernetes çš„æœ€ä¸»è¦çš„åº”ç”¨åœºæ™¯å°±æ˜¯å¸®åŠ©ä¼ä¸šå»ºç«‹æ›´å…ˆè¿›çš„åº”ç”¨å‘å¸ƒå¹³å°ï¼Œä¾æ‰˜å¼€æºæŠ€æœ¯çš„åˆ›æ–°èƒ½åŠ›è®©ä¼ä¸šèŠ±è´¹å¾ˆå°‘çš„ç ”å‘æŠ•å…¥å°±å¯ä»¥ç«‹å³æ‹¥æœ‰ä¸»æµå¤§å‚æ‰èƒ½æ”¯æŒçš„åº”ç”¨ç°åº¦å‘å¸ƒã€è“ç»¿å‘å¸ƒã€å›æ»šå‘å¸ƒã€‚</p>
<p>åŸç”Ÿçš„ Kubernetes æ”¯æŒå•ä¸ªåº”ç”¨å®¹å™¨ Pod çš„æ»šåŠ¨æ›´æ–°ï¼Œå€ŸåŠ©è¿™ä¸ªèƒ½åŠ›ï¼Œå¾ˆå¤šä¼ä¸šå®ç°äº†ç±»ä¼¼çš„ç°åº¦ã€è“ç»¿å‘å¸ƒçš„èƒ½åŠ›ã€‚ä½†æ˜¯å¾€å¾€åœ¨å›é¡¾å®ç°æ•ˆæœä¸Šåˆæ„Ÿè§‰è·¯æ•°ä¸å¯¹ã€‚æ˜¯çš„ï¼ŒKubernetes æœ¬èº«å¹¶æ²¡æœ‰æ”¯æŒåº”ç”¨å±‚çš„é›†ç¾¤ç³»ç»Ÿçš„ç°åº¦ã€è“ç»¿ç­‰é«˜çº§å‘å¸ƒç‰¹æ€§çš„èƒ½åŠ›ï¼Œæ‰€ä»¥è¿™ç§æ”¹é€ æ˜¯æ²¡æœ‰èµ°å¯¹è·¯çº¿ã€‚</p>
<p>åœ¨æœ€æ–°çš„ Kubernetes ä¸­å·²ç»å¼•å…¥äº† Ingress å¯¹è±¡ï¼Œå®ƒæä¾›ä¸ƒå±‚å—åŒ—å‘æµé‡çš„å¼•æµæœåŠ¡ï¼Œç›®å‰é»˜è®¤å¸¸è§çš„ç»„ä»¶æ˜¯ç”¨ NGINX Ingress Controller + Nginx æ¥æ”¯æ’‘ã€‚ç”±äº Nginx æ”¯æŒåœ¨æµé‡è¯·æ±‚ä¸­åŠ å…¥ Header æ ‡ç­¾ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å¯ä»¥å®Œç¾æ”¯æŒä¸šåŠ¡çš„å…¥å£æµé‡ç°åº¦å‘å¸ƒã€‚ä»¥ä¸‹æ˜¯ Nginx Ingress å¯¹ç°åº¦å‘å¸ƒçš„æ³¨è§£ï¼š</p>
<pre tabindex="0"><code>nginx.ingress.kubernetes.io/canary    &quot;true&quot; or &quot;false&quot;
nginx.ingress.kubernetes.io/canary-by-header    string
nginx.ingress.kubernetes.io/canary-by-header-value    string
nginx.ingress.kubernetes.io/canary-by-header-pattern    string
nginx.ingress.kubernetes.io/canary-by-cookie    string
nginx.ingress.kubernetes.io/canary-weight    number

</code></pre><p>åŸºäº Request Header çš„æµé‡åˆ‡åˆ†ï¼Œéƒ¨åˆ†æ³¨è§£çš„è¯¦è§£å¦‚ä¸‹ã€‚</p>
<pre tabindex="0"><code>nginx.ingress.kubernetes.io/canary-by-header

</code></pre><p>ç”¨äºé€šçŸ¥ Ingress å°†è¯·æ±‚è·¯ç”±åˆ° Canary Ingress ä¸­æŒ‡å®šçš„æœåŠ¡çš„ Headerã€‚å½“è¯·æ±‚ Header è®¾ç½®ä¸º always æ—¶ï¼Œå®ƒå°†è¢«è·¯ç”±åˆ° Canaryã€‚å½“ Header è®¾ç½®ä¸º never æ—¶ï¼Œå®ƒå°†æ°¸è¿œä¸ä¼šè¢«è·¯ç”±åˆ° Canaryã€‚å¯¹äºå…¶ä»–å€¼å°†å¿½ç•¥æ­¤è¯·æ±‚ Headerï¼Œå¹¶é€šè¿‡ä¼˜å…ˆçº§å°†è¯·æ±‚ä¸å…¶ä»– Canary è§„åˆ™è¿›è¡Œæ¯”è¾ƒã€‚</p>
<pre tabindex="0"><code>nginx.ingress.kubernetes.io/canary-by-header-value

</code></pre><p>è¦åŒ¹é…çš„ Header å€¼ï¼Œç”¨äºé€šçŸ¥ Ingress å°†è¯·æ±‚è·¯ç”±åˆ° Canary Ingress ä¸­æŒ‡å®šçš„æœåŠ¡ã€‚å½“è¯·æ±‚ Header è®¾ç½®ä¸ºæ­¤å€¼æ—¶ï¼Œå®ƒå°†è¢«è·¯ç”±åˆ° Canaryã€‚å¯¹äºå…¶ä»– Header å€¼å°†è¢«å¿½ç•¥ï¼Œå¹¶ä¸”è¯·æ±‚å€¼ä¼šä¸å…¶ä»– Canary è§„åˆ™çš„ä¼˜å…ˆçº§è¿›è¡Œæ¯”è¾ƒã€‚æ­¤æ³¨è§£å¿…é¡»ä¸ canary-by-header ä¸€èµ·ä½¿ç”¨ã€‚</p>
<pre tabindex="0"><code>nginx.ingress.kubernetes.io/canary-by-header

</code></pre><p>æ³¨è§£å…è®¸è‡ªå®šä¹‰ Header å€¼è€Œä¸æ˜¯ä½¿ç”¨ç¨‹åºè‡ªå®šä¹‰ Header æ¥æ§åˆ¶æµé‡ã€‚å¦‚æœ <code>nginx.ingress.kubernetes.io/canary-by-header</code> æ³¨è§£æœªå®šä¹‰åˆ™æ²¡æœ‰ä»»ä½•æ•ˆæœã€‚</p>
<p>å®Œæ•´ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>---
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  annotations:
    nginx.ingress.kubernetes.io/canary: &quot;true&quot;
    nginx.ingress.kubernetes.io/canary-by-header: &quot;new&quot;
    nginx.ingress.kubernetes.io/canary-by-header-valueï¼š&quot;xxx&quot;
  labels:
    app: demo
  name: demo-ingress
  namespace: demo-canary
spec:
  rules:
  - host: canary.example.com
    http:
      paths:
      - backend:
          serviceName: demo-canary
          servicePort: 80
        path: /

</code></pre><p>è¿™æ ·çš„ç°åº¦å‘å¸ƒæ•ˆæœåº”ç”¨åœºæ™¯æ˜¯æœ‰é™çš„ï¼Œå¾€å¾€ä¼ä¸šå†…éƒ¨çš„åº”ç”¨å‘å¸ƒçš„æ—¶å€™åŒ…å«åå‡ äºŒåä¸ªç»„ä»¶ï¼Œè¿™äº›ç»„å»ºç›´æ¥è¿˜æœ‰å¾ˆå¤šç½‘å…³è¿›è¡Œç»†åˆ†ï¼Œå¦‚ä½•æœ‰æ•ˆç»™ç»†åˆ†ç»„ä»¶çš„æµé‡ç®¡ç†æ‰æ˜¯ç°åœ¨çš„è¿«åˆ‡éœ€æ±‚ã€‚è¿™ç§æµé‡ç­–ç•¥æŒ‰ç…§å½“å‰çš„æ¶æ„æ–¹å‘ï¼Œæ˜¯åœ¨å¾€å¾®æœåŠ¡ç½‘æ ¼æ–¹å‘å‘å±•ï¼Œæ¯”è¾ƒå‡ºåçš„å¼€æºæ¡†æ¶å°±æ˜¯ Istioã€‚ç¬”è€…è®¤ä¸ºä½¿ç”¨æœåŠ¡ç½‘æ ¼æ¥å®ç°åº”ç”¨çš„æµé‡è§‚æµ‹å’Œå¼•å¯¼æ‰æ›´å…·å¼¹æ€§ã€‚</p>
<p>ä¸€è°ˆåˆ° Istioï¼Œç›¸ä¿¡å¤§å®¶ä¸€å®šéƒ¨ç½²è¿‡ Bookinfo é¡¹ç›®ï¼Œå…¶ä¸­æœ€ä½“ç°ä¸šåŠ¡ä»·å€¼çš„å°±æ˜¯ä¸šåŠ¡æµé‡çš„æ ‡è®°å’Œåˆ‡æ¢ï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Kubernetes%20%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/assets/54f84c90-d65e-11ea-aefa-4fa1d18dcf14.jpg" alt="bookinfo"></p>
<p>Istio é€šè¿‡æ§åˆ¶ Header å®ç°è“ç»¿ç¤ºä¾‹ï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Kubernetes%20%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/assets/605f0010-d65e-11ea-b558-cd3c105f83ae.jpg" alt="blue green"></p>
<p>Istio é€šè¿‡æ›´æ”¹ Header å€¼å®ç°ç°åº¦å‘å¸ƒç¤ºä¾‹ï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Kubernetes%20%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/assets/73f16050-d65e-11ea-8a75-23aebf65f18c.jpg" alt="canary deployment"></p>
<p><strong>ç¬”è€…å»ºè®®</strong>ï¼šä½¿ç”¨æœåŠ¡ç½‘æ ¼æ¥å®ç°åº”ç”¨æµé‡çš„åˆ‡æ¢æ˜¯æ¯”è¾ƒè‡ªç„¶çš„è®¾è®¡å®ç°æ–¹å¼ï¼Œå®ƒæ‰€ä¾èµ–çš„åº•å±‚æŠ€æœ¯ç¡®å®å°±æ˜¯ Kubernetes çš„ç»å…¸æ»šåŠ¨æ›´æ–°æŠ€æœ¯ã€‚ä½†æ˜¯æ¯”åŸç”Ÿ Kubernetes æ›´å¥½çš„åœ°æ–¹æ˜¯ï¼ŒæœåŠ¡ç½‘æ ¼åœ¨é€šè¿‡ Header å¼•å¯¼æµé‡çš„ç‰¹æ€§ä¸­ï¼Œè¿˜åŠ å…¥äº†ç†”æ–­ã€é»‘åå•ã€é™æµç­‰æ›´é«˜çº§çš„åº”ç”¨ä¿éšœç‰¹æ€§ï¼Œå€¼å¾—ä½¿ç”¨ã€‚</p>
<h3 id="ç»ƒä¹ -4é…ç½®åˆç†çš„ç½‘ç»œæ–¹æ¡ˆå¹¶è®©æµé‡æ•°æ®å¯è§†åŒ–">ç»ƒä¹ -4ï¼šé…ç½®åˆç†çš„ç½‘ç»œæ–¹æ¡ˆå¹¶è®©æµé‡æ•°æ®å¯è§†åŒ–</h3>
<p>åº”ç”¨åœ¨éƒ¨ç½²åˆ° Kubernetes é›†ç¾¤åï¼Œæˆ‘ä»¬æœ€æ€¥æ‰‹çš„éœ€æ±‚å°±æ˜¯ä¸šåŠ¡æ•°æ®çš„å¯è§†åŒ–ã€‚å½“å‰ï¼Œä»ç„¶æœ‰å¾ˆå¤šç”¨æˆ·åœ¨çº ç»“ä½¿ç”¨å“ªç§ç½‘ç»œæ–¹æ¡ˆæ˜¯æœ€å¥½çš„ï¼Œä»ç¬”è€…æ¥çœ‹ï¼Œè¿™ä¸ªé€‰å‹æ˜¯éœ€è¦ä¾æ®ä½ çš„ç¡¬ä»¶ç½‘ç»œåŸºç¡€è®¾æ–½æ¥å†³å®šçš„ã€‚å¹¶ä¸”å½“å‰ä¸»æµçš„å®¹å™¨ç½‘ç»œæ’ä»¶çš„æŸè€—éå¸¸æ¥è¿‘åŸç”Ÿç½‘ç»œï¼Œæ—©æœŸç”¨æˆ·ç½‘ç»œçš„ç³Ÿç³•ä½“éªŒå·²ç»ä¸€å»ä¸å¤è¿”ã€‚</p>
<p>å®¹å™¨æŠ€æœ¯çš„èƒ½åŠ›æå‡å®Œå…¨ä¾èµ– Kernel å†…æ ¸çš„æŠ€æœ¯èƒ½åŠ›ï¼Œå®¹å™¨ç½‘ç»œä¹ŸåŒ…æ‹¬åœ¨å†…ã€‚åœ¨æœ€è¿‘çš„ Kernel 4.9 ä¸­å¼€å§‹å¼•å…¥äº†æ‰©å±• Berkeley Packet Filteringï¼ˆeBPFï¼‰ç‰¹æ€§ä½¿å¾—ç”¨æˆ·ç©ºé—´çš„å„ä¸ªç‚¹ä¸Šé™„åŠ è‡ªå®šä¹‰ç¨‹åºï¼ŒåŒ…æ‹¬ï¼ˆsocketsã€trace pointsã€packet receptionï¼‰ï¼Œç”¨äºæ¥æ”¶å’Œå¤„ç†æ•°æ®ã€‚å®ƒå®ç°ç½‘ç»œå®‰å…¨ç­–ç•¥å’Œå¯è§†åŒ–çš„åˆ©å™¨ï¼Œå‚è€ƒå¼€æºå¯è§‚æµ‹é¡¹ç›® Hubble è®©å¤§å®¶ä½“ä¼šä¸‹å®ƒçš„èƒ½åŠ›ï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Kubernetes%20%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/assets/9678a3e0-d65e-11ea-855e-35d62ffd230b.jpg" alt="img"></p>
<p>æ­¤å¯è§‚æµ‹é¡¹ç›®æ¥æºè‡ªä¸»æµåŸç”Ÿå®¹å™¨ç½‘ç»œ <strong>Cilium</strong> æä¾›æ”¯æŒã€‚è¿™é‡Œä»‹ç»å®ƒï¼Œæ˜¯å› ä¸ºå®ƒé€‰æ‹©ä½¿ç”¨ eBPF æŠ€æœ¯æ¥å®ç°å®¹å™¨ç½‘ç»œæµé‡çš„è½¬å‘ï¼Œç›´æ¥ä»£æ›¿äº† iptablesã€‚å®ƒæ˜¯èƒ½å’Œ <strong>Calico</strong> å®¹å™¨ç½‘ç»œç›¸æå¹¶è®ºå¼€æºé¡¹ç›®ã€‚ä½ ä¸€å®šå…³å¿ƒå¯¹æ¯”ï¼Œè¿™é‡Œå¼•ç”¨ç½‘ä¸Šçš„ä¸€ä»½å¯¹æ¯”å‚è€ƒï¼š</p>
<blockquote>
<p><a href="https://itnext.io/benchmark-results-of-kubernetes-network-plugins-cni-over-10gbit-s-network-updated-april-2019-4a9886efe9c4">https://itnext.io/benchmark-results-of-kubernetes-network-plugins-cni-over-10gbit-s-network-updated-april-2019-4a9886efe9c4</a></p>
</blockquote>
<p>å¯ä»¥çœ‹åˆ°æ€§èƒ½å·®ä¸ä¸å¤§ï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/Kubernetes%20%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/assets/b98f7d40-d65e-11ea-8a86-ed86f9ad27de.jpg" alt="img"></p>
<p><strong>ç¬”è€…å»ºè®®</strong>ï¼šå½“å‰å®¹å™¨ç½‘ç»œçš„é€‰æ‹©å¹¶æ²¡æœ‰åƒä»¥å‰é‚£æ ·çº ç»“äº†ã€‚ä»»æ„ä¸€ç§ç½‘ç»œæ–¹æ¡ˆéƒ½æ˜¯å¯ä»¥è¦†ç›–å¤§éƒ¨åˆ†ä¸šåŠ¡éœ€æ±‚çš„ã€‚ä½†æ˜¯å½“å‰æ–°å‹çš„å®¹å™¨ç½‘ç»œæ–¹æ¡ˆä¾‹å¦‚ Cilium å¼€å§‹æä¾›é™¤äº†ç½‘ç»œè¿é€šæ€§ä¹‹å¤–çš„æ›´å¤šå‹å¥½ç‰¹æ€§ï¼Œæ¯”å¦‚å¤šé›†ç¾¤ç½‘ç»œã€æ›¿æ¢ Kubeproxyã€æ•°æ®å¯è§†åŒ–ç­‰ã€‚å€¼å¾—ä½ å…³æ³¨å’Œä½“éªŒã€‚</p>
<h3 id="ç»ƒä¹ -5å–„ç”¨å®˜æ–¹æ–‡æ¡£å–„ç”¨å·¥å…·æ¥è§£å†³é—®é¢˜">ç»ƒä¹ -5ï¼šå–„ç”¨å®˜æ–¹æ–‡æ¡£ï¼Œå–„ç”¨å·¥å…·æ¥è§£å†³é—®é¢˜</h3>
<p>Kubernetes å¤§ç‰ˆæœ¬åŸºæœ¬ä¸Š 3 ä¸ªæœˆå°±ä¼šæ›´æ–°ä¸€æ¬¡ï¼Œå¦‚æœè®©æˆ‘ä»¬å¤©å¤©æ³¡åœ¨é˜…è¯»å„ç§æ–‡æ¡£èµ„æ–™çš„è¯ï¼Œæˆ‘ç›¸ä¿¡ä¸€å®šä¼šè®©å¾ˆå¤šäººå¤´è„‘å¤§çˆ†ç‚¸ã€‚ä¸ºäº†è§£å†³ä¸šåŠ¡åº”ç”¨çš„å‘å¸ƒé—®é¢˜ï¼ŒKubernetes çš„æºå¤´ä¿¡æ¯å¿…è¦ä¿è¯æœ€æ–°ã€æœ€å…¨ã€æœ€æƒå¨ã€‚è¿™é‡Œï¼Œç¬”è€…å†æ¬¡å¼ºè°ƒï¼Œå®˜æ–¹çš„ç¤¾åŒºæ–‡æ¡£ç«™ç‚¹ï¼ˆ<a href="https://kubernetes.io/docs">https://kubernetes.io/docs</a>ï¼‰å°±æ˜¯æœ€æ–°ã€æœ€å…¨ã€æœ€æƒå¨çš„å‚è€ƒèµ„æ–™äº†ã€‚ä¸è¦åœ¨åˆ°åˆ«å¤„æ±‚è¯ï¼Œå®˜æ–¹çš„æ–‡æ¡£éƒ½æ˜¯ç»è¿‡å…¨çƒå¼€å‘è€…çš„é˜…è¯»å’Œç›‘ç£ï¼Œæ¯”å…¶å®ƒè½¬è½½çš„è¦åŠæ—¶å¯é ã€‚</p>
<p>å¦å¤–ï¼ŒKubernetes æ˜¯äº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼šï¼ˆCNCFï¼‰çš„æŠ€æœ¯è“å›¾ä¸­äº†ä¸€ä¸ªç»„ä»¶ï¼Œå½“ä½ é‡åˆ°æŠ€æœ¯éš¾é¢˜æ—¶ï¼Œè¯·ç¬¬ä¸€æ—¶é—´å‚è€ƒ CNCF çš„æŠ€æœ¯è“å›¾æ‰¾ç‚¹çµæ„Ÿï¼š</p>
<blockquote>
<p><a href="https://landscape.cncf.io/">https://landscape.cncf.io/</a></p>
</blockquote>
<p>ç›¸ä¿¡ä½ ä¸€å®šå¯ä»¥è·å¾—æ»¡æ„çš„æ¶æ„å»ºè®®å’Œæ–¹æ¡ˆã€‚</p>
<p><strong>ç¬”è€…å»ºè®®</strong>ï¼šé‡åˆ°æ¦‚å¿µé—®é¢˜ä¸æ¸…æ¥šï¼Œè¯·åˆ° <a href="https://kubernetes.io/docs">https://kubernetes.io/docs</a> æœç´¢è·å–æœ€æ–°çš„èµ„æ–™ã€‚é‡åˆ°æŠ€æœ¯æ¶æ„çš„é—®é¢˜ï¼Œè¯·åˆ° <a href="https://landscape.cncf.io/">https://landscape.cncf.io/</a> å‚è€ƒäº‘åŸç”Ÿçš„æŠ€æœ¯æ¶æ„è“å›¾ï¼Œç›¸ä¿¡ä¹Ÿå¯ä»¥æ‰¾åˆ°çº¿ç´¢ã€‚</p>
<h3 id="æ€»ç»“">æ€»ç»“</h3>
<p>ä½œä¸ºç¬”è€…ï¼Œä¸€è·¯ç»ƒä¹ å®è·µèµ°è¿‡æ¥ï¼Œæˆ‘å‘ç°ä¼ä¸šåœ¨åº”ç”¨å®¹å™¨ä¸Šçš„æƒ§æ€•å°±çœŸå®å­˜åœ¨çš„ã€‚ä¸ºäº†å…‹æœææƒ§ï¼Œä½ éœ€è¦å¤šåœ¨æœ¬åœ°æ¼”ç»ƒå’ŒéªŒè¯æŠ€æœ¯ç»†èŠ‚çš„å¯è¡Œæ€§ã€‚å› ä¸ºå„ä¸ªä¼ä¸šçš„ç¡¬ä»¶åŸºç¡€è®¾æ–½ä¸ä¸€æ ·ï¼Œè¯·ä¸è¦æ— è„‘ç…§åŠä¸šç•Œå¤§å‚çš„è½åœ° Kubernetes çš„æˆåŠŸç»éªŒã€‚ä»å®é™…éœ€æ±‚å‡ºå‘ï¼ŒæŒ‰ç…§è‡ªå·±å…¬å¸çš„ä¸šåŠ¡åœºæ™¯æ¥å®è·µæ‰æ˜¯ç›®çš„ï¼Œåšä¸€æ¬¡çœŸæ­£çš„æ¶æ„å¸ˆä¸»äººã€‚</p>

        </div>
    </article>
</div>

    </main>
    <footer>
        <div id="pagination">
            
<div class="paginator">
    <div class="prev">
        
        <a href="/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/05-%E8%A7%A3%E5%86%B3-k8s-%E8%90%BD%E5%9C%B0%E9%9A%BE%E9%A2%98%E7%9A%84%E6%96%B9%E6%B3%95%E8%AE%BA%E6%8F%90%E7%82%BC/"><span>05 è§£å†³ K8s è½åœ°éš¾é¢˜çš„æ–¹æ³•è®ºæç‚¼</span></a>
    </div>
    <div class="next">
        
        <a href="/documents/columns/kubernetes/kubernetes%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97/07-%E5%AE%B9%E5%99%A8%E5%BC%95%E6%93%8E-containerd-%E8%90%BD%E5%9C%B0%E5%AE%9E%E8%B7%B5/"><span>07 å®¹å™¨å¼•æ“ containerd è½åœ°å®è·µ</span></a>
    </div>
</div>

        </div>
        <div class="toggler" onclick="toggleLight(this);">ğŸ’¡</div>
        <div id="copyright" style="display: none;">
    
    
    <p>&copy; 27270 <a href="/"></a>, powered by Hugo and Qiao</p>
</div>
    </footer>
    
<script>
    function toggleLight() {
        document.getElementById('page').classList.toggle('night');
    }
</script>
</body>

</html>