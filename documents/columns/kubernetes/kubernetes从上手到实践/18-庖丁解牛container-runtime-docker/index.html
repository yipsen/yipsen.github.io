<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
<meta name="X-UA-Compatible" , content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<link rel="icon" type="image/png" href="/%20/favicon.png">

<title>18 åº–ä¸è§£ç‰›ï¼šContainer Runtime ï¼ˆDockerï¼‰ | Yipsen Ye</title>
<meta name="description" content="æ•´ä½“æ¦‚è§ˆ æˆ‘ä»¬åœ¨ç¬¬ 3 èŠ‚çš„æ—¶å€™ï¼Œæåˆ°è¿‡ Container Runtime çš„æ¦‚å¿µï¼Œä¹Ÿå¤§è‡´ä»‹ç»è¿‡å®ƒçš„ä¸»è¦ä½œç”¨åœ¨äºä¸‹è½½é•œåƒï¼Œè¿è¡Œå®¹å™¨ç­‰ã€‚
ç»è¿‡æˆ‘ä»¬å‰é¢çš„å­¦ä¹ ï¼Œkube-scheduler å†³å®šäº† Pod å°†è¢«è°ƒåº¦åˆ°å“ªä¸ª Node ä¸Šï¼Œè€Œ kubelet åˆ™è´Ÿè´£ Pod åœ¨æ­¤ Node ä¸Šå¯æŒ‰é¢„æœŸå·¥ä½œã€‚å¦‚æœæ²¡æœ‰ Container Runtimeï¼Œé‚£ Pod ä¸­çš„ container åœ¨è¯¥ Node ä¸Šä¹Ÿä¾¿æ— æ³•æ­£å¸¸å¯åŠ¨è¿è¡Œäº†ã€‚
æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä»¥å½“å‰æœ€ä¸ºé€šç”¨çš„ Container Runtime Docker ä¸ºä¾‹è¿›è¡Œä»‹ç»ã€‚
Container Runtime æ˜¯ä»€ä¹ˆ Container Runtime æˆ‘ä»¬é€šå¸¸å«å®ƒå®¹å™¨è¿è¡Œæ—¶ï¼Œè€Œè¿™ä¸€æ¦‚å¿µçš„äº§ç”Ÿä¹Ÿæ˜¯ç”±äºå®¹å™¨åŒ–æŠ€æœ¯å’Œ K8S çš„å¤§åŠ›å‘å±•ï¼Œä¸ºäº†ç»Ÿä¸€å·¥ä¸šæ ‡å‡†ï¼Œä¹Ÿä¸ºäº†é¿å… K8S ç»‘å®šäºç‰¹å®šçš„å®¹å™¨è¿è¡Œæ—¶ï¼Œæ‰€ä»¥ä¾¿æˆç«‹äº† Open Container Initiative (OCI) ç»„ç»‡ï¼Œè‡´åŠ›äºå°†å®¹å™¨è¿è¡Œæ—¶æ ‡å‡†åŒ–å’Œå®¹å™¨é•œåƒæ ‡å‡†åŒ–ã€‚
å‡¡æ˜¯éµå®ˆæ­¤æ ‡å‡†çš„å®ç°ï¼Œå‡å¯ç”±æ ‡å‡†æ ¼å¼çš„é•œåƒå¯åŠ¨ç›¸åº”çš„å®¹å™¨ï¼Œå¹¶å®Œæˆä¸€äº›ç‰¹å®šçš„æ“ä½œã€‚
Docker æ˜¯ä»€ä¹ˆ Docker æ˜¯ä¸€ä¸ªå®¹å™¨ç®¡ç†å¹³å°ï¼Œå®ƒæœ€åˆæ˜¯è¢«è®¾è®¡ç”¨äºå¿«é€Ÿåˆ›å»ºï¼Œå‘å¸ƒå’Œè¿è¡Œå®¹å™¨çš„å·¥å…·ï¼Œä¸è¿‡éšç€å®ƒçš„å‘å±•ï¼Œå…¶ä¸­é›†æˆäº†è¶Šæ¥è¶Šå¤šçš„åŠŸèƒ½ã€‚
Docker ä¹Ÿå¯ä»¥è¯´æ˜¯ä¸€ä¸ªåŒ…å«æ ‡å‡†å®¹å™¨è¿è¡Œæ—¶çš„å·¥å…·é›†ï¼Œå½“å‰ç‰ˆæœ¬ä¸­é»˜è®¤çš„ runtime ç§°ä¹‹ä¸º runcã€‚ å…³äº runc ç›¸å…³çš„ä¸€äº›å†…å®¹å¯å‚è€ƒæˆ‘ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« ã€‚
å½“ç„¶ï¼Œè¿™é‡Œæåˆ°äº† é»˜è®¤çš„è¿è¡Œæ—¶ é‚£ä¹Ÿå°±æ„å‘³ç€å®ƒå¯æ”¯æŒå…¶ä»–çš„è¿è¡Œæ—¶å®ç°ã€‚
CRI æ˜¯ä»€ä¹ˆ è¯´åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±ä¼šå‘ç°ï¼ŒK8S ä½œä¸ºç›®å‰äº‘åŸç”ŸæŠ€æœ¯ä½“ç³»ä¸­æœ€é‡è¦çš„ä¸€ç¯ï¼Œä¸ºäº†è®©å®ƒæ›´æœ‰æ‰©å±•æ€§ï¼Œå½“ç„¶ä¹Ÿä¸ä¼šå°†è‡ªå·±å®Œå…¨å±€é™äºæŸä¸€ç§ç‰¹å®šçš„å®¹å™¨è¿è¡Œæ—¶ã€‚
è‡ª K8S 1.5 ï¼ˆ2016 å¹´ 11 æœˆï¼‰å¼€å§‹ï¼Œæ–°å¢äº†ä¸€ä¸ªå®¹å™¨è¿è¡Œæ—¶çš„æ’ä»¶ APIï¼Œå¹¶ç§°ä¹‹ä¸º CRI ï¼ˆContainer Runtime Interfaceï¼‰ï¼Œé€šè¿‡ CRI å¯ä»¥æ”¯æŒ kubelet ä½¿ç”¨ä¸åŒçš„å®¹å™¨è¿è¡Œæ—¶ï¼Œè€Œä¸éœ€è¦é‡æ–°ç¼–è¯‘ã€‚">
<meta name="author" content="">

<link rel="stylesheet" type="text/css" href="/styles/main.css">

</head>

<body id="page">
    <header>
        <div class="nav-logo">
    <a href="http://yipsen.github.io/">
        
        <span class="nav-title">Yipsen Ye</span>
    </a>
</div>
<nav class="navbar justify-content-end">
    <ul class="nav-list">
        
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/posts/">æ–‡ç« </a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/collections/">é™„è¡¨</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/about/">å…³äº</a>
        </li>
        
    </ul>
</nav>
    </header>
    <main id="content">
        
<div class="container"><aside>
    <div>
        
        
            
            
            <div class="post-category-icon"></div>
            <a href="/categories/kubernetes%e4%bb%8e%e4%b8%8a%e6%89%8b%e5%88%b0%e5%ae%9e%e8%b7%b5/">Kubernetesä»ä¸Šæ‰‹åˆ°å®è·µ</a>
            <ul>
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/01-%E5%BC%80%E7%AF%87-kubernetes-%E6%98%AF%E4%BB%80%E4%B9%88%E4%BB%A5%E5%8F%8A%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%AE%83/">01 å¼€ç¯‡ï¼š Kubernetes æ˜¯ä»€ä¹ˆä»¥åŠä¸ºä»€ä¹ˆéœ€è¦å®ƒ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/02-%E5%88%9D%E6%AD%A5%E8%AE%A4%E8%AF%86kubernetes-%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/">02 åˆæ­¥è®¤è¯†ï¼šKubernetes åŸºç¡€æ¦‚å¿µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/03-%E5%AE%8F%E8%A7%82%E8%AE%A4%E8%AF%86%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84/">03 å®è§‚è®¤è¯†ï¼šæ•´ä½“æ¶æ„</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/04-%E6%90%AD%E5%BB%BA-kubernetes-%E9%9B%86%E7%BE%A4-%E6%9C%AC%E5%9C%B0%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA/">04 æ­å»º Kubernetes é›†ç¾¤ - æœ¬åœ°å¿«é€Ÿæ­å»º</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/05-%E5%8A%A8%E6%89%8B%E5%AE%9E%E8%B7%B5%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA-kubernetes-%E9%9B%86%E7%BE%A4-%E7%94%9F%E4%BA%A7%E5%8F%AF%E7%94%A8/">05 åŠ¨æ‰‹å®è·µï¼šæ­å»ºä¸€ä¸ª Kubernetes é›†ç¾¤ - ç”Ÿäº§å¯ç”¨</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/06-%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E5%88%9D%E8%AF%86-kubectl/">06 é›†ç¾¤ç®¡ç†ï¼šåˆè¯† kubectl</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/07-%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E4%BB%A5-redis-%E4%B8%BA%E4%BE%8B-%E9%83%A8%E7%BD%B2%E5%8F%8A%E8%AE%BF%E9%97%AE/">07 é›†ç¾¤ç®¡ç†ï¼šä»¥ Redis ä¸ºä¾‹-éƒ¨ç½²åŠè®¿é—®</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/08-%E5%AE%89%E5%85%A8%E9%87%8D%E7%82%B9-%E8%AE%A4%E8%AF%81%E5%92%8C%E6%8E%88%E6%9D%83/">08 å®‰å…¨é‡ç‚¹ è®¤è¯å’Œæˆæƒ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/09-%E5%BA%94%E7%94%A8%E5%8F%91%E5%B8%83%E9%83%A8%E7%BD%B2%E5%AE%9E%E9%99%85%E9%A1%B9%E7%9B%AE/">09 åº”ç”¨å‘å¸ƒï¼šéƒ¨ç½²å®é™…é¡¹ç›®</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/10-%E5%BA%94%E7%94%A8%E7%AE%A1%E7%90%86%E5%88%9D%E8%AF%86-helm/">10 åº”ç”¨ç®¡ç†ï¼šåˆè¯† Helm</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/11-%E9%83%A8%E7%BD%B2%E5%AE%9E%E8%B7%B5%E4%BB%A5-helm-%E9%83%A8%E7%BD%B2%E9%A1%B9%E7%9B%AE/">11 éƒ¨ç½²å®è·µï¼šä»¥ Helm éƒ¨ç½²é¡¹ç›®</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/12-%E5%BA%96%E4%B8%81%E8%A7%A3%E7%89%9Bkube-apiserver/">12 åº–ä¸è§£ç‰›ï¼škube-apiserver</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/13-%E5%BA%96%E4%B8%81%E8%A7%A3%E7%89%9Betcd/">13 åº–ä¸è§£ç‰›ï¼šetcd</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/14-%E5%BA%96%E4%B8%81%E8%A7%A3%E7%89%9Bcontroller-manager/">14 åº–ä¸è§£ç‰›ï¼šcontroller-manager</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/15-%E5%BA%96%E4%B8%81%E8%A7%A3%E7%89%9Bkube-scheduler/">15 åº–ä¸è§£ç‰›ï¼škube-scheduler</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/16-%E5%BA%96%E4%B8%81%E8%A7%A3%E7%89%9Bkubelet/">16 åº–ä¸è§£ç‰›ï¼škubelet</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/17-%E5%BA%96%E4%B8%81%E8%A7%A3%E7%89%9Bkube-proxy/">17 åº–ä¸è§£ç‰›ï¼škube-proxy</a></li>
                
                
                
                    <li>18 åº–ä¸è§£ç‰›ï¼šContainer Runtime ï¼ˆDockerï¼‰</li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/19-troubleshoot/">19 Troubleshoot</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/20-%E6%89%A9%E5%B1%95%E5%A2%9E%E5%BC%BAdashboard/">20 æ‰©å±•å¢å¼ºï¼šDashboard</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/21-%E6%89%A9%E5%B1%95%E5%A2%9E%E5%BC%BAcoredns/">21 æ‰©å±•å¢å¼ºï¼šCoreDNS</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/22-%E6%9C%8D%E5%8A%A1%E5%A2%9E%E5%BC%BAingress/">22 æœåŠ¡å¢å¼ºï¼šIngress</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/23-%E7%9B%91%E6%8E%A7%E5%AE%9E%E8%B7%B5%E5%AF%B9-k8s-%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%E7%9B%91%E6%8E%A7/">23 ç›‘æ§å®è·µï¼šå¯¹ K8S é›†ç¾¤è¿›è¡Œç›‘æ§</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/24-%E6%80%BB%E7%BB%93/">24 æ€»ç»“</a></li>
                
                
            </ul>
        
    </div>
</aside>

<style>
    aside {
        position: fixed;
        left: 20px;
        background: #ffdee3;
        border-radius: 6px;
        padding: 20px;
        padding-top: 60px;
        box-shadow: 5px 10px #888;
        list-style-type: none;
        display: none;
    }

    .post-category-icon {
        position: absolute;
        width: 80px;
        height: 80px;
        top: -40px;
        left: 50%;
        margin-left: -40px;
        text-align: center;
        font-size: 36px;
        content: 'J';
        background: #ffdee3;
        border-radius: 100%;
        border: 10px solid #fff;
        box-shadow: 5px 10px #888;
    }
</style><article class="post-block">
        <h1 class="post-title">18 åº–ä¸è§£ç‰›ï¼šContainer Runtime ï¼ˆDockerï¼‰</h1>
        <div class="post-info">
            <div class="post-date"> 
                <span>2021-12-22 01:47:44</span>
            </div>
        </div>
        <div class="post-content">
            <h2 id="æ•´ä½“æ¦‚è§ˆ">æ•´ä½“æ¦‚è§ˆ</h2>
<p>æˆ‘ä»¬åœ¨ç¬¬ 3 èŠ‚çš„æ—¶å€™ï¼Œæåˆ°è¿‡ <code>Container Runtime</code> çš„æ¦‚å¿µï¼Œä¹Ÿå¤§è‡´ä»‹ç»è¿‡å®ƒçš„ä¸»è¦ä½œç”¨åœ¨äºä¸‹è½½é•œåƒï¼Œè¿è¡Œå®¹å™¨ç­‰ã€‚</p>
<p>ç»è¿‡æˆ‘ä»¬å‰é¢çš„å­¦ä¹ ï¼Œ<code>kube-scheduler</code> å†³å®šäº† <code>Pod</code> å°†è¢«è°ƒåº¦åˆ°å“ªä¸ª <code>Node</code> ä¸Šï¼Œè€Œ <code>kubelet</code> åˆ™è´Ÿè´£ <code>Pod</code> åœ¨æ­¤ <code>Node</code> ä¸Šå¯æŒ‰é¢„æœŸå·¥ä½œã€‚å¦‚æœæ²¡æœ‰ <code>Container Runtime</code>ï¼Œé‚£ <code>Pod</code> ä¸­çš„ <code>container</code> åœ¨è¯¥ <code>Node</code> ä¸Šä¹Ÿä¾¿æ— æ³•æ­£å¸¸å¯åŠ¨è¿è¡Œäº†ã€‚</p>
<p>æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä»¥å½“å‰æœ€ä¸ºé€šç”¨çš„ <code>Container Runtime</code> Docker ä¸ºä¾‹è¿›è¡Œä»‹ç»ã€‚</p>
<h2 id="container-runtime-æ˜¯ä»€ä¹ˆ">Container Runtime æ˜¯ä»€ä¹ˆ</h2>
<p><code>Container Runtime</code> æˆ‘ä»¬é€šå¸¸å«å®ƒå®¹å™¨è¿è¡Œæ—¶ï¼Œè€Œè¿™ä¸€æ¦‚å¿µçš„äº§ç”Ÿä¹Ÿæ˜¯ç”±äºå®¹å™¨åŒ–æŠ€æœ¯å’Œ K8S çš„å¤§åŠ›å‘å±•ï¼Œä¸ºäº†ç»Ÿä¸€å·¥ä¸šæ ‡å‡†ï¼Œä¹Ÿä¸ºäº†é¿å… K8S ç»‘å®šäºç‰¹å®šçš„å®¹å™¨è¿è¡Œæ—¶ï¼Œæ‰€ä»¥ä¾¿æˆç«‹äº† <a href="https://www.opencontainers.org/">Open Container Initiative (OCI)</a> ç»„ç»‡ï¼Œè‡´åŠ›äºå°†å®¹å™¨è¿è¡Œæ—¶æ ‡å‡†åŒ–å’Œå®¹å™¨é•œåƒæ ‡å‡†åŒ–ã€‚</p>
<p>å‡¡æ˜¯éµå®ˆæ­¤æ ‡å‡†çš„å®ç°ï¼Œå‡å¯ç”±æ ‡å‡†æ ¼å¼çš„é•œåƒå¯åŠ¨ç›¸åº”çš„å®¹å™¨ï¼Œå¹¶å®Œæˆä¸€äº›ç‰¹å®šçš„æ“ä½œã€‚</p>
<h2 id="docker-æ˜¯ä»€ä¹ˆ">Docker æ˜¯ä»€ä¹ˆ</h2>
<p>Docker æ˜¯ä¸€ä¸ªå®¹å™¨ç®¡ç†å¹³å°ï¼Œå®ƒæœ€åˆæ˜¯è¢«è®¾è®¡ç”¨äºå¿«é€Ÿåˆ›å»ºï¼Œå‘å¸ƒå’Œè¿è¡Œå®¹å™¨çš„å·¥å…·ï¼Œä¸è¿‡éšç€å®ƒçš„å‘å±•ï¼Œå…¶ä¸­é›†æˆäº†è¶Šæ¥è¶Šå¤šçš„åŠŸèƒ½ã€‚</p>
<p>Docker ä¹Ÿå¯ä»¥è¯´æ˜¯ä¸€ä¸ªåŒ…å«æ ‡å‡†å®¹å™¨è¿è¡Œæ—¶çš„å·¥å…·é›†ï¼Œå½“å‰ç‰ˆæœ¬ä¸­é»˜è®¤çš„ <code>runtime</code> ç§°ä¹‹ä¸º <code>runc</code>ã€‚ å…³äº <code>runc</code> ç›¸å…³çš„ä¸€äº›å†…å®¹å¯å‚è€ƒ<a href="http://moelove.info/2018/11/23/runc-1.0-rc6-%E5%8F%91%E5%B8%83%E4%B9%8B%E9%99%85/">æˆ‘ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« </a>ã€‚</p>
<p>å½“ç„¶ï¼Œè¿™é‡Œæåˆ°äº† <strong>é»˜è®¤çš„è¿è¡Œæ—¶</strong> é‚£ä¹Ÿå°±æ„å‘³ç€å®ƒå¯æ”¯æŒå…¶ä»–çš„è¿è¡Œæ—¶å®ç°ã€‚</p>
<h2 id="cri-æ˜¯ä»€ä¹ˆ">CRI æ˜¯ä»€ä¹ˆ</h2>
<p>è¯´åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±ä¼šå‘ç°ï¼ŒK8S ä½œä¸ºç›®å‰äº‘åŸç”ŸæŠ€æœ¯ä½“ç³»ä¸­æœ€é‡è¦çš„ä¸€ç¯ï¼Œä¸ºäº†è®©å®ƒæ›´æœ‰æ‰©å±•æ€§ï¼Œå½“ç„¶ä¹Ÿä¸ä¼šå°†è‡ªå·±å®Œå…¨å±€é™äºæŸä¸€ç§ç‰¹å®šçš„å®¹å™¨è¿è¡Œæ—¶ã€‚</p>
<p>è‡ª K8S 1.5 ï¼ˆ2016 å¹´ 11 æœˆï¼‰å¼€å§‹ï¼Œæ–°å¢äº†ä¸€ä¸ªå®¹å™¨è¿è¡Œæ—¶çš„æ’ä»¶ APIï¼Œå¹¶ç§°ä¹‹ä¸º <code>CRI</code> ï¼ˆContainer Runtime Interfaceï¼‰ï¼Œé€šè¿‡ <code>CRI</code> å¯ä»¥æ”¯æŒ <code>kubelet</code> ä½¿ç”¨ä¸åŒçš„å®¹å™¨è¿è¡Œæ—¶ï¼Œè€Œä¸éœ€è¦é‡æ–°ç¼–è¯‘ã€‚</p>
<p><code>CRI</code> ä¸»è¦æ˜¯åŸºäº gRPC å®ç°äº† <code>RuntimeService</code> å’Œ <code>ImageService</code> è¿™ä¸¤ä¸ªæœåŠ¡ï¼Œå¯ä»¥å‚è€ƒ <code>pkg/kubelet/apis/cri/runtime/v1alpha2/api.proto</code> ä¸­çš„ API å®šä¹‰ã€‚ç”±äºæœ¬èŠ‚ä¾§é‡äº <code>Container Runtime/Docker</code> è¿™é‡Œå°±ä¸å¯¹ <code>CRI</code> çš„å…·ä½“å®ç°è¿›è¡Œå±•å¼€äº†ã€‚</p>
<p>åªè¦ç»§ç»­å°† <code>kubelet</code> å½“ä½œ agent çš„è§’è‰²ï¼Œè€Œå®ƒä¸åŸºäº <code>CRI</code> å®ç°çš„ <code>CRI shim</code> æœåŠ¡è¿›è¡Œé€šä¿¡ç†è§£å³å¯ã€‚</p>
<h2 id="docker-å¦‚ä½•å·¥ä½œ">Docker å¦‚ä½•å·¥ä½œ</h2>
<p>è¿™é‡Œæˆ‘ä»¬ä¸»è¦ä»‹ç»åœ¨ K8S ä¸­ä¸€äº› Docker å¸¸è§çš„åŠ¨ä½œã€‚</p>
<h3 id="éƒ¨ç½²ä¸€ä¸ª-redis">éƒ¨ç½²ä¸€ä¸ª Redis</h3>
<pre tabindex="0"><code>master $ kubectl run redis --image=redis
deployment.apps/redis created
master $ kubectl get all
NAME                        READY     STATUS              RESTARTS   AGE
pod/redis-bb7894d65-7vsj8   0/1       ContainerCreating   0          6s

NAME                 TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE
service/kubernetes   ClusterIP   10.96.0.1    &lt;none&gt;        443/TCP   26m

NAME                    DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/redis   1         1         1            0           6s

NAME                              DESIRED   CURRENT   READY     AGE
replicaset.apps/redis-bb7894d65   1         1         0         6s
</code></pre><p>æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ <code>kubectl run</code> çš„æ–¹å¼éƒ¨ç½²äº†ä¸€ä¸ª Redis</p>
<h3 id="æŸ¥çœ‹è¯¦æƒ…">æŸ¥çœ‹è¯¦æƒ…</h3>
<pre tabindex="0"><code>master $ kubectl describe pod/redis-bb7894d65-7vsj8
Name:               redis-bb7894d65-7vsj8
Namespace:          default
Priority:           0
PriorityClassName:  &lt;none&gt;
Node:               node01/172.17.0.21
Start Time:         Sat, 15 Dec 2018 04:48:49 +0000
Labels:             pod-template-hash=663450821
                    run=redis
Annotations:        &lt;none&gt;
Status:             Running
IP:                 10.40.0.1
Controlled By:      ReplicaSet/redis-bb7894d65
Containers:
  redis:
    Container ID:   docker://ab87085456aca76825dd639bcde27160d9c2c84cac5388585bcc9ed3afda6522
    Image:          redis
    Image ID:       docker-pullable://redis@sha256:010a8bd5c6a9d469441aa35187d18c181e3195368bce309348b3ee639fce96e0
    Port:           &lt;none&gt;
    Host Port:      &lt;none&gt;
    State:          Running
      Started:      Sat, 15 Dec 2018 04:48:57 +0000
    Ready:          True
    Restart Count:  0
    Environment:    &lt;none&gt;
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from default-token-zxt27 (ro)
Conditions:
  Type              Status
  Initialized       True
  Ready             True
  ContainersReady   True
  PodScheduled      True
Volumes:
  default-token-zxt27:
    Type:        Secret (a volume populated by a Secret)
    SecretName:  default-token-zxt27
    Optional:    false
QoS Class:       BestEffort
Node-Selectors:  &lt;none&gt;
Tolerations:     node.kubernetes.io/not-ready:NoExecute for 300s
                 node.kubernetes.io/unreachable:NoExecute for 300s
Events:
  Type    Reason     Age   From               Message
  ----    ------     ----  ----               -------
  Normal  Scheduled  7m    default-scheduler  Successfully assigned default/redis-bb7894d65-7vsj8to node01
  Normal  Pulling    7m    kubelet, node01    pulling image &quot;redis&quot;
  Normal  Pulled     7m    kubelet, node01    Successfully pulled image &quot;redis&quot;
  Normal  Created    7m    kubelet, node01    Created container
  Normal  Started    7m    kubelet, node01    Started container
</code></pre><p>å¯ä»¥é€šè¿‡ <code>kubectl describe</code> æŸ¥çœ‹è¯¥ <code>Pod</code> çš„äº‹ä»¶è¯¦æƒ…ã€‚è¿™é‡Œä¸»è¦æœ‰å‡ ä¸ªé˜¶æ®µã€‚</p>
<h4 id="è°ƒåº¦">è°ƒåº¦</h4>
<pre tabindex="0"><code>Normal  Scheduled  7m    default-scheduler  Successfully assigned default/redis-bb7894d65-7vsj8to node01
</code></pre><p>åœ¨ç¬¬ 15 å°èŠ‚ <code>kube-scheduler</code> ä¸­æˆ‘ä»¬ä»‹ç»è¿‡ï¼Œé€šè¿‡ <code>kube-scheduler</code> å¯ä»¥å†³å®š <code>Pod</code> ä¼šè°ƒåº¦åˆ°å“ªä¸ª <code>Node</code>ã€‚æœ¬ä¾‹ä¸­ï¼Œ<code>redis-bb7894d65-7vsj8to</code> è¢«è°ƒåº¦åˆ°äº† <code>node01</code>ã€‚</p>
<h4 id="pull-é•œåƒ">pull é•œåƒ</h4>
<pre tabindex="0"><code>Normal  Pulling    7m    kubelet, node01    pulling image &quot;redis&quot;
Normal  Pulled     7m    kubelet, node01    Successfully pulled image &quot;redis&quot;
</code></pre><p>è¿™é‡Œ <code>kubelet</code> åŠè¯¥èŠ‚ç‚¹ä¸Šçš„ <code>Container Runtime</code> ï¼ˆDockerï¼‰å¼€å§‹å‘æŒ¥ä½œç”¨ï¼Œå…ˆæ‹‰å–é•œåƒã€‚å¦‚æœæ­¤åˆ»ä½ ç™»å½• <code>node01</code> çš„æœºå™¨ï¼Œæ‰§è¡Œ <code>docker pull redis</code> ä¾¿å¯åŒæ­¥çœ‹åˆ°æ‹‰å–è¿›åº¦ã€‚</p>
<h4 id="åˆ›å»ºé•œåƒå¹¶å¯åŠ¨">åˆ›å»ºé•œåƒå¹¶å¯åŠ¨</h4>
<pre tabindex="0"><code>Normal  Created    7m    kubelet, node01    Created container
Normal  Started    7m    kubelet, node01    Started container
</code></pre><p>æ‹‰å–é•œåƒå®Œæˆåï¼Œä¾¿ä¼šå¼€å§‹åˆ›å»ºå¹¶å¯åŠ¨è¯¥å®¹å™¨ï¼Œå¹¶è¿”å›ä»»åŠ¡ç»“æœã€‚æ­¤åˆ»ç™»å½• <code>node01</code> æœºå™¨ï¼Œä¾¿ä¼šçœ‹åˆ°å½“å‰åœ¨è¿è¡Œçš„å®¹å™¨äº†ã€‚</p>
<pre tabindex="0"><code>node01 $ docker ps |grep redis
ab87085456ac        redis@sha256:010a8bd5c6a9d469441aa35187d18c181e3195368bce309348b3ee639fce96e0  &quot;docker-entrypoint...&quot;   19 minutes ago      Up 19 minutes                           k8s_redis_redis-bb7894d65-7vsj8_default_b693b56c-0024-11e9-9bab-0242ac11000a_0
8f264abd82fe        k8s.gcr.io/pause:3.1  &quot;/pause&quot;                 19 minutes ago      Up 19 minutes                           k8s_POD_redis-bb7894d65-7vsj8_default_b693b56c-0024-11e9-9bab-0242ac11000a_0
</code></pre><h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>æœ¬èŠ‚æˆ‘ä»¬ä»‹ç»äº† <code>Container Runtime</code> çš„åŸºæœ¬æ¦‚å¿µï¼ŒåŠ K8S ä¸ºäº†èƒ½å¢åŠ æ‰©å±•æ€§ï¼Œæä¾›äº†ç»Ÿä¸€çš„ <code>CRI</code> æ’ä»¶æ¥å£ï¼Œå¯ç”¨äºæ”¯æŒå¤šç§å®¹å™¨è¿è¡Œæ—¶ã€‚</p>
<p>å½“å‰ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„æ˜¯ <a href="https://github.com/moby/moby/"><code>Docker</code></a>ï¼Œå½“å‰è¿˜æ”¯æŒçš„ä¸»è¦æœ‰ <a href="https://github.com/opencontainers/runc"><code>runc</code></a>ï¼Œ<a href="https://github.com/containerd/containerd"><code>Containerd</code></a>ï¼Œ<a href="https://github.com/hyperhq/runv"><code>runV</code></a> ä»¥åŠ <a href="https://github.com/rkt/rkt"><code>rkt</code></a> ç­‰ã€‚</p>
<p>ç”±äº Docker çš„çŸ¥è¯†ç‚¹å¾ˆå¤šï¼Œå…³äº Docker çš„å®è·µå’Œå†…éƒ¨åŸç†å¯å‚è€ƒæˆ‘ä¹‹å‰çš„ä¸€æ¬¡åˆ†äº« <a href="https://github.com/tao12345666333/slides/raw/master/2018.09.13-Tech-Talk-Time/Docker%E5%AE%9E%E6%88%98%E5%92%8C%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86-%E5%BC%A0%E6%99%8B%E6%B6%9B.pdf">Docker å®æˆ˜å’ŒåŸºæœ¬åŸç†</a>ã€‚</p>
<p>åœ¨ä½¿ç”¨ K8S æ—¶ï¼Œä¹Ÿæœ‰æä¸ªåˆ«æƒ…å†µéœ€è¦é€šè¿‡æ’æŸ¥ Docker çš„æ—¥å¿—æ¥åˆ†æé—®é¢˜ã€‚</p>
<p>è‡³æ­¤ï¼ŒK8S ä¸­ä¸»è¦çš„æ ¸å¿ƒç»„ä»¶æˆ‘ä»¬å·²ç»ä»‹ç»å®Œæ¯•ï¼Œä¸‹èŠ‚æˆ‘ä»¬ä¸»è¦é›†ä¸­äºåœ¨ K8S ç¯å¢ƒä¸­ï¼Œå¦‚ä½•å®šä½å’Œè§£å†³é—®é¢˜ï¼Œä»¥åŠç±»ä¼¼åˆšæ‰æåˆ°çš„éœ€è¦é€šè¿‡ Docker è¿›è¡Œæ’æŸ¥é—®é¢˜çš„æƒ…å†µã€‚</p>

        </div>
    </article>
</div>
<div class="division-line"></div>
<div class="others">
    <div>æ ‡ç­¾ï¼šğŸ·ï¸<a class="post-tag" href="/tags/kubernetes/">kubernetes</a>&nbsp;</div>
    <div>åˆ†ç±»ï¼š ğŸ“’<a class="post-category" href="/categories/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/">Kubernetesä»ä¸Šæ‰‹åˆ°å®è·µ</a>&nbsp; </div>
</div>

    </main>
    <footer>
        <div id="pagination">
            
<div class="paginator">
    <div class="prev">
        
        <a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/17-%E5%BA%96%E4%B8%81%E8%A7%A3%E7%89%9Bkube-proxy/"><span>17 åº–ä¸è§£ç‰›ï¼škube-proxy</span></a>
    </div>
    <div class="next">
        
        <a href="http://yipsen.github.io/documents/columns/kubernetes/kubernetes%E4%BB%8E%E4%B8%8A%E6%89%8B%E5%88%B0%E5%AE%9E%E8%B7%B5/19-troubleshoot/"><span>19 Troubleshoot</span></a>
    </div>
</div>

        </div>
        <div id="float">
            <ul class="float-button-bar">
    <li>
        <button class="float-button top" onclick="scrollToTop(this);">UP</button>
    </li>
    <li>
        <button class="float-button toggler" onclick="changeSkin(this);">DARK</button>
    </li>
</ul>
        </div>
        <div id="copyright" style="display: none;">
    
    
    <p>&copy; 2020 <a href="/"></a>, powered by Hugo and Qiao</p>
</div>
    </footer>
    
<script>
    const changeSkin = () => {
        document.getElementById('page').classList.toggle('night');
    }
    const scrollToTop = () => {
        window.scrollTo(0, 0);
    }
</script>
</body>

</html>