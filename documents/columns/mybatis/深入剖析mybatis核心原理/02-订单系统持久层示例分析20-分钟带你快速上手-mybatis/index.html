<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
<meta name="X-UA-Compatible" , content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<link rel="icon" type="image/png" href="/%20/favicon.png">

<title>02 è®¢å•ç³»ç»ŸæŒä¹…å±‚ç¤ºä¾‹åˆ†æï¼Œ20 åˆ†é’Ÿå¸¦ä½ å¿«é€Ÿä¸Šæ‰‹ MyBatis | Yipsen Ye</title>
<meta name="description" content="åœ¨å¼€å§‹æ·±å…¥åˆ†æ MyBatis æ ¸å¿ƒæ¶æ„ä»¥åŠå…·ä½“ä»£ç å®ç°ä¹‹å‰ï¼Œæˆ‘å…ˆé€šè¿‡ä¸€ä¸ªç¤ºä¾‹æ¥å¸®åŠ©ä½ å¿«é€Ÿäº†è§£ MyBatis ä¸­çš„å¸¸è§æ¦‚å¿µä»¥åŠå…¶åŸºç¡€ä½¿ç”¨æ–¹æ³•ã€‚
è¿™é‡Œæˆ‘ä¼šä»¥ä¸€ä¸ªç®€æ˜“è®¢å•ç³»ç»Ÿçš„æŒä¹…åŒ–å±‚ä¸ºä¾‹è¿›è¡Œè®²è§£ï¼Œæ•´ä½“çš„è®²è§£é€»è¾‘æ˜¯è¿™æ ·çš„ï¼š
 é¦–å…ˆä»‹ç»è®¢å•ç³»ç»Ÿ domain å±‚çš„è®¾è®¡ï¼Œäº†è§£å¦‚ä½•å°†ä¸šåŠ¡æ¦‚å¿µæŠ½è±¡æˆ Java ç±»ï¼› æ¥ä¸‹æ¥ä»‹ç»æ•°æ®åº“è¡¨çš„è®¾è®¡ï¼ŒåŒæ—¶è¯´æ˜å…³ç³»å‹çš„æ•°æ®åº“è¡¨ä¸é¢å‘å¯¹è±¡æ¨¡å‹çš„ç±»ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼› éšåä»‹ç»è®¢å•ç³»ç»Ÿçš„ DAO æ¥å£å±‚ï¼ŒDAO æ¥å£å±‚æ˜¯æ“ä½œæ•°æ®çš„æœ€å°åŒ–å•å…ƒï¼Œä¹Ÿæ˜¯è¯»å†™æ•°æ®åº“çš„åœ°åŸºï¼› æœ€åå†ç®€å•æä¾›äº†ä¸€ä¸ª Service å±‚å’Œæµ‹è¯•ç”¨ä¾‹ï¼Œç”¨æ¥æ£€æµ‹å‰é¢çš„ä»£ç å®ç°æ˜¯å¦èƒ½æ­£å¸¸å·¥ä½œã€‚  ç°åœ¨å‡ ä¹æ‰€æœ‰çš„ Java å·¥ç¨‹éƒ½ä¼šä½¿ç”¨ Maven æ¥ç®¡ç† jar åŒ…ä¾èµ–ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ª Maven é¡¹ç›®ï¼Œç„¶ååœ¨ pom.xml ä¸­æ·»åŠ å¦‚ä¸‹ jar ä¾èµ–ï¼Œè¿™äº› jar åŒ…éƒ½æ˜¯è®¢å•ç¤ºä¾‹ç³»ç»Ÿå¿…ä¸å¯å°‘çš„ä¾èµ–ï¼š
&amp;lt;dependencies&amp;gt;&amp;lt;!--MyBatisä¾èµ–--&amp;gt;&amp;lt;dependency&amp;gt;&amp;lt;groupId&amp;gt;org.mybatis&amp;lt;/groupId&amp;gt;&amp;lt;artifactId&amp;gt;mybatis&amp;lt;/artifactId&amp;gt;&amp;lt;version&amp;gt;3.5.6&amp;lt;/version&amp;gt;&amp;lt;/dependency&amp;gt;&amp;lt;!--MySQL JDBCä¾èµ–ï¼Œç”¨æ¥è¿æ¥æ•°æ®åº“--&amp;gt;&amp;lt;dependency&amp;gt;&amp;lt;groupId&amp;gt;mysql&amp;lt;/groupId&amp;gt;&amp;lt;artifactId&amp;gt;mysql-connector-java&amp;lt;/artifactId&amp;gt;&amp;lt;version&amp;gt;8.0.15&amp;lt;/version&amp;gt;&amp;lt;/dependency&amp;gt;&amp;lt;!--Guavaä¾èµ–--&amp;gt;&amp;lt;dependency&amp;gt;&amp;lt;groupId&amp;gt;com.google.guava&amp;lt;/groupId&amp;gt;&amp;lt;artifactId&amp;gt;guava&amp;lt;/artifactId&amp;gt;&amp;lt;version&amp;gt;19.0&amp;lt;/version&amp;gt;&amp;lt;/dependency&amp;gt;&amp;lt;!--Junitä¾èµ–ï¼Œç”¨æ¥æ‰§è¡Œå•å…ƒæµ‹è¯•--&amp;gt;&amp;lt;dependency&amp;gt;&amp;lt;groupId&amp;gt;junit&amp;lt;/groupId&amp;gt;&amp;lt;artifactId&amp;gt;junit&amp;lt;/artifactId&amp;gt;&amp;lt;version&amp;gt;4.10&amp;lt;/version&amp;gt;&amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt;&amp;lt;/dependency&amp;gt;&amp;lt;/dependencies&amp;gt;domain è®¾è®¡ åœ¨ä¸šåŠ¡ç³»ç»Ÿçš„å¼€å‘ä¸­ï¼Œdomain å±‚çš„ä¸»è¦ç›®çš„å°±æ˜¯å°†ä¸šåŠ¡ä¸Šçš„æ¦‚å¿µæŠ½è±¡æˆé¢å‘å¯¹è±¡æ¨¡å‹ä¸­çš„ç±»ï¼Œè¿™äº›ç±»æ˜¯ä¸šåŠ¡ç³»ç»Ÿè¿ä½œçš„åŸºç¡€ã€‚åœ¨æˆ‘ä»¬çš„ç®€æ˜“è®¢å•ç³»ç»Ÿä¸­ï¼Œæœ‰ç”¨æˆ·ã€åœ°å€ã€è®¢å•ã€è®¢å•æ¡ç›®å’Œå•†å“è¿™äº”ä¸ªæ ¸å¿ƒçš„æ¦‚å¿µã€‚
è®¢å•ç³»ç»Ÿä¸­ domain å±‚çš„è®¾è®¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š">
<meta name="author" content="">

<link rel="stylesheet" type="text/css" href="/styles/main.css">

</head>

<body id="page">
    <header>
        <div class="logo-link" style="width: 60px; color: #CA6924;">
    <a href="http://yipsen.github.io/">
        <img style="margin-bottom: -1rem;" src="/images/deer.svg" alt="logo">
        <span style="font-size: 0.5rem; color: #CA6924;">Yipsen Ye</span>
    </a>
</div>
<nav class="navbar justify-content-end">
    <ul class="nav-list">
        
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/posts/">æœ­è®°</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/collections/">é™„è¡¨</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/about/">å…³äº</a>
        </li>
        
    </ul>
</nav>
    </header>
    <main id="content">
        
<div class="container"><aside>
    <div>
        
        
            
            
            <div class="post-category-icon"></div>
            <a href="/categories/%e6%b7%b1%e5%85%a5%e5%89%96%e6%9e%90mybatis%e6%a0%b8%e5%bf%83%e5%8e%9f%e7%90%86/">æ·±å…¥å‰–æMyBatisæ ¸å¿ƒåŸç†</a>
            <ul>
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/00-%E5%BC%80%E7%AF%87%E8%AF%8D-%E9%A2%86%E7%95%A5-mybatis-%E8%AE%BE%E8%AE%A1%E6%80%9D%E7%BB%B4%E7%AA%81%E7%A0%B4%E6%8C%81%E4%B9%85%E5%8C%96%E6%8A%80%E6%9C%AF%E7%93%B6%E9%A2%88/">00 å¼€ç¯‡è¯ é¢†ç•¥ MyBatis è®¾è®¡æ€ç»´ï¼Œçªç ´æŒä¹…åŒ–æŠ€æœ¯ç“¶é¢ˆ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/01-%E5%B8%B8%E8%A7%81%E6%8C%81%E4%B9%85%E5%B1%82%E6%A1%86%E6%9E%B6%E8%B5%8F%E6%9E%90%E5%88%B0%E5%BA%95%E6%98%AF%E4%BB%80%E4%B9%88%E8%AE%A9%E4%BD%A0%E9%80%89%E6%8B%A9-mybatis/">01 å¸¸è§æŒä¹…å±‚æ¡†æ¶èµæï¼Œåˆ°åº•æ˜¯ä»€ä¹ˆè®©ä½ é€‰æ‹© MyBatisï¼Ÿ</a></li>
                
                
                
                    <li>02 è®¢å•ç³»ç»ŸæŒä¹…å±‚ç¤ºä¾‹åˆ†æï¼Œ20 åˆ†é’Ÿå¸¦ä½ å¿«é€Ÿä¸Šæ‰‹ MyBatis</li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/03-mybatis-%E6%BA%90%E7%A0%81%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E5%8F%8A%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84%E8%A7%A3%E6%9E%90/">03 MyBatis æºç ç¯å¢ƒæ­å»ºåŠæ•´ä½“æ¶æ„è§£æ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/04-mybatis-%E5%8F%8D%E5%B0%84%E5%B7%A5%E5%85%B7%E7%AE%B1%E5%B8%A6%E4%BD%A0%E9%A2%86%E7%95%A5%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84%E5%8F%8D%E5%B0%84%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF/">04 MyBatis åå°„å·¥å…·ç®±ï¼šå¸¦ä½ é¢†ç•¥ä¸ä¸€æ ·çš„åå°„è®¾è®¡æ€è·¯</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/05-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8B%E4%BD%93%E7%B3%BB%E4%B8%8E-java-%E7%B1%BB%E5%9E%8B%E4%BD%93%E7%B3%BB%E4%B9%8B%E9%97%B4%E7%9A%84%E7%88%B1%E6%81%A8%E6%83%85%E4%BB%87/">05 æ•°æ®åº“ç±»å‹ä½“ç³»ä¸ Java ç±»å‹ä½“ç³»ä¹‹é—´çš„â€œçˆ±æ¨æƒ…ä»‡â€</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/06-%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6%E5%8D%83%E5%8D%83%E4%B8%87mybatis-%E9%83%BD%E8%83%BD%E5%85%BC%E5%AE%B9%E7%9A%84%E7%A7%98%E5%AF%86%E6%98%AF%E4%BB%80%E4%B9%88/">06 æ—¥å¿—æ¡†æ¶åƒåƒä¸‡ï¼ŒMyBatis éƒ½èƒ½å…¼å®¹çš„ç§˜å¯†æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/07-%E6%B7%B1%E5%85%A5%E6%95%B0%E6%8D%AE%E6%BA%90%E5%92%8C%E4%BA%8B%E5%8A%A1%E6%8A%8A%E6%8F%A1%E6%8C%81%E4%B9%85%E5%8C%96%E6%A1%86%E6%9E%B6%E7%9A%84%E4%B8%A4%E4%B8%AA%E5%85%B3%E9%94%AE%E5%91%BD%E8%84%89/">07 æ·±å…¥æ•°æ®æºå’Œäº‹åŠ¡ï¼ŒæŠŠæ¡æŒä¹…åŒ–æ¡†æ¶çš„ä¸¤ä¸ªå…³é”®å‘½è„‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/08-mapper-%E6%96%87%E4%BB%B6%E4%B8%8E-java-%E6%8E%A5%E5%8F%A3%E7%9A%84%E4%BC%98%E9%9B%85%E6%98%A0%E5%B0%84%E4%B9%8B%E9%81%93/">08 Mapper æ–‡ä»¶ä¸ Java æ¥å£çš„ä¼˜é›…æ˜ å°„ä¹‹é“</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/09-%E5%9F%BA%E4%BA%8E-mybatis-%E7%BC%93%E5%AD%98%E5%88%86%E6%9E%90%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/">09 åŸºäº MyBatis ç¼“å­˜åˆ†æè£…é¥°å™¨æ¨¡å¼çš„æœ€ä½³å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/10-%E9%B8%9F%E7%9E%B0-mybatis-%E5%88%9D%E5%A7%8B%E5%8C%96%E6%8A%8A%E6%8F%A1-mybatis-%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E8%84%89%E7%BB%9C%E4%B8%8A/">10 é¸Ÿç° MyBatis åˆå§‹åŒ–ï¼ŒæŠŠæ¡ MyBatis å¯åŠ¨æµç¨‹è„‰ç»œï¼ˆä¸Šï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/11-%E9%B8%9F%E7%9E%B0-mybatis-%E5%88%9D%E5%A7%8B%E5%8C%96%E6%8A%8A%E6%8F%A1-mybatis-%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E8%84%89%E7%BB%9C%E4%B8%8B/">11 é¸Ÿç° MyBatis åˆå§‹åŒ–ï¼ŒæŠŠæ¡ MyBatis å¯åŠ¨æµç¨‹è„‰ç»œï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/12-%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90%E5%8A%A8%E6%80%81-sql-%E8%AF%AD%E5%8F%A5%E8%A7%A3%E6%9E%90%E5%85%A8%E6%B5%81%E7%A8%8B%E4%B8%8A/">12 æ·±å…¥åˆ†æåŠ¨æ€ SQL è¯­å¥è§£æå…¨æµç¨‹ï¼ˆä¸Šï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/13-%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90%E5%8A%A8%E6%80%81-sql-%E8%AF%AD%E5%8F%A5%E8%A7%A3%E6%9E%90%E5%85%A8%E6%B5%81%E7%A8%8B%E4%B8%8B/">13 æ·±å…¥åˆ†æåŠ¨æ€ SQL è¯­å¥è§£æå…¨æµç¨‹ï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/14-%E6%8E%A2%E7%A9%B6-mybatis-%E7%BB%93%E6%9E%9C%E9%9B%86%E6%98%A0%E5%B0%84%E6%9C%BA%E5%88%B6%E8%83%8C%E5%90%8E%E7%9A%84%E7%A7%98%E5%AF%86%E4%B8%8A/">14 æ¢ç©¶ MyBatis ç»“æœé›†æ˜ å°„æœºåˆ¶èƒŒåçš„ç§˜å¯†ï¼ˆä¸Šï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/15-%E6%8E%A2%E7%A9%B6-mybatis-%E7%BB%93%E6%9E%9C%E9%9B%86%E6%98%A0%E5%B0%84%E6%9C%BA%E5%88%B6%E8%83%8C%E5%90%8E%E7%9A%84%E7%A7%98%E5%AF%86%E4%B8%8B/">15 æ¢ç©¶ MyBatis ç»“æœé›†æ˜ å°„æœºåˆ¶èƒŒåçš„ç§˜å¯†ï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/16-statementhandler%E5%8F%82%E6%95%B0%E7%BB%91%E5%AE%9Asql-%E6%89%A7%E8%A1%8C%E5%92%8C%E7%BB%93%E6%9E%9C%E6%98%A0%E5%B0%84%E7%9A%84%E5%A5%A0%E5%9F%BA%E8%80%85/">16 StatementHandlerï¼šå‚æ•°ç»‘å®šã€SQL æ‰§è¡Œå’Œç»“æœæ˜ å°„çš„å¥ åŸºè€…</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/17-executor-%E6%89%8D%E6%98%AF%E6%89%A7%E8%A1%8C-sql-%E8%AF%AD%E5%8F%A5%E7%9A%84%E5%B9%95%E5%90%8E%E6%8E%A8%E6%89%8B%E4%B8%8A/">17 Executor æ‰æ˜¯æ‰§è¡Œ SQL è¯­å¥çš„å¹•åæ¨æ‰‹ï¼ˆä¸Šï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/18-executor-%E6%89%8D%E6%98%AF%E6%89%A7%E8%A1%8C-sql-%E8%AF%AD%E5%8F%A5%E7%9A%84%E5%B9%95%E5%90%8E%E6%8E%A8%E6%89%8B%E4%B8%8B/">18 Executor æ‰æ˜¯æ‰§è¡Œ SQL è¯­å¥çš„å¹•åæ¨æ‰‹ï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/19-%E6%B7%B1%E5%85%A5-mybatis-%E5%86%85%E6%A0%B8%E4%B8%8E%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E7%9A%84%E6%A1%A5%E6%A2%81%E6%8E%A5%E5%8F%A3%E5%B1%82/">19 æ·±å…¥ MyBatis å†…æ ¸ä¸ä¸šåŠ¡é€»è¾‘çš„æ¡¥æ¢â€”â€”æ¥å£å±‚</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/20-%E6%8F%92%E4%BB%B6%E4%BD%93%E7%B3%BB%E8%AE%A9-mybatis-%E4%B8%96%E7%95%8C%E6%9B%B4%E5%8A%A0%E7%B2%BE%E5%BD%A9/">20 æ’ä»¶ä½“ç³»è®© MyBatis ä¸–ç•Œæ›´åŠ ç²¾å½©</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/21-%E6%B7%B1%E6%8C%96-mybatis-%E4%B8%8E-spring-%E9%9B%86%E6%88%90%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/">21 æ·±æŒ– MyBatis ä¸ Spring é›†æˆåº•å±‚åŸç†</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/22-%E5%9F%BA%E4%BA%8E-mybatis-%E7%9A%84%E8%A1%8D%E7%94%9F%E6%A1%86%E6%9E%B6%E4%B8%80%E8%A7%88/">22 åŸºäº MyBatis çš„è¡ç”Ÿæ¡†æ¶ä¸€è§ˆ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/23-%E7%BB%93%E6%9D%9F%E8%AF%AD-%E4%BC%9A%E4%BD%BF%E7%94%A8%E5%8F%AA%E8%83%BD%E9%BB%98%E9%BB%98%E6%90%AC%E7%A0%96%E6%87%82%E5%8E%9F%E7%90%86%E6%89%8D%E8%83%BD%E5%BF%AB%E9%80%9F%E6%99%8B%E5%8D%87/">23 ç»“æŸè¯­ ä¼šä½¿ç”¨åªèƒ½é»˜é»˜â€œæ¬ç –â€ï¼Œæ‡‚åŸç†æ‰èƒ½å¿«é€Ÿæ™‹å‡</a></li>
                
                
            </ul>
        
    </div>
</aside>

<style>
    aside {
        position: fixed;
        left: 20px;
        background: #ffdee3;
        border-radius: 6px;
        padding: 20px;
        padding-top: 60px;
        box-shadow: 5px 10px #888;
        list-style-type: none;
        display: none;
    }

    .post-category-icon {
        position: absolute;
        width: 80px;
        height: 80px;
        top: -40px;
        left: 50%;
        margin-left: -40px;
        text-align: center;
        font-size: 36px;
        content: 'J';
        background: #ffdee3;
        border-radius: 100%;
        border: 10px solid #fff;
        box-shadow: 5px 10px #888;
    }
</style><article class="post-block">
        <h1 class="post-title">02 è®¢å•ç³»ç»ŸæŒä¹…å±‚ç¤ºä¾‹åˆ†æï¼Œ20 åˆ†é’Ÿå¸¦ä½ å¿«é€Ÿä¸Šæ‰‹ MyBatis</h1>
        <div class="post-info">
            <div> 
                <span class="post-date">ğŸ“…&nbsp;2021-12-22 01:51:04</span>ğŸ·ï¸&nbsp;<a class="post-tag" href="/tags/mybatis/">mybatis</a></div><div class="post-category">
                
                ğŸ“š&nbsp;<a href="/categories/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/">æ·±å…¥å‰–æMyBatisæ ¸å¿ƒåŸç†</a>
                
            </div></div>
        <div class="post-content">
            <p>åœ¨å¼€å§‹æ·±å…¥åˆ†æ MyBatis æ ¸å¿ƒæ¶æ„ä»¥åŠå…·ä½“ä»£ç å®ç°ä¹‹å‰ï¼Œæˆ‘å…ˆé€šè¿‡ä¸€ä¸ªç¤ºä¾‹æ¥å¸®åŠ©ä½ å¿«é€Ÿäº†è§£ MyBatis ä¸­çš„å¸¸è§æ¦‚å¿µä»¥åŠå…¶åŸºç¡€ä½¿ç”¨æ–¹æ³•ã€‚</p>
<p>è¿™é‡Œæˆ‘ä¼šä»¥<strong>ä¸€ä¸ªç®€æ˜“è®¢å•ç³»ç»Ÿçš„æŒä¹…åŒ–å±‚</strong>ä¸ºä¾‹è¿›è¡Œè®²è§£ï¼Œæ•´ä½“çš„è®²è§£é€»è¾‘æ˜¯è¿™æ ·çš„ï¼š</p>
<ul>
<li>é¦–å…ˆä»‹ç»è®¢å•ç³»ç»Ÿ domain å±‚çš„è®¾è®¡ï¼Œäº†è§£å¦‚ä½•å°†ä¸šåŠ¡æ¦‚å¿µæŠ½è±¡æˆ Java ç±»ï¼›</li>
<li>æ¥ä¸‹æ¥ä»‹ç»æ•°æ®åº“è¡¨çš„è®¾è®¡ï¼ŒåŒæ—¶è¯´æ˜å…³ç³»å‹çš„æ•°æ®åº“è¡¨ä¸é¢å‘å¯¹è±¡æ¨¡å‹çš„ç±»ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼›</li>
<li>éšåä»‹ç»è®¢å•ç³»ç»Ÿçš„ DAO æ¥å£å±‚ï¼ŒDAO æ¥å£å±‚æ˜¯æ“ä½œæ•°æ®çš„æœ€å°åŒ–å•å…ƒï¼Œä¹Ÿæ˜¯è¯»å†™æ•°æ®åº“çš„åœ°åŸºï¼›</li>
<li>æœ€åå†ç®€å•æä¾›äº†ä¸€ä¸ª Service å±‚å’Œæµ‹è¯•ç”¨ä¾‹ï¼Œç”¨æ¥æ£€æµ‹å‰é¢çš„ä»£ç å®ç°æ˜¯å¦èƒ½æ­£å¸¸å·¥ä½œã€‚</li>
</ul>
<p>ç°åœ¨<strong>å‡ ä¹æ‰€æœ‰çš„ Java å·¥ç¨‹éƒ½ä¼šä½¿ç”¨ Maven æ¥ç®¡ç† jar åŒ…ä¾èµ–</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ª Maven é¡¹ç›®ï¼Œç„¶ååœ¨ pom.xml ä¸­æ·»åŠ å¦‚ä¸‹ jar ä¾èµ–ï¼Œè¿™äº› jar åŒ…éƒ½æ˜¯è®¢å•ç¤ºä¾‹ç³»ç»Ÿå¿…ä¸å¯å°‘çš„ä¾èµ–ï¼š</p>
<pre tabindex="0"><code>&lt;dependencies&gt;

  &lt;!--MyBatisä¾èµ–--&gt;

  &lt;dependency&gt;

      &lt;groupId&gt;org.mybatis&lt;/groupId&gt;

      &lt;artifactId&gt;mybatis&lt;/artifactId&gt;

      &lt;version&gt;3.5.6&lt;/version&gt;

  &lt;/dependency&gt;

  &lt;!--MySQL JDBCä¾èµ–ï¼Œç”¨æ¥è¿æ¥æ•°æ®åº“--&gt;

  &lt;dependency&gt;

      &lt;groupId&gt;mysql&lt;/groupId&gt;

      &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;

      &lt;version&gt;8.0.15&lt;/version&gt;

  &lt;/dependency&gt;

  &lt;!--Guavaä¾èµ–--&gt;

  &lt;dependency&gt;

      &lt;groupId&gt;com.google.guava&lt;/groupId&gt;

      &lt;artifactId&gt;guava&lt;/artifactId&gt;

      &lt;version&gt;19.0&lt;/version&gt;

  &lt;/dependency&gt;

  &lt;!--Junitä¾èµ–ï¼Œç”¨æ¥æ‰§è¡Œå•å…ƒæµ‹è¯•--&gt;

  &lt;dependency&gt;

      &lt;groupId&gt;junit&lt;/groupId&gt;

      &lt;artifactId&gt;junit&lt;/artifactId&gt;

      &lt;version&gt;4.10&lt;/version&gt;

      &lt;scope&gt;test&lt;/scope&gt;

  &lt;/dependency&gt;

&lt;/dependencies&gt;
</code></pre><h3 id="domain-è®¾è®¡">domain è®¾è®¡</h3>
<p>åœ¨ä¸šåŠ¡ç³»ç»Ÿçš„å¼€å‘ä¸­ï¼Œ<strong>domain å±‚çš„ä¸»è¦ç›®çš„å°±æ˜¯å°†ä¸šåŠ¡ä¸Šçš„æ¦‚å¿µæŠ½è±¡æˆé¢å‘å¯¹è±¡æ¨¡å‹ä¸­çš„ç±»</strong>ï¼Œè¿™äº›ç±»æ˜¯ä¸šåŠ¡ç³»ç»Ÿè¿ä½œçš„åŸºç¡€ã€‚åœ¨æˆ‘ä»¬çš„ç®€æ˜“è®¢å•ç³»ç»Ÿä¸­ï¼Œæœ‰ç”¨æˆ·ã€åœ°å€ã€è®¢å•ã€è®¢å•æ¡ç›®å’Œå•†å“è¿™äº”ä¸ªæ ¸å¿ƒçš„æ¦‚å¿µã€‚</p>
<p>è®¢å•ç³»ç»Ÿä¸­ domain å±‚çš„è®¾è®¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90%20MyBatis%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86-%E5%AE%8C/assets/CgqCHmAJK4eAXeXQAACJoVb_GUk600.png" alt="Drawing 0.png"></p>
<p>ç®€æ˜“è®¢å•ç³»ç»Ÿ domain å±‚è®¾è®¡å›¾</p>
<p>åœ¨ä¸Šå›¾ä¸­ï¼Œ<strong>Customer ç±»æŠ½è±¡çš„æ˜¯ç”µå•†å¹³å°ä¸­çš„ç”¨æˆ·</strong>ï¼Œå…¶ä¸­è®°å½•äº†ç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ï¼ˆid å­—æ®µï¼‰ã€å§“åï¼ˆname å­—æ®µï¼‰ä»¥åŠæ‰‹æœºå·ï¼ˆphone å­—æ®µï¼‰ï¼Œå¦å¤–ï¼Œè¿˜è®°å½•äº†å½“å‰ç”¨æˆ·æ·»åŠ çš„å…¨éƒ¨é€è´§åœ°å€ã€‚</p>
<p><strong>Address ç±»æŠ½è±¡äº†ç”¨æˆ·çš„é€è´§åœ°å€</strong>ï¼Œå…¶ä¸­è®°å½•äº†è¡—é“ï¼ˆstreet å­—æ®µï¼‰ã€åŸå¸‚ï¼ˆcity å­—æ®µï¼‰ã€å›½å®¶ï¼ˆcountry å­—æ®µï¼‰ç­‰ä¿¡æ¯ï¼Œè¿˜ç»´æŠ¤äº†ä¸€ä¸ª Customer ç±»å‹çš„å¼•ç”¨ï¼ŒæŒ‡å‘æ‰€å±çš„ç”¨æˆ·ã€‚</p>
<p><strong>Order ç±»æŠ½è±¡çš„æ˜¯ç”µå•†å¹³å°ä¸­çš„è®¢å•</strong>ï¼Œè®°å½•äº†è®¢å•çš„å”¯ä¸€æ ‡è¯†ï¼ˆid å­—æ®µï¼‰ã€è®¢å•åˆ›å»ºæ—¶é—´ï¼ˆcreateTime å­—æ®µï¼‰ï¼Œå…¶ä¸­é€šè¿‡ customer å­—æ®µï¼ˆCustomer ç±»å‹ï¼‰æŒ‡å‘äº†è®¢å•å…³è”çš„ç”¨æˆ·ï¼Œé€šè¿‡ deliveryAddress å­—æ®µï¼ˆAddress ç±»å‹ï¼‰æŒ‡å‘äº†è¯¥è®¢å•çš„é€è´§åœ°å€ã€‚å¦å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ orderItems é›†åˆï¼ˆList é›†åˆï¼‰è®°å½•è®¢å•å†…çš„å…·ä½“æ¡ç›®ã€‚</p>
<p><strong>OrderItem ç±»æŠ½è±¡äº†è®¢å•ä¸­çš„è´­ç‰©æ¡ç›®</strong>ï¼Œè®°å½•äº†è´­ç‰©æ¡ç›®çš„å”¯ä¸€æ ‡è¯†ï¼ˆid å­—æ®µï¼‰ï¼Œå…¶ä¸­ product å­—æ®µï¼ˆProduct ç±»å‹ï¼‰æŒ‡å‘äº†è¯¥è´­ç‰©æ¡ç›®ä¸­å…·ä½“è´­ä¹°çš„å•†å“ï¼Œamount å­—æ®µè®°å½•è´­ä¹°å•†å“çš„ä¸ªæ•°ï¼Œprice å­—æ®µåˆ™æ˜¯è¯¥ OrderItem çš„æ€»é‡‘é¢ï¼ˆå³ Product.price * amountï¼‰ï¼ŒOrder è®¢å•çš„æ€»ä»·æ ¼ï¼ˆtotalPrice å­—æ®µï¼‰åˆ™æ˜¯ç”±å…¶ä¸­å…¨éƒ¨ OrderItem çš„ price ç´¯åŠ å¾—åˆ°çš„ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„ OrderItem æ€»é‡‘é¢ä»¥åŠ Order æ€»é‡‘é¢ï¼Œéƒ½ä¸ä¼šæŒä¹…åŒ–åˆ°æ•°æ®ï¼Œè€Œæ˜¯å®æ—¶è®¡ç®—å¾—åˆ°çš„ã€‚</p>
<p><strong>Product ç±»æŠ½è±¡äº†ç”µå•†å¹³å°ä¸­å•†å“çš„æ¦‚å¿µ</strong>ï¼Œå…¶ä¸­è®°å½•äº†å•†å“çš„å”¯ä¸€æ ‡è¯†ï¼ˆid å­—æ®µï¼‰ã€å•†å“åç§°ï¼ˆname å­—æ®µï¼‰ã€å•†å“æè¿°ï¼ˆdescription å­—æ®µï¼‰ä»¥åŠå•†å“ä»·æ ¼ï¼ˆprice å­—æ®µï¼‰ã€‚</p>
<p>ç»“åˆå‰é¢çš„ä»‹ç»ä»¥åŠç±»å›¾åˆ†æï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼š</p>
<ul>
<li>é€šè¿‡ Customer.addresses ä»¥åŠ Address.customer è¿™ä¸¤ä¸ªå±æ€§ï¼Œç»´æŠ¤äº† Customer ä¸ Address ä¹‹é—´<strong>ä¸€å¯¹å¤š</strong>å…³ç³»ï¼›</li>
<li>é€šè¿‡ Order.customer å±æ€§ï¼Œç»´æŠ¤äº† Customer ä¸ Order ä¹‹é—´çš„<strong>ä¸€å¯¹å¤š</strong>å…³ç³»ï¼›</li>
<li>é€šè¿‡ Order.deliveryAddress å±æ€§ï¼Œç»´æŠ¤äº† Order ä¸ Address ä¹‹é—´çš„<strong>ä¸€å¯¹ä¸€</strong>å…³ç³»ï¼›</li>
<li>é€šè¿‡ OrderItem.orderId å±æ€§ï¼Œç»´æŠ¤äº† Order ä¸ OrderItem ä¹‹é—´çš„<strong>ä¸€å¯¹å¤š</strong>å…³ç³»ï¼›</li>
<li>é€šè¿‡ OrderItem.product å±æ€§ï¼Œç»´æŠ¤äº† OrderItem ä¸ Product ä¹‹é—´çš„<strong>ä¸€å¯¹ä¸€</strong>å…³ç³»ã€‚</li>
</ul>
<h3 id="æ•°æ®åº“è¡¨è®¾è®¡">æ•°æ®åº“è¡¨è®¾è®¡</h3>
<p>ä»‹ç»å®Œ domain å±‚çš„è®¾è®¡ï¼Œä¸‹é¢æˆ‘ä»¬å†æ¥çœ‹å¯¹åº”çš„æ•°æ®åº“è¡¨è®¾è®¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90%20MyBatis%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86-%E5%AE%8C/assets/CgqCHmAJK5mAIH-vAAB6RUBTHlw421.png" alt="Drawing 1.png"></p>
<p>ç®€æ˜“è®¢å•ç³»ç»Ÿæ•°æ®åº“è¡¨è®¾è®¡</p>
<p>ä¸å‰é¢çš„domain å±‚è®¾è®¡å›¾ç›¸æ¯”ï¼Œå…¶ä¸­çš„å„é¡¹æ˜¯å¯ä»¥ä¸€ä¸€å¯¹åº”èµ·æ¥çš„ã€‚</p>
<ul>
<li>t_customer è¡¨å¯¹åº” Customer ç±»ï¼Œt_product è¡¨å¯¹åº” Product ç±»ã€‚</li>
<li>t_address è¡¨å¯¹åº” Address ç±»ï¼Œå…¶ä¸­ customer_id åˆ—ä½œä¸ºå¤–é”®æŒ‡å‘ t_customer.idï¼Œå®ç°äº† Customer ä¸ Address çš„ä¸€å¯¹å¤šå…³ç³»ã€‚</li>
<li>t_order_item è¡¨å¯¹åº” OrderItem ç±»ï¼Œå…¶ä¸­ product_id åˆ—ä½œä¸ºå¤–é”®æŒ‡å‘ t_product.idï¼Œå®ç°äº† OrderItem ä¸ Product çš„ä¸€å¯¹ä¸€å…³ç³»ï¼›order_id åˆ—ä½œä¸ºå¤–é”®æŒ‡å‘ t_order.idï¼Œå®ç°äº† Order ä¸ OrderItem çš„ä¸€å¯¹å¤šå…³ç³»ã€‚</li>
<li>t_order è¡¨å¯¹åº” Order ç±»ï¼Œå…¶ä¸­çš„ customer_id åˆ—æŒ‡å‘ t_customer.idï¼Œå®ç°äº† Customer ä¸ Order çš„ä¸€å¯¹å¤šå…³ç³»ï¼›address_id åˆ—æŒ‡å‘ t_address.idï¼Œå®ç°äº† Order ä¸ Address çš„ä¸€å¯¹ä¸€å…³ç³»ã€‚</li>
</ul>
<p>ä¸Šè¿°è¡¨ä¸­çš„å…¶ä»–å­—æ®µä¸ domain å±‚ä¸­å¯¹åº”ç±»ä¸­çš„å­—æ®µä¹Ÿæ˜¯ä¸€ä¸€å¯¹åº”ï¼Œè¿™é‡Œå°±ä¸å†é‡å¤äº†ã€‚</p>
<h3 id="dao-å±‚">DAO å±‚</h3>
<p><strong>DAO å±‚ä¸»è¦æ˜¯è´Ÿè´£ä¸æŒä¹…åŒ–å­˜å‚¨è¿›è¡Œäº¤äº’ï¼Œå®Œæˆæ•°æ®æŒä¹…åŒ–çš„ç›¸å…³å·¥ä½œ</strong>ï¼Œè¿™é‡Œæˆ‘ä»¬å°±ä»‹ç»ä¸€ä¸‹ å¦‚ä½•ä½¿ç”¨ MyBatis æ¥å¼€å‘ Java åº”ç”¨ä¸­çš„æŒä¹…å±‚ã€‚</p>
<p>åœ¨ DAO å±‚ä¸­ï¼Œéœ€è¦å…ˆæ ¹æ®éœ€æ±‚ç¡®å®š DAO å±‚çš„åŸºæœ¬èƒ½åŠ›ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ˜¯é’ˆå¯¹æ¯ä¸ª domain ç±»æä¾›æœ€åŸºç¡€çš„ CRUD æ“ä½œï¼Œä¹‹ååœ¨ DAO å±‚ä¹‹ä¸Šçš„ Service å±‚ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ DAO å±‚çš„æ¥å£ï¼Œè€Œæ— é¡»å…³å¿ƒåº•å±‚ä½¿ç”¨çš„æ˜¯æ•°æ®åº“è¿˜æ˜¯å…¶ä»–å­˜å‚¨ï¼Œä¹Ÿæ— é¡»å…³å¿ƒè¯»å†™æ•°æ®ä½¿ç”¨çš„æ˜¯ SQL è¯­å¥è¿˜æ˜¯å…¶ä»–æŸ¥è¯¢è¯­å¥ï¼Œè¿™å°±èƒ½å¤Ÿå®ç°ä¸šåŠ¡é€»è¾‘å’Œå­˜å‚¨çš„è§£è€¦ã€‚</p>
<h4 id="1-dao-æ¥å£ä¸å®ç°">1. DAO æ¥å£ä¸å®ç°</h4>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬å¼€å§‹ä»‹ç»ç®€æ˜“è®¢å•ç³»ç»Ÿä¸­ DAO æ¥å£çš„å†…å®¹ã€‚</p>
<p>é¦–å…ˆæ˜¯ CustomerMapper æ¥å£ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>public interface CustomerMapper {

    // æ ¹æ®ç”¨æˆ·IdæŸ¥è¯¢Customer(ä¸æŸ¥è¯¢Address)

    Customer find(long id);

    // æ ¹æ®ç”¨æˆ·IdæŸ¥è¯¢Customer(åŒæ—¶æŸ¥è¯¢Address)

    Customer findWithAddress(long id);

    // æ ¹æ®orderIdæŸ¥è¯¢Customer

    Customer findByOrderId(long orderId);

    // æŒä¹…åŒ–Customerå¯¹è±¡

    int save(Customer customer);

}
</code></pre><p>å®šä¹‰å®Œ CustomerMapper æ¥å£ä¹‹åï¼Œæˆ‘ä»¬<strong>æ— é¡»çœŸæ­£å®ç° CustomerMapper æ¥å£ï¼Œè€Œæ˜¯åœ¨ /resources/mapper ç›®å½•ä¸‹é…ç½®ç›¸åº”çš„é…ç½®æ–‡ä»¶â€”â€” CustomerMapper.xmlï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­å®šä¹‰éœ€è¦æ‰§è¡Œçš„ SQL è¯­å¥ä»¥åŠæŸ¥è¯¢ç»“æœé›†çš„æ˜ å°„è§„åˆ™</strong>ã€‚MyBatis åº•å±‚ä¼šç”Ÿæˆä¸€ä¸ªå®ç°äº† CustomerMapper æ¥å£çš„ä»£ç†å¯¹è±¡æ¥æ‰§è¡Œ CustomerMapper.xml é…ç½®æ–‡ä»¶ä¸­çš„ SQL è¯­å¥ï¼Œå®ç° DAO å±‚çš„åŠŸèƒ½ï¼ˆMyBatis å¦‚ä½•ç”Ÿæˆä»£ç†å¯¹è±¡ç­‰åº•å±‚åŸç†åœ¨æœ¬è¯¾ç¨‹åé¢ä¼šæ·±å…¥åˆ†æï¼Œè¿™é‡Œå°±å…ˆä»‹ç»è¯¥ç¤ºä¾‹ç³»ç»Ÿçš„ç›¸å…³å†…å®¹ï¼‰ã€‚</p>
<p>CustomerMapper.xml çš„å…·ä½“å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>&lt;mapper namespace=&quot;org.example.dao.CustomerMapper&quot;&gt;

    &lt;!-- å®šä¹‰æ˜ å°„è§„åˆ™ --&gt;

    &lt;resultMap id=&quot;customerSimpleMap&quot; type=&quot;Customer&quot;&gt;

        &lt;!--  ä¸»é”®æ˜ å°„ --&gt;

        &lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;

        &lt;!--  å±æ€§æ˜ å°„ --&gt;

        &lt;result property=&quot;name&quot; column=&quot;name&quot;/&gt;

        &lt;result property=&quot;phone&quot; column=&quot;phone&quot;/&gt;

    &lt;/resultMap&gt;

    &lt;!-- å®šä¹‰æ˜ å°„è§„åˆ™ --&gt;

    &lt;resultMap id=&quot;customerMap&quot; type=&quot;Customer&quot;&gt;

        &lt;!--  ä¸»é”®æ˜ å°„ --&gt;

        &lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;

        &lt;!--  å±æ€§æ˜ å°„ --&gt;

        &lt;result property=&quot;name&quot; column=&quot;name&quot;/&gt;

        &lt;result property=&quot;phone&quot; column=&quot;phone&quot;/&gt;

        &lt;!-- æ˜ å°„addressesé›†åˆï¼Œ&lt;collection&gt;æ ‡ç­¾ç”¨äºæ˜ å°„é›†åˆç±»çš„å±æ€§ï¼Œå®ç°ä¸€å¯¹å¤šçš„å…³è”å…³ç³» --&gt;

        &lt;collection property=&quot;addresses&quot; javaType=&quot;list&quot; ofType=&quot;Address&quot;&gt;

            &lt;id property=&quot;id&quot; column=&quot;address_id&quot;/&gt;

            &lt;result property=&quot;street&quot; column=&quot;street&quot;/&gt;

            &lt;result property=&quot;city&quot; column=&quot;city&quot;/&gt;

            &lt;result property=&quot;country&quot; column=&quot;country&quot;/&gt;

        &lt;/collection&gt;

    &lt;/resultMap&gt;

    &lt;!-- å®šä¹‰selectè¯­å¥ï¼ŒCustomerMapperæ¥å£ä¸­çš„find()æ–¹æ³•ä¼šæ‰§è¡Œè¯¥SQLï¼Œ

        æŸ¥è¯¢ç»“æœé€šè¿‡customerSimpleMapè¿™ä¸ªæ˜ å°„ç”ŸæˆCustomerå¯¹è±¡--&gt;

    &lt;select id=&quot;find&quot; resultMap=&quot;customerSimpleMap&quot;&gt;

        SELECT * FROM t_customer WHERE id = #{id:INTEGER}

    &lt;/select&gt;

    &lt;!-- å®šä¹‰selectè¯­å¥ï¼ŒCustomerMapperæ¥å£ä¸­çš„findWithAddress()æ–¹æ³•ä¼šæ‰§è¡Œè¯¥SQLï¼Œ

        æŸ¥è¯¢ç»“æœé€šè¿‡customerMapè¿™ä¸ªæ˜ å°„ç”ŸæˆCustomerå¯¹è±¡--&gt;

    &lt;select id=&quot;findWithAddress&quot; resultMap=&quot;customerMap&quot;&gt;

        SELECT c.*,a.id as address_id, a.* FROM t_customer as c join t_address as a

        on c.id = a.customer_id

        WHERE c.id = #{id:INTEGER}

    &lt;/select&gt;

    &lt;!-- CustomerMapperæ¥å£ä¸­çš„findByOrderId()æ–¹æ³•ä¼šæ‰§è¡Œè¯¥SQLï¼Œ

        æŸ¥è¯¢ç»“æœé€šè¿‡customerSimpleMapè¿™ä¸ªæ˜ å°„ç”ŸæˆCustomerå¯¹è±¡--&gt;

    &lt;select id=&quot;findByOrderId&quot; resultMap=&quot;customerSimpleMap&quot;&gt;

        SELECT * FROM t_customer as c join t_order as t

        on c.id = t.customer_id

        WHERE t.customer_id = #{id:INTEGER}

    &lt;/select&gt;

    &lt;!-- å®šä¹‰insertè¯­å¥ï¼ŒCustomerMapperæ¥å£ä¸­çš„save()æ–¹æ³•ä¼šæ‰§è¡Œè¯¥SQLï¼Œ

        æ•°æ®åº“ç”Ÿæˆçš„è‡ªå¢idä¼šè‡ªåŠ¨å¡«å……åˆ°ä¼ å…¥çš„Customerå¯¹è±¡çš„idå­—æ®µä¸­--&gt;

    &lt;insert id=&quot;save&quot; keyProperty=&quot;id&quot; useGeneratedKeys=&quot;true&quot;&gt;

      insert into t_customer (id, name, phone)

      values (#{id},#{name},#{phone})

    &lt;/insert&gt;

&lt;/mapper&gt;
</code></pre><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ AddressMapper æ¥å£çš„å®šä¹‰ï¼Œå®ƒä¸»è¦æ˜¯é’ˆå¯¹ Address å¯¹è±¡çš„ CRUDï¼š</p>
<pre tabindex="0"><code>public interface AddressMapper {

    // æ ¹æ®idæŸ¥è¯¢Addresså¯¹è±¡

    Address find(long id);

    // æŸ¥è¯¢ä¸€ä¸ªç”¨æˆ·çš„å…¨éƒ¨åœ°å€ä¿¡æ¯

    List&lt;Address&gt; findAll(long customerId);

    // æŸ¥è¯¢æŒ‡å®šè®¢å•çš„é€è´§åœ°å€

    Address findByOrderId(long orderId);

    // å­˜å‚¨Addresså¯¹è±¡ï¼ŒåŒæ—¶ä¼šè®°å½•å…³è”çš„Customer

    int save(@Param(&quot;address&quot;) Address address,

              @Param(&quot;customerId&quot;) long customerId);

}
</code></pre><p>AddressMapper æ¥å£å¯¹åº”çš„ AddressMapper.xml é…ç½®æ–‡ä»¶ä¸­ï¼ŒåŒæ ·å®šä¹‰äº†æ¯ä¸ªæ–¹æ³•è¦æ‰§è¡Œçš„ SQL è¯­å¥ä»¥åŠæŸ¥è¯¢ç»“æœä¸ Address å¯¹è±¡ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼Œå…·ä½“å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>&lt;mapper namespace=&quot;org.example.dao.AddressMapper&quot;&gt;

    &lt;!-- find()ã€findAll()æ–¹æ³•å¯¹åº”çš„&lt;select&gt;æ ‡ç­¾ä»¥åŠ&lt;resultMap&gt;æ˜ å°„æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œä¸å†å±•ç¤ºï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒä»£ç è¿›è¡Œå­¦ä¹  --&gt;

    &lt;!-- å®šä¹‰selectè¯­å¥ï¼ŒAddressMapperæ¥å£ä¸­çš„findByOrderId()æ–¹æ³•ä¼šæ‰§è¡Œè¯¥SQLï¼Œ

    æŸ¥è¯¢ç»“æœé€šè¿‡addressMapè¿™ä¸ªæ˜ å°„ç”ŸæˆAddresså¯¹è±¡--&gt;

    &lt;select id=&quot;findByOrderId&quot; resultMap=&quot;addressMap&quot;&gt;

        SELECT a.* FROM t_address as a join t_order as o

        on a.id = o.address_id

        WHERE o.address_id = #{id}

    &lt;/select&gt;

    &lt;!-- å®šä¹‰insertè¯­å¥ï¼ŒAddressMapperæ¥å£ä¸­çš„save()æ–¹æ³•ä¼šæ‰§è¡Œè¯¥SQLï¼Œ

        æ•°æ®åº“ç”Ÿæˆçš„è‡ªå¢idä¼šè‡ªåŠ¨å¡«å……åˆ°ä¼ å…¥çš„Addresså¯¹è±¡çš„idå­—æ®µä¸­--&gt;

    &lt;insert id=&quot;save&quot; keyProperty=&quot;address.id&quot; useGeneratedKeys=&quot;true&quot;&gt;

      insert into t_address (street, city, country, customer_id)

      values (#{address.street},#{address.city},#{address.country},#{customerId})

    &lt;/insert&gt;

&lt;/mapper&gt;
</code></pre><p>ä¸‹é¢æ¥çœ‹ ProductMapper æ¥å£ï¼Œå…¶ä¸­<strong>é™¤äº†æ ¹æ® id æŸ¥è¯¢ Product ä¹‹å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ name è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢</strong>ï¼Œå…·ä½“å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>public interface ProductMapper {

    // æ ¹æ®idæŸ¥è¯¢å•†å“ä¿¡æ¯

    Product find(long id);

    // æ ¹æ®åç§°æœç´¢å•†å“ä¿¡æ¯

    List&lt;Product&gt; findByName(String name);

    // ä¿å­˜å•†å“ä¿¡æ¯

    long save(Product product);

}
</code></pre><p>ProductMapper æ¥å£å¯¹åº”çš„ ProductMapper.xml é…ç½®æ–‡ä»¶ä¸­ï¼Œå®šä¹‰äº† Product ç›¸å…³çš„ SQL è¯­å¥ä»¥åŠæŸ¥è¯¢ç»“æœä¸ Product å¯¹è±¡ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚ProductMapper.xml é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„ SQL è¯­å¥ä»¥åŠ ResultMap æ˜ å°„æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œä¸å†å±•ç¤ºï¼Œä½ è‹¥æ„Ÿå…´è¶£çš„è¯å¯ä»¥å‚è€ƒ<a href="https://github.com/xxxlxy2008/mybatisDemo">æºç </a>è¿›è¡Œå­¦ä¹ ã€‚</p>
<p>ç´§æ¥ç€ï¼Œæˆ‘ä»¬å†æ¥çœ‹ OrderItemMapper æ¥å£çš„å®šä¹‰ï¼Œå…¶ä¸­å®šä¹‰äº† OrderItem å¯¹è±¡çš„æ“ä½œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>public interface OrderItemMapper {

    // æ ¹æ®idæŸ¥è¯¢OrderItemå¯¹è±¡

    OrderItem find(long id);

    // æŸ¥è¯¢æŒ‡å®šçš„è®¢å•ä¸­çš„å…¨éƒ¨OrderItem

    List&lt;OrderItem&gt; findByOrderId(long orderId);

    // ä¿å­˜ä¸€ä¸ªOrderItemä¿¡æ¯

    long save(@Param(&quot;orderItem&quot;)OrderItem orderItem, 

              @Param(&quot;orderId&quot;) long orderId);

}
</code></pre><p>ä¸ä¹‹å¯¹åº”çš„ OrderItemMapper.xml é…ç½®æ–‡ä»¶çš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>&lt;mapper namespace=&quot;org.example.dao.OrderItemMapper&quot;&gt;

    &lt;!-- å®šä¹‰t_order_itemä¸OrderItemå¯¹è±¡ä¹‹é—´çš„æ˜ å°„å…³ç³»--&gt;

    &lt;resultMap id=&quot;orderItemtMap&quot; type=&quot;OrderItem&quot;&gt;

        &lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;

        &lt;result property=&quot;amount&quot; column=&quot;amount&quot;/&gt;

        &lt;result property=&quot;orderId&quot; column=&quot;order_id&quot;/&gt;

        &lt;!--æ˜ å°„OrderItemå…³è”çš„Productå¯¹è±¡ï¼Œ&lt;association&gt;æ ‡ç­¾ç”¨äºå®ç°ä¸€å¯¹ä¸€çš„å…³è”å…³ç³»--&gt;

        &lt;association property=&quot;product&quot; javaType=&quot;Product&quot;&gt;

            &lt;id property=&quot;id&quot; column=&quot;product_id&quot;/&gt;

            &lt;result property=&quot;name&quot; column=&quot;name&quot;/&gt;

            &lt;result property=&quot;description&quot; column=&quot;description&quot;/&gt;

            &lt;result property=&quot;price&quot; column=&quot;price&quot;/&gt;

        &lt;/association&gt;

    &lt;/resultMap&gt;

    &lt;!-- å®šä¹‰selectè¯­å¥ï¼ŒOrderItemMapperæ¥å£ä¸­çš„find()æ–¹æ³•ä¼šæ‰§è¡Œè¯¥SQLï¼Œ

        æŸ¥è¯¢ç»“æœé€šè¿‡orderItemtMapè¿™ä¸ªæ˜ å°„ç”ŸæˆOrderItemå¯¹è±¡--&gt;

    &lt;select id=&quot;find&quot; resultMap=&quot;orderItemtMap&quot;&gt;

        SELECT i.*,p.*,p.id as product_id FROM t_order_item as i join t_product as p

        on i.product_id = p.id WHERE id = #{id:INTEGER}

    &lt;/select&gt;

    &lt;!-- å®šä¹‰selectè¯­å¥ï¼ŒOrderItemMapperæ¥å£ä¸­çš„findAll()æ–¹æ³•ä¼šæ‰§è¡Œè¯¥SQLï¼Œ

        æŸ¥è¯¢ç»“æœé€šè¿‡orderItemtMapè¿™ä¸ªæ˜ å°„ç”ŸæˆOrderItemå¯¹è±¡--&gt;

    &lt;select id=&quot;findByOrderId&quot; resultMap=&quot;orderItemtMap&quot;&gt;

        SELECT i.*,p.* FROM t_order_item as i join t_product as p

        on i.product_id = p.id WHERE i.order_id = #{order_id:INTEGER}

    &lt;/select&gt;

    &lt;!-- å®šä¹‰insertè¯­å¥ï¼ŒOrderItemMapperæ¥å£ä¸­çš„save()æ–¹æ³•ä¼šæ‰§è¡Œè¯¥SQLï¼Œ

        æ•°æ®åº“ç”Ÿæˆçš„è‡ªå¢idä¼šè‡ªåŠ¨å¡«å……åˆ°ä¼ å…¥çš„OrderItemå¯¹è±¡çš„idå­—æ®µä¸­--&gt;

    &lt;insert id=&quot;save&quot; keyProperty=&quot;orderItem.id&quot; useGeneratedKeys=&quot;true&quot;&gt;

      insert into t_order_item (amount, product_id, order_id)

      values (#{orderItem.amount}, #{orderItem.product.id}, #{orderId})

    &lt;/insert&gt;

&lt;/mapper&gt;
</code></pre><p>æœ€åæ¥çœ‹ OrderMapper æ¥å£çš„å®šä¹‰ï¼Œå…¶ä¸­å®šä¹‰äº†æŸ¥è¯¢ã€å­˜å‚¨ Order å¯¹è±¡çš„ç›¸å…³æ–¹æ³•ï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>public interface OrderMapper {

    // æ ¹æ®è®¢å•IdæŸ¥è¯¢

    Order find(long id);

    // æŸ¥è¯¢ä¸€ä¸ªç”¨æˆ·ä¸€æ®µæ—¶é—´æ®µå†…çš„è®¢å•åˆ—è¡¨

    List&lt;Order&gt; findByCustomerId(long customerId, long startTime, long endTime);

    // ä¿å­˜ä¸€ä¸ªè®¢å•

    long save(Order order);

}
</code></pre><p>ä¸ OrderMapper æ¥å£å¯¹åº”çš„ SQL è¯­å¥å®šä¹‰åœ¨ OrderMapper.xml é…ç½®æ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>&lt;mapper namespace=&quot;org.example.dao.OrderMapper&quot;&gt;

    &lt;!-- å®šä¹‰t_orderè¡¨æŸ¥è¯¢è®°å½•ä¸Orderå¯¹è±¡ä¹‹é—´æ˜ å°„ --&gt;

    &lt;resultMap id=&quot;orderMap&quot; type=&quot;Order&quot;&gt;

        &lt;!-- ä¸»é”®æ˜ å°„ --&gt;

        &lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;

        &lt;!-- å±æ€§æ˜ å°„ --&gt;

        &lt;result property=&quot;createTime&quot; column=&quot;create_time&quot;/&gt;

        &lt;!-- æ˜ å°„customerå­—æ®µ --&gt;

        &lt;association property=&quot;customer&quot; javaType=&quot;Customer&quot;&gt;

            &lt;id property=&quot;id&quot; column=&quot;customer_id&quot;/&gt;

        &lt;/association&gt;

        &lt;!-- æ˜ å°„deliveryAddresså­—æ®µ --&gt;

        &lt;association property=&quot;deliveryAddress&quot; javaType=&quot;Address&quot;&gt;

            &lt;id property=&quot;id&quot; column=&quot;address_id&quot;/&gt;

        &lt;/association&gt;

        &lt;!-- è¿™é‡Œå¹¶æ²¡æœ‰æ˜ å°„orderItemsé›†åˆ--&gt;

    &lt;/resultMap&gt;

    &lt;!-- å®šä¹‰selectè¯­å¥ï¼ŒOrderMapperæ¥å£ä¸­çš„find()æ–¹æ³•ä¼šæ‰§è¡Œè¯¥SQLï¼Œ

        æŸ¥è¯¢ç»“æœé€šè¿‡orderMapè¿™ä¸ªæ˜ å°„ç”ŸæˆOrderå¯¹è±¡--&gt;

    &lt;select id=&quot;find&quot; resultMap=&quot;orderMap&quot;&gt;

        SELECT * FROM t_order WHERE id = #{id:INTEGER}

    &lt;/select&gt;

    &lt;!-- å®šä¹‰selectè¯­å¥ï¼ŒOrderMapperæ¥å£ä¸­çš„findByCustomerId()æ–¹æ³•ä¼šæ‰§è¡Œè¯¥SQLï¼Œ

        æŸ¥è¯¢ç»“æœé€šè¿‡orderMapè¿™ä¸ªæ˜ å°„ç”ŸæˆOrderå¯¹è±¡ã€‚æ³¨æ„è¿™é‡Œå¤§äºå·ã€å°äºå·åœ¨XMLä¸­çš„å†™æ³•--&gt;

    &lt;select id=&quot;findByCustomerId&quot; resultMap=&quot;orderMap&quot;&gt;

        SELECT * FROM t_order WHERE customer_id = #{id}

        and create_date_time &lt;![CDATA[ &gt;= ]]&gt; #{startTime}

        and  create_date_time &lt;![CDATA[ &lt;= ]]&gt; #{endTime}

    &lt;/select&gt;

    &lt;!-- å®šä¹‰insertè¯­å¥ï¼ŒOrderMapperæ¥å£ä¸­çš„save()æ–¹æ³•ä¼šæ‰§è¡Œè¯¥SQLï¼Œ

        æ•°æ®åº“ç”Ÿæˆçš„è‡ªå¢idä¼šè‡ªåŠ¨å¡«å……åˆ°ä¼ å…¥çš„Orderå¯¹è±¡çš„idå­—æ®µä¸­--&gt;

    &lt;insert id=&quot;save&quot; keyProperty=&quot;id&quot; useGeneratedKeys=&quot;true&quot;&gt;

      insert into t_order (customer_id, address_id, create_time)

      values (#{customer.id}, #{deliveryAddress.id}, #{createTime})

    &lt;/insert&gt;

&lt;/mapper&gt;
</code></pre><h4 id="2-daoutils-å·¥å…·ç±»">2. DaoUtils å·¥å…·ç±»</h4>
<p>åœ¨ DAO å±‚ä¸­ï¼Œé™¤äº†å®šä¹‰ä¸Šè¿°æ¥å£å’Œç›¸å…³å®ç°ä¹‹å¤–ï¼Œè¿˜éœ€è¦ç®¡ç†æ•°æ®åº“è¿æ¥å’Œäº‹åŠ¡ã€‚åœ¨è®¢å•ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬<strong>ä½¿ç”¨ DaoUtils å·¥å…·ç±»æ¥å®Œæˆ MyBatis ä¸­ SqlSession ä»¥åŠäº‹åŠ¡çš„ç›¸å…³æ“ä½œ</strong>ï¼Œè¿™ä¸ªå®ç°éå¸¸ç®€å•ï¼Œåœ¨å®è·µä¸­ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨ä¸“é—¨çš„äº‹åŠ¡ç®¡ç†å™¨æ¥ç®¡ç†äº‹åŠ¡ã€‚</p>
<p>ä¸‹é¢æ˜¯ DaoUtils å·¥å…·ç±»çš„æ ¸å¿ƒå®ç°ï¼š</p>
<pre tabindex="0"><code>public class DaoUtils {

    private static SqlSessionFactory factory;

    static { // åœ¨é™æ€ä»£ç å—ä¸­ç›´æ¥è¯»å–MyBatisçš„mybatis-config.xmlé…ç½®æ–‡ä»¶

        String resource = &quot;mybatis-config.xml&quot;;

        InputStream inputStream = null;

        try {

            inputStream = Resources.getResourceAsStream(resource);

        } catch (IOException e) {

            System.err.println(&quot;read mybatis-config.xml fail&quot;);

            e.printStackTrace();

            System.exit(1);

        }

        // åŠ è½½å®Œmybatis-config.xmlé…ç½®æ–‡ä»¶ä¹‹åï¼Œä¼šæ ¹æ®å…¶ä¸­çš„é…ç½®ä¿¡æ¯åˆ›å»ºSqlSessionFactoryå¯¹è±¡

        factory = new SqlSessionFactoryBuilder()

                .build(inputStream);

    }

    public static &lt;R&gt; R execute(Function&lt;SqlSession, R&gt; function) {

        // åˆ›å»ºSqlSession

        SqlSession session = factory.openSession();

        try {

            R apply = function.apply(session);

            // æäº¤äº‹åŠ¡

            session.commit();

            return apply;

        } catch (Throwable t) {

            // å‡ºç°å¼‚å¸¸çš„æ—¶å€™ï¼Œå›æ»šäº‹åŠ¡

            session.rollback(); 

            System.out.println(&quot;execute error&quot;);

            throw t;

        } finally {

            // å…³é—­SqlSession

            session.close();

        }

    }

}
</code></pre><p>åœ¨ DaoUtils ä¸­åŠ è½½çš„ mybatis-config.xml é…ç½®æ–‡ä»¶ä½äº /resource ç›®å½•ä¸‹ï¼Œ<strong>æ˜¯ MyBatis æ¡†æ¶é…ç½®çš„å…¥å£</strong>ï¼Œå…¶ä¸­é…ç½®äº†è¦è¿æ¥çš„æ•°æ®åº“åœ°å€ã€Mapper.xml æ–‡ä»¶çš„ä½ç½®ä»¥åŠä¸€äº›è‡ªå®šä¹‰å˜é‡å’Œåˆ«åï¼Œå…·ä½“å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>&lt;configuration&gt;

    &lt;properties&gt; &lt;!-- å®šä¹‰å±æ€§å€¼ --&gt;

        &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;

        &lt;property name=&quot;id&quot; value=&quot;xxx&quot;/&gt;

    &lt;/properties&gt;

    &lt;settings&gt;&lt;!-- å…¨å±€é…ç½®ä¿¡æ¯ --&gt;

        &lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt;

    &lt;/settings&gt;

    &lt;typeAliases&gt;

        &lt;!-- é…ç½®åˆ«åä¿¡æ¯ï¼Œåœ¨æ˜ å°„é…ç½®æ–‡ä»¶ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨Customerè¿™ä¸ªåˆ«å

            ä»£æ›¿org.example.domain.Customerè¿™ä¸ªç±» --&gt;

        &lt;typeAlias type=&quot;org.example.domain.Customer&quot; alias=&quot;Customer&quot;/&gt;

        &lt;typeAlias type=&quot;org.example.domain.Address&quot; alias=&quot;Address&quot;/&gt;

        &lt;typeAlias type=&quot;org.example.domain.Order&quot; alias=&quot;Order&quot;/&gt;

        &lt;typeAlias type=&quot;org.example.domain.OrderItem&quot; alias=&quot;OrderItem&quot;/&gt;

        &lt;typeAlias type=&quot;org.example.domain.Product&quot; alias=&quot;Product&quot;/&gt;

    &lt;/typeAliases&gt;

    &lt;environments default=&quot;development&quot;&gt;

        &lt;environment id=&quot;development&quot;&gt;

            &lt;!-- é…ç½®äº‹åŠ¡ç®¡ç†å™¨çš„ç±»å‹ --&gt;

            &lt;transactionManager type=&quot;JDBC&quot;/&gt;

            &lt;!-- é…ç½®æ•°æ®æºçš„ç±»å‹ï¼Œä»¥åŠæ•°æ®åº“è¿æ¥çš„ç›¸å…³ä¿¡æ¯ --&gt;

            &lt;dataSource type=&quot;POOLED&quot;&gt;

                &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;

                &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/test&quot;/&gt;

                &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;

                &lt;property name=&quot;password&quot; value=&quot;xxx&quot;/&gt;

            &lt;/dataSource&gt;

        &lt;/environment&gt;

    &lt;/environments&gt;

    &lt;!-- é…ç½®æ˜ å°„é…ç½®æ–‡ä»¶çš„ä½ç½® --&gt;

    &lt;mappers&gt;

        &lt;mapper resource=&quot;mapper/CustomerMapper.xml&quot;/&gt;

        &lt;mapper resource=&quot;mapper/AddressMapper.xml&quot;/&gt;

        &lt;mapper resource=&quot;mapper/OrderItemMapper.xml&quot;/&gt;

        &lt;mapper resource=&quot;mapper/OrderMapper.xml&quot;/&gt;

        &lt;mapper resource=&quot;mapper/ProductMapper.xml&quot;/&gt;

    &lt;/mappers&gt;

&lt;/configuration&gt;
</code></pre><h3 id="service-å±‚">Service å±‚</h3>
<p>ä»‹ç»å®Œ DAO å±‚ä¹‹åï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å†æ¥èŠèŠ Service å±‚ã€‚</p>
<p><strong>Service å±‚çš„æ ¸å¿ƒèŒè´£æ˜¯å®ç°ä¸šåŠ¡é€»è¾‘</strong>ã€‚åœ¨ Service å±‚å®ç°çš„ä¸šåŠ¡é€»è¾‘ä¸€èˆ¬è¦ä¾èµ–åˆ°å‰é¢ä»‹ç»çš„ DAO å±‚çš„èƒ½åŠ›ï¼Œ<strong>å°†ä¸šåŠ¡é€»è¾‘å°è£…åˆ° Service å±‚å¯ä»¥æ›´æ–¹ä¾¿åœ°å¤ç”¨ä¸šåŠ¡é€»è¾‘å®ç°ï¼Œä»£ç ä¼šæ˜¾å¾—éå¸¸ç®€æ´ï¼Œç³»ç»Ÿä¹Ÿä¼šæ›´åŠ ç¨³å®š</strong>ã€‚</p>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ CustomerService å®ç°ï¼Œå…¶ä¸­æä¾›äº†æ³¨å†Œç”¨æˆ·ã€æ·»åŠ é€è´§åœ°å€ã€æŸ¥è¯¢ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ã€æŸ¥è¯¢ç”¨æˆ·å…¨éƒ¨é€è´§åœ°å€ç­‰åŸºæœ¬åŠŸèƒ½ï¼Œå…·ä½“å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>public class CustomerService {

    // åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·

    public long register(String name, String phone) {

        // æ£€æŸ¥ä¼ å…¥çš„nameå‚æ•°ä»¥åŠphoneå‚æ•°æ˜¯å¦åˆæ³•

        Preconditions.checkArgument(!Strings.isNullOrEmpty(name), &quot;name is empty&quot;);

        Preconditions.checkArgument(!Strings.isNullOrEmpty(phone), &quot;phone is empty&quot;);

        // æˆ‘ä»¬è¿˜å¯ä»¥å®Œæˆå…¶ä»–ä¸šåŠ¡é€»è¾‘ï¼Œä¾‹å¦‚æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦é‡å¤ã€æ‰‹æœºå·æ˜¯å¦é‡å¤ç­‰ï¼Œè¿™é‡Œä¸å†å±•ç¤º

        return DaoUtils.execute(sqlSession -&gt; {

            // åˆ›å»ºCustomerå¯¹è±¡ï¼Œå¹¶é€šè¿‡CustomerMapper.save()æ–¹æ³•å®ŒæˆæŒä¹…åŒ–

            CustomerMapper mapper = sqlSession.getMapper(CustomerMapper.class);

            Customer customer = new Customer();

            customer.setName(name);

            customer.setPhone(phone);

            int affected = mapper.save(customer);

            if (affected &lt;= 0) {

                throw new RuntimeException(&quot;Save Customer fail...&quot;);

            }

            return customer.getId();

        });

    }

    // ç”¨æˆ·æ·»åŠ ä¸€ä¸ªæ–°çš„é€è´§åœ°å€

    public long addAddress(long customerId, String street, String city, String country) {

        // æ£€æŸ¥ä¼ å…¥å‚æ•°æ˜¯å¦åˆæ³•

        Preconditions.checkArgument(customerId &gt; 0, &quot;customerId is empty&quot;);

        Preconditions.checkArgument(!Strings.isNullOrEmpty(street), &quot;street is empty&quot;);

        Preconditions.checkArgument(!Strings.isNullOrEmpty(city), &quot;city is empty&quot;);

        Preconditions.checkArgument(!Strings.isNullOrEmpty(country), &quot;country is empty&quot;);

        // æˆ‘ä»¬è¿˜å¯ä»¥å®Œæˆå…¶ä»–ä¸šåŠ¡é€»è¾‘ï¼Œä¾‹å¦‚æ£€æŸ¥è¯¥åœ°å€æ˜¯å¦è¶…å‡ºäº†é€è´§èŒƒå›´ç­‰ï¼Œè¿™é‡Œä¸å†å±•ç¤º

        return DaoUtils.execute(sqlSession -&gt; {

            // åˆ›å»ºAddresså¯¹è±¡å¹¶è°ƒç”¨AddressMapper.save()æ–¹æ³•å®ŒæˆæŒä¹…åŒ–

            AddressMapper mapper = sqlSession.getMapper(AddressMapper.class);

            Address address = new Address();

            address.setStreet(street);

            address.setCity(city);

            address.setCountry(city);

            int affected = mapper.save(address, customerId);

            if (affected &lt;= 0) {

                throw new RuntimeException(&quot;Save Customer fail...&quot;);

            }

            return address.getId();

        });

    }

    public List&lt;Address&gt; findAllAddress(long customerId) {

        // æ£€æŸ¥ç”¨æˆ·idå‚æ•°æ˜¯å¦åˆæ³•

        Preconditions.checkArgument(customerId &gt; 0, &quot;id error&quot;);

        return DaoUtils.execute(sqlSession -&gt; {

            // æ‰§è¡ŒAddressMapper.find()æ–¹æ³•å®ŒæˆæŸ¥è¯¢

            AddressMapper mapper = sqlSession.getMapper(AddressMapper.class);

            return mapper.findAll(customerId);

        });

    }

    public Customer find(long id) {

        // æ£€æŸ¥ç”¨æˆ·idå‚æ•°æ˜¯å¦åˆæ³•

        Preconditions.checkArgument(id &gt; 0, &quot;id error&quot;);

        return DaoUtils.execute(sqlSession -&gt; {

            // æ‰§è¡ŒCustomerMapper.find()æ–¹æ³•å®ŒæˆæŸ¥è¯¢

            CustomerMapper mapper = sqlSession.getMapper(CustomerMapper.class);

            return mapper.find(id);

        });

    }

    public Customer findWithAddress(long id) {

        // æ£€æŸ¥ç”¨æˆ·idå‚æ•°æ˜¯å¦åˆæ³•

        Preconditions.checkArgument(id &gt; 0, &quot;id error&quot;);

        return DaoUtils.execute(sqlSession -&gt; {

            // æ‰§è¡ŒCustomerMapper.findWithAddress()æ–¹æ³•å®ŒæˆæŸ¥è¯¢

            CustomerMapper mapper = sqlSession.getMapper(CustomerMapper.class);

            return mapper.findWithAddress(id);

        });

    }

}
</code></pre><p>æ¥ä¸‹æ¥çœ‹ ProductService å®ç°ï¼Œå…¶ä¸­æä¾›äº†æ–°å¢å•†å“ã€æ ¹æ® id ç²¾ç¡®æŸ¥è¯¢å•†å“ä»¥åŠæ ¹æ®åç§°æ¨¡ç³ŠæŸ¥è¯¢å•†å“çš„åŸºç¡€åŠŸèƒ½ï¼Œå…·ä½“å®ç°å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>public class ProductService {

    // åˆ›å»ºå•†å“

    public long createProduct(Product product) {

        // æ£€æŸ¥productä¸­çš„å„ä¸ªå­—æ®µæ˜¯å¦åˆæ³•

        Preconditions.checkArgument(product != null, &quot;product is null&quot;);

        Preconditions.checkArgument(!Strings.isNullOrEmpty(product.getName()), &quot;product name is empty&quot;);

        Preconditions.checkArgument(!Strings.isNullOrEmpty(product.getDescription()), &quot;description name is empty&quot;);

        Preconditions.checkArgument(product.getPrice().compareTo(new BigDecimal(0)) &gt; 0,

                &quot;price&lt;=0 error&quot;);

        return DaoUtils.execute(sqlSession -&gt; {

            // é€šè¿‡ProductMapperä¸­çš„save()æ–¹æ³•å®ŒæˆæŒä¹…åŒ–

            ProductMapper productMapper = sqlSession.getMapper(ProductMapper.class);

            return productMapper.save(product);

        });

    }

    public Product find(long productId) {

        // æ£€æŸ¥productIdå‚æ•°æ˜¯å¦åˆæ³•

        Preconditions.checkArgument(productId &gt; 0, &quot;product id error&quot;);

        return DaoUtils.execute(sqlSession -&gt; {

            // é€šè¿‡ProductMapperä¸­çš„find()æ–¹æ³•ç²¾ç¡®æŸ¥è¯¢Product

            ProductMapper productMapper = sqlSession.getMapper(ProductMapper.class);

            return productMapper.find(productId);

        });

    }

    public List&lt;Product&gt; find(String productName) {

        // æ£€æŸ¥productNameå‚æ•°æ˜¯å¦åˆæ³•

        Preconditions.checkArgument(Strings.isNullOrEmpty(productName), &quot;product id error&quot;);

        return DaoUtils.execute(sqlSession -&gt; {

            // æ ¹æ®productNameæ¨¡ç³ŠæŸ¥è¯¢Product 

            ProductMapper productMapper = sqlSession.getMapper(ProductMapper.class);

            return productMapper.findByName(productName);

        });

    }

}
</code></pre><p>æœ€åï¼Œå†æ¥çœ‹ OrderService å¯¹ Order è®¢å•ä¸šåŠ¡çš„å°è£…ï¼Œå…¶ä¸­å°è£…äº†åˆ›å»ºè®¢å•å’ŒæŸ¥è¯¢è®¢å•çš„é€»è¾‘ï¼Œå¦å¤–ï¼Œè¿˜æä¾›äº†å®æ—¶è®¡ç®—è®¢å•æ€»ä»·çš„åŠŸèƒ½ï¼Œå…·ä½“å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>public class OrderService {

    // åˆ›å»ºè®¢å•

    public long createOrder(Order order) {

        Preconditions.checkArgument(order != null, &quot;order is null&quot;);

        Preconditions.checkArgument(order.getOrderItems() != null

                        &amp;&amp; order.getOrderItems().size() &gt; 0,

                &quot;orderItems is empty&quot;);

        return DaoUtils.execute(sqlSession -&gt; {

            OrderMapper orderMapper = sqlSession.getMapper(OrderMapper.class);

            OrderItemMapper orderItemMapper = sqlSession.getMapper(OrderItemMapper.class);

            // è°ƒç”¨OrderMapper.save()æ–¹æ³•å®Œæˆè®¢å•çš„æŒä¹…åŒ–

            long affected = orderMapper.save(order);

            if (affected &lt;= 0) {

                throw new RuntimeException(&quot;Save Order fail...&quot;);

            }

            long orderId = order.getId();

            for (OrderItem orderItem : order.getOrderItems()) {

                // é€šè¿‡OrderItemMapperå®ŒæˆOrderItemçš„æŒä¹…åŒ–

                orderItemMapper.save(orderItem, orderId);

            }

            return orderId;

        });

    }

    // æ ¹æ®è®¢å•idæŸ¥è¯¢è®¢å•çš„å…¨éƒ¨ä¿¡æ¯

    public Order find(long orderId) {

        // æ£€æŸ¥orderIdå‚æ•°æ˜¯å¦åˆæ³•

        Preconditions.checkArgument(orderId &gt; 0, &quot;orderId error&quot;);

        return DaoUtils.execute(sqlSession -&gt; {

            // æŸ¥è¯¢è¯¥è®¢å•å…³è”çš„å…¨éƒ¨OrderItem

            OrderItemMapper orderItemMapper = sqlSession.getMapper(OrderItemMapper.class);

            List&lt;OrderItem&gt; orderItems = orderItemMapper.findByOrderId(orderId);

            // æŸ¥è¯¢è®¢å•æœ¬èº«çš„ä¿¡æ¯

            OrderMapper orderMapper = sqlSession.getMapper(OrderMapper.class);

            Order order = orderMapper.find(orderId);

            order.setOrderItems(orderItems);

            // è®¡ç®—è®¢å•æ€»é¢

            order.setTotalPrice(calculateTotalPrice(order));

            // æŸ¥è¯¢è®¢å•å…³è”çš„Address

            AddressMapper addressMapper = sqlSession.getMapper(AddressMapper.class);

            Address address = addressMapper.find(order.getDeliveryAddress().getId());

            order.setDeliveryAddress(address);

            return order;

        });

    }

    private BigDecimal calculateTotalPrice(Order order) {

        List&lt;OrderItem&gt; orderItems = order.getOrderItems();

        BigDecimal totalPrice = new BigDecimal(0);

        for (OrderItem orderItem : orderItems) {

            BigDecimal itemPrice = orderItem.getProduct().getPrice()

                    .multiply(new BigDecimal(orderItem.getAmount()));

            orderItem.setPrice(itemPrice);

            totalPrice.add(itemPrice);

        }

        return totalPrice;

    }

}
</code></pre><h3 id="æµ‹è¯•ç”¨ä¾‹">æµ‹è¯•ç”¨ä¾‹</h3>
<p>ä»‹ç»å®Œ Service ä¹‹åï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥ç¼–å†™ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç”¨ä¾‹ï¼Œæµ‹è¯•ä¸€ä¸‹ Service å±‚å’Œ DAO å±‚çš„å®ç°æ˜¯å¦æ­£ç¡®ï¼Œå…·ä½“çš„æµ‹è¯•ç”¨ä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>public class CustomerServiceTest {

    private static CustomerService customerService;

    private static OrderService orderService;

    private static ProductService productService;

    @Before

    public void init() { // æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹ä¹‹å‰ï¼Œåˆå§‹åŒ–Serviceå±‚çš„å„ä¸ªå®ç°

        customerService = new CustomerService();

        orderService = new OrderService();

        productService = new ProductService();

    }

    @Test

    public void test01() {

        // åˆ›å»ºä¸€ä¸ªç”¨æˆ·

        long customerId = customerService.register(&quot;æ¨å››æ­£&quot;, &quot;12345654321&quot;);

        // ä¸ºç”¨æˆ·æ·»åŠ ä¸€ä¸ªé…é€åœ°å€

        long addressId = customerService.addAddress(customerId,

                &quot;ç‰›æ æ‘&quot;, &quot;ç‰›æ å¸‚&quot;, &quot;çŸ®äººå›½&quot;);

        System.out.println(addressId);

        // æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ä»¥åŠåœ°å€ä¿¡æ¯

        Customer customer = customerService.find(customerId);

        System.out.println(customer);

        Customer customer2 = customerService.findWithAddress(customerId);

        System.out.println(customer2);

        List&lt;Address&gt; addressList = customerService.findAllAddress(customerId);

        addressList.stream().forEach(System.out::println);

        // å…¥åº“ä¸€äº›å•†å“

        Product product = new Product();

        product.setName(&quot;MyBatisè¯¾ç¨‹&quot;);

        product.setDescription(&quot;æ·±å…¥MyBatisæºç çš„è§†é¢‘æ•™ç¨‹&quot;);

        product.setPrice(new BigDecimal(99));

        long productId = productService.createProduct(product);

        System.out.println(&quot;create productId:&quot; + productId);

        // åˆ›å»ºä¸€ä¸ªè®¢å•

        Order order = new Order();

        order.setCustomer(customer); // ä¹°å®¶

        order.setDeliveryAddress(addressList.get(0)); // é…é€åœ°å€

        // ç”Ÿæˆè´­ä¹°æ¡ç›®

        OrderItem orderItem = new OrderItem();

        orderItem.setAmount(20);

        orderItem.setProduct(product);

        order.setOrderItems(Lists.newArrayList(orderItem));

        long orderId = orderService.createOrder(order);

        System.out.println(&quot;create orderId:&quot; + orderId);

        Order order2 = orderService.find(orderId);

        System.out.println(order2);

    }

}
</code></pre><h3 id="æ€»ç»“">æ€»ç»“</h3>
<p>åœ¨è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ MyBatis å®ç°ç®€æ˜“è®¢å•ç³»ç»Ÿçš„æŒä¹…åŒ–å±‚ï¼šé¦–å…ˆä»‹ç»äº†è®¢å•ç³»ç»Ÿ domain å±‚çš„è®¾è®¡ï¼Œå°†ç”¨æˆ·ã€è®¢å•ã€å•†å“ç­‰ä¸šåŠ¡æ¦‚å¿µæŠ½è±¡æˆäº†å¯¹åº”çš„ Customerã€Orderã€Product ç­‰ Java ç±»ï¼›æ¥ä¸‹æ¥åˆ†æäº†è®¢å•ç³»ç»ŸæŒä¹…å±‚ä¸­æ•°æ®åº“è¡¨çš„è®¾è®¡ï¼Œä¸»è¦æ˜¯ä»å…³ç³»æ¨¡å‹è§’åº¦æŠ½è±¡ä¸šåŠ¡æ¦‚å¿µï¼›éšååˆè®²è§£äº†è®¢å•ç³»ç»Ÿçš„ DAO æ¥å£å±‚ï¼Œå®šä¹‰äº†æ“ä½œæ•°æ®çš„åŸºæœ¬æ–¹æ³•ï¼›æœ€åæˆ‘ä»¬æä¾›äº†ä¸€ä¸ª Service ç±»å»å®ç°ç®€å•çš„ä¸šåŠ¡é€»è¾‘ä»¥åŠç›¸å…³çš„æµ‹è¯•ç”¨ä¾‹ã€‚</p>
<p>åœ¨æœ¬è®²çš„æœ«å°¾ï¼Œæˆ‘ç»™ä½ ç•™ä¸€ä¸ªå°ä»»åŠ¡ï¼šåœ¨ç°æœ‰æºç åŸºç¡€ä¸Šï¼Œå°†å„ä¸ª DAO æ¥å£çš„å®ç°è°ƒé€šï¼Œå¹¶ç¼–å†™å¯¹åº”çš„å•å…ƒæµ‹è¯•è¿›è¡Œæ£€æŸ¥ã€‚</p>

        </div>
    </article>
</div>

    </main>
    <footer>
        <div id="pagination">
            
<div class="paginator">
    <div class="prev">
        
        <a href="/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/01-%E5%B8%B8%E8%A7%81%E6%8C%81%E4%B9%85%E5%B1%82%E6%A1%86%E6%9E%B6%E8%B5%8F%E6%9E%90%E5%88%B0%E5%BA%95%E6%98%AF%E4%BB%80%E4%B9%88%E8%AE%A9%E4%BD%A0%E9%80%89%E6%8B%A9-mybatis/"><span>01 å¸¸è§æŒä¹…å±‚æ¡†æ¶èµæï¼Œåˆ°åº•æ˜¯ä»€ä¹ˆè®©ä½ é€‰æ‹© MyBatisï¼Ÿ</span></a>
    </div>
    <div class="next">
        
        <a href="/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/03-mybatis-%E6%BA%90%E7%A0%81%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E5%8F%8A%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84%E8%A7%A3%E6%9E%90/"><span>03 MyBatis æºç ç¯å¢ƒæ­å»ºåŠæ•´ä½“æ¶æ„è§£æ</span></a>
    </div>
</div>

        </div>
        <div class="toggler" onclick="toggleLight(this);">ğŸ’¡</div>
        <div id="copyright" style="display: none;">
    
    
    <p>&copy; 28280 <a href="/"></a>, powered by Hugo and Qiao</p>
</div>
    </footer>
    
<script>
    function toggleLight() {
        document.getElementById('page').classList.toggle('night');
    }
</script>
</body>

</html>