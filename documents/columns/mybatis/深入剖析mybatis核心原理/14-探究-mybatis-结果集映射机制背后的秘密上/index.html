<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
<meta name="X-UA-Compatible" , content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<link rel="icon" type="image/png" href="/%20/favicon.png">

<title>14 æ¢ç©¶ MyBatis ç»“æœé›†æ˜ å°„æœºåˆ¶èƒŒåçš„ç§˜å¯†ï¼ˆä¸Šï¼‰ | Yipsen Ye</title>
<meta name="description" content="åœ¨å‰é¢ä»‹ç» MyBatis è§£æ Mapper.xml æ˜ å°„æ–‡ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ° &amp;lt;resultMap&amp;gt; æ ‡ç­¾ä¼šè¢«è§£ææˆ ResultMap å¯¹è±¡ï¼Œå…¶ä¸­å®šä¹‰äº† ResultSet ä¸ Java å¯¹è±¡çš„æ˜ å°„è§„åˆ™ï¼Œç®€å•æ¥è¯´ï¼Œä¹Ÿå°±æ˜¯ä¸€è¡Œæ•°æ®è®°å½•å¦‚ä½•æ˜ å°„æˆä¸€ä¸ª Java å¯¹è±¡ï¼Œè¿™ç§æ˜ å°„æœºåˆ¶æ˜¯ MyBatis ä½œä¸º ORM æ¡†æ¶çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ã€‚
ResultMap åªæ˜¯å®šä¹‰äº†ä¸€ä¸ªé™æ€çš„æ˜ å°„è§„åˆ™ï¼Œé‚£åœ¨è¿è¡Œæ—¶ï¼ŒMyBatis æ˜¯å¦‚ä½•æ ¹æ®æ˜ å°„è§„åˆ™å°† ResultSet æ˜ å°„æˆ Java å¯¹è±¡çš„å‘¢ï¼Ÿå½“ MyBatis æ‰§è¡Œå®Œä¸€æ¡ select è¯­å¥ï¼Œæ‹¿åˆ° ResultSet ç»“æœé›†ä¹‹åï¼Œä¼šå°†å…¶äº¤ç»™å…³è”çš„ ResultSetHandler è¿›è¡Œåç»­çš„æ˜ å°„å¤„ç†ã€‚
ResultSetHandler æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå…¶ä¸­å®šä¹‰äº†ä¸‰ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ç”¨æ¥å¤„ç†ä¸åŒçš„æŸ¥è¯¢è¿”å›å€¼ï¼š
public interface ResultSetHandler {// å°†ResultSetæ˜ å°„æˆJavaå¯¹è±¡&amp;lt;E&amp;gt; List&amp;lt;E&amp;gt; handleResultSets(Statement stmt) throws SQLException;// å°†ResultSetæ˜ å°„æˆæ¸¸æ ‡å¯¹è±¡&amp;lt;E&amp;gt; Cursor&amp;lt;E&amp;gt; handleCursorResultSets(Statement stmt) throws SQLException;// å¤„ç†å­˜å‚¨è¿‡ç¨‹çš„è¾“å‡ºå‚æ•°void handleOutputParameters(CallableStatement cs) throws SQLException;}åœ¨ MyBatis ä¸­åªæä¾›äº†ä¸€ä¸ª ResultSetHandler æ¥å£å®ç°ï¼Œå³ DefaultResultSetHandlerã€‚ä¸‹é¢æˆ‘ä»¬å°±ä»¥ DefaultResultSetHandler ä¸ºä¸­å¿ƒï¼Œä»‹ç» MyBatis ä¸­ ResultSet æ˜ å°„çš„æ ¸å¿ƒæµç¨‹ã€‚">
<meta name="author" content="">

<link rel="stylesheet" type="text/css" href="/styles/main.css">

</head>

<body id="page">
    <header>
        <div class="nav-logo">
    <a href="http://yipsen.github.io/">
        
        <span class="nav-title">Yipsen Ye</span>
    </a>
</div>
<nav class="navbar justify-content-end">
    <ul class="nav-list">
        
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/posts/">æ–‡ç« </a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/collections/">é™„è¡¨</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/about/">å…³äº</a>
        </li>
        
    </ul>
</nav>
    </header>
    <main id="content">
        
<div class="container"><aside>
    <div>
        
        
            
            
            <div class="post-category-icon"></div>
            <a href="/categories/%e6%b7%b1%e5%85%a5%e5%89%96%e6%9e%90mybatis%e6%a0%b8%e5%bf%83%e5%8e%9f%e7%90%86/">æ·±å…¥å‰–æMyBatisæ ¸å¿ƒåŸç†</a>
            <ul>
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/00-%E5%BC%80%E7%AF%87%E8%AF%8D-%E9%A2%86%E7%95%A5-mybatis-%E8%AE%BE%E8%AE%A1%E6%80%9D%E7%BB%B4%E7%AA%81%E7%A0%B4%E6%8C%81%E4%B9%85%E5%8C%96%E6%8A%80%E6%9C%AF%E7%93%B6%E9%A2%88/">00 å¼€ç¯‡è¯ é¢†ç•¥ MyBatis è®¾è®¡æ€ç»´ï¼Œçªç ´æŒä¹…åŒ–æŠ€æœ¯ç“¶é¢ˆ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/01-%E5%B8%B8%E8%A7%81%E6%8C%81%E4%B9%85%E5%B1%82%E6%A1%86%E6%9E%B6%E8%B5%8F%E6%9E%90%E5%88%B0%E5%BA%95%E6%98%AF%E4%BB%80%E4%B9%88%E8%AE%A9%E4%BD%A0%E9%80%89%E6%8B%A9-mybatis/">01 å¸¸è§æŒä¹…å±‚æ¡†æ¶èµæï¼Œåˆ°åº•æ˜¯ä»€ä¹ˆè®©ä½ é€‰æ‹© MyBatisï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/02-%E8%AE%A2%E5%8D%95%E7%B3%BB%E7%BB%9F%E6%8C%81%E4%B9%85%E5%B1%82%E7%A4%BA%E4%BE%8B%E5%88%86%E6%9E%9020-%E5%88%86%E9%92%9F%E5%B8%A6%E4%BD%A0%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B-mybatis/">02 è®¢å•ç³»ç»ŸæŒä¹…å±‚ç¤ºä¾‹åˆ†æï¼Œ20 åˆ†é’Ÿå¸¦ä½ å¿«é€Ÿä¸Šæ‰‹ MyBatis</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/03-mybatis-%E6%BA%90%E7%A0%81%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E5%8F%8A%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84%E8%A7%A3%E6%9E%90/">03 MyBatis æºç ç¯å¢ƒæ­å»ºåŠæ•´ä½“æ¶æ„è§£æ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/04-mybatis-%E5%8F%8D%E5%B0%84%E5%B7%A5%E5%85%B7%E7%AE%B1%E5%B8%A6%E4%BD%A0%E9%A2%86%E7%95%A5%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84%E5%8F%8D%E5%B0%84%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF/">04 MyBatis åå°„å·¥å…·ç®±ï¼šå¸¦ä½ é¢†ç•¥ä¸ä¸€æ ·çš„åå°„è®¾è®¡æ€è·¯</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/05-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8B%E4%BD%93%E7%B3%BB%E4%B8%8E-java-%E7%B1%BB%E5%9E%8B%E4%BD%93%E7%B3%BB%E4%B9%8B%E9%97%B4%E7%9A%84%E7%88%B1%E6%81%A8%E6%83%85%E4%BB%87/">05 æ•°æ®åº“ç±»å‹ä½“ç³»ä¸ Java ç±»å‹ä½“ç³»ä¹‹é—´çš„â€œçˆ±æ¨æƒ…ä»‡â€</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/06-%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6%E5%8D%83%E5%8D%83%E4%B8%87mybatis-%E9%83%BD%E8%83%BD%E5%85%BC%E5%AE%B9%E7%9A%84%E7%A7%98%E5%AF%86%E6%98%AF%E4%BB%80%E4%B9%88/">06 æ—¥å¿—æ¡†æ¶åƒåƒä¸‡ï¼ŒMyBatis éƒ½èƒ½å…¼å®¹çš„ç§˜å¯†æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/07-%E6%B7%B1%E5%85%A5%E6%95%B0%E6%8D%AE%E6%BA%90%E5%92%8C%E4%BA%8B%E5%8A%A1%E6%8A%8A%E6%8F%A1%E6%8C%81%E4%B9%85%E5%8C%96%E6%A1%86%E6%9E%B6%E7%9A%84%E4%B8%A4%E4%B8%AA%E5%85%B3%E9%94%AE%E5%91%BD%E8%84%89/">07 æ·±å…¥æ•°æ®æºå’Œäº‹åŠ¡ï¼ŒæŠŠæ¡æŒä¹…åŒ–æ¡†æ¶çš„ä¸¤ä¸ªå…³é”®å‘½è„‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/08-mapper-%E6%96%87%E4%BB%B6%E4%B8%8E-java-%E6%8E%A5%E5%8F%A3%E7%9A%84%E4%BC%98%E9%9B%85%E6%98%A0%E5%B0%84%E4%B9%8B%E9%81%93/">08 Mapper æ–‡ä»¶ä¸ Java æ¥å£çš„ä¼˜é›…æ˜ å°„ä¹‹é“</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/09-%E5%9F%BA%E4%BA%8E-mybatis-%E7%BC%93%E5%AD%98%E5%88%86%E6%9E%90%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/">09 åŸºäº MyBatis ç¼“å­˜åˆ†æè£…é¥°å™¨æ¨¡å¼çš„æœ€ä½³å®è·µ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/10-%E9%B8%9F%E7%9E%B0-mybatis-%E5%88%9D%E5%A7%8B%E5%8C%96%E6%8A%8A%E6%8F%A1-mybatis-%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E8%84%89%E7%BB%9C%E4%B8%8A/">10 é¸Ÿç° MyBatis åˆå§‹åŒ–ï¼ŒæŠŠæ¡ MyBatis å¯åŠ¨æµç¨‹è„‰ç»œï¼ˆä¸Šï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/11-%E9%B8%9F%E7%9E%B0-mybatis-%E5%88%9D%E5%A7%8B%E5%8C%96%E6%8A%8A%E6%8F%A1-mybatis-%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E8%84%89%E7%BB%9C%E4%B8%8B/">11 é¸Ÿç° MyBatis åˆå§‹åŒ–ï¼ŒæŠŠæ¡ MyBatis å¯åŠ¨æµç¨‹è„‰ç»œï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/12-%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90%E5%8A%A8%E6%80%81-sql-%E8%AF%AD%E5%8F%A5%E8%A7%A3%E6%9E%90%E5%85%A8%E6%B5%81%E7%A8%8B%E4%B8%8A/">12 æ·±å…¥åˆ†æåŠ¨æ€ SQL è¯­å¥è§£æå…¨æµç¨‹ï¼ˆä¸Šï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/13-%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90%E5%8A%A8%E6%80%81-sql-%E8%AF%AD%E5%8F%A5%E8%A7%A3%E6%9E%90%E5%85%A8%E6%B5%81%E7%A8%8B%E4%B8%8B/">13 æ·±å…¥åˆ†æåŠ¨æ€ SQL è¯­å¥è§£æå…¨æµç¨‹ï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li>14 æ¢ç©¶ MyBatis ç»“æœé›†æ˜ å°„æœºåˆ¶èƒŒåçš„ç§˜å¯†ï¼ˆä¸Šï¼‰</li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/15-%E6%8E%A2%E7%A9%B6-mybatis-%E7%BB%93%E6%9E%9C%E9%9B%86%E6%98%A0%E5%B0%84%E6%9C%BA%E5%88%B6%E8%83%8C%E5%90%8E%E7%9A%84%E7%A7%98%E5%AF%86%E4%B8%8B/">15 æ¢ç©¶ MyBatis ç»“æœé›†æ˜ å°„æœºåˆ¶èƒŒåçš„ç§˜å¯†ï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/16-statementhandler%E5%8F%82%E6%95%B0%E7%BB%91%E5%AE%9Asql-%E6%89%A7%E8%A1%8C%E5%92%8C%E7%BB%93%E6%9E%9C%E6%98%A0%E5%B0%84%E7%9A%84%E5%A5%A0%E5%9F%BA%E8%80%85/">16 StatementHandlerï¼šå‚æ•°ç»‘å®šã€SQL æ‰§è¡Œå’Œç»“æœæ˜ å°„çš„å¥ åŸºè€…</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/17-executor-%E6%89%8D%E6%98%AF%E6%89%A7%E8%A1%8C-sql-%E8%AF%AD%E5%8F%A5%E7%9A%84%E5%B9%95%E5%90%8E%E6%8E%A8%E6%89%8B%E4%B8%8A/">17 Executor æ‰æ˜¯æ‰§è¡Œ SQL è¯­å¥çš„å¹•åæ¨æ‰‹ï¼ˆä¸Šï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/18-executor-%E6%89%8D%E6%98%AF%E6%89%A7%E8%A1%8C-sql-%E8%AF%AD%E5%8F%A5%E7%9A%84%E5%B9%95%E5%90%8E%E6%8E%A8%E6%89%8B%E4%B8%8B/">18 Executor æ‰æ˜¯æ‰§è¡Œ SQL è¯­å¥çš„å¹•åæ¨æ‰‹ï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/19-%E6%B7%B1%E5%85%A5-mybatis-%E5%86%85%E6%A0%B8%E4%B8%8E%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E7%9A%84%E6%A1%A5%E6%A2%81%E6%8E%A5%E5%8F%A3%E5%B1%82/">19 æ·±å…¥ MyBatis å†…æ ¸ä¸ä¸šåŠ¡é€»è¾‘çš„æ¡¥æ¢â€”â€”æ¥å£å±‚</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/20-%E6%8F%92%E4%BB%B6%E4%BD%93%E7%B3%BB%E8%AE%A9-mybatis-%E4%B8%96%E7%95%8C%E6%9B%B4%E5%8A%A0%E7%B2%BE%E5%BD%A9/">20 æ’ä»¶ä½“ç³»è®© MyBatis ä¸–ç•Œæ›´åŠ ç²¾å½©</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/21-%E6%B7%B1%E6%8C%96-mybatis-%E4%B8%8E-spring-%E9%9B%86%E6%88%90%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/">21 æ·±æŒ– MyBatis ä¸ Spring é›†æˆåº•å±‚åŸç†</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/22-%E5%9F%BA%E4%BA%8E-mybatis-%E7%9A%84%E8%A1%8D%E7%94%9F%E6%A1%86%E6%9E%B6%E4%B8%80%E8%A7%88/">22 åŸºäº MyBatis çš„è¡ç”Ÿæ¡†æ¶ä¸€è§ˆ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/23-%E7%BB%93%E6%9D%9F%E8%AF%AD-%E4%BC%9A%E4%BD%BF%E7%94%A8%E5%8F%AA%E8%83%BD%E9%BB%98%E9%BB%98%E6%90%AC%E7%A0%96%E6%87%82%E5%8E%9F%E7%90%86%E6%89%8D%E8%83%BD%E5%BF%AB%E9%80%9F%E6%99%8B%E5%8D%87/">23 ç»“æŸè¯­ ä¼šä½¿ç”¨åªèƒ½é»˜é»˜â€œæ¬ç –â€ï¼Œæ‡‚åŸç†æ‰èƒ½å¿«é€Ÿæ™‹å‡</a></li>
                
                
            </ul>
        
    </div>
</aside>

<style>
    aside {
        position: fixed;
        left: 20px;
        background: #ffdee3;
        border-radius: 6px;
        padding: 20px;
        padding-top: 60px;
        box-shadow: 5px 10px #888;
        list-style-type: none;
        display: none;
    }

    .post-category-icon {
        position: absolute;
        width: 80px;
        height: 80px;
        top: -40px;
        left: 50%;
        margin-left: -40px;
        text-align: center;
        font-size: 36px;
        content: 'J';
        background: #ffdee3;
        border-radius: 100%;
        border: 10px solid #fff;
        box-shadow: 5px 10px #888;
    }
</style><article class="post-block">
        <h1 class="post-title">14 æ¢ç©¶ MyBatis ç»“æœé›†æ˜ å°„æœºåˆ¶èƒŒåçš„ç§˜å¯†ï¼ˆä¸Šï¼‰</h1>
        <div class="post-info">
            <div class="post-date"> 
                <span>2021-12-22 01:51:16</span>
            </div>
        </div>
        <div class="post-content">
            <p>åœ¨å‰é¢ä»‹ç» MyBatis è§£æ Mapper.xml æ˜ å°„æ–‡ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ° <code>&lt;resultMap&gt;</code> æ ‡ç­¾ä¼šè¢«è§£ææˆ ResultMap å¯¹è±¡ï¼Œå…¶ä¸­å®šä¹‰äº† ResultSet ä¸ Java å¯¹è±¡çš„æ˜ å°„è§„åˆ™ï¼Œç®€å•æ¥è¯´ï¼Œä¹Ÿå°±æ˜¯<strong>ä¸€è¡Œæ•°æ®è®°å½•å¦‚ä½•æ˜ å°„æˆä¸€ä¸ª Java å¯¹è±¡</strong>ï¼Œè¿™ç§æ˜ å°„æœºåˆ¶æ˜¯ MyBatis ä½œä¸º ORM æ¡†æ¶çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ã€‚</p>
<p>ResultMap åªæ˜¯å®šä¹‰äº†ä¸€ä¸ªé™æ€çš„æ˜ å°„è§„åˆ™ï¼Œé‚£åœ¨è¿è¡Œæ—¶ï¼ŒMyBatis æ˜¯å¦‚ä½•æ ¹æ®æ˜ å°„è§„åˆ™å°† ResultSet æ˜ å°„æˆ Java å¯¹è±¡çš„å‘¢ï¼Ÿå½“ MyBatis æ‰§è¡Œå®Œä¸€æ¡ select è¯­å¥ï¼Œ<strong>æ‹¿åˆ° ResultSet ç»“æœé›†ä¹‹åï¼Œä¼šå°†å…¶äº¤ç»™å…³è”çš„ ResultSetHandler è¿›è¡Œåç»­çš„æ˜ å°„å¤„ç†</strong>ã€‚</p>
<p>ResultSetHandler æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå…¶ä¸­å®šä¹‰äº†ä¸‰ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ç”¨æ¥å¤„ç†ä¸åŒçš„æŸ¥è¯¢è¿”å›å€¼ï¼š</p>
<pre tabindex="0"><code>public interface ResultSetHandler {

    // å°†ResultSetæ˜ å°„æˆJavaå¯¹è±¡

    &lt;E&gt; List&lt;E&gt; handleResultSets(Statement stmt) throws SQLException;

    // å°†ResultSetæ˜ å°„æˆæ¸¸æ ‡å¯¹è±¡

    &lt;E&gt; Cursor&lt;E&gt; handleCursorResultSets(Statement stmt) throws SQLException;

    // å¤„ç†å­˜å‚¨è¿‡ç¨‹çš„è¾“å‡ºå‚æ•°

    void handleOutputParameters(CallableStatement cs) throws SQLException;

}
</code></pre><p><strong>åœ¨ MyBatis ä¸­åªæä¾›äº†ä¸€ä¸ª ResultSetHandler æ¥å£å®ç°ï¼Œå³ DefaultResultSetHandler</strong>ã€‚ä¸‹é¢æˆ‘ä»¬å°±ä»¥ DefaultResultSetHandler ä¸ºä¸­å¿ƒï¼Œä»‹ç» MyBatis ä¸­ ResultSet æ˜ å°„çš„æ ¸å¿ƒæµç¨‹ã€‚</p>
<h3 id="ç»“æœé›†å¤„ç†å…¥å£">ç»“æœé›†å¤„ç†å…¥å£</h3>
<p>ä½ å¦‚æœæœ‰ JDBC ç¼–ç¨‹ç»éªŒçš„è¯ï¼Œåº”è¯¥çŸ¥é“åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œä¸€æ¡ Select è¯­å¥é€šå¸¸åªèƒ½æ‹¿åˆ°ä¸€ä¸ª ResultSetï¼Œä½†è¿™åªæ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„ä¸€ç§æŸ¥è¯¢æ•°æ®åº“çš„æ–¹å¼ï¼Œå…¶å®æ•°æ®åº“è¿˜æ”¯æŒåŒæ—¶è¿”å›å¤šä¸ª ResultSet çš„åœºæ™¯ï¼Œä¾‹å¦‚åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­æ‰§è¡Œå¤šæ¡ Select è¯­å¥ã€‚MyBatis ä½œä¸ºä¸€ä¸ªé€šç”¨çš„æŒä¹…åŒ–æ¡†æ¶ï¼Œä¸ä»…è¦æ”¯æŒå¸¸ç”¨çš„åŸºç¡€åŠŸèƒ½ï¼Œè¿˜è¦å¯¹å…¶ä»–ä½¿ç”¨åœºæ™¯è¿›è¡Œå…¨é¢çš„æ”¯æŒã€‚</p>
<p><strong>DefaultResultSetHandler å®ç°çš„ handleResultSets() æ–¹æ³•æ”¯æŒå¤šä¸ª ResultSet çš„å¤„ç†</strong>ï¼ˆå• ResultSet çš„å¤„ç†åªæ˜¯å…¶ä¸­çš„ç‰¹ä¾‹ï¼‰ï¼Œç›¸å…³çš„ä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>public List&lt;Object&gt; handleResultSets(Statement stmt) throws SQLException {

    // ç”¨äºè®°å½•æ¯ä¸ªResultSetæ˜ å°„å‡ºæ¥çš„Javaå¯¹è±¡

    final List&lt;Object&gt; multipleResults = new ArrayList&lt;&gt;();

    int resultSetCount = 0;

    // ä»Statementä¸­è·å–ç¬¬ä¸€ä¸ªResultSetï¼Œå…¶ä¸­å¯¹ä¸åŒçš„æ•°æ®åº“æœ‰å…¼å®¹å¤„ç†é€»è¾‘,

    // è¿™é‡Œæ‹¿åˆ°çš„ResultSetä¼šè¢«å°è£…æˆResultSetWrapperå¯¹è±¡è¿”å›

    ResultSetWrapper rsw = getFirstResultSet(stmt);

    // è·å–è¿™æ¡SQLè¯­å¥å…³è”çš„å…¨éƒ¨ResultMapè§„åˆ™ã€‚å¦‚æœä¸€æ¡SQLè¯­å¥èƒ½å¤Ÿäº§ç”Ÿå¤šä¸ªResultSetï¼Œ

    // é‚£ä¹ˆåœ¨ç¼–å†™Mapper.xmlæ˜ å°„æ–‡ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨SQLæ ‡ç­¾çš„resultMapå±æ€§ä¸­é…ç½®å¤šä¸ª

    // &lt;resultMap&gt;æ ‡ç­¾çš„idï¼Œå®ƒä»¬ä¹‹é—´é€šè¿‡&quot;,&quot;åˆ†éš”ï¼Œå®ç°å¯¹å¤šä¸ªç»“æœé›†çš„æ˜ å°„

    List&lt;ResultMap&gt; resultMaps = mappedStatement.getResultMaps();

    int resultMapCount = resultMaps.size();

    validateResultMapsCount(rsw, resultMapCount);

    while (rsw != null &amp;&amp; resultMapCount &gt; resultSetCount) { // éå†ResultMapé›†åˆ

        ResultMap resultMap = resultMaps.get(resultSetCount);

        // æ ¹æ®ResultMapä¸­å®šä¹‰çš„æ˜ å°„è§„åˆ™å¤„ç†ResultSetï¼Œå¹¶å°†æ˜ å°„å¾—åˆ°çš„Javaå¯¹è±¡æ·»åŠ åˆ°

        // multipleResultsé›†åˆä¸­ä¿å­˜

        handleResultSet(rsw, resultMap, multipleResults, null);

        // è·å–ä¸‹ä¸€ä¸ªResultSet

        rsw = getNextResultSet(stmt);

        // æ¸…ç†nestedResultObjectsé›†åˆï¼Œè¿™ä¸ªé›†åˆæ˜¯ç”¨æ¥å­˜å‚¨ä¸­é—´æ•°æ®çš„

        cleanUpAfterHandlingResultSet();

        resultSetCount++; // é€’å¢ResultSetç¼–å·

    }

    // ä¸‹é¢è¿™æ®µé€»è¾‘æ˜¯æ ¹æ®ResultSetçš„åç§°å¤„ç†åµŒå¥—æ˜ å°„ï¼Œä½ å¯ä»¥æš‚æ—¶ä¸å…³æ³¨è¿™æ®µä»£ç ï¼Œ

    // åµŒå¥—æ˜ å°„ä¼šåœ¨åé¢è¯¦ç»†ä»‹ç»

    ... 

    // è¿”å›å…¨éƒ¨æ˜ å°„å¾—åˆ°çš„Javaå¯¹è±¡

    return collapseSingleResultList(multipleResults);

}
</code></pre><p>è¿™é‡Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹éå†å¤šç»“æœé›†æ—¶ä½¿ç”¨åˆ°çš„ getFirstResultSet() æ–¹æ³•å’Œ getNextResultSet() æ–¹æ³•ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•åº•å±‚éƒ½æ˜¯ä¾èµ– java.sql.Statement çš„ getMoreResults() æ–¹æ³•å’Œ getUpdateCount() æ–¹æ³•æ£€æµ‹æ˜¯å¦å­˜åœ¨åç»­çš„ ResultSet å¯¹è±¡ï¼Œæ£€æµ‹æˆåŠŸä¹‹åï¼Œä¼šé€šè¿‡ getResultSet() æ–¹æ³•è·å–ä¸‹ä¸€ä¸ª ResultSet å¯¹è±¡ã€‚</p>
<p><strong>è¿™é‡Œè·å–åˆ°çš„ ResultSet å¯¹è±¡ï¼Œä¼šè¢«åŒ…è£…æˆ ResultSetWrapper å¯¹è±¡è¿”å›ã€‚</strong></p>
<p>ResultSetWrapper ä¸»è¦ç”¨äºå°è£… ResultSet çš„ä¸€äº›å…ƒæ•°æ®ï¼Œå…¶ä¸­è®°å½•äº† ResultSet ä¸­æ¯åˆ—çš„åç§°ã€å¯¹åº”çš„ Java ç±»å‹ã€JdbcType ç±»å‹ä»¥åŠæ¯åˆ—å¯¹åº”çš„ TypeHandlerã€‚</p>
<p>å¦å¤–ï¼ŒResultSetWrapper å¯ä»¥å°†åº•å±‚ ResultSet çš„åˆ—ä¸ä¸€ä¸ª ResultMap æ˜ å°„çš„åˆ—è¿›è¡Œäº¤é›†ï¼Œå¾—åˆ°å‚ä¸æ˜ å°„çš„åˆ—å’Œæœªè¢«æ˜ å°„çš„åˆ—ï¼Œåˆ†åˆ«è®°å½•åˆ° mappedColumnNamesMap é›†åˆå’Œ unMappedColumnNamesMap é›†åˆä¸­ã€‚è¿™ä¸¤ä¸ªé›†åˆéƒ½æ˜¯ Map<code>&lt;String, List&lt;String&gt;&gt;</code> ç±»å‹ï¼Œå…¶ä¸­æœ€å¤–å±‚çš„ Key æ˜¯ ResultMap çš„ idï¼ŒValue åˆ†åˆ«æ˜¯å‚ä¸æ˜ å°„çš„åˆ—åé›†åˆå’Œæœªè¢«æ˜ å°„çš„åˆ—åé›†åˆã€‚</p>
<p>é™¤äº†è®°å½•ä¸Šè¿°å…ƒæ•°æ®ä»¥å¤–ï¼ŒResultSetWrapper è¿˜å°è£…äº†ä¸€å¥—æŸ¥è¯¢ä¸Šè¿°å…ƒæ•°æ®çš„æ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ getMappedColumnNames() æ–¹æ³•æŸ¥è¯¢ä¸€ä¸ª ResultMap æ˜ å°„äº†å½“å‰ ResultSet çš„å“ªäº›åˆ—ï¼Œè¿˜å¯ä»¥é€šè¿‡ getJdbcType()ã€getTypeHandler() ç­‰æ–¹æ³•æŸ¥è¯¢æŒ‡å®šåˆ—å¯¹åº”çš„ JdbcTypeã€TypeHandler ç­‰ã€‚</p>
<h3 id="ç®€å•æ˜ å°„">ç®€å•æ˜ å°„</h3>
<p>äº†è§£äº†å¤„ç† ResultSet çš„å…¥å£é€»è¾‘ä¹‹åï¼Œä¸‹é¢æˆ‘ä»¬ç»§ç»­æ¥æ·±å…¥äº†è§£ä¸€ä¸‹ DefaultResultSetHandler æ˜¯å¦‚ä½•å¤„ç†å•ä¸ªç»“æœé›†çš„ï¼Œè¿™éƒ¨åˆ†é€»è¾‘çš„å…¥å£æ˜¯ handleResultSet() æ–¹æ³•ï¼Œå…¶ä¸­ä¼šæ ¹æ®ç¬¬å››ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ parentMappingï¼Œåˆ¤æ–­å½“å‰è¦å¤„ç†çš„ ResultSet æ˜¯åµŒå¥—æ˜ å°„ï¼Œè¿˜æ˜¯å¤–å±‚æ˜ å°„ã€‚</p>
<p>æ— è®ºæ˜¯å¤„ç†å¤–å±‚æ˜ å°„è¿˜æ˜¯åµŒå¥—æ˜ å°„ï¼Œ<strong>éƒ½ä¼šä¾èµ– handleRowValues() æ–¹æ³•å®Œæˆç»“æœé›†çš„å¤„ç†</strong>ï¼ˆé€šè¿‡æ–¹æ³•åä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒhandleRowValues() æ–¹æ³•æ˜¯å¤„ç†å¤šè¡Œè®°å½•çš„ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªç»“æœé›†ï¼‰ã€‚</p>
<p>è‡³äº handleRowValues() æ–¹æ³•ï¼Œå…¶ä¸­ä¼šé€šè¿‡ handleRowValuesForNestedResultMap() æ–¹æ³•å¤„ç†åŒ…å«åµŒå¥—æ˜ å°„çš„ ResultMapï¼Œé€šè¿‡ handleRowValuesForSimpleResultMap() æ–¹æ³•å¤„ç†ä¸åŒ…å«åµŒå¥—æ˜ å°„çš„ç®€å• ResultMapï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>public void handleRowValues(ResultSetWrapper rsw, ResultMap resultMap, ResultHandler&lt;?&gt; resultHandler, RowBounds rowBounds, ResultMapping parentMapping) throws SQLException {

    if (resultMap.hasNestedResultMaps()) { // åŒ…å«åµŒå¥—æ˜ å°„çš„å¤„ç†æµç¨‹

        ensureNoRowBounds();

        checkResultHandler();

        handleRowValuesForNestedResultMap(rsw, resultMap, resultHandler, rowBounds, parentMapping);

    } else { // ç®€å•æ˜ å°„çš„å¤„ç†

        handleRowValuesForSimpleResultMap(rsw, resultMap, resultHandler, rowBounds, parentMapping);

    }

}
</code></pre><p>è¿™é‡Œæˆ‘ä»¬é‡ç‚¹æ¥çœ‹ handleRowValuesForSimpleResultMap() æ–¹æ³•å¦‚ä½•æ˜ å°„ä¸€ä¸ª ResultSet çš„ï¼Œè¯¥æ–¹æ³•çš„æ ¸å¿ƒæ­¥éª¤å¯æ€»ç»“ä¸ºå¦‚ä¸‹ã€‚</p>
<ol>
<li>æ‰§è¡Œ skipRows() æ–¹æ³•è·³è¿‡å¤šä½™çš„è®°å½•ï¼Œå®šä½åˆ°æŒ‡å®šçš„è¡Œã€‚</li>
<li>é€šè¿‡ shouldProcessMoreRows() æ–¹æ³•ï¼Œæ£€æµ‹æ˜¯å¦è¿˜æœ‰éœ€è¦æ˜ å°„çš„æ•°æ®è®°å½•ã€‚</li>
<li>å¦‚æœå­˜åœ¨éœ€è¦æ˜ å°„çš„è®°å½•ï¼Œåˆ™å…ˆé€šè¿‡ resolveDiscriminatedResultMap() æ–¹æ³•å¤„ç†æ˜ å°„ä¸­ç”¨åˆ°çš„ Discriminatorï¼Œå†³å®šæ­¤æ¬¡æ˜ å°„å®é™…ä½¿ç”¨çš„ ResultMapã€‚</li>
<li>é€šè¿‡ getRowValue() æ–¹æ³•å¯¹ ResultSet ä¸­çš„ä¸€è¡Œè®°å½•è¿›è¡Œæ˜ å°„ï¼Œæ˜ å°„è§„åˆ™ä½¿ç”¨çš„å°±æ˜¯æ­¥éª¤ 3 ä¸­ç¡®å®šçš„ ResultMapã€‚</li>
<li>æ‰§è¡Œ storeObject() æ–¹æ³•è®°å½•æ­¥éª¤ 4 ä¸­è¿”å›çš„ã€æ˜ å°„å¥½çš„ Java å¯¹è±¡ã€‚</li>
</ol>
<p>åœ¨å¼€å§‹è¯¦ç»†ä»‹ç»ä¸Šè¿°æ˜ å°„æµç¨‹ä¸­çš„æ¯ä¸€æ­¥ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹è´¯ç©¿æ•´ä¸ªæ˜ å°„è¿‡ç¨‹çš„ä¸¤ä¸ªè¾…åŠ©å¯¹è±¡â€”â€”<strong>DefaultResultHandler å’Œ DefaultResultContext</strong>ã€‚</p>
<p>åœ¨ DefaultResultSetHandler ä¸­ç»´æŠ¤äº†ä¸€ä¸ª resultHandler å­—æ®µï¼ˆResultHandler æ¥å£ç±»å‹ï¼‰æŒ‡å‘ä¸€ä¸ª DefaultResultHandler å¯¹è±¡ï¼Œå…¶æ ¸å¿ƒä½œç”¨æ˜¯å­˜å‚¨å¤šä¸ªç»“æœé›†æ˜ å°„å¾—åˆ°çš„ Java å¯¹è±¡ã€‚</p>
<p>ResultHandler æ¥å£æœ‰ä¸¤ä¸ªé»˜è®¤å®ç°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90%20MyBatis%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86-%E5%AE%8C/assets/CioPOWBImeaAdnRHAAEZqfOie0w629.png" alt="å›¾ç‰‡1.png"></p>
<p>ResultHandler æ¥å£ç»§æ‰¿å›¾</p>
<p>DefaultResultHandler å®ç°çš„åº•å±‚ä½¿ç”¨ ArrayList<code>&lt;Object&gt;</code> å­˜å‚¨æ˜ å°„å¾—åˆ°çš„ Java å¯¹è±¡ï¼ŒDefaultMapResultHandler å®ç°çš„åº•å±‚ä½¿ç”¨ Map<code>&lt;K, V&gt;</code> å­˜å‚¨æ˜ å°„å¾—åˆ°çš„ Java å¯¹è±¡ï¼Œå…¶ä¸­ Key æ˜¯ä»ç»“æœå¯¹è±¡ä¸­è·å–çš„æŒ‡å®šå±æ€§çš„å€¼ï¼ŒValue å°±æ˜¯æ˜ å°„å¾—åˆ°çš„ Java å¯¹è±¡ã€‚</p>
<p>è‡³äº DefaultResultContext å¯¹è±¡ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸ä¸€ä¸ª ResultSet ç›¸åŒï¼Œæ¯ä» ResultSet æ˜ å°„å¾—åˆ°ä¸€ä¸ª Java å¯¹è±¡éƒ½ä¼šæš‚å­˜åˆ° DefaultResultContext ä¸­çš„ resultObject å­—æ®µï¼Œç­‰å¾…åç»­ä½¿ç”¨ï¼ŒåŒæ—¶ DefaultResultContext è¿˜å¯ä»¥è®¡ç®—ä»ä¸€ä¸ª ResultSet æ˜ å°„å‡ºæ¥çš„å¯¹è±¡ä¸ªæ•°ï¼ˆä¾é  resultCount å­—æ®µç»Ÿè®¡ï¼‰ã€‚</p>
<p>äº†è§£äº† handleRowValuesForSimpleResultMap() æ–¹æ³•çš„æ ¸å¿ƒæ­¥éª¤ä»¥åŠå…¨éƒ¨è´¯ç©¿æ•´ä¸ªæ˜ å°„æµç¨‹çš„è¾…åŠ©å¯¹è±¡ä¹‹åï¼Œä¸‹é¢æˆ‘ä»¬å¼€å§‹æ·±å…¥æ¯ä¸ªæ­¥éª¤è¿›è¡Œè¯¦ç»†åˆ†æã€‚</p>
<h4 id="1-resultset-çš„é¢„å¤„ç†">1. ResultSet çš„é¢„å¤„ç†</h4>
<p>æœ‰ MyBatis ä½¿ç”¨ç»éªŒçš„åŒå­¦å¯èƒ½çŸ¥é“ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ RowBounds æŒ‡å®š offsetã€limit å‚æ•°å®ç°åˆ†é¡µçš„æ•ˆæœã€‚<strong>è¿™é‡Œçš„ skipRows() æ–¹æ³•å°±ä¼šæ ¹æ® RowBounds ç§»åŠ¨ ResultSet çš„æŒ‡é’ˆåˆ°æŒ‡å®šçš„æ•°æ®è¡Œï¼Œè¿™æ ·åç»­çš„æ˜ å°„æ“ä½œå°±å¯ä»¥ä»è¿™ä¸€è¡Œå¼€å§‹</strong>ã€‚</p>
<p>skipRows() æ–¹æ³•ä¼šæ£€æŸ¥ ResultSet çš„å±æ€§ï¼Œå¦‚æœæ˜¯ TYPE_FORWARD_ONLY ç±»å‹ï¼Œåˆ™åªèƒ½é€šè¿‡å¾ªç¯ + ResultSet.next() æ–¹æ³•ï¼ˆæŒ‡é’ˆçš„é€è¡Œå‰ç§»ï¼‰å®šä½åˆ°æŒ‡å®šçš„æ•°æ®è¡Œï¼›åä¹‹ï¼Œå¯ä»¥é€šè¿‡ ResultSet.absolute() æ–¹æ³•ç›´æ¥ç§»åŠ¨æŒ‡é’ˆã€‚</p>
<p>å¤„ç† RowBounds çš„å¦ä¸€ä¸ªæ–¹æ³•æ˜¯ shouldProcessMoreRows() æ–¹æ³•ï¼Œå…¶ä¸­ä¼šæ£€æŸ¥å½“å‰å·²ç»æ˜ å°„çš„è¡Œæ˜¯å¦è¾¾åˆ°äº† RowBounds.limit å­—æ®µæŒ‡å®šçš„è¡Œæ•°ä¸Šé™ï¼Œå¦‚æœè¾¾åˆ°ï¼Œåˆ™è¿”å› falseï¼Œåœæ­¢åç»­æ“ä½œã€‚å½“ç„¶ï¼Œæ§åˆ¶æ˜¯å¦è¿›è¡Œåç»­æ˜ å°„æ“ä½œçš„æ¡ä»¶è¿˜æœ‰ ResultSet.next() æ–¹æ³•ï¼ˆå³ç»“æœé›†ä¸­æ˜¯å¦è¿˜æœ‰æ•°æ®ï¼‰ã€‚</p>
<p>é€šè¿‡ä¸Šè¿°åˆ†ææˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œé€šè¿‡ RowBounds å®ç°çš„åˆ†é¡µåŠŸèƒ½å®é™…ä¸Šè¿˜æ˜¯ä¼šå°†å…¨éƒ¨æ•°æ®åŠ è½½åˆ° ResultSet ä¸­ï¼Œè€Œä¸æ˜¯åªåŠ è½½æŒ‡å®šèŒƒå›´çš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¤ä¸º RowBounds å®ç°çš„æ˜¯ä¸€ç§â€œå‡åˆ†é¡µâ€ã€‚è¿™ç§â€œå‡åˆ†é¡µâ€åœ¨æ•°æ®é‡å¤§çš„æ—¶å€™ï¼Œæ€§èƒ½å°±ä¼šå¾ˆå·®ï¼Œåœ¨å¤„ç†å¤§æ•°æ®é‡åˆ†é¡µæ—¶ï¼Œå»ºè®®é€šè¿‡ SQL è¯­å¥ where æ¡ä»¶ + limit çš„æ–¹å¼å®ç°åˆ†é¡µã€‚</p>
<h4 id="2-ç¡®å®š-resultmap">2. ç¡®å®š ResultMap</h4>
<p>åœ¨å®Œæˆ ResultSet çš„é¢„å¤„ç†ä¹‹åï¼Œæ¥ä¸‹æ¥ä¼š<strong>é€šè¿‡ resolveDiscriminatedResultMap() æ–¹æ³•å¤„ç† æ ‡ç­¾ï¼Œç¡®å®šæ­¤æ¬¡æ˜ å°„æ“ä½œæœ€ç»ˆä½¿ç”¨çš„ ResultMap å¯¹è±¡</strong>ã€‚</p>
<p>ä¸ºäº†æ›´åŠ æ–¹ä¾¿å’Œå®Œæ•´åœ°æè¿° resolveDiscriminatedResultMap() æ–¹æ³•çš„æ ¸å¿ƒæµç¨‹ï¼Œè¿™é‡Œæˆ‘ä»¬ç»“åˆä¸€ä¸ªç®€å•ç¤ºä¾‹è¿›è¡Œåˆ†æï¼Œæ¯”å¦‚ï¼Œç°åœ¨æœ‰ä¸€ä¸ª ResultSet åŒ…å« idã€nameã€classifyã€subClassify å››åˆ—ï¼Œå¹¶ä¸”ç”± animalMap æ¥æ˜ å°„è¯¥ ResultSetï¼Œå…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90%20MyBatis%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86-%E5%AE%8C/assets/CioPOWBINOWAMLKdAAg_Jy5Lhxg738.png" alt="Drawing 1.png"></p>
<p>&lt; discriminator&gt;å¤„ç†ç¤ºä¾‹å›¾</p>
<p>é€šè¿‡ resolveDiscriminatedResultMap() æ–¹æ³•ç¡®å®š ResultMap çš„æµç¨‹å¤§è‡´æ˜¯è¿™æ ·çš„ï¼š</p>
<ul>
<li>é¦–å…ˆæŒ‰ç…§ animalMap è¿™ä¸ª ResultMap æ˜ å°„è¿™è¡Œè®°å½•ï¼Œè¯¥è¡Œè®°å½•ä¸­çš„ classify åˆ—å€¼ä¸º mammaliaï¼Œæ ¹æ®å…¶ä¸­å®šä¹‰çš„ <code>&lt;discriminator&gt;</code> æ ‡ç­¾çš„é…ç½®ï¼Œä¼šé€‰æ‹©ä½¿ç”¨ mammaliaMap è¿™ä¸ª ResultMap å¯¹å½“å‰è¿™æ¡è®°å½•è¿›è¡Œæ˜ å°„ï¼›</li>
<li>æ¥ä¸‹æ¥çœ‹ mammaliaMap è¿™ä¸ª ResultMapï¼Œå…¶ä¸­çš„ <code>&lt;discriminator&gt;</code> æ ‡ç­¾æ£€æŸ¥çš„æ˜¯ subClassify çš„åˆ—å€¼ï¼Œå½“å‰è®°å½•çš„ subClassify åˆ—å€¼ä¸º humanï¼Œæ‰€ä»¥ä¼šé€‰æ‹© humanMap è¿™ä¸ª ResultMap æ˜ å°„å½“å‰è¿™æ¡è®°å½•ï¼Œå¾—åˆ°ä¸€ä¸ª Human å¯¹è±¡ã€‚</li>
</ul>
<p>äº†è§£äº†ä¸Šè¿°åŸºæœ¬æµç¨‹ä¹‹åï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ resolveDiscriminatedResultMap() æ–¹æ³•çš„å…·ä½“å®ç°ï¼š</p>
<pre tabindex="0"><code>public ResultMap resolveDiscriminatedResultMap(ResultSet rs, ResultMap resultMap, String columnPrefix) throws SQLException {

    // ç”¨äºç»´æŠ¤å¤„ç†è¿‡çš„ResultMapå”¯ä¸€æ ‡è¯†

    Set&lt;String&gt; pastDiscriminators = new HashSet&lt;&gt;();

    // è·å–ResultMapä¸­çš„Discriminatorå¯¹è±¡ï¼Œè¿™æ˜¯é€šè¿‡&lt;resultMap&gt;æ ‡ç­¾ä¸­çš„&lt;discriminator&gt;æ ‡ç­¾è§£æå¾—åˆ°çš„

    Discriminator discriminator = resultMap.getDiscriminator();

    while (discriminator != null) {

        // è·å–å½“å‰å¾…æ˜ å°„çš„è®°å½•ä¸­Discriminatorè¦æ£€æµ‹çš„åˆ—çš„å€¼

        final Object value = getDiscriminatorValue(rs, discriminator, columnPrefix);

        // æ ¹æ®ä¸Šè¿°åˆ—å€¼ç¡®å®šè¦ä½¿ç”¨çš„ResultMapçš„å”¯ä¸€æ ‡è¯†

        final String discriminatedMapId = discriminator.getMapIdFor(String.valueOf(value));

        if (configuration.hasResultMap(discriminatedMapId)) {

            // ä»å…¨å±€é…ç½®å¯¹è±¡Configurationä¸­è·å–ResultMapå¯¹è±¡

            resultMap = configuration.getResultMap(discriminatedMapId);

            // è®°å½•å½“å‰Discriminatorå¯¹è±¡

            Discriminator lastDiscriminator = discriminator;

            // è·å–ResultMapå¯¹è±¡ä¸­çš„Discriminator

            discriminator = resultMap.getDiscriminator();

            // æ£€æµ‹Discriminatoræ˜¯å¦å‡ºç°äº†ç¯å½¢å¼•ç”¨

            if (discriminator == lastDiscriminator || !pastDiscriminators.add(discriminatedMapId)) {

                break;

            }

        } else {

            break;

        }

    }

    // è¿”å›æœ€ç»ˆè¦ä½¿ç”¨çš„ResultMap

    return resultMap;

}
</code></pre><h4 id="3-åˆ›å»ºæ˜ å°„ç»“æœå¯¹è±¡">3. åˆ›å»ºæ˜ å°„ç»“æœå¯¹è±¡</h4>
<p>ç»è¿‡ resolveDiscriminatedResultMap() æ–¹æ³•è§£æï¼Œæˆ‘ä»¬æœ€ç»ˆç¡®å®šäº†å½“å‰è®°å½•ä½¿ç”¨å“ªä¸ª ResultMap è¿›è¡Œæ˜ å°„ã€‚</p>
<p>æ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯<strong>æŒ‰ç…§ ResultMap è§„åˆ™è¿›è¡Œå„ä¸ªåˆ—çš„æ˜ å°„ï¼Œå¾—åˆ°æœ€ç»ˆçš„ Java å¯¹è±¡</strong>ï¼Œè¿™éƒ¨åˆ†é€»è¾‘æ˜¯åœ¨ä¸‹é¢è¦ä»‹ç»çš„ getRowValue() æ–¹æ³•å®Œæˆçš„ï¼Œå…¶æ ¸å¿ƒæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ul>
<li>é¦–å…ˆæ ¹æ® ResultMap çš„ type å±æ€§å€¼åˆ›å»ºæ˜ å°„çš„ç»“æœå¯¹è±¡ï¼›</li>
<li>ç„¶åæ ¹æ® ResultMap çš„é…ç½®ä»¥åŠå…¨å±€ä¿¡æ¯ï¼Œå†³å®šæ˜¯å¦è‡ªåŠ¨æ˜ å°„ ResultMap ä¸­æœªæ˜ç¡®æ˜ å°„çš„åˆ—ï¼›</li>
<li>æ¥ç€æ ¹æ® ResultMap æ˜ å°„è§„åˆ™ï¼Œå°† ResultSet ä¸­çš„åˆ—å€¼ä¸ç»“æœå¯¹è±¡ä¸­çš„å±æ€§å€¼è¿›è¡Œæ˜ å°„ï¼›</li>
<li>æœ€åè¿”å›æ˜ å°„çš„ç»“æœå¯¹è±¡ï¼Œå¦‚æœæ²¡æœ‰æ˜ å°„ä»»ä½•å±æ€§ï¼Œåˆ™éœ€è¦æ ¹æ®å…¨å±€é…ç½®å†³å®šå¦‚ä½•è¿”å›è¿™ä¸ªç»“æœå€¼ï¼Œè¿™é‡Œä¸åŒåœºæ™¯å’Œé…ç½®ï¼Œå¯èƒ½è¿”å›å®Œæ•´çš„ç»“æœå¯¹è±¡ã€ç©ºç»“æœå¯¹è±¡æˆ–æ˜¯ nullã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ getRowValue() æ–¹æ³•çš„æ ¸å¿ƒå®ç°ï¼š</p>
<pre tabindex="0"><code>private Object getRowValue(ResultSetWrapper rsw, ResultMap resultMap, String columnPrefix) throws SQLException {

    final ResultLoaderMap lazyLoader = new ResultLoaderMap();

    // æ ¹æ®ResultMapçš„typeå±æ€§å€¼åˆ›å»ºæ˜ å°„çš„ç»“æœå¯¹è±¡

    Object rowValue = createResultObject(rsw, resultMap, lazyLoader, columnPrefix);

    if (rowValue != null &amp;&amp; !hasTypeHandlerForResultObject(rsw, resultMap.getType())) {

        final MetaObject metaObject = configuration.newMetaObject(rowValue);

        boolean foundValues = this.useConstructorMappings;

        // æ ¹æ®ResultMapçš„é…ç½®ä»¥åŠå…¨å±€ä¿¡æ¯ï¼Œå†³å®šæ˜¯å¦è‡ªåŠ¨æ˜ å°„ResultMapä¸­æœªæ˜ç¡®æ˜ å°„çš„åˆ—

        if (shouldApplyAutomaticMappings(resultMap, false)) {

            foundValues = applyAutomaticMappings(rsw, resultMap, metaObject, columnPrefix) || foundValues;

        }

        // æ ¹æ®ResultMapæ˜ å°„è§„åˆ™ï¼Œå°†ResultSetä¸­çš„åˆ—å€¼ä¸ç»“æœå¯¹è±¡ä¸­çš„å±æ€§å€¼è¿›è¡Œæ˜ å°„

        foundValues = applyPropertyMappings(rsw, resultMap, metaObject, lazyLoader, columnPrefix) || foundValues;

        // å¦‚æœæ²¡æœ‰æ˜ å°„ä»»ä½•å±æ€§ï¼Œéœ€è¦æ ¹æ®å…¨å±€é…ç½®å†³å®šå¦‚ä½•è¿”å›è¿™ä¸ªç»“æœå€¼ï¼Œ

        // è¿™é‡Œä¸åŒåœºæ™¯å’Œé…ç½®ï¼Œå¯èƒ½è¿”å›å®Œæ•´çš„ç»“æœå¯¹è±¡ã€ç©ºç»“æœå¯¹è±¡æˆ–æ˜¯null

        foundValues = lazyLoader.size() &gt; 0 || foundValues;

        rowValue = foundValues || configuration.isReturnInstanceForEmptyRow() ? rowValue : null;

    }

    return rowValue;

}
</code></pre><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„ç¬¬ä¸€æ­¥ï¼Œä¹Ÿå°±æ˜¯åˆ›å»ºæ˜ å°„çš„ç»“æœå¯¹è±¡ï¼Œè¿™éƒ¨åˆ†é€»è¾‘ä½äº createResultObject() æ–¹æ³•ä¸­ã€‚è¿™ä¸ªæ–¹æ³•ä¸­æœ‰ä¸¤ä¸ªå…³é”®æ­¥éª¤ï¼šä¸€ä¸ªæ˜¯è°ƒç”¨å¦ä¸€ä¸ª createResultObject() é‡è½½æ–¹æ³•æ¥åˆ›å»ºç»“æœå¯¹è±¡ï¼Œå¦ä¸€ä¸ªæ˜¯é€šè¿‡ ProxyFactory åˆ›å»ºä»£ç†å¯¹è±¡æ¥å¤„ç†å»¶è¿ŸåŠ è½½çš„å±æ€§ã€‚</p>
<p>ç”±äºæˆ‘ä»¬é‡ç‚¹åˆ†æçš„æ˜¯ç®€å• ResultSet çš„æ˜ å°„æµç¨‹ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬é‡ç‚¹çœ‹ createResultObject() é‡è½½æ–¹æ³•æ˜¯å¦‚ä½•åˆ›å»ºæ˜ å°„ç»“æœå¯¹è±¡çš„ã€‚</p>
<p>é¦–å…ˆè¿›è¡Œä¸€äº›å‡†å¤‡å·¥ä½œï¼šè·å– ResultMap ä¸­ type å±æ€§æŒ‡å®šçš„ç»“æœå¯¹è±¡çš„ç±»å‹ï¼Œå¹¶åˆ›å»ºè¯¥ç±»å‹å¯¹åº”çš„ MetaClass å¯¹è±¡ï¼›è·å– ResultMap ä¸­é…ç½®çš„ <code>&lt;constructor&gt;</code> æ ‡ç­¾ä¿¡æ¯ï¼ˆä¹Ÿå°±æ˜¯å¯¹åº”çš„ ResultMapping å¯¹è±¡é›†åˆï¼‰ï¼Œå¦‚æœè¯¥ä¿¡æ¯ä¸ä¸ºç©ºï¼Œåˆ™å¯ä»¥ç¡®å®šç»“æœç±»å‹ä¸­çš„å”¯ä¸€æ„é€ å‡½æ•°ã€‚</p>
<p>ç„¶åå†æ ¹æ®å››ç§ä¸åŒçš„åœºæ™¯ï¼Œä½¿ç”¨ä¸åŒçš„æ–¹å¼åˆ›å»ºç»“æœå¯¹è±¡ï¼Œä¸‹é¢å°±æ˜¯è¿™å››ç§åœºæ™¯çš„æ ¸å¿ƒé€»è¾‘ã€‚</p>
<ul>
<li>åœºæ™¯ä¸€ï¼ŒResultSet ä¸­åªæœ‰ä¸€åˆ—ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ‰¾åˆ°ä¸€ä¸ª TypeHandler å®Œæˆè¯¥åˆ—åˆ°ç›®æ ‡ç»“æœç±»å‹çš„æ˜ å°„ï¼Œæ­¤æ—¶å¯ä»¥ç›´æ¥è¯»å– ResultSet ä¸­çš„åˆ—å€¼å¹¶é€šè¿‡ TypeHandler è½¬æ¢å¾—åˆ°ç»“æœå¯¹è±¡ã€‚è¿™éƒ¨åˆ†é€»è¾‘æ˜¯åœ¨ createPrimitiveResultObject() æ–¹æ³•ä¸­å®ç°çš„ï¼Œè¯¥åœºæ™¯å¤šç”¨äº Java åŸå§‹ç±»å‹çš„å¤„ç†ã€‚</li>
<li>åœºæ™¯äºŒï¼Œå¦‚æœ ResultMap ä¸­é…ç½®äº† <code>&lt;constructor&gt;</code> æ ‡ç­¾ï¼Œå°±ä¼šå…ˆè§£æ <code>&lt;constructor&gt;</code> æ ‡ç­¾ä¸­æŒ‡å®šçš„æ„é€ æ–¹æ³•å‚æ•°çš„ç±»å‹ï¼Œå¹¶ä»å¾…æ˜ å°„çš„æ•°æ®è¡Œä¸­è·å–å¯¹åº”çš„å®å‚å€¼ï¼Œç„¶åé€šè¿‡åå°„æ–¹å¼è°ƒç”¨å¯¹åº”çš„æ„é€ æ–¹æ³•æ¥åˆ›å»ºç»“æœå¯¹è±¡ã€‚è¿™éƒ¨åˆ†é€»è¾‘åœ¨ createParameterizedResultObject() æ–¹æ³•ä¸­å®ç°ã€‚</li>
<li>åœºæ™¯ä¸‰ï¼Œå¦‚æœä¸æ»¡è¶³ä¸Šè¿°ä¸¤ä¸ªåœºæ™¯ï¼Œåˆ™å°è¯•æŸ¥æ‰¾é»˜è®¤æ„é€ æ–¹æ³•æ¥åˆ›å»ºç»“æœå¯¹è±¡ï¼Œè¿™é‡Œä½¿ç”¨å‰é¢ä»‹ç»çš„ ObjectFactory.create() æ–¹æ³•å®ç°ï¼Œåº•å±‚åŸç†è¿˜æ˜¯ Java çš„åå°„æœºåˆ¶ã€‚</li>
<li>åœºæ™¯å››ï¼Œæœ€åä¼šæ£€æµ‹æ˜¯å¦å·²ç»å¼€å¯äº†è‡ªåŠ¨æ˜ å°„åŠŸèƒ½ï¼Œå¦‚æœå¼€å¯äº†ï¼Œä¼šå°è¯•æŸ¥æ‰¾åˆé€‚çš„æ„é€ æ–¹æ³•åˆ›å»ºç»“æœå¯¹è±¡ã€‚è¿™é‡Œé¦–å…ˆä¼šæŸ¥æ‰¾ @AutomapConstructor æ³¨è§£æ ‡æ³¨çš„æ„é€ æ–¹æ³•ï¼ŒæŸ¥æ‰¾å¤±è´¥ä¹‹åï¼Œåˆ™ä¼šå°è¯•æŸ¥æ‰¾æ¯ä¸ªå‚æ•°éƒ½æœ‰ TypeHandler èƒ½ä¸ ResultSet åˆ—è¿›è¡Œæ˜ å°„çš„æ„é€ æ–¹æ³•ï¼Œç¡®å®šè¦ä½¿ç”¨çš„æ„é€ æ–¹æ³•ä¹‹åï¼Œä¹Ÿæ˜¯é€šè¿‡ ObjectFactory å®Œæˆå¯¹è±¡åˆ›å»ºçš„ã€‚è¿™éƒ¨åˆ†é€»è¾‘åœ¨ createByConstructorSignature() æ–¹æ³•ä¸­å®ç°ã€‚</li>
</ul>
<h4 id="4-è‡ªåŠ¨æ˜ å°„">4. è‡ªåŠ¨æ˜ å°„</h4>
<p>åˆ›å»ºå®Œç»“æœå¯¹è±¡ä¹‹åï¼Œä¸‹é¢å°±å¯ä»¥å¼€å§‹æ˜ å°„å„ä¸ªå­—æ®µäº†ã€‚</p>
<p>åœ¨ç®€å•æ˜ å°„æµç¨‹ä¸­ï¼Œä¼šå…ˆé€šè¿‡ shouldApplyAutomaticMappings() æ–¹æ³•<strong>æ£€æµ‹æ˜¯å¦å¼€å¯äº†è‡ªåŠ¨æ˜ å°„</strong>ï¼Œä¸»è¦æ£€æµ‹ä»¥ä¸‹ä¸¤ä¸ªåœ°æ–¹ã€‚</p>
<ul>
<li>æ£€æµ‹å½“å‰ä½¿ç”¨çš„ ResultMap æ˜¯å¦é…ç½®äº† autoMapping å±æ€§ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ç›´æ¥æ ¹æ®è¯¥ autoMapping å±æ€§çš„å€¼å†³å®šæ˜¯å¦å¼€å¯è‡ªåŠ¨æ˜ å°„åŠŸèƒ½ã€‚</li>
<li>æ£€æµ‹ mybatis-config.xml çš„ <code>&lt;settings&gt;</code> æ ‡ç­¾ä¸­é…ç½®çš„ autoMappingBehavior å€¼ï¼Œå†³å®šæ˜¯å¦å¼€å¯è‡ªåŠ¨æ˜ å°„åŠŸèƒ½ã€‚autoMappingBehavior æŒ‡å®š MyBatis æ¡†æ¶å¦‚ä½•è¿›è¡Œè‡ªåŠ¨æ˜ å°„ï¼Œè¯¥å±æ€§æœ‰ä¸‰ä¸ªå¯é€‰å€¼ï¼šâ‘ NONEï¼Œè¡¨ç¤ºå®Œå…¨å…³é—­è‡ªåŠ¨æ˜ å°„åŠŸèƒ½ï¼›â‘¡PARTIALï¼Œè¡¨ç¤ºåªä¼šè‡ªåŠ¨æ˜ å°„æ²¡æœ‰å®šä¹‰åµŒå¥—æ˜ å°„çš„ ResultMapï¼›â‘¢FULLï¼Œè¡¨ç¤ºå®Œå…¨æ‰“å¼€è‡ªåŠ¨æ˜ å°„åŠŸèƒ½ï¼Œè¿™é‡Œä¼šè‡ªåŠ¨æ˜ å°„æ‰€æœ‰ ResultMapã€‚autoMappingBehavior çš„é»˜è®¤å€¼æ˜¯ PARTIALã€‚</li>
</ul>
<p>å½“ç¡®å®šå½“å‰ ResultMap éœ€è¦è¿›è¡Œè‡ªåŠ¨æ˜ å°„çš„æ—¶å€™ï¼Œä¼šé€šè¿‡ applyAutomaticMappings() æ–¹æ³•è¿›è¡Œè‡ªåŠ¨æ˜ å°„ï¼Œå…¶ä¸­çš„æ ¸å¿ƒé€»è¾‘å¤§è‡´å¯æè¿°ä¸ºå¦‚ä¸‹ã€‚</p>
<ul>
<li>é¦–å…ˆï¼Œä» ResultSetWrapper ä¸­è·å–æ‰€æœ‰æœªæ˜ å°„çš„åˆ—åï¼Œç„¶åé€ä¸ªå¤„ç†æ¯ä¸ªåˆ—åã€‚é€šè¿‡åˆ—åè·å–å¯¹åº”çš„å±æ€§åç§°ï¼Œè¿™é‡Œä¼šå°†åˆ—åè½¬æ¢ä¸ºå°å†™å¹¶æˆªæ‰æŒ‡å®šçš„å‰ç¼€ï¼Œå¾—åˆ°ç›¸åº”çš„å±æ€§åç§°ã€‚</li>
<li>ç„¶åï¼Œæ£€æµ‹ç»“æœå¯¹è±¡ä¸­æ˜¯å¦æœ‰ä¸Šé¢å¾—åˆ°çš„å±æ€§ã€‚å¦‚æœå±æ€§ä¸å­˜åœ¨ï¼Œåˆ™é€šè¿‡å…¨å±€é…ç½®çš„ AutoMappingUnknownColumnBehavior è¿›è¡Œå¤„ç†ã€‚å¦‚æœå±æ€§å­˜åœ¨ï¼Œåˆ™æ£€æµ‹è¯¥å±æ€§æ˜¯å¦æœ‰åˆé€‚çš„ TypeHandlerï¼›å¦‚æœä¸å­˜åœ¨åˆé€‚çš„ TypeHandlerï¼Œä¾æ—§æ˜¯é€šè¿‡å…¨å±€é…ç½®çš„ AutoMappingUnknownColumnBehavior è¿›è¡Œå¤„ç†ã€‚</li>
<li>ç»è¿‡ä¸Šè¿°æ£€æµ‹ä¹‹åï¼Œå°±å¯ä»¥åˆ›å»º UnMappedColumnAutoMapping å¯¹è±¡å°†è¯¥åˆ—ä¸å¯¹åº”çš„å±æ€§è¿›è¡Œå…³è”ã€‚åœ¨ UnMappedColumnAutoMapping ä¸­è®°å½•äº†åˆ—åã€å±æ€§åä»¥åŠç›¸å…³çš„ TypeHandlerã€‚</li>
<li>æœ€åï¼Œéå†ä¸Šé¢å¾—åˆ° UnMappedColumnAutoMapping é›†åˆï¼Œé€šè¿‡å…¶ä¸­çš„ TypeHandler è¯»å–åˆ—å€¼å¹¶è½¬æ¢æˆç›¸åº”çš„ Java ç±»å‹ï¼Œå†é€šè¿‡ MetaObject è®¾ç½®åˆ°ç›¸åº”å±æ€§ä¸­ã€‚</li>
</ul>
<p>è¿™æ ·å°±å®Œæˆäº†è‡ªåŠ¨æ˜ å°„çš„åŠŸèƒ½ã€‚</p>
<h4 id="5-æ­£å¸¸æ˜ å°„">5. æ­£å¸¸æ˜ å°„</h4>
<p>å®Œæˆè‡ªåŠ¨æ˜ å°„ä¹‹åï¼ŒMyBatis ä¼š<strong>æ‰§è¡Œ applyPropertyMappings() æ–¹æ³•å¤„ç† ResultMap ä¸­æ˜ç¡®è¦æ˜ å°„çš„åˆ—</strong>ï¼ŒapplyPropertyMappings() æ–¹æ³•çš„æ ¸å¿ƒæµç¨‹å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<ul>
<li>é¦–å…ˆä» ResultSetWrapper ä¸­æ˜ç¡®éœ€è¦æ˜ å°„çš„åˆ—åé›†åˆï¼Œä»¥åŠ ResultMap ä¸­å®šä¹‰çš„ ResultMapping å¯¹è±¡é›†åˆã€‚</li>
<li>éå†å…¨éƒ¨ ResultMapping é›†åˆï¼Œé’ˆå¯¹æ¯ä¸ª ResultMapping å¯¹è±¡ä¸º column å±æ€§å€¼æ·»åŠ æŒ‡å®šçš„å‰ç¼€ï¼Œå¾—åˆ°æœ€ç»ˆçš„åˆ—åï¼Œç„¶åæ‰§è¡Œ getPropertyMappingValue() æ–¹æ³•å®Œæˆæ˜ å°„ï¼Œå¾—åˆ°å¯¹åº”çš„å±æ€§å€¼ã€‚</li>
<li>å¦‚æœæˆåŠŸè·å–åˆ°äº†å±æ€§å€¼ï¼Œåˆ™é€šè¿‡ç»“æœå¯¹è±¡å…³è”çš„ MetaObject å¯¹è±¡è®¾ç½®åˆ°å¯¹åº”å±æ€§ä¸­ã€‚</li>
</ul>
<p>åœ¨ getPropertyMappingValue() æ–¹æ³•ä¸­ï¼Œä¸»è¦å¤„ç†äº†ä¸‰ç§åœºæ™¯çš„æ˜ å°„ï¼š</p>
<ul>
<li>ç¬¬ä¸€ç§æ˜¯åŸºæœ¬ç±»å‹çš„æ˜ å°„ï¼Œè¿™ç§åœºæ™¯ç›´æ¥å¯ä»¥é€šè¿‡ TypeHandler ä» ResultSet ä¸­è¯»å–åˆ—å€¼ï¼Œå¹¶åœ¨è½¬åŒ–ä¹‹åè¿”å›ï¼›</li>
<li>ç¬¬äºŒç§å’Œç¬¬ä¸‰ç§åœºæ™¯åˆ†åˆ«æ˜¯åµŒå¥—æ˜ å°„å’Œå¤šç»“æœé›†çš„æ˜ å°„ï¼Œè¿™ä¸¤ä¸ªé€»è¾‘ç›¸å¯¹å¤æ‚ï¼Œåœ¨ä¸‹ä¸€è®²æˆ‘ä»¬å†è¯¦ç»†ä»‹ç»ã€‚</li>
</ul>
<h4 id="6-å­˜å‚¨å¯¹è±¡">6. å­˜å‚¨å¯¹è±¡</h4>
<p>é€šè¿‡ä¸Šè¿° 5 ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆç®€å•æ˜ å°„çš„å¤„ç†ï¼Œå¾—åˆ°äº†ä¸€ä¸ªå®Œæ•´çš„ç»“æœå¯¹è±¡ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±è¦<strong>é€šè¿‡ storeObject() æ–¹æ³•æŠŠè¿™ä¸ªç»“æœå¯¹è±¡ä¿å­˜åˆ°åˆé€‚çš„ä½ç½®</strong>ã€‚</p>
<p>è¿™é‡Œå¤„ç†çš„ç®€å•æ˜ å°„ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªåµŒå¥—æ˜ å°„ä¸­çš„å­æ˜ å°„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å°†ç»“æœå¯¹è±¡ä¿å­˜åˆ°å¤–å±‚å¯¹è±¡çš„å±æ€§ä¸­ï¼›å¦‚æœæ˜¯ä¸€ä¸ªæ™®é€šæ˜ å°„æˆ–æ˜¯å¤–å±‚æ˜ å°„çš„ç»“æœå¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å°†ç»“æœå¯¹è±¡ä¿å­˜åˆ° ResultHandler ä¸­ã€‚</p>
<p>æ˜ç¡®äº†ç»“æœå¯¹è±¡çš„å­˜å‚¨ä½ç½®ä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹ storeObject() æ–¹æ³•çš„å…·ä½“å®ç°ï¼š</p>
<pre tabindex="0"><code>private void storeObject(...) throws SQLException {

    if (parentMapping != null) {

        // åµŒå¥—æŸ¥è¯¢æˆ–åµŒå¥—æ˜ å°„çš„åœºæ™¯ï¼Œæ­¤æ—¶éœ€è¦å°†ç»“æœå¯¹è±¡ä¿å­˜åˆ°å¤–å±‚å¯¹è±¡å¯¹åº”çš„å±æ€§ä¸­

        linkToParents(rs, parentMapping, rowValue);

    } else {

        // æ™®é€šæ˜ å°„(æ²¡æœ‰åµŒå¥—æ˜ å°„)æˆ–æ˜¯åµŒå¥—æ˜ å°„ä¸­çš„å¤–å±‚æ˜ å°„çš„åœºæ™¯ï¼Œæ­¤æ—¶éœ€è¦å°†ç»“æœå¯¹è±¡ä¿å­˜åˆ°ResultHandlerä¸­

        callResultHandler(resultHandler, resultContext, rowValue);

    }

}
</code></pre><h3 id="æ€»ç»“">æ€»ç»“</h3>
<p>è¿™ä¸€è®²æˆ‘ä»¬é‡ç‚¹ä»‹ç»äº†ç»“æœé›†æ˜ å°„ï¼Œè¿™æ˜¯ MyBatis çš„æ ¸å¿ƒå®ç°ä¹‹ä¸€ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬ä»‹ç»äº† ResultSetHandler æ¥å£ä»¥åŠ DefaultResultSetHandler è¿™ä¸ªé»˜è®¤å®ç°ï¼Œå¹¶è®²è§£äº†å•ä¸ªç»“æœé›†æ˜ å°„çš„å…¥å£ï¼šhandleResultSet() æ–¹æ³•ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»§ç»­æ·±å…¥ï¼Œè¯¦ç»†åˆ†æäº† handleRowValuesForSimpleResultMap() æ–¹æ³•å®ç°ç®€å•æ˜ å°„çš„æ ¸å¿ƒæ­¥éª¤ï¼Œå…¶ä¸­æ¶‰åŠé¢„å¤„ç† ResultSetã€æŸ¥æ‰¾å¹¶ç¡®å®š ResultMapã€åˆ›å»ºå¹¶å¡«å……æ˜ å°„ç»“æœå¯¹è±¡ã€è‡ªåŠ¨æ˜ å°„ã€æ­£å¸¸æ˜ å°„ã€å­˜å‚¨æ˜ å°„ç»“æœå¯¹è±¡è¿™å…­å¤§æ ¸å¿ƒæ­¥éª¤ã€‚</p>

        </div>
    </article>
</div>
<div class="division-line"></div>
<div class="others">
    <div>æ ‡ç­¾ï¼šğŸ·ï¸<a class="post-tag" href="/tags/mybatis/">mybatis</a>&nbsp;</div>
    <div>åˆ†ç±»ï¼š ğŸ“’<a class="post-category" href="/categories/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/">æ·±å…¥å‰–æMyBatisæ ¸å¿ƒåŸç†</a>&nbsp; </div>
</div>

    </main>
    <footer>
        <div id="pagination">
            
<div class="paginator">
    <div class="prev">
        
        <a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/13-%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90%E5%8A%A8%E6%80%81-sql-%E8%AF%AD%E5%8F%A5%E8%A7%A3%E6%9E%90%E5%85%A8%E6%B5%81%E7%A8%8B%E4%B8%8B/"><span>13 æ·±å…¥åˆ†æåŠ¨æ€ SQL è¯­å¥è§£æå…¨æµç¨‹ï¼ˆä¸‹ï¼‰</span></a>
    </div>
    <div class="next">
        
        <a href="http://yipsen.github.io/documents/columns/mybatis/%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90mybatis%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86/15-%E6%8E%A2%E7%A9%B6-mybatis-%E7%BB%93%E6%9E%9C%E9%9B%86%E6%98%A0%E5%B0%84%E6%9C%BA%E5%88%B6%E8%83%8C%E5%90%8E%E7%9A%84%E7%A7%98%E5%AF%86%E4%B8%8B/"><span>15 æ¢ç©¶ MyBatis ç»“æœé›†æ˜ å°„æœºåˆ¶èƒŒåçš„ç§˜å¯†ï¼ˆä¸‹ï¼‰</span></a>
    </div>
</div>

        </div>
        <div id="float">
            <ul class="float-button-bar">
    <li>
        <button class="float-button top" onclick="scrollToTop(this);">UP</button>
    </li>
    <li>
        <button class="float-button toggler" onclick="changeSkin(this);">DARK</button>
    </li>
</ul>
        </div>
        <div id="copyright" style="display: none;">
    
    
    <p>&copy; 2020 <a href="/"></a>, powered by Hugo and Qiao</p>
</div>
    </footer>
    
<script>
    const changeSkin = () => {
        document.getElementById('page').classList.toggle('night');
    }
    const scrollToTop = () => {
        window.scrollTo(0, 0);
    }
</script>
</body>

</html>