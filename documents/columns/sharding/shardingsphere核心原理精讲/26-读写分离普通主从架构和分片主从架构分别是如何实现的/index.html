<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
<meta name="X-UA-Compatible" , content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<link rel="icon" type="image/png" href="/%20/favicon.png">

<title>26 è¯»å†™åˆ†ç¦»ï¼šæ™®é€šä¸»ä»æ¶æ„å’Œåˆ†ç‰‡ä¸»ä»æ¶æ„åˆ†åˆ«æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ | Yipsen Ye</title>
<meta name="description" content="åœ¨ â€œ17 | è·¯ç”±å¼•æ“ï¼šå¦‚ä½•ç†è§£åˆ†ç‰‡è·¯ç”±æ ¸å¿ƒç±» ShardingRouter çš„è¿ä½œæœºåˆ¶ï¼Ÿâ€ è¯¾æ—¶ä¸­ä»‹ç» ShardingSphere çš„è·¯ç”±å¼•æ“æ—¶ï¼Œæˆ‘ä»¬æåˆ°äº† ShardingMasterSlaveRouter ç±»ï¼Œè¯¥ç±»ç”¨äºè¿›è¡Œå¯¹åˆ†ç‰‡ä¿¡æ¯è¿›è¡Œè¯»å†™åˆ†ç¦»ã€‚
ä»Šå¤©æˆ‘ä»¬å°±å°†å…³æ³¨è¿™ä¸ªè¯é¢˜ï¼Œçœ‹çœ‹ ShardingSphere æ˜¯å¦‚ä½•å®ç°ä¸»ä»æ¶æ„ä¸‹çš„è¯»å†™åˆ†ç¦»è·¯ç”±çš„ï¼Ÿ
ShardingMasterSlaveRouter æˆ‘ä»¬æ¥åˆ° ShardingMasterSlaveRouter ç±»ã€‚ä»æ•ˆæœä¸Šè®²ï¼Œè¯»å†™åˆ†ç¦»å®é™…ä¸Šä¹Ÿæ˜¯ä¸€ç§è·¯ç”±ç­–ç•¥ï¼Œæ‰€ä»¥è¯¥ç±»åŒæ ·ä½äº sharding-core-route å·¥ç¨‹ä¸‹ã€‚
ShardingMasterSlaveRouter çš„å…¥å£å‡½æ•° route å¦‚ä¸‹æ‰€ç¤ºï¼š
public SQLRouteResult route(final SQLRouteResult sqlRouteResult) {for (MasterSlaveRule each : masterSlaveRules) {//æ ¹æ®æ¯æ¡ MasterSlaveRule æ‰§è¡Œè·¯ç”±æ–¹æ³•route(each, sqlRouteResult);}return sqlRouteResult;}è¿™é‡Œå¼•å…¥äº†ä¸€ä¸ªè§„åˆ™ç±» MasterSlaveRuleï¼Œæ ¹æ®æ¯æ¡ MasterSlaveRule ä¼šæ‰§è¡Œç‹¬ç«‹çš„ route æ–¹æ³•ï¼Œå¹¶æœ€ç»ˆè¿”å›ç»„åˆçš„ SQLRouteResultã€‚
è¿™ä¸ª route æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š
private void route(final MasterSlaveRule masterSlaveRule, final SQLRouteResult sqlRouteResult) {Collection&amp;lt;RoutingUnit&amp;gt; toBeRemoved = new LinkedList&amp;lt;&amp;gt;();Collection&amp;lt;RoutingUnit&amp;gt; toBeAdded = new LinkedList&amp;lt;&amp;gt;();for (RoutingUnit each : sqlRouteResult.">
<meta name="author" content="">

<link rel="stylesheet" type="text/css" href="/styles/main.css">

</head>

<body id="page">
    <header>
        <div class="logo-link" style="width: 60px; color: #CA6924;">
    <a href="http://yipsen.github.io/">
        <img style="margin-bottom: -1rem;" src="/images/deer.svg" alt="logo">
        <span style="font-size: 0.5rem; color: #CA6924;">Yipsen Ye</span>
    </a>
</div>
<nav class="navbar justify-content-end">
    <ul class="nav-list">
        
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/posts/">æœ­è®°</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/collections/">é™„è¡¨</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/about/">å…³äº</a>
        </li>
        
    </ul>
</nav>
    </header>
    <main id="content">
        
<div class="container"><aside>
    <div>
        
        
            
            
            <div class="post-category-icon"></div>
            <a href="/categories/shardingsphere%e6%a0%b8%e5%bf%83%e5%8e%9f%e7%90%86%e7%b2%be%e8%ae%b2/">ShardingSphereæ ¸å¿ƒåŸç†ç²¾è®²</a>
            <ul>
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/00-%E5%A6%82%E4%BD%95%E6%AD%A3%E7%A1%AE%E5%AD%A6%E4%B9%A0%E4%B8%80%E6%AC%BE%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">00 å¦‚ä½•æ­£ç¡®å­¦ä¹ ä¸€æ¬¾åˆ†åº“åˆ†è¡¨å¼€æºæ¡†æ¶ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/01-%E4%BB%8E%E7%90%86%E8%AE%BA%E5%88%B0%E5%AE%9E%E8%B7%B5%E5%A6%82%E4%BD%95%E8%AE%A9%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E7%9C%9F%E6%AD%A3%E8%90%BD%E5%9C%B0/">01 ä»ç†è®ºåˆ°å®è·µï¼šå¦‚ä½•è®©åˆ†åº“åˆ†è¡¨çœŸæ­£è½åœ°ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/02-%E9%A1%B6%E7%BA%A7%E9%A1%B9%E7%9B%AEshardingsphere-%E6%98%AF%E4%B8%80%E6%AC%BE%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84-apache-%E5%BC%80%E6%BA%90%E8%BD%AF%E4%BB%B6/">02 é¡¶çº§é¡¹ç›®ï¼šShardingSphere æ˜¯ä¸€æ¬¾ä»€ä¹ˆæ ·çš„ Apache å¼€æºè½¯ä»¶ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/03-%E8%A7%84%E8%8C%83%E5%85%BC%E5%AE%B9jdbc-%E8%A7%84%E8%8C%83%E4%B8%8E-shardingsphere-%E6%98%AF%E4%BB%80%E4%B9%88%E5%85%B3%E7%B3%BB/">03 è§„èŒƒå…¼å®¹ï¼šJDBC è§„èŒƒä¸ ShardingSphere æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/04-%E5%BA%94%E7%94%A8%E9%9B%86%E6%88%90%E5%9C%A8%E4%B8%9A%E5%8A%A1%E7%B3%BB%E7%BB%9F%E4%B8%AD%E4%BD%BF%E7%94%A8-shardingsphere-%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9C%89%E5%93%AA%E4%BA%9B/">04 åº”ç”¨é›†æˆï¼šåœ¨ä¸šåŠ¡ç³»ç»Ÿä¸­ä½¿ç”¨ ShardingSphere çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/05-%E9%85%8D%E7%BD%AE%E9%A9%B1%E5%8A%A8shardingsphere-%E4%B8%AD%E7%9A%84%E9%85%8D%E7%BD%AE%E4%BD%93%E7%B3%BB%E6%98%AF%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E7%9A%84/">05 é…ç½®é©±åŠ¨ï¼šShardingSphere ä¸­çš„é…ç½®ä½“ç³»æ˜¯å¦‚ä½•è®¾è®¡çš„ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/09-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%BC%BA%E4%B8%80%E8%87%B4%E6%80%A7%E4%BA%8B%E5%8A%A1%E4%B8%8E%E6%9F%94%E6%80%A7%E4%BA%8B%E5%8A%A1/">09 åˆ†å¸ƒå¼äº‹åŠ¡ï¼šå¦‚ä½•ä½¿ç”¨å¼ºä¸€è‡´æ€§äº‹åŠ¡ä¸æŸ”æ€§äº‹åŠ¡ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/10-%E6%95%B0%E6%8D%AE%E8%84%B1%E6%95%8F%E5%A6%82%E4%BD%95%E7%A1%AE%E4%BF%9D%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AE%89%E5%85%A8%E8%AE%BF%E9%97%AE/">10 æ•°æ®è„±æ•ï¼šå¦‚ä½•ç¡®ä¿æ•æ„Ÿæ•°æ®çš„å®‰å…¨è®¿é—®ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/11-%E7%BC%96%E6%8E%92%E6%B2%BB%E7%90%86%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E7%8E%AF%E5%A2%83%E4%B8%8B%E7%9A%84%E5%8A%A8%E6%80%81%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/">11 ç¼–æ’æ²»ç†ï¼šå¦‚ä½•å®ç°åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„åŠ¨æ€é…ç½®ç®¡ç†ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/12-%E4%BB%8E%E5%BA%94%E7%94%A8%E5%88%B0%E5%8E%9F%E7%90%86%E5%A6%82%E4%BD%95%E9%AB%98%E6%95%88%E9%98%85%E8%AF%BB-shardingsphere-%E6%BA%90%E7%A0%81/">12 ä»åº”ç”¨åˆ°åŸç†ï¼šå¦‚ä½•é«˜æ•ˆé˜…è¯» ShardingSphere æºç ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/13-%E5%BE%AE%E5%86%85%E6%A0%B8%E6%9E%B6%E6%9E%84shardingsphere-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%89%A9%E5%B1%95%E6%80%A7/">13 å¾®å†…æ ¸æ¶æ„ï¼šShardingSphere å¦‚ä½•å®ç°ç³»ç»Ÿçš„æ‰©å±•æ€§ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/14-%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%BB%E9%94%AEshardingsphere-%E4%B8%AD%E6%9C%89%E5%93%AA%E4%BA%9B%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%BB%E9%94%AE%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F/">14 åˆ†å¸ƒå¼ä¸»é”®ï¼šShardingSphere ä¸­æœ‰å“ªäº›åˆ†å¸ƒå¼ä¸»é”®å®ç°æ–¹å¼ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/15-%E8%A7%A3%E6%9E%90%E5%BC%95%E6%93%8Esql-%E8%A7%A3%E6%9E%90%E6%B5%81%E7%A8%8B%E5%BA%94%E8%AF%A5%E5%8C%85%E6%8B%AC%E5%93%AA%E4%BA%9B%E6%A0%B8%E5%BF%83%E9%98%B6%E6%AE%B5%E4%B8%8A/">15 è§£æå¼•æ“ï¼šSQL è§£ææµç¨‹åº”è¯¥åŒ…æ‹¬å“ªäº›æ ¸å¿ƒé˜¶æ®µï¼Ÿï¼ˆä¸Šï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/16-%E8%A7%A3%E6%9E%90%E5%BC%95%E6%93%8Esql-%E8%A7%A3%E6%9E%90%E6%B5%81%E7%A8%8B%E5%BA%94%E8%AF%A5%E5%8C%85%E6%8B%AC%E5%93%AA%E4%BA%9B%E6%A0%B8%E5%BF%83%E9%98%B6%E6%AE%B5%E4%B8%8B/">16 è§£æå¼•æ“ï¼šSQL è§£ææµç¨‹åº”è¯¥åŒ…æ‹¬å“ªäº›æ ¸å¿ƒé˜¶æ®µï¼Ÿï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/17-%E8%B7%AF%E7%94%B1%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E5%88%86%E7%89%87%E8%B7%AF%E7%94%B1%E6%A0%B8%E5%BF%83%E7%B1%BB-shardingrouter-%E7%9A%84%E8%BF%90%E4%BD%9C%E6%9C%BA%E5%88%B6/">17 è·¯ç”±å¼•æ“ï¼šå¦‚ä½•ç†è§£åˆ†ç‰‡è·¯ç”±æ ¸å¿ƒç±» ShardingRouter çš„è¿ä½œæœºåˆ¶ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/18-%E8%B7%AF%E7%94%B1%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E7%9A%84%E5%88%86%E7%89%87%E8%B7%AF%E7%94%B1%E5%92%8C%E5%B9%BF%E6%92%AD%E8%B7%AF%E7%94%B1/">18 è·¯ç”±å¼•æ“ï¼šå¦‚ä½•å®ç°æ•°æ®è®¿é—®çš„åˆ†ç‰‡è·¯ç”±å’Œå¹¿æ’­è·¯ç”±ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/19-%E8%B7%AF%E7%94%B1%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E5%9C%A8%E8%B7%AF%E7%94%B1%E8%BF%87%E7%A8%8B%E4%B8%AD%E9%9B%86%E6%88%90%E5%A4%9A%E7%A7%8D%E8%B7%AF%E7%94%B1%E7%AD%96%E7%95%A5%E5%92%8C%E8%B7%AF%E7%94%B1%E7%AE%97%E6%B3%95/">19 è·¯ç”±å¼•æ“ï¼šå¦‚ä½•åœ¨è·¯ç”±è¿‡ç¨‹ä¸­é›†æˆå¤šç§è·¯ç”±ç­–ç•¥å’Œè·¯ç”±ç®—æ³•ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/20-%E6%94%B9%E5%86%99%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F%E4%B8%8B%E7%9A%84-sql-%E6%94%B9%E5%86%99%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6/">20 æ”¹å†™å¼•æ“ï¼šå¦‚ä½•ç†è§£è£…é¥°å™¨æ¨¡å¼ä¸‹çš„ SQL æ”¹å†™å®ç°æœºåˆ¶ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/21-%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E%E5%88%86%E7%89%87%E7%8E%AF%E5%A2%83%E4%B8%8B-sql-%E6%89%A7%E8%A1%8C%E7%9A%84%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B%E5%BA%94%E8%AF%A5%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E6%8A%BD%E8%B1%A1/">21 æ‰§è¡Œå¼•æ“ï¼šåˆ†ç‰‡ç¯å¢ƒä¸‹ SQL æ‰§è¡Œçš„æ•´ä½“æµç¨‹åº”è¯¥å¦‚ä½•è¿›è¡ŒæŠ½è±¡ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/22-%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E6%8A%8A%E6%8F%A1-shardingsphere-%E4%B8%AD%E7%9A%84-executor-%E6%89%A7%E8%A1%8C%E6%A8%A1%E5%9E%8B%E4%B8%8A/">22 æ‰§è¡Œå¼•æ“ï¼šå¦‚ä½•æŠŠæ¡ ShardingSphere ä¸­çš„ Executor æ‰§è¡Œæ¨¡å‹ï¼Ÿï¼ˆä¸Šï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/23-%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E6%8A%8A%E6%8F%A1-shardingsphere-%E4%B8%AD%E7%9A%84-executor-%E6%89%A7%E8%A1%8C%E6%A8%A1%E5%9E%8B%E4%B8%8B/">23 æ‰§è¡Œå¼•æ“ï¼šå¦‚ä½•æŠŠæ¡ ShardingSphere ä¸­çš„ Executor æ‰§è¡Œæ¨¡å‹ï¼Ÿï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/24-%E5%BD%92%E5%B9%B6%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E6%95%B0%E6%8D%AE%E5%BD%92%E5%B9%B6%E7%9A%84%E7%B1%BB%E5%9E%8B%E4%BB%A5%E5%8F%8A%E7%AE%80%E5%8D%95%E5%BD%92%E5%B9%B6%E7%AD%96%E7%95%A5%E7%9A%84%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B/">24 å½’å¹¶å¼•æ“ï¼šå¦‚ä½•ç†è§£æ•°æ®å½’å¹¶çš„ç±»å‹ä»¥åŠç®€å•å½’å¹¶ç­–ç•¥çš„å®ç°è¿‡ç¨‹ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/25-%E5%BD%92%E5%B9%B6%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E6%B5%81%E5%BC%8F%E5%BD%92%E5%B9%B6%E5%92%8C%E5%86%85%E5%AD%98%E5%BD%92%E5%B9%B6%E5%9C%A8%E5%A4%8D%E6%9D%82%E5%BD%92%E5%B9%B6%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%9A%84%E5%BA%94%E7%94%A8%E6%96%B9%E5%BC%8F/">25 å½’å¹¶å¼•æ“ï¼šå¦‚ä½•ç†è§£æµå¼å½’å¹¶å’Œå†…å­˜å½’å¹¶åœ¨å¤æ‚å½’å¹¶åœºæ™¯ä¸‹çš„åº”ç”¨æ–¹å¼ï¼Ÿ</a></li>
                
                
                
                    <li>26 è¯»å†™åˆ†ç¦»ï¼šæ™®é€šä¸»ä»æ¶æ„å’Œåˆ†ç‰‡ä¸»ä»æ¶æ„åˆ†åˆ«æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/27-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3-shardingsphere-%E4%B8%AD%E5%AF%B9%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%9A%84%E6%8A%BD%E8%B1%A1%E8%BF%87%E7%A8%8B/">27 åˆ†å¸ƒå¼äº‹åŠ¡ï¼šå¦‚ä½•ç†è§£ ShardingSphere ä¸­å¯¹åˆ†å¸ƒå¼äº‹åŠ¡çš„æŠ½è±¡è¿‡ç¨‹ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/28-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1shardingsphere-%E4%B8%AD%E5%A6%82%E4%BD%95%E9%9B%86%E6%88%90%E5%BC%BA%E4%B8%80%E8%87%B4%E6%80%A7%E4%BA%8B%E5%8A%A1%E5%92%8C%E6%9F%94%E6%80%A7%E4%BA%8B%E5%8A%A1%E6%94%AF%E6%8C%81%E4%B8%8A/">28 åˆ†å¸ƒå¼äº‹åŠ¡ï¼šShardingSphere ä¸­å¦‚ä½•é›†æˆå¼ºä¸€è‡´æ€§äº‹åŠ¡å’ŒæŸ”æ€§äº‹åŠ¡æ”¯æŒï¼Ÿï¼ˆä¸Šï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/29-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1shardingsphere-%E4%B8%AD%E5%A6%82%E4%BD%95%E9%9B%86%E6%88%90%E5%BC%BA%E4%B8%80%E8%87%B4%E6%80%A7%E4%BA%8B%E5%8A%A1%E5%92%8C%E6%9F%94%E6%80%A7%E4%BA%8B%E5%8A%A1%E6%94%AF%E6%8C%81%E4%B8%8B/">29 åˆ†å¸ƒå¼äº‹åŠ¡ï¼šShardingSphere ä¸­å¦‚ä½•é›†æˆå¼ºä¸€è‡´æ€§äº‹åŠ¡å’ŒæŸ”æ€§äº‹åŠ¡æ”¯æŒï¼Ÿï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/30-%E6%95%B0%E6%8D%AE%E8%84%B1%E6%95%8F%E5%A6%82%E4%BD%95%E5%9F%BA%E4%BA%8E%E6%94%B9%E5%86%99%E5%BC%95%E6%93%8E%E5%AE%9E%E7%8E%B0%E4%BD%8E%E4%BE%B5%E5%85%A5%E6%80%A7%E6%95%B0%E6%8D%AE%E8%84%B1%E6%95%8F%E6%96%B9%E6%A1%88/">30 æ•°æ®è„±æ•ï¼šå¦‚ä½•åŸºäºæ”¹å†™å¼•æ“å®ç°ä½ä¾µå…¥æ€§æ•°æ®è„±æ•æ–¹æ¡ˆï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/31-%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E5%A6%82%E4%BD%95%E5%9F%BA%E4%BA%8E%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E5%AE%9E%E7%8E%B0%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E7%9A%84%E5%8A%A8%E6%80%81%E5%8C%96%E7%AE%A1%E7%90%86/">31 é…ç½®ä¸­å¿ƒï¼šå¦‚ä½•åŸºäºé…ç½®ä¸­å¿ƒå®ç°é…ç½®ä¿¡æ¯çš„åŠ¨æ€åŒ–ç®¡ç†ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/32-%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E5%A6%82%E4%BD%95%E5%9F%BA%E4%BA%8E%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BF%E9%97%AE%E7%86%94%E6%96%AD%E6%9C%BA%E5%88%B6/">32 æ³¨å†Œä¸­å¿ƒï¼šå¦‚ä½•åŸºäºæ³¨å†Œä¸­å¿ƒå®ç°æ•°æ®åº“è®¿é—®ç†”æ–­æœºåˆ¶ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/33-%E9%93%BE%E8%B7%AF%E8%B7%9F%E8%B8%AA%E5%A6%82%E4%BD%95%E5%9F%BA%E4%BA%8E-hook-%E6%9C%BA%E5%88%B6%E4%BB%A5%E5%8F%8A-opentracing-%E5%8D%8F%E8%AE%AE%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E9%93%BE%E8%B7%AF%E8%B7%9F%E8%B8%AA/">33 é“¾è·¯è·Ÿè¸ªï¼šå¦‚ä½•åŸºäº Hook æœºåˆ¶ä»¥åŠ OpenTracing åè®®å®ç°æ•°æ®è®¿é—®é“¾è·¯è·Ÿè¸ªï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/35-%E7%BB%93%E8%AF%ADshardingsphere-%E6%80%BB%E7%BB%93%E5%8F%8A%E5%B1%95%E6%9C%9B/">35 ç»“è¯­ï¼šShardingSphere æ€»ç»“åŠå±•æœ›</a></li>
                
                
            </ul>
        
    </div>
</aside>

<style>
    aside {
        position: fixed;
        left: 20px;
        background: #ffdee3;
        border-radius: 6px;
        padding: 20px;
        padding-top: 60px;
        box-shadow: 5px 10px #888;
        list-style-type: none;
        display: none;
    }

    .post-category-icon {
        position: absolute;
        width: 80px;
        height: 80px;
        top: -40px;
        left: 50%;
        margin-left: -40px;
        text-align: center;
        font-size: 36px;
        content: 'J';
        background: #ffdee3;
        border-radius: 100%;
        border: 10px solid #fff;
        box-shadow: 5px 10px #888;
    }
</style><article class="post-block">
        <h1 class="post-title">26 è¯»å†™åˆ†ç¦»ï¼šæ™®é€šä¸»ä»æ¶æ„å’Œåˆ†ç‰‡ä¸»ä»æ¶æ„åˆ†åˆ«æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</h1>
        <div class="post-info">
            <div> 
                <span class="post-date">ğŸ“…&nbsp;2021-12-22 01:56:05</span>ğŸ·ï¸&nbsp;<a class="post-tag" href="/tags/sharding/">sharding</a></div><div class="post-category">
                
                ğŸ“š&nbsp;<a href="/categories/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/">ShardingSphereæ ¸å¿ƒåŸç†ç²¾è®²</a>
                
            </div></div>
        <div class="post-content">
            <p>åœ¨ <strong>â€œ17 | è·¯ç”±å¼•æ“ï¼šå¦‚ä½•ç†è§£åˆ†ç‰‡è·¯ç”±æ ¸å¿ƒç±» ShardingRouter çš„è¿ä½œæœºåˆ¶ï¼Ÿâ€</strong> è¯¾æ—¶ä¸­ä»‹ç» ShardingSphere çš„è·¯ç”±å¼•æ“æ—¶ï¼Œæˆ‘ä»¬æåˆ°äº† ShardingMasterSlaveRouter ç±»ï¼Œè¯¥ç±»ç”¨äºè¿›è¡Œå¯¹åˆ†ç‰‡ä¿¡æ¯è¿›è¡Œè¯»å†™åˆ†ç¦»ã€‚</p>
<p>ä»Šå¤©æˆ‘ä»¬å°±å°†å…³æ³¨è¿™ä¸ªè¯é¢˜ï¼Œçœ‹çœ‹ ShardingSphere æ˜¯å¦‚ä½•å®ç°ä¸»ä»æ¶æ„ä¸‹çš„è¯»å†™åˆ†ç¦»è·¯ç”±çš„ï¼Ÿ</p>
<h3 id="shardingmasterslaverouter">ShardingMasterSlaveRouter</h3>
<p>æˆ‘ä»¬æ¥åˆ° ShardingMasterSlaveRouter ç±»ã€‚ä»æ•ˆæœä¸Šè®²ï¼Œè¯»å†™åˆ†ç¦»å®é™…ä¸Šä¹Ÿæ˜¯ä¸€ç§è·¯ç”±ç­–ç•¥ï¼Œæ‰€ä»¥è¯¥ç±»åŒæ ·ä½äº sharding-core-route å·¥ç¨‹ä¸‹ã€‚</p>
<p>ShardingMasterSlaveRouter çš„å…¥å£å‡½æ•° route å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>public SQLRouteResult route(final SQLRouteResult sqlRouteResult) {
    for (MasterSlaveRule each : masterSlaveRules) {
    //æ ¹æ®æ¯æ¡ MasterSlaveRule æ‰§è¡Œè·¯ç”±æ–¹æ³•
        route(each, sqlRouteResult);
    }
    return sqlRouteResult;
}
</code></pre><p>è¿™é‡Œå¼•å…¥äº†ä¸€ä¸ªè§„åˆ™ç±» MasterSlaveRuleï¼Œæ ¹æ®æ¯æ¡ MasterSlaveRule ä¼šæ‰§è¡Œç‹¬ç«‹çš„ route æ–¹æ³•ï¼Œå¹¶æœ€ç»ˆè¿”å›ç»„åˆçš„ SQLRouteResultã€‚</p>
<p>è¿™ä¸ª route æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>private void route(final MasterSlaveRule masterSlaveRule, final SQLRouteResult sqlRouteResult) {
        Collection&lt;RoutingUnit&gt; toBeRemoved = new LinkedList&lt;&gt;();
        Collection&lt;RoutingUnit&gt; toBeAdded = new LinkedList&lt;&gt;();
        for (RoutingUnit each : sqlRouteResult.getRoutingResult().getRoutingUnits()) {
            if (!masterSlaveRule.getName().equalsIgnoreCase(each.getDataSourceName())) {
                continue;
            }
            toBeRemoved.add(each);
            String actualDataSourceName;
            // åˆ¤æ–­æ˜¯å¦èµ°ä¸»åº“
            if (isMasterRoute(sqlRouteResult.getSqlStatementContext().getSqlStatement())) {
                MasterVisitedManager.setMasterVisited();
                actualDataSourceName = masterSlaveRule.getMasterDataSourceName();
            } else { //å¦‚æœä»åº“æœ‰å¤šä¸ªï¼Œé»˜è®¤é‡‡ç”¨è½®è¯¢ç­–ç•¥ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©éšæœºè®¿é—®ç­–ç•¥
                actualDataSourceName = masterSlaveRule.getLoadBalanceAlgorithm().getDataSource(
                        masterSlaveRule.getName(), masterSlaveRule.getMasterDataSourceName(), new ArrayList&lt;&gt;(masterSlaveRule.getSlaveDataSourceNames()));
            }
            toBeAdded.add(createNewRoutingUnit(actualDataSourceName, each));
        }
        sqlRouteResult.getRoutingResult().getRoutingUnits().removeAll(toBeRemoved);
        sqlRouteResult.getRoutingResult().getRoutingUnits().addAll(toBeAdded);
}
</code></pre><p>åœ¨è¯»å†™åˆ†ç¦»åœºæ™¯ä¸‹ï¼Œå› ä¸ºæ¶‰åŠè·¯ç”±ä¿¡æ¯çš„è°ƒæ•´ï¼Œæ‰€ä»¥è¿™æ®µä»£ç ä¸­æ„å»ºäº†ä¸¤ä¸ªä¸´æ—¶å˜é‡ toBeRemoved å’Œ toBeAddedï¼Œå®ƒä»¬åˆ†åˆ«ç”¨äºä¿å­˜éœ€è¦ç§»é™¤å’Œéœ€è¦æ–°å¢çš„ RoutingUnitã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬æ¥è®¡ç®—çœŸæ­£éœ€è¦è®¿é—®çš„æ•°æ®åº“å actualDataSourceNameï¼Œè¿™é‡Œå°±éœ€è¦åˆ¤æ–­æ˜¯å¦èµ°ä¸»åº“ã€‚è¯·æ³¨æ„ï¼Œåœ¨å½“å‰çš„ 4.X ç‰ˆæœ¬ä¸­ï¼ŒShardingSphere åªæ”¯æŒå•ä¸»åº“çš„åº”ç”¨åœºæ™¯ï¼Œè€Œä»åº“å¯ä»¥æœ‰å¾ˆå¤šä¸ªã€‚</p>
<p>åˆ¤æ–­æ˜¯å¦ä¸ºä¸»åº“çš„ isMasterRoute æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>private boolean isMasterRoute(final SQLStatement sqlStatement) {
    return containsLockSegment(sqlStatement) || !(sqlStatement instanceof SelectStatement) || MasterVisitedManager.isMasterVisited() || HintManager.isMasterRouteOnly();
}
</code></pre><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰å››ä¸ªæ¡ä»¶ï¼Œæ»¡è¶³ä»»ä½•ä¸€ä¸ªéƒ½å°†ç¡®å®šèµ°ä¸»åº“è·¯ç”±ã€‚å‰é¢ä¸¤ä¸ªæ¯”è¾ƒå¥½ç†è§£ï¼Œåé¢çš„ MasterVisitedManager å®é™…ä¸Šæ˜¯ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„å®¹å™¨ï¼ŒåŒ…å«äº†è¯¥çº¿ç¨‹è®¿é—®æ˜¯å¦æ¶‰åŠä¸»åº“çš„ä¿¡æ¯ã€‚</p>
<p>è€ŒåŸºäºæˆ‘ä»¬åœ¨ <strong>â€œ08 | è¯»å†™åˆ†ç¦»ï¼šå¦‚ä½•é›†æˆåˆ†åº“åˆ†è¡¨+æ•°æ®åº“ä¸»ä»æ¶æ„ï¼Ÿâ€</strong> è¯¾æ—¶ä¸­å¯¹ Hint æ¦‚å¿µå’Œå¼ºåˆ¶è·¯ç”±æœºåˆ¶çš„ç†è§£ï¼ŒHintManager æ˜¯ ShardingSphere ä¸­å¯¹æ•°æ®åº“ Hint è®¿é—®æœºåˆ¶çš„å®ç°ç±»ï¼Œå¯ä»¥è®¾ç½®å¼ºåˆ¶èµ°ä¸»åº“æˆ–è€…éæŸ¥è¯¢æ“ä½œèµ°ä¸»åº“ã€‚</p>
<p>å¦‚æœä¸èµ°ä¸»åº“è·¯ç”±ï¼Œé‚£ä¹ˆæµç¨‹å°±ä¼šèµ°åˆ°ä»åº“è·¯ç”±ï¼›è€Œå¦‚æœä»åº“æœ‰å¤šä¸ªï¼Œå°±éœ€è¦é‡‡ç”¨ä¸€å®šçš„ç­–ç•¥æ¥ç¡®å®šå…·ä½“çš„æŸä¸€ä¸ªä»åº“ã€‚ShardingSphere åœ¨è¿™æ–¹é¢æä¾›äº†ä¸€ä¸ª MasterSlaveLoadBalanceAlgorithm æ¥å£å®Œæˆä»åº“çš„é€‰æ‹©ï¼Œè¯·æ³¨æ„è¯¥æ¥å£ä½äº sharding-core-api å·¥ç¨‹ä¸­ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>public interface MasterSlaveLoadBalanceAlgorithm extends TypeBasedSPI {
     // åœ¨ä»åº“åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªä»åº“è¿›è¡Œè·¯ç”±
    String getDataSource(String name, String masterDataSourceName, List&lt;String&gt; slaveDataSourceNames);
}
</code></pre><p>å¯ä»¥çœ‹åˆ° MasterSlaveLoadBalanceAlgorithm æ¥å£ç»§æ‰¿äº† TypeBasedSPI æ¥å£ï¼Œè¡¨æ˜å®ƒæ˜¯ä¸€ä¸ª SPIã€‚ç„¶åå®ƒçš„å‚æ•°ä¸­åŒ…å«äº†ä¸€ä¸ª MasterDataSourceName å’Œä¸€æ‰¹ SlaveDataSourceNameï¼Œæœ€ç»ˆè¿”å›ä¸€ä¸ª SlaveDataSourceNameã€‚</p>
<p>ShardingSphere æä¾›äº†ä¸¤ä¸ª MasterSlaveLoadBalanceAlgorithm çš„å®ç°ç±»ï¼Œä¸€ä¸ªæ˜¯æ”¯æŒéšæœºç®—æ³•çš„ RandomMasterSlaveLoadBalanceAlgorithmï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯æ”¯æŒè½®è¯¢ç®—æ³•çš„ RoundRobinMasterSlaveLoadBalanceAlgorithmã€‚</p>
<p>æˆ‘ä»¬åœ¨ sharding-core-common å·¥ç¨‹ä¸­å‘ç°äº†å¯¹åº”çš„ ServiceLoader ç±» MasterSlaveLoadBalanceAlgorithmServiceLoaderï¼Œè€Œå…·ä½“ MasterSlaveLoadBalanceAlgorithm å®ç°ç±»çš„è·å–æ˜¯åœ¨ MasterSlaveRule ä¸­ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œåœ¨æ—¥å¸¸å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å®é™…ä¸Šä¸é€šè¿‡é…ç½®ä½“ç³»è®¾ç½®è¿™ä¸ªè´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œä¹Ÿèƒ½æ­£å¸¸è¿è¡Œè´Ÿè½½å‡è¡¡ç­–ç•¥ã€‚</p>
<p>MasterSlaveRule ä¸­çš„ createMasterSlaveLoadBalanceAlgorithm æ–¹æ³•ç»™å‡ºäº†ç­”æ¡ˆï¼š</p>
<pre tabindex="0"><code>private MasterSlaveLoadBalanceAlgorithm createMasterSlaveLoadBalanceAlgorithm(final LoadBalanceStrategyConfiguration loadBalanceStrategyConfiguration) {
    //è·å– MasterSlaveLoadBalanceAlgorithmServiceLoader
    MasterSlaveLoadBalanceAlgorithmServiceLoader serviceLoader = new MasterSlaveLoadBalanceAlgorithmServiceLoader(); 
    //æ ¹æ®é…ç½®æ¥åŠ¨æ€åŠ è½½è´Ÿè½½å‡è¡¡ç®—æ³•å®ç°ç±»
    return null == loadBalanceStrategyConfiguration
                ? serviceLoader.newService() : serviceLoader.newService(loadBalanceStrategyConfiguration.getType(), loadBalanceStrategyConfiguration.getProperties());
}
</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“ loadBalanceStrategyConfiguration é…ç½®ä¸å­˜åœ¨æ—¶ï¼Œä¼šç›´æ¥ä½¿ç”¨ serviceLoader.newService() æ–¹æ³•å®Œæˆ SPI å®ä¾‹çš„åˆ›å»ºã€‚æˆ‘ä»¬å›é¡¾ <strong>â€œ13 | å¾®å†…æ ¸æ¶æ„ï¼šShardingSphere å¦‚ä½•å®ç°ç³»ç»Ÿçš„æ‰©å±•æ€§ï¼Ÿâ€</strong> ä¸­çš„ä»‹ç»ï¼Œå°±ä¼šçŸ¥é“è¯¥æ–¹æ³•ä¼šè·å–ç³»ç»Ÿä¸­ç¬¬ä¸€ä¸ªå¯ç”¨çš„ SPI å®ä¾‹ã€‚</p>
<p>æˆ‘ä»¬åŒæ ·åœ¨ sharding-core-common å·¥ç¨‹ä¸­æ‰¾åˆ°äº† SPI çš„é…ç½®ä¿¡æ¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/ShardingSphere%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2-%E5%AE%8C/assets/Ciqc1F9Z3gGABwnKAAB1KuzlwD4571.png" alt="1.png"></p>
<p>é’ˆå¯¹ MasterSlaveLoadBalanceAlgorithm çš„ SPI é…ç½®</p>
<p>æŒ‰ç…§è¿™é‡Œçš„é…ç½®ä¿¡æ¯ï¼Œç¬¬ä¸€ä¸ªè·å–çš„ SPI å®ä¾‹åº”è¯¥æ˜¯ RoundRobinMasterSlaveLoadBalanceAlgorithmï¼Œå³<strong>è½®è¯¢ç­–ç•¥</strong>ï¼Œå®ƒçš„ getDataSource æ–¹æ³•å®ç°å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>@Override
public String getDataSource(final String name, final String masterDataSourceName, final List&lt;String&gt; slaveDataSourceNames) {
        AtomicInteger count = COUNTS.containsKey(name) ? COUNTS.get(name) : new AtomicInteger(0);
        COUNTS.putIfAbsent(name, count);
        count.compareAndSet(slaveDataSourceNames.size(), 0);
        return slaveDataSourceNames.get(Math.abs(count.getAndIncrement()) % slaveDataSourceNames.size());
}
</code></pre><p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡é…ç½®é€‰æ‹©éšæœºè®¿é—®ç­–ç•¥ï¼ŒRandomMasterSlaveLoadBalanceAlgorithm çš„ getDataSource æ›´åŠ ç®€å•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>@Override
public String getDataSource(final String name, final String masterDataSourceName, final List&lt;String&gt; slaveDataSourceNames) {
        return slaveDataSourceNames.get(ThreadLocalRandom.current().nextInt(slaveDataSourceNames.size()));
}
</code></pre><p>è‡³æ­¤ï¼Œå…³äº ShardingMasterSlaveRouter çš„ä»‹ç»å°±ç»“æŸäº†ï¼Œé€šè¿‡è¯¥ç±»æˆ‘ä»¬å¯ä»¥å®Œæˆåˆ†ç‰‡ä¿¡æ¯çš„ä¸»ä»è·¯ç”±ï¼Œä»è€Œå®ç°è¯»å†™åˆ†ç¦»ã€‚</p>
<p>åœ¨ ShardingSphere ä¸­ï¼Œè¿˜å­˜åœ¨ä¸€ä¸ªä¸å«åˆ†ç‰‡ä¿¡æ¯çš„ä¸»ä»è·¯ç”±ç±» MasterSlaveRouterï¼Œå…¶å®ç°è¿‡ç¨‹ä¸ ShardingMasterSlaveRouter éå¸¸ç±»ä¼¼ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€ä¸‹ã€‚</p>
<h3 id="masterslaverouter">MasterSlaveRouter</h3>
<p>ä»å‘½åä¸Šçœ‹ï¼ŒShardingMasterSlaveRouter ç±»çš„ä½œç”¨æ˜¯å®Œæˆåˆ†ç‰‡æ¡ä»¶ä¸‹çš„ä¸»ä»è·¯ç”±ã€‚é€šè¿‡å‰é¢å†…å®¹çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“è¯¥ç±»ä¸»è¦ç”¨äºè·¯ç”±å¼•æ“ä¸­ï¼Œå³åœ¨æ™®é€š ShardingRouter ä¸Šå†æ·»åŠ ä¸€å±‚è¯»å†™åˆ†ç¦»è·¯ç”±æœºåˆ¶ã€‚å¯ä»¥æƒ³è±¡è¿™æ˜¯ä¸€ç§æ¯”è¾ƒååº•å±‚çš„è¯»å†™åˆ†ç¦»æœºåˆ¶ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨è·¯ç”±ç¯èŠ‚å¯¹ç›®æ ‡æ•°æ®åº“åšäº†è°ƒæ•´ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä»å¦ä¸€ä¸ªç»´åº¦å‡ºå‘è®¨è®ºè¯»å†™åˆ†ç¦»ï¼Œæˆ‘ä»¬çš„æ€è·¯æ˜¯ä»æ›´é«˜çš„å±‚æ¬¡æ§åˆ¶æ•´ä¸ªè¯»å†™åˆ†ç¦»è¿‡ç¨‹ã€‚è®©æˆ‘ä»¬æ¥åˆ° sharding-jdbc-core å·¥ç¨‹ä¸­ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬æ›¾ç»è®¨è®ºè¿‡ ShardingDataSourceFactory ç±»ï¼Œè€Œè¿™æ¬¡æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ MasterSlaveDataSourceFactoryï¼Œè¯¥å·¥å‚ç±»çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ª MasterSlaveDataSourceï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>public final class MasterSlaveDataSourceFactory {

    public static DataSource createDataSource(final Map&lt;String, DataSource&gt; dataSourceMap, final MasterSlaveRuleConfiguration masterSlaveRuleConfig, final Properties props) throws SQLException {
        return new MasterSlaveDataSource(dataSourceMap, new MasterSlaveRule(masterSlaveRuleConfig), props);
    }
}
</code></pre><p>MasterSlaveDataSource çš„å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°è¯¥ç±»åŒæ ·æ‰©å±•äº† AbstractDataSourceAdapter ç±»ã€‚å…³äº AbstractDataSourceAdapter ä»¥åŠé’ˆå¯¹ Connection å’Œ Statement çš„å„ç§é€‚é…å™¨ç±»æˆ‘ä»¬å·²ç»åœ¨ <strong>â€œ03 | è§„èŒƒå…¼å®¹ï¼šJDBC è§„èŒƒä¸ ShardingSphere æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿâ€</strong> ä¸­è¿›è¡Œäº†è¯¦ç»†è®¨è®ºï¼Œè¿™é‡Œä¸å†å±•å¼€ã€‚</p>
<pre tabindex="0"><code>public class MasterSlaveDataSource extends AbstractDataSourceAdapter {

    private final MasterSlaveRuntimeContext runtimeContext;

    public MasterSlaveDataSource(final Map&lt;String, DataSource&gt; dataSourceMap, final MasterSlaveRule masterSlaveRule, final Properties props) throws SQLException {
        super(dataSourceMap);
        runtimeContext = new MasterSlaveRuntimeContext(dataSourceMap, masterSlaveRule, props, getDatabaseType());
    }

    @Override
    public final MasterSlaveConnection getConnection() {
        return new MasterSlaveConnection(getDataSourceMap(), runtimeContext);
    }
}
</code></pre><p>ä¸å…¶ä»– DataSource ä¸€æ ·ï¼ŒMasterSlaveDataSource åŒæ ·è´Ÿè´£åˆ›å»º RuntimeContext ä¸Šä¸‹æ–‡å¯¹è±¡å’Œ Connection å¯¹è±¡ã€‚å…ˆæ¥çœ‹è¿™é‡Œçš„ MasterSlaveRuntimeContextï¼Œæˆ‘ä»¬å‘ç°ä¸ ShardingRuntimeContext ç›¸æ¯”ï¼Œè¿™ä¸ªç±»è¦ç®€å•ä¸€ç‚¹ï¼Œåªæ˜¯æ„å»ºäº†æ‰€éœ€çš„ DatabaseMetaData å¹¶è¿›è¡Œç¼“å­˜ã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬å†æ¥çœ‹ MasterSlaveConnectionã€‚ä¸å…¶ä»– Connection ç±»ä¸€æ ·ï¼Œè¿™é‡Œä¹Ÿæœ‰ä¸€ç»„ createStatement å’Œ prepareStatement æ–¹æ³•ç”¨æ¥è·å– Statement å’Œ PreparedStatementï¼Œåˆ†åˆ«å¯¹åº” MasterSlaveStatement å’Œ MasterSlavePreparedStatementã€‚</p>
<p>æˆ‘ä»¬æ¥çœ‹ MasterSlaveStatement ä¸­çš„å®ç°ï¼Œé¦–å…ˆè¿˜æ˜¯å…³æ³¨äºå®ƒçš„æŸ¥è¯¢æ–¹æ³• executeQueryï¼š</p>
<pre tabindex="0"><code>@Override
public ResultSet executeQuery(final String sql) throws SQLException {
        if (Strings.isNullOrEmpty(sql)) {
            throw new SQLException(SQLExceptionConstant.SQL_STRING_NULL_OR_EMPTY);
        }
        //æ¸…é™¤ StatementExecutor ä¸­çš„ç›¸å…³å˜é‡
        clearPrevious();
        //é€šè¿‡ MasterSlaveRouter è·å–ç›®æ ‡ DataSource
        Collection&lt;String&gt; dataSourceNames = masterSlaveRouter.route(sql, false);
        Preconditions.checkState(1 == dataSourceNames.size(), &quot;Cannot support executeQuery for DML or DDL&quot;);
        //ä» Connection ä¸­è·å– Statement
        Statement statement = connection.getConnection(dataSourceNames.iterator().next()).createStatement(resultSetType, resultSetConcurrency, resultSetHoldability);
        routedStatements.add(statement);
        //æ‰§è¡ŒæŸ¥è¯¢å¹¶è¿”å›ç»“æœ
        return statement.executeQuery(sql);
}
</code></pre><p>ä¸ ShardingStatement ä¸åŒï¼Œä¸Šè¿°æ–¹æ³•å¹¶æ²¡æœ‰é€šè¿‡åˆ†ç‰‡è·¯ç”±è·å–ç›®æ ‡ dataSourceNamesï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡ MasterSlaveRouter æ¥å®ç°è¿™ä¸€ç›®æ ‡ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°è¿™é‡Œä¹Ÿæ²¡æœ‰é€šè¿‡ ShardingSphere çš„æ‰§è¡Œå¼•æ“å’Œå½’å¹¶å¼•æ“æ¥æ‰§è¡Œ SQL å¹¶å½’å¹¶ç»“æœï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨äº† statement çš„ executeQuery å®Œæˆ SQL çš„æ‰§è¡Œã€‚æ˜¾ç„¶ï¼Œè¿™ä¸ªæ ¸å¿ƒæ­¥éª¤æ˜¯é€šè¿‡ MasterSlaveRouter å®ç°çš„è·¯ç”±æœºåˆ¶ã€‚</p>
<p>MasterSlaveRouter çš„ route æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>private Collection&lt;String&gt; route(final SQLStatement sqlStatement) {
         //å¦‚æœæ˜¯å¼ºåˆ¶ä¸»åº“è·¯ç”±
        if (isMasterRoute(sqlStatement)) {
            MasterVisitedManager.setMasterVisited();
            return Collections.singletonList(masterSlaveRule.getMasterDataSourceName());
        }
        //é€šè¿‡è´Ÿè½½å‡è¡¡æ‰§è¡Œä»åº“è·¯ç”±
        return Collections.singletonList(masterSlaveRule.getLoadBalanceAlgorithm().getDataSource(
                masterSlaveRule.getName(), masterSlaveRule.getMasterDataSourceName(), new ArrayList&lt;&gt;(masterSlaveRule.getSlaveDataSourceNames())));
}
</code></pre><p>ä¸Šè¿°ä»£ç ä¼¼æ›¾ç›¸è¯†ï¼Œç›¸å…³çš„å¤„ç†æµç¨‹ï¼Œä»¥åŠèƒŒåçš„ LoadBalanceAlgorithm æˆ‘ä»¬åœ¨ä»‹ç» ShardingMasterSlaveRouter ç±»æ—¶å·²ç»åšäº†å…¨é¢å±•å¼€ã€‚é€šè¿‡ dataSourceNames ä¸­çš„ä»»ä½•ä¸€ä¸ªç›®æ ‡æ•°æ®åº“åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„å»º Connection å¹¶åˆ›å»ºç”¨äºæ‰§è¡ŒæŸ¥è¯¢çš„ Statementã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬æ¥çœ‹ MasterSlaveStatement çš„ executeUpdate æ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>@Override
public int executeUpdate(final String sql) throws SQLException {
         //æ¸…é™¤ StatementExecutor ä¸­çš„ç›¸å…³å˜é‡
        clearPrevious();
        int result = 0;
        for (String each : masterSlaveRouter.route(sql, false)) {
         //ä» Connection ä¸­è·å– Statement
            Statement statement = connection.getConnection(each).createStatement(resultSetType, resultSetConcurrency, resultSetHoldability);
            routedStatements.add(statement);
            //æ‰§è¡Œæ›´æ–°
            result += statement.executeUpdate(sql);
        }
        return result;
}
</code></pre><p>è¿™é‡Œçš„æµç¨‹æ˜¯ç›´æ¥é€šè¿‡ masterSlaveRouter è·å–å„ä¸ªç›®æ ‡æ•°æ®åº“ï¼Œç„¶ååˆ†åˆ«æ„å»º Statement è¿›è¡Œæ‰§è¡Œã€‚</p>
<p>åŒæ ·ï¼Œæˆ‘ä»¬æ¥åˆ° MasterSlavePreparedStatement ç±»ï¼Œå…ˆæ¥çœ‹å®ƒçš„å…¶ä¸­ä¸€ä¸ªæ„é€ å‡½æ•°ï¼ˆå…¶ä½™çš„ä¹Ÿç±»ä¼¼ï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>public MasterSlavePreparedStatement(final MasterSlaveConnection connection, final String sql, final int resultSetType, final int resultSetConcurrency, final int resultSetHoldability) throws SQLException {
        if (Strings.isNullOrEmpty(sql)) {
            throw new SQLException(SQLExceptionConstant.SQL_STRING_NULL_OR_EMPTY);
        }
        this.connection = connection;
        //åˆ›å»º MasterSlaveRouter
        masterSlaveRouter = new MasterSlaveRouter(connection.getRuntimeContext().getRule(), connection.getRuntimeContext().getParseEngine(), 
                connection.getRuntimeContext().getProps().&lt;Boolean&gt;getValue(ShardingPropertiesConstant.SQL_SHOW));
        for (String each : masterSlaveRouter.route(sql, true)) {
             //å¯¹æ¯ä¸ªç›®æ ‡ DataSource ä» Connection ä¸­è·å– PreparedStatement
            PreparedStatement preparedStatement = connection.getConnection(each).prepareStatement(sql, resultSetType, resultSetConcurrency, resultSetHoldability);
            routedStatements.add(preparedStatement);
        }
}
</code></pre><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæ„å»ºäº† MasterSlaveRouterï¼Œç„¶åå¯¹äºé€šè¿‡ MasterSlaveRouter è·¯ç”±è·å–çš„æ¯ä¸ªæ•°æ®åº“ï¼Œåˆ†åˆ«åˆ›å»ºä¸€ä¸ª PreparedStatement å¹¶ä¿å­˜åˆ° routedStatements åˆ—è¡¨ä¸­ã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬æ¥çœ‹ MasterSlavePreparedStatement çš„ executeQuery æ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>@Override
public ResultSet executeQuery() throws SQLException {
        Preconditions.checkArgument(1 == routedStatements.size(), &quot;Cannot support executeQuery for DDL&quot;);
        return routedStatements.iterator().next().executeQuery();
}
</code></pre><p>å¯¹äºä¸Šè¿° executeQuery æ–¹æ³•è€Œè¨€ï¼Œæˆ‘ä»¬åªéœ€è¦è·å– routedStatements ä¸­çš„ä»»ä½•ä¸€ä¸ª PreparedStatement è¿›è¡Œæ‰§è¡Œå³å¯ã€‚è€Œå¯¹äº Update æ“ä½œï¼ŒMasterSlavePreparedStatement çš„æ‰§è¡Œæµç¨‹ä¹Ÿä¸ MasterSlaveStatement çš„ä¸€è‡´ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>@Override
public int executeUpdate() throws SQLException {
        int result = 0;
        for (PreparedStatement each : routedStatements) {
            result += each.executeUpdate();
        }
        return result;
}
</code></pre><p>è‡³æ­¤ï¼ŒShardingSphere ä¸­ä¸è¯»å†™åˆ†ç¦»ç›¸å…³çš„æ ¸å¿ƒç±»ä»¥åŠä¸»è¦æµç¨‹ä»‹ç»å®Œæ¯•ã€‚æ€»ä½“è€Œè¨€ï¼Œè¿™éƒ¨åˆ†çš„å†…å®¹å› ä¸ºä¸æ¶‰åŠåˆ†ç‰‡æ“ä½œï¼Œæ‰€ä»¥æ•´ä½“ç»“æ„è¿˜æ˜¯æ¯”è¾ƒç›´æ¥å’Œæ˜ç¡®çš„ã€‚å°¤å…¶æ˜¯æˆ‘ä»¬åœ¨äº†è§£äº†åˆ†ç‰‡ç›¸å…³çš„ ShardingDataSourceã€ShardingConnectionã€ShardingStatement å’Œ ShardingPreparedStatement ä¹‹åå†æ¥ç†è§£ä»Šå¤©çš„å†…å®¹å°±æ˜¾å¾—ç‰¹åˆ«ç®€å•ï¼Œå¾ˆå¤šåº•å±‚çš„é€‚é…å™¨æ¨¡å¼ç­‰å†…å®¹å‰é¢éƒ½ä»‹ç»è¿‡ã€‚</p>
<p>ä½œä¸ºæ€»ç»“ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç®€å•æ¢³ç†ä¸€ä¸‹è¯»å†™åˆ†ç¦»ç›¸å…³çš„ç±»å±‚ç»“æ„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/ShardingSphere%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2-%E5%AE%8C/assets/CgqCHl9Z3jGAH6CLAAByFyKIpQ0068.png" alt="image.png"></p>
<h3 id="ä»æºç è§£æåˆ°æ—¥å¸¸å¼€å‘">ä»æºç è§£æåˆ°æ—¥å¸¸å¼€å‘</h3>
<p>åœ¨ä»Šå¤©çš„å†…å®¹ä¸­ï¼Œæˆ‘ä»¬æ¥è§¦åˆ°äº†åˆ†å¸ƒå¼ç³»ç»Ÿå¼€å‘è¿‡ç¨‹ä¸­éå¸¸å¸¸è§çš„ä¸€ä¸ªè¯é¢˜ï¼Œå³<strong>è´Ÿè½½å‡è¡¡</strong>ã€‚è´Ÿè½½å‡è¡¡çš„åœºæ™¯å°±ç±»ä¼¼äºåœ¨å¤šä¸ªä»åº“ä¸­é€‰æ‹©ä¸€ä¸ªç›®æ ‡åº“è¿›è¡Œè·¯ç”±ä¸€æ ·ï¼Œé€šå¸¸éœ€è¦ä¾èµ–äºä¸€å®šçš„è´Ÿè½½å‡è¡¡ç®—æ³•ï¼ŒShardingSphere ä¸­å°±æä¾›äº†<strong>éšæœº</strong>å’Œ<strong>è½®è¯¢</strong>è¿™ä¸¤ç§å¸¸è§çš„å®ç°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ—¥å¸¸å¼€å‘è¿‡ç¨‹ä¸­å‚è€ƒå®ƒçš„å®ç°æ–¹æ³•ã€‚</p>
<p>å½“ç„¶ï¼Œå› ä¸º MasterSlaveLoadBalanceAlgorithm æ¥å£æ˜¯ä¸€ä¸ª SPIï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥å®šåˆ¶åŒ–æ–°çš„è´Ÿè½½å‡è¡¡ç®—æ³•å¹¶åŠ¨æ€åŠ è½½åˆ° ShardingSphereã€‚</p>
<h3 id="å°ç»“ä¸é¢„å‘Š">å°ç»“ä¸é¢„å‘Š</h3>
<p>è¯»å†™åˆ†ç¦»æ˜¯ ShardingSphere åˆ†ç‰‡å¼•æ“ä¸­çš„æœ€åä¸€éƒ¨åˆ†å†…å®¹ï¼Œåœ¨å®é™…åº”ç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åˆ†ç‰‡å¼•æ“ä¸‹åµŒå…¥è¯»å†™åˆ†ç¦»æœºåˆ¶ï¼Œä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ã€‚</p>
<p>æ‰€ä»¥åœ¨å®ç°ä¸Šï¼ŒShardingSphere ä¹Ÿæä¾›äº†ä¸¤ç§ä¸åŒçš„å®ç°ç±»ï¼šä¸€ç§æ˜¯åˆ†ç‰‡ç¯å¢ƒä¸‹çš„ ShardingMasterSlaveRouterï¼Œä¸€ç§æ˜¯ç”¨äºå•ç‹¬ä½¿ç”¨çš„ MasterSlaveRouterï¼Œæˆ‘ä»¬å¯¹è¿™ä¸¤ä¸ªå®ç°ç±»çš„åŸç†è¿›è¡Œäº†è¯¦ç»†çš„åˆ†æå’Œå±•å¼€ã€‚</p>
<p>æœ€åè¿™é‡Œç»™ä½ ç•™ä¸€é“æ€è€ƒé¢˜ï¼šShardingSphere ä¸­ï¼Œè¯»å†™åˆ†ç¦»å¼•æ“ä¸è´Ÿè½½å‡è¡¡ç®—æ³•çš„é›†æˆè¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</p>
<p>ä»ä¸‹ä¸€è¯¾æ—¶å¼€å§‹ï¼Œæˆ‘ä»¬å°†è¿›å…¥ ShardingSphere ä¸­å¦ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—çš„æºç è§£æï¼Œè¿™å°±æ˜¯åˆ†å¸ƒå¼äº‹åŠ¡ã€‚</p>

        </div>
    </article>
</div>

    </main>
    <footer>
        <div id="pagination">
            
<div class="paginator">
    <div class="prev">
        
        <a href="/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/25-%E5%BD%92%E5%B9%B6%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E6%B5%81%E5%BC%8F%E5%BD%92%E5%B9%B6%E5%92%8C%E5%86%85%E5%AD%98%E5%BD%92%E5%B9%B6%E5%9C%A8%E5%A4%8D%E6%9D%82%E5%BD%92%E5%B9%B6%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%9A%84%E5%BA%94%E7%94%A8%E6%96%B9%E5%BC%8F/"><span>25 å½’å¹¶å¼•æ“ï¼šå¦‚ä½•ç†è§£æµå¼å½’å¹¶å’Œå†…å­˜å½’å¹¶åœ¨å¤æ‚å½’å¹¶åœºæ™¯ä¸‹çš„åº”ç”¨æ–¹å¼ï¼Ÿ</span></a>
    </div>
    <div class="next">
        
        <a href="/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/27-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3-shardingsphere-%E4%B8%AD%E5%AF%B9%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%9A%84%E6%8A%BD%E8%B1%A1%E8%BF%87%E7%A8%8B/"><span>27 åˆ†å¸ƒå¼äº‹åŠ¡ï¼šå¦‚ä½•ç†è§£ ShardingSphere ä¸­å¯¹åˆ†å¸ƒå¼äº‹åŠ¡çš„æŠ½è±¡è¿‡ç¨‹ï¼Ÿ</span></a>
    </div>
</div>

        </div>
        <div class="toggler" onclick="toggleLight(this);">ğŸ’¡</div>
        <div id="copyright" style="display: none;">
    
    
    <p>&copy; 28280 <a href="/"></a>, powered by Hugo and Qiao</p>
</div>
    </footer>
    
<script>
    function toggleLight() {
        document.getElementById('page').classList.toggle('night');
    }
</script>
</body>

</html>