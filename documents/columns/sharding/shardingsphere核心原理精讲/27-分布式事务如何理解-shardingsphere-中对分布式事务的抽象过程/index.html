<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
<meta name="X-UA-Compatible" , content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<link rel="icon" type="image/png" href="/%20/favicon.png">

<title>27 åˆ†å¸ƒå¼äº‹åŠ¡ï¼šå¦‚ä½•ç†è§£ ShardingSphere ä¸­å¯¹åˆ†å¸ƒå¼äº‹åŠ¡çš„æŠ½è±¡è¿‡ç¨‹ï¼Ÿ | Yipsen Ye</title>
<meta name="description" content="ä»ä»Šå¤©å¼€å§‹ï¼Œæˆ‘ä»¬å°†è¿›å…¥ä¸€ä¸ªå…¨æ–°æ¨¡å—ï¼Œå³ShardingSphere åˆ†å¸ƒå¼äº‹åŠ¡ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ä¸»é¢˜ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸‰ä¸ªè¯¾æ—¶æ¥å…¨é¢ä»‹ç» ShardingSphere çš„äº‹åŠ¡å®ç°æœºåˆ¶ã€‚
ShardingTransactionManagerEngine åœ¨ç¬¬ 18 è¯¾æ—¶å’Œç¬¬ 19 è¯¾æ—¶çš„â€œåˆ†å¸ƒå¼äº‹åŠ¡ï¼šå¦‚ä½•ä½¿ç”¨å¼ºä¸€è‡´äº‹åŠ¡ä¸æŸ”æ€§äº‹åŠ¡ï¼Ÿâ€ä¸­ï¼Œæˆ‘ä»¬å·²ç»å¯¹åˆ†å¸ƒå¼äº‹åŠ¡çš„åŸºæœ¬æ¦‚å¿µåšäº†ä»‹ç»ã€‚
åœ¨äº†è§£å®Œä¸€äº›åŸºæœ¬æ¦‚å¿µä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹ ShardingSphere ä¸­åˆ†å¸ƒå¼äº‹åŠ¡æ¨¡å—çš„ä»£ç å·¥ç¨‹ç»„ç»‡ç»“æ„ï¼Œæˆ‘ä»¬å‘ç°å­˜åœ¨ä¸‰ä¸ªåº•å±‚çš„å·¥ç¨‹ï¼Œå³ sharding-transaction-coreã€sharding-transaction-2pc å’Œ sharding-transaction-baseã€‚
ä»å‘½åä¸Šï¼Œæˆ‘ä»¬ä¸éš¾çœ‹å‡º sharding-transaction-core åº”è¯¥åŒ…å«äº†åˆ†å¸ƒå¼äº‹åŠ¡ç›¸å…³çš„ä¸€äº›åŸºç¡€æ ¸å¿ƒç±»ï¼Œè€Œ sharding-transaction-2pc å’Œ sharding-transaction-base åˆ†åˆ«åŸºäºå¼ºä¸€è‡´æ€§å’Œæœ€ç»ˆä¸€è‡´æ€§çš„ä¸¤ç§å®ç°ã€‚
è¿™äº›åŒ…ç»“æ„çš„å‘½åå®é™…ä¸Šå¯ä»¥ä½“ç°åœ¨äº‹åŠ¡ç±»å‹ TransactionType çš„å®šä¹‰ä¸Šï¼Œå®ƒæ˜¯ä¸€ä¸ªæšä¸¾ï¼Œåˆ†åˆ«ä»£è¡¨äº†æœ¬åœ°äº‹åŠ¡ã€XA äºŒé˜¶æ®µæäº¤äº‹åŠ¡å’Œ BASE æŸ”æ€§äº‹åŠ¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
public enum TransactionType {LOCAL, XA, BASE}TransactionType ç±»ä½äº sharding-transaction-core å·¥ç¨‹ä¸­ï¼Œè®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªå·¥ç¨‹ä¸­çš„å…¶ä»–å†…å®¹ï¼Œé¦–å…ˆå…¶å†²çš„å°±æ˜¯ ShardingTransactionManagerEngine æ¥å£ã€‚
åœ¨å‰é¢çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬åœ¨ ShardingRuntimeContext è¿™ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ä¸­ç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ç®¡ç†å™¨çš„å…¥å£ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
public final class ShardingRuntimeContext extends AbstractRuntimeContext&amp;lt;ShardingRule&amp;gt; {â€¦private final ShardingTransactionManagerEngine shardingTransactionManagerEngine;public ShardingRuntimeContext(final Map&amp;lt;String, DataSource&amp;gt; dataSourceMap, final ShardingRule rule, final Properties props, final DatabaseType databaseType) throws SQLException {â€¦//åˆ›å»ºåˆ†å¸ƒå¼äº‹åŠ¡ç®¡ç†å™¨å¼•æ“å¹¶åˆå§‹åŒ–shardingTransactionManagerEngine = new ShardingTransactionManagerEngine();shardingTransactionManagerEngine.">
<meta name="author" content="">

<link rel="stylesheet" type="text/css" href="/styles/main.css">

</head>

<body id="page">
    <header>
        <div class="nav-logo">
    <a href="http://yipsen.github.io/">
        
        <span class="nav-title">Yipsen Ye</span>
    </a>
</div>
<nav class="navbar justify-content-end">
    <ul class="nav-list">
        
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/posts/">æ–‡ç« </a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/collections/">é™„è¡¨</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/about/">å…³äº</a>
        </li>
        
    </ul>
</nav>
    </header>
    <main id="content">
        
<div class="container"><aside>
    <div>
        
        
            
            
            <div class="post-category-icon"></div>
            <a href="/categories/shardingsphere%e6%a0%b8%e5%bf%83%e5%8e%9f%e7%90%86%e7%b2%be%e8%ae%b2/">ShardingSphereæ ¸å¿ƒåŸç†ç²¾è®²</a>
            <ul>
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/00-%E5%A6%82%E4%BD%95%E6%AD%A3%E7%A1%AE%E5%AD%A6%E4%B9%A0%E4%B8%80%E6%AC%BE%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">00 å¦‚ä½•æ­£ç¡®å­¦ä¹ ä¸€æ¬¾åˆ†åº“åˆ†è¡¨å¼€æºæ¡†æ¶ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/01-%E4%BB%8E%E7%90%86%E8%AE%BA%E5%88%B0%E5%AE%9E%E8%B7%B5%E5%A6%82%E4%BD%95%E8%AE%A9%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E7%9C%9F%E6%AD%A3%E8%90%BD%E5%9C%B0/">01 ä»ç†è®ºåˆ°å®è·µï¼šå¦‚ä½•è®©åˆ†åº“åˆ†è¡¨çœŸæ­£è½åœ°ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/02-%E9%A1%B6%E7%BA%A7%E9%A1%B9%E7%9B%AEshardingsphere-%E6%98%AF%E4%B8%80%E6%AC%BE%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84-apache-%E5%BC%80%E6%BA%90%E8%BD%AF%E4%BB%B6/">02 é¡¶çº§é¡¹ç›®ï¼šShardingSphere æ˜¯ä¸€æ¬¾ä»€ä¹ˆæ ·çš„ Apache å¼€æºè½¯ä»¶ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/03-%E8%A7%84%E8%8C%83%E5%85%BC%E5%AE%B9jdbc-%E8%A7%84%E8%8C%83%E4%B8%8E-shardingsphere-%E6%98%AF%E4%BB%80%E4%B9%88%E5%85%B3%E7%B3%BB/">03 è§„èŒƒå…¼å®¹ï¼šJDBC è§„èŒƒä¸ ShardingSphere æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/04-%E5%BA%94%E7%94%A8%E9%9B%86%E6%88%90%E5%9C%A8%E4%B8%9A%E5%8A%A1%E7%B3%BB%E7%BB%9F%E4%B8%AD%E4%BD%BF%E7%94%A8-shardingsphere-%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9C%89%E5%93%AA%E4%BA%9B/">04 åº”ç”¨é›†æˆï¼šåœ¨ä¸šåŠ¡ç³»ç»Ÿä¸­ä½¿ç”¨ ShardingSphere çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/05-%E9%85%8D%E7%BD%AE%E9%A9%B1%E5%8A%A8shardingsphere-%E4%B8%AD%E7%9A%84%E9%85%8D%E7%BD%AE%E4%BD%93%E7%B3%BB%E6%98%AF%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E7%9A%84/">05 é…ç½®é©±åŠ¨ï¼šShardingSphere ä¸­çš„é…ç½®ä½“ç³»æ˜¯å¦‚ä½•è®¾è®¡çš„ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/09-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%BC%BA%E4%B8%80%E8%87%B4%E6%80%A7%E4%BA%8B%E5%8A%A1%E4%B8%8E%E6%9F%94%E6%80%A7%E4%BA%8B%E5%8A%A1/">09 åˆ†å¸ƒå¼äº‹åŠ¡ï¼šå¦‚ä½•ä½¿ç”¨å¼ºä¸€è‡´æ€§äº‹åŠ¡ä¸æŸ”æ€§äº‹åŠ¡ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/10-%E6%95%B0%E6%8D%AE%E8%84%B1%E6%95%8F%E5%A6%82%E4%BD%95%E7%A1%AE%E4%BF%9D%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AE%89%E5%85%A8%E8%AE%BF%E9%97%AE/">10 æ•°æ®è„±æ•ï¼šå¦‚ä½•ç¡®ä¿æ•æ„Ÿæ•°æ®çš„å®‰å…¨è®¿é—®ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/11-%E7%BC%96%E6%8E%92%E6%B2%BB%E7%90%86%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E7%8E%AF%E5%A2%83%E4%B8%8B%E7%9A%84%E5%8A%A8%E6%80%81%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/">11 ç¼–æ’æ²»ç†ï¼šå¦‚ä½•å®ç°åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„åŠ¨æ€é…ç½®ç®¡ç†ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/12-%E4%BB%8E%E5%BA%94%E7%94%A8%E5%88%B0%E5%8E%9F%E7%90%86%E5%A6%82%E4%BD%95%E9%AB%98%E6%95%88%E9%98%85%E8%AF%BB-shardingsphere-%E6%BA%90%E7%A0%81/">12 ä»åº”ç”¨åˆ°åŸç†ï¼šå¦‚ä½•é«˜æ•ˆé˜…è¯» ShardingSphere æºç ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/13-%E5%BE%AE%E5%86%85%E6%A0%B8%E6%9E%B6%E6%9E%84shardingsphere-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%89%A9%E5%B1%95%E6%80%A7/">13 å¾®å†…æ ¸æ¶æ„ï¼šShardingSphere å¦‚ä½•å®ç°ç³»ç»Ÿçš„æ‰©å±•æ€§ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/14-%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%BB%E9%94%AEshardingsphere-%E4%B8%AD%E6%9C%89%E5%93%AA%E4%BA%9B%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%BB%E9%94%AE%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F/">14 åˆ†å¸ƒå¼ä¸»é”®ï¼šShardingSphere ä¸­æœ‰å“ªäº›åˆ†å¸ƒå¼ä¸»é”®å®ç°æ–¹å¼ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/15-%E8%A7%A3%E6%9E%90%E5%BC%95%E6%93%8Esql-%E8%A7%A3%E6%9E%90%E6%B5%81%E7%A8%8B%E5%BA%94%E8%AF%A5%E5%8C%85%E6%8B%AC%E5%93%AA%E4%BA%9B%E6%A0%B8%E5%BF%83%E9%98%B6%E6%AE%B5%E4%B8%8A/">15 è§£æå¼•æ“ï¼šSQL è§£ææµç¨‹åº”è¯¥åŒ…æ‹¬å“ªäº›æ ¸å¿ƒé˜¶æ®µï¼Ÿï¼ˆä¸Šï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/16-%E8%A7%A3%E6%9E%90%E5%BC%95%E6%93%8Esql-%E8%A7%A3%E6%9E%90%E6%B5%81%E7%A8%8B%E5%BA%94%E8%AF%A5%E5%8C%85%E6%8B%AC%E5%93%AA%E4%BA%9B%E6%A0%B8%E5%BF%83%E9%98%B6%E6%AE%B5%E4%B8%8B/">16 è§£æå¼•æ“ï¼šSQL è§£ææµç¨‹åº”è¯¥åŒ…æ‹¬å“ªäº›æ ¸å¿ƒé˜¶æ®µï¼Ÿï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/17-%E8%B7%AF%E7%94%B1%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E5%88%86%E7%89%87%E8%B7%AF%E7%94%B1%E6%A0%B8%E5%BF%83%E7%B1%BB-shardingrouter-%E7%9A%84%E8%BF%90%E4%BD%9C%E6%9C%BA%E5%88%B6/">17 è·¯ç”±å¼•æ“ï¼šå¦‚ä½•ç†è§£åˆ†ç‰‡è·¯ç”±æ ¸å¿ƒç±» ShardingRouter çš„è¿ä½œæœºåˆ¶ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/18-%E8%B7%AF%E7%94%B1%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E7%9A%84%E5%88%86%E7%89%87%E8%B7%AF%E7%94%B1%E5%92%8C%E5%B9%BF%E6%92%AD%E8%B7%AF%E7%94%B1/">18 è·¯ç”±å¼•æ“ï¼šå¦‚ä½•å®ç°æ•°æ®è®¿é—®çš„åˆ†ç‰‡è·¯ç”±å’Œå¹¿æ’­è·¯ç”±ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/19-%E8%B7%AF%E7%94%B1%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E5%9C%A8%E8%B7%AF%E7%94%B1%E8%BF%87%E7%A8%8B%E4%B8%AD%E9%9B%86%E6%88%90%E5%A4%9A%E7%A7%8D%E8%B7%AF%E7%94%B1%E7%AD%96%E7%95%A5%E5%92%8C%E8%B7%AF%E7%94%B1%E7%AE%97%E6%B3%95/">19 è·¯ç”±å¼•æ“ï¼šå¦‚ä½•åœ¨è·¯ç”±è¿‡ç¨‹ä¸­é›†æˆå¤šç§è·¯ç”±ç­–ç•¥å’Œè·¯ç”±ç®—æ³•ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/20-%E6%94%B9%E5%86%99%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F%E4%B8%8B%E7%9A%84-sql-%E6%94%B9%E5%86%99%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6/">20 æ”¹å†™å¼•æ“ï¼šå¦‚ä½•ç†è§£è£…é¥°å™¨æ¨¡å¼ä¸‹çš„ SQL æ”¹å†™å®ç°æœºåˆ¶ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/21-%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E%E5%88%86%E7%89%87%E7%8E%AF%E5%A2%83%E4%B8%8B-sql-%E6%89%A7%E8%A1%8C%E7%9A%84%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B%E5%BA%94%E8%AF%A5%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E6%8A%BD%E8%B1%A1/">21 æ‰§è¡Œå¼•æ“ï¼šåˆ†ç‰‡ç¯å¢ƒä¸‹ SQL æ‰§è¡Œçš„æ•´ä½“æµç¨‹åº”è¯¥å¦‚ä½•è¿›è¡ŒæŠ½è±¡ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/22-%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E6%8A%8A%E6%8F%A1-shardingsphere-%E4%B8%AD%E7%9A%84-executor-%E6%89%A7%E8%A1%8C%E6%A8%A1%E5%9E%8B%E4%B8%8A/">22 æ‰§è¡Œå¼•æ“ï¼šå¦‚ä½•æŠŠæ¡ ShardingSphere ä¸­çš„ Executor æ‰§è¡Œæ¨¡å‹ï¼Ÿï¼ˆä¸Šï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/23-%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E6%8A%8A%E6%8F%A1-shardingsphere-%E4%B8%AD%E7%9A%84-executor-%E6%89%A7%E8%A1%8C%E6%A8%A1%E5%9E%8B%E4%B8%8B/">23 æ‰§è¡Œå¼•æ“ï¼šå¦‚ä½•æŠŠæ¡ ShardingSphere ä¸­çš„ Executor æ‰§è¡Œæ¨¡å‹ï¼Ÿï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/24-%E5%BD%92%E5%B9%B6%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E6%95%B0%E6%8D%AE%E5%BD%92%E5%B9%B6%E7%9A%84%E7%B1%BB%E5%9E%8B%E4%BB%A5%E5%8F%8A%E7%AE%80%E5%8D%95%E5%BD%92%E5%B9%B6%E7%AD%96%E7%95%A5%E7%9A%84%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B/">24 å½’å¹¶å¼•æ“ï¼šå¦‚ä½•ç†è§£æ•°æ®å½’å¹¶çš„ç±»å‹ä»¥åŠç®€å•å½’å¹¶ç­–ç•¥çš„å®ç°è¿‡ç¨‹ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/25-%E5%BD%92%E5%B9%B6%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E6%B5%81%E5%BC%8F%E5%BD%92%E5%B9%B6%E5%92%8C%E5%86%85%E5%AD%98%E5%BD%92%E5%B9%B6%E5%9C%A8%E5%A4%8D%E6%9D%82%E5%BD%92%E5%B9%B6%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%9A%84%E5%BA%94%E7%94%A8%E6%96%B9%E5%BC%8F/">25 å½’å¹¶å¼•æ“ï¼šå¦‚ä½•ç†è§£æµå¼å½’å¹¶å’Œå†…å­˜å½’å¹¶åœ¨å¤æ‚å½’å¹¶åœºæ™¯ä¸‹çš„åº”ç”¨æ–¹å¼ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/26-%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E6%99%AE%E9%80%9A%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%92%8C%E5%88%86%E7%89%87%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%88%86%E5%88%AB%E6%98%AF%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%9A%84/">26 è¯»å†™åˆ†ç¦»ï¼šæ™®é€šä¸»ä»æ¶æ„å’Œåˆ†ç‰‡ä¸»ä»æ¶æ„åˆ†åˆ«æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</a></li>
                
                
                
                    <li>27 åˆ†å¸ƒå¼äº‹åŠ¡ï¼šå¦‚ä½•ç†è§£ ShardingSphere ä¸­å¯¹åˆ†å¸ƒå¼äº‹åŠ¡çš„æŠ½è±¡è¿‡ç¨‹ï¼Ÿ</li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/28-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1shardingsphere-%E4%B8%AD%E5%A6%82%E4%BD%95%E9%9B%86%E6%88%90%E5%BC%BA%E4%B8%80%E8%87%B4%E6%80%A7%E4%BA%8B%E5%8A%A1%E5%92%8C%E6%9F%94%E6%80%A7%E4%BA%8B%E5%8A%A1%E6%94%AF%E6%8C%81%E4%B8%8A/">28 åˆ†å¸ƒå¼äº‹åŠ¡ï¼šShardingSphere ä¸­å¦‚ä½•é›†æˆå¼ºä¸€è‡´æ€§äº‹åŠ¡å’ŒæŸ”æ€§äº‹åŠ¡æ”¯æŒï¼Ÿï¼ˆä¸Šï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/29-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1shardingsphere-%E4%B8%AD%E5%A6%82%E4%BD%95%E9%9B%86%E6%88%90%E5%BC%BA%E4%B8%80%E8%87%B4%E6%80%A7%E4%BA%8B%E5%8A%A1%E5%92%8C%E6%9F%94%E6%80%A7%E4%BA%8B%E5%8A%A1%E6%94%AF%E6%8C%81%E4%B8%8B/">29 åˆ†å¸ƒå¼äº‹åŠ¡ï¼šShardingSphere ä¸­å¦‚ä½•é›†æˆå¼ºä¸€è‡´æ€§äº‹åŠ¡å’ŒæŸ”æ€§äº‹åŠ¡æ”¯æŒï¼Ÿï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/30-%E6%95%B0%E6%8D%AE%E8%84%B1%E6%95%8F%E5%A6%82%E4%BD%95%E5%9F%BA%E4%BA%8E%E6%94%B9%E5%86%99%E5%BC%95%E6%93%8E%E5%AE%9E%E7%8E%B0%E4%BD%8E%E4%BE%B5%E5%85%A5%E6%80%A7%E6%95%B0%E6%8D%AE%E8%84%B1%E6%95%8F%E6%96%B9%E6%A1%88/">30 æ•°æ®è„±æ•ï¼šå¦‚ä½•åŸºäºæ”¹å†™å¼•æ“å®ç°ä½ä¾µå…¥æ€§æ•°æ®è„±æ•æ–¹æ¡ˆï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/31-%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E5%A6%82%E4%BD%95%E5%9F%BA%E4%BA%8E%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E5%AE%9E%E7%8E%B0%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E7%9A%84%E5%8A%A8%E6%80%81%E5%8C%96%E7%AE%A1%E7%90%86/">31 é…ç½®ä¸­å¿ƒï¼šå¦‚ä½•åŸºäºé…ç½®ä¸­å¿ƒå®ç°é…ç½®ä¿¡æ¯çš„åŠ¨æ€åŒ–ç®¡ç†ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/32-%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E5%A6%82%E4%BD%95%E5%9F%BA%E4%BA%8E%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BF%E9%97%AE%E7%86%94%E6%96%AD%E6%9C%BA%E5%88%B6/">32 æ³¨å†Œä¸­å¿ƒï¼šå¦‚ä½•åŸºäºæ³¨å†Œä¸­å¿ƒå®ç°æ•°æ®åº“è®¿é—®ç†”æ–­æœºåˆ¶ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/33-%E9%93%BE%E8%B7%AF%E8%B7%9F%E8%B8%AA%E5%A6%82%E4%BD%95%E5%9F%BA%E4%BA%8E-hook-%E6%9C%BA%E5%88%B6%E4%BB%A5%E5%8F%8A-opentracing-%E5%8D%8F%E8%AE%AE%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E9%93%BE%E8%B7%AF%E8%B7%9F%E8%B8%AA/">33 é“¾è·¯è·Ÿè¸ªï¼šå¦‚ä½•åŸºäº Hook æœºåˆ¶ä»¥åŠ OpenTracing åè®®å®ç°æ•°æ®è®¿é—®é“¾è·¯è·Ÿè¸ªï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/35-%E7%BB%93%E8%AF%ADshardingsphere-%E6%80%BB%E7%BB%93%E5%8F%8A%E5%B1%95%E6%9C%9B/">35 ç»“è¯­ï¼šShardingSphere æ€»ç»“åŠå±•æœ›</a></li>
                
                
            </ul>
        
    </div>
</aside>

<style>
    aside {
        position: fixed;
        left: 20px;
        background: #ffdee3;
        border-radius: 6px;
        padding: 20px;
        padding-top: 60px;
        box-shadow: 5px 10px #888;
        list-style-type: none;
        display: none;
    }

    .post-category-icon {
        position: absolute;
        width: 80px;
        height: 80px;
        top: -40px;
        left: 50%;
        margin-left: -40px;
        text-align: center;
        font-size: 36px;
        content: 'J';
        background: #ffdee3;
        border-radius: 100%;
        border: 10px solid #fff;
        box-shadow: 5px 10px #888;
    }
</style><article class="post-block">
        <h1 class="post-title">27 åˆ†å¸ƒå¼äº‹åŠ¡ï¼šå¦‚ä½•ç†è§£ ShardingSphere ä¸­å¯¹åˆ†å¸ƒå¼äº‹åŠ¡çš„æŠ½è±¡è¿‡ç¨‹ï¼Ÿ</h1>
        <div class="post-info">
            <div class="post-date"> 
                <span>2021-12-22 01:56:06</span>
            </div>
        </div>
        <div class="post-content">
            <p>ä»ä»Šå¤©å¼€å§‹ï¼Œæˆ‘ä»¬å°†è¿›å…¥ä¸€ä¸ªå…¨æ–°æ¨¡å—ï¼Œå³<strong>ShardingSphere åˆ†å¸ƒå¼äº‹åŠ¡</strong>ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ä¸»é¢˜ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸‰ä¸ªè¯¾æ—¶æ¥å…¨é¢ä»‹ç» ShardingSphere çš„äº‹åŠ¡å®ç°æœºåˆ¶ã€‚</p>
<h3 id="shardingtransactionmanagerengine">ShardingTransactionManagerEngine</h3>
<p>åœ¨ç¬¬ 18 è¯¾æ—¶å’Œç¬¬ 19 è¯¾æ—¶çš„â€œåˆ†å¸ƒå¼äº‹åŠ¡ï¼šå¦‚ä½•ä½¿ç”¨å¼ºä¸€è‡´äº‹åŠ¡ä¸æŸ”æ€§äº‹åŠ¡ï¼Ÿâ€ä¸­ï¼Œæˆ‘ä»¬å·²ç»å¯¹åˆ†å¸ƒå¼äº‹åŠ¡çš„åŸºæœ¬æ¦‚å¿µåšäº†ä»‹ç»ã€‚</p>
<p>åœ¨äº†è§£å®Œä¸€äº›åŸºæœ¬æ¦‚å¿µä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹ ShardingSphere ä¸­åˆ†å¸ƒå¼äº‹åŠ¡æ¨¡å—çš„ä»£ç å·¥ç¨‹ç»„ç»‡ç»“æ„ï¼Œæˆ‘ä»¬å‘ç°å­˜åœ¨ä¸‰ä¸ªåº•å±‚çš„å·¥ç¨‹ï¼Œå³ sharding-transaction-coreã€sharding-transaction-2pc å’Œ sharding-transaction-baseã€‚</p>
<p>ä»å‘½åä¸Šï¼Œæˆ‘ä»¬ä¸éš¾çœ‹å‡º sharding-transaction-core åº”è¯¥åŒ…å«äº†åˆ†å¸ƒå¼äº‹åŠ¡ç›¸å…³çš„ä¸€äº›åŸºç¡€æ ¸å¿ƒç±»ï¼Œè€Œ sharding-transaction-2pc å’Œ sharding-transaction-base åˆ†åˆ«åŸºäºå¼ºä¸€è‡´æ€§å’Œæœ€ç»ˆä¸€è‡´æ€§çš„ä¸¤ç§å®ç°ã€‚</p>
<p>è¿™äº›åŒ…ç»“æ„çš„å‘½åå®é™…ä¸Šå¯ä»¥ä½“ç°åœ¨äº‹åŠ¡ç±»å‹ TransactionType çš„å®šä¹‰ä¸Šï¼Œå®ƒæ˜¯ä¸€ä¸ªæšä¸¾ï¼Œåˆ†åˆ«ä»£è¡¨äº†æœ¬åœ°äº‹åŠ¡ã€XA äºŒé˜¶æ®µæäº¤äº‹åŠ¡å’Œ BASE æŸ”æ€§äº‹åŠ¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>public enum TransactionType {
    LOCAL, XA, BASE
}
</code></pre><p>TransactionType ç±»ä½äº sharding-transaction-core å·¥ç¨‹ä¸­ï¼Œè®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªå·¥ç¨‹ä¸­çš„å…¶ä»–å†…å®¹ï¼Œé¦–å…ˆå…¶å†²çš„å°±æ˜¯ ShardingTransactionManagerEngine æ¥å£ã€‚</p>
<p>åœ¨å‰é¢çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬åœ¨ ShardingRuntimeContext è¿™ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ä¸­ç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ç®¡ç†å™¨çš„å…¥å£ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>public final class ShardingRuntimeContext extends AbstractRuntimeContext&lt;ShardingRule&gt; {
â€¦
    private final ShardingTransactionManagerEngine shardingTransactionManagerEngine;

public ShardingRuntimeContext(final Map&lt;String, DataSource&gt; dataSourceMap, final ShardingRule rule, final Properties props, final DatabaseType databaseType) throws SQLException {
       â€¦
        //åˆ›å»ºåˆ†å¸ƒå¼äº‹åŠ¡ç®¡ç†å™¨å¼•æ“å¹¶åˆå§‹åŒ–
        shardingTransactionManagerEngine = new ShardingTransactionManagerEngine();
        shardingTransactionManagerEngine.init(databaseType, dataSourceMap);
}
â€¦
}
</code></pre><p>åœ¨ ShardingTransactionManagerEngine çš„æ„é€ å‡½æ•°ä¸­ï¼Œè°ƒç”¨äº†å¦‚ä¸‹æ‰€ç¤ºçš„ loadShardingTransactionManager æ–¹æ³•ï¼š</p>
<pre tabindex="0"><code>private final Map&lt;TransactionType, ShardingTransactionManager&gt; transactionManagerMap = new EnumMap&lt;&gt;(TransactionType.class);

    private void loadShardingTransactionManager() {
         //é€šè¿‡ ServiceLoader åŠ è½½ ShardingTransactionManager å®ç°ç±»
        for (ShardingTransactionManager each : ServiceLoader.load(ShardingTransactionManager.class)) {
            if (transactionManagerMap.containsKey(each.getTransactionType())) {
                log.warn(&quot;Find more than one {} transaction manager implementation class, use `{}` now&quot;,
                    each.getTransactionType(), transactionManagerMap.get(each.getTransactionType()).getClass().getName());
                continue;
            }
            transactionManagerMap.put(each.getTransactionType(), each);
        }
}
</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨äº† JDK ä¸­ ServiceLoader å·¥å…·ç±»çš„ load æ–¹æ³•æ¥åŠ è½½ ShardingTransactionManager çš„å®ç°ç±»ï¼Œè¿™æ˜¯ä½¿ç”¨ SPI å®ç°å¾®å†…æ ¸æ¶æ„çš„æœ€ç›´æ¥çš„æ–¹å¼ï¼Œä¸Šè¿°æ–¹æ³•çš„ä½œç”¨å°±æ˜¯åŠ è½½ç±»è·¯å¾„ä¸Šçš„ ShardingTransactionManager å¹¶ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚åœ¨ ShardingSphere ä¸­ï¼ŒShardingTransactionManager æ˜¯å¯¹åˆ†å¸ƒå¼äº‹åŠ¡ç®¡ç†å™¨çš„ä¸€ç§æŠ½è±¡ã€‚æˆ‘ä»¬åœ¨åç»­å†…å®¹ä¸­ä¼šå…·ä½“å±•å¼€ã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬çœ‹åˆ°åœ¨ ShardingRuntimeContext ä¸­ï¼Œå½“æ„å»ºå®Œ ShardingTransactionManagerEngine å¯¹è±¡ä¹‹åï¼Œä¼šè°ƒç”¨å®ƒçš„ init æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>public void init(final DatabaseType databaseType, final Map&lt;String, DataSource&gt; dataSourceMap) {
        for (Entry&lt;TransactionType, ShardingTransactionManager&gt; entry : transactionManagerMap.entrySet()) {
            entry.getValue().init(databaseType, getResourceDataSources(dataSourceMap));
        }
}

private Collection&lt;ResourceDataSource&gt; getResourceDataSources(final Map&lt;String, DataSource&gt; dataSourceMap) {
        List&lt;ResourceDataSource&gt; result = new LinkedList&lt;&gt;();
        for (Map.Entry&lt;String, DataSource&gt; entry : dataSourceMap.entrySet()) {
           //åˆ›å»º ResourceDataSource å¯¹è±¡
            result.add(new ResourceDataSource(entry.getKey(), entry.getValue()));
        }
        return result;
}
</code></pre><p>è¿™éƒ¨åˆ†çš„ä»£ç ç›¸å½“äºæ˜¯æ‰§è¡Œæ‰€è·å– ShardingTransactionManager çš„ init æ–¹æ³•å¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ã€‚åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œè¿˜çœ‹åˆ°äº†ä¸€ä¸ªæ–°çš„æ•°æ®æºå¯¹è±¡ ResourceDataSourceï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>public final class ResourceDataSource {
    private final String originalName;
    private String uniqueResourceName;
    private final DataSource dataSource;

    public ResourceDataSource(final String originalName, final DataSource dataSource) {
        this.originalName = originalName;
        this.dataSource = dataSource;
        this.uniqueResourceName = ResourceIDGenerator.getInstance().nextId() + originalName;
    }
}
</code></pre><p>ResourceDataSource çš„ä½œç”¨å°±æ˜¯ä¿å­˜æ•°æ®åº“åå’Œ DataSource çš„ä¿¡æ¯ï¼Œå¹¶ä¸ºè¿™ä¸ª ResourceDataSource æ„å»ºä¸€ä¸ªå”¯ä¸€çš„èµ„æºåç§°ï¼Œæ„å»ºè¿‡ç¨‹ä½¿ç”¨äº† ResourceIDGenerator å·¥å…·ç±»ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å­¦ä¹ ä¸€ä¸‹å®ƒçš„å®ç°æ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œç”¨åˆ°äº†å•ä¾‹æ¨¡å¼å’ŒåŸå­ç±» AtomicIntegerï¼š</p>
<pre tabindex="0"><code>public final class ResourceIDGenerator {

    private static final ResourceIDGenerator INSTANCE = new ResourceIDGenerator();
private final AtomicInteger count = new AtomicInteger();

//åˆ›å»ºå•ä¾‹
    public static ResourceIDGenerator getInstance() {
        return INSTANCE;
    }

    String nextId() {
        return String.format(&quot;resource-%d-&quot;, count.incrementAndGet());
    }
}
</code></pre><p>è®©æˆ‘ä»¬å†å›åˆ° ShardingTransactionManagerEngineï¼Œæ¥çœ‹å®ƒçš„ getTransactionManager æ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>public ShardingTransactionManager getTransactionManager(final TransactionType transactionType) {
        ShardingTransactionManager result = transactionManagerMap.get(transactionType);
        if (TransactionType.LOCAL != transactionType) {
            Preconditions.checkNotNull(result, &quot;Cannot find transaction manager of [%s]&quot;, transactionType);
        }
        return result;
}
</code></pre><p>è¿™é‡Œåªæ˜¯æ ¹æ®äº‹åŠ¡ç±»å‹è·å–äº†å¯¹åº”çš„ ShardingTransactionManagerã€‚æœ€åï¼ŒShardingTransactionManagerEngine ä¸­è¿˜æœ‰ä¸€ä¸ª close æ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>public void close() throws Exception {
        for (Entry&lt;TransactionType, ShardingTransactionManager&gt; entry : transactionManagerMap.entrySet()) {
            entry.getValue().close();
        }
}
</code></pre><p>é€šè¿‡ä¸Šè¿°åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºï¼ŒShardingTransactionManagerEngine ä½œä¸ºåˆ†å¸ƒå¼äº‹åŠ¡çš„å…¥å£ï¼Œæ›´å¤šçš„èµ·åˆ°å¯¹ ShardingTransactionManager çš„ç®¡ç†å’Œç»´æŠ¤ä½œç”¨ï¼Œç›¸å½“äºæ˜¯ä¸€ä¸ªå®¹å™¨ã€‚</p>
<p>é‚£ä¹ˆ ShardingTransactionManager æ˜¯å¦‚ä½•è¿ä½œçš„å‘¢ï¼Ÿè®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€ä¸‹ã€‚</p>
<h3 id="shardingtransactionmanager">ShardingTransactionManager</h3>
<p>ShardingTransactionManager æ¥å£ä½äº sharding-transaction-core å·¥ç¨‹çš„ org.apache.shardingsphere.transaction.spi åŒ…ä¸­ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>public interface ShardingTransactionManager extends AutoCloseable {

    //æ ¹æ®æ•°æ®åº“ç±»å‹å’Œ ResourceDataSource è¿›è¡Œåˆå§‹åŒ–
    void init(DatabaseType databaseType, Collection&lt;ResourceDataSource&gt; resourceDataSources);

    //è·å– TransactionType
    TransactionType getTransactionType();

    //åˆ¤æ–­æ˜¯å¦åœ¨äº‹åŠ¡ä¸­
    boolean isInTransaction();

    //è·å–æ”¯æŒäº‹åŠ¡çš„ Connection
    Connection getConnection(String dataSourceName) throws SQLException;

    //å¼€å§‹äº‹åŠ¡
    void begin();

    //æäº¤äº‹åŠ¡
    void commit();

    //å›æ»šäº‹åŠ¡
    void rollback();
}
</code></pre><p>æˆ‘ä»¬çœ‹åˆ°ä»è¯¥æ¥å£ä¸­å¯ä»¥æ ¹æ® DataSource åè·å– Connectionã€‚åŒæ—¶ï¼Œå¯¹æ¯”åé¢è¦ä»‹ç»çš„ JTA ä¸­çš„ TransactionManager æ¥å£ï¼Œæˆ‘ä»¬åŒæ ·æ‰¾åˆ°äº†ä½œä¸ºä¸€ä¸ªäº‹åŠ¡ç®¡ç†å™¨è€Œè¨€æ‰€å¿…éœ€çš„ beginã€commit å’Œ rollback è¿™ä¸‰ä¸ªåŸºæœ¬æ“ä½œã€‚ShardingSphere è¿˜ä¸ºè¿™äº›åŸºæœ¬æ“ä½œä¸“é—¨æä¾›äº†ä¸€ä¸ªæšä¸¾ TransactionOperationTypeã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡æŸ¥çœ‹ ShardingSphere ä¸­ ShardingTransactionManager çš„ç±»å±‚ç»“æ„ï¼Œå‘ç°å­˜åœ¨ä¸¤ä¸ªå®ç°ç±»ï¼Œå³ XAShardingTransactionManager å’Œ SeataATShardingTransactionManager ç±»ã€‚</p>
<h4 id="1xashardingtransactionmanager">1.XAShardingTransactionManager</h4>
<p>è¦ç†è§£åŸºäº XA åè®®çš„ ShardingTransactionManagerï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦å…·å¤‡ä¸€å®šçš„ç†è®ºçŸ¥è¯†ã€‚XA æ˜¯ç”± X/Open ç»„ç»‡æå‡ºçš„ä¸¤é˜¶æ®µæäº¤åè®®ï¼Œæ˜¯ä¸€ç§åˆ†å¸ƒå¼äº‹åŠ¡çš„è§„èŒƒï¼ŒXA è§„èŒƒä¸»è¦å®šä¹‰äº†é¢å‘å…¨å±€çš„äº‹åŠ¡ç®¡ç†å™¨ TransactionManagerï¼ˆTMï¼‰å’Œé¢å‘å±€éƒ¨çš„èµ„æºç®¡ç†å™¨ ResourceManagerï¼ˆRMï¼‰ä¹‹é—´çš„æ¥å£ã€‚</p>
<p>XA æ¥å£æ˜¯åŒå‘çš„ç³»ç»Ÿæ¥å£ï¼Œåœ¨ TransactionManagerï¼Œä»¥åŠä¸€ä¸ªæˆ–å¤šä¸ª ResourceManager ä¹‹é—´å½¢æˆé€šä¿¡æ¡¥æ¢ã€‚é€šè¿‡è¿™æ ·çš„è®¾è®¡ï¼ŒTransactionManager æ§åˆ¶ç€å…¨å±€äº‹åŠ¡ï¼Œç®¡ç†äº‹åŠ¡ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶åè°ƒèµ„æºï¼Œè€Œ ResourceManager è´Ÿè´£æ§åˆ¶å’Œç®¡ç†åŒ…æ‹¬æ•°æ®åº“ç›¸å…³çš„å„ç§å®é™…èµ„æºã€‚</p>
<p>XA çš„æ•´ä½“ç»“æ„ä»¥åŠ TransactionManager å’Œ ResourceManager ä¹‹é—´çš„äº¤äº’è¿‡ç¨‹å‚è€ƒä¸‹å›¾ï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/ShardingSphere%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2-%E5%AE%8C/assets/Ciqc1F9fO8mADc8eAAClhM8LyC0111.png" alt="Drawing 0.png"></p>
<p>XA åè®®ç»„æˆç»“æ„å›¾</p>
<p>æ‰€æœ‰å…³äºåˆ†å¸ƒå¼äº‹åŠ¡çš„ä»‹ç»ä¸­éƒ½å¿…ç„¶ä¼šè®²åˆ°ä¸¤é˜¶æ®µæäº¤ï¼Œå› ä¸ºå®ƒæ˜¯å®ç° XA åˆ†å¸ƒå¼äº‹åŠ¡çš„å…³é”®ã€‚æˆ‘ä»¬çŸ¥é“åœ¨ä¸¤é˜¶æ®µæäº¤è¿‡ç¨‹ä¸­ï¼Œå­˜åœ¨åè°ƒè€…å’Œå‚ä¸è€…ä¸¤ç§è§’è‰²ã€‚åœ¨ä¸Šå›¾ä¸­ï¼ŒXA å¼•å…¥çš„ TransactionManager å……å½“ç€å…¨å±€äº‹åŠ¡ä¸­çš„â€œåè°ƒè€…â€è§’è‰²ï¼Œè€Œå›¾ä¸­çš„ ResourceManager ç›¸å½“äºâ€œå‚ä¸è€…â€è§’è‰²ï¼Œå¯¹è‡ªèº«å†…éƒ¨çš„èµ„æºè¿›è¡Œç»Ÿä¸€ç®¡ç†ã€‚</p>
<p>ç†è§£äº†è¿™äº›æ¦‚å¿µä¹‹åï¼Œæˆ‘ä»¬å†æ¥çœ‹ Java ä¸­çš„å®ç°ã€‚ä½œä¸º Java å¹³å°ä¸­çš„äº‹åŠ¡è§„èŒƒï¼ŒJTAï¼ˆJava Transaction APIï¼‰ä¹Ÿå®šä¹‰äº†å¯¹ XA äº‹åŠ¡çš„æ”¯æŒã€‚å®é™…ä¸Šï¼ŒJTA æ˜¯åŸºäº XA æ¶æ„è¿›è¡Œå»ºæ¨¡çš„ï¼Œåœ¨ JTA ä¸­ï¼Œäº‹åŠ¡ç®¡ç†å™¨æŠ½è±¡ä¸º javax.transaction.TransactionManager æ¥å£ï¼Œå¹¶é€šè¿‡åº•å±‚äº‹åŠ¡æœåŠ¡è¿›è¡Œå®ç°ã€‚</p>
<p>å’Œå¾ˆå¤šå…¶ä»–çš„ Java è§„èŒƒä¸€æ ·ï¼ŒJTA ä»…ä»…å®šä¹‰äº†æ¥å£ï¼Œå…·ä½“çš„å®ç°åˆ™æ˜¯ç”±ä¾›åº”å•†è´Ÿè´£æä¾›ã€‚ç›®å‰JTA çš„å®ç°åˆ†æˆä¸¤å¤§ç±»ï¼Œå…¶ä¸­ä¸€ç±»æ˜¯ç›´æ¥é›†æˆåœ¨åº”ç”¨æœåŠ¡å™¨ä¸­ï¼Œä¾‹å¦‚ JBossï¼›å¦ä¸€ç±»åˆ™æ˜¯ç‹¬ç«‹çš„å®ç°ï¼Œä¾‹å¦‚ ShardingSphere ä¸­æ‰€é‡‡ç”¨çš„ Atomikos å’Œ Bitronixï¼Œè¿™äº›å®ç°å¯ä»¥åº”ç”¨åœ¨é‚£äº›ä¸ä½¿ç”¨ J2EE åº”ç”¨æœåŠ¡å™¨çš„ç¯å¢ƒé‡Œï¼ˆä¾‹å¦‚æ™®é€šçš„ Java åº”ç”¨ï¼‰ç”¨ä»¥æä¾›åˆ†å¸ƒå¼äº‹åŠ¡ä¿è¯ã€‚å¦ä¸€æ–¹é¢ï¼ŒJTA æ¥å£é‡Œçš„ ResourceManager åŒæ ·éœ€è¦æ•°æ®åº“å‚å•†æä¾› XA çš„é©±åŠ¨å®ç°ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å¯¹ JTA ä¸­çš„ç›¸å…³æ ¸å¿ƒç±»åšè¿›ä¸€æ­¥åˆ†æï¼Œè¿™äº›å†…å®¹æ˜¯åç»­ç†è§£ ShardingSphere ä¸­åˆ†å¸ƒå¼äº‹åŠ¡å®ç°æœºåˆ¶çš„åŸºç¡€ã€‚</p>
<p>åœ¨ JTA ä¸­ï¼Œæä¾›äº†ä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒæ¥å£ï¼š</p>
<ul>
<li><strong>UserTransaction</strong></li>
</ul>
<p>è¯¥æ¥å£æ˜¯é¢å‘å¼€å‘äººå‘˜çš„æ¥å£ï¼Œèƒ½å¤Ÿç¼–ç¨‹æ§åˆ¶äº‹åŠ¡å¤„ç†ã€‚</p>
<ul>
<li><strong>TransactionManager</strong></li>
</ul>
<p>é€šè¿‡è¯¥æ¥å£å…è®¸åº”ç”¨ç¨‹åºæœåŠ¡å™¨æ¥æ§åˆ¶åˆ†å¸ƒå¼äº‹åŠ¡ã€‚</p>
<ul>
<li><strong>Transaction</strong></li>
</ul>
<p>ä»£è¡¨æ­£åœ¨ç®¡ç†åº”ç”¨ç¨‹åºçš„äº‹åŠ¡ã€‚</p>
<ul>
<li><strong>XAResource</strong></li>
</ul>
<p>è¿™æ˜¯ä¸€ä¸ªé¢å‘æä¾›å•†çš„å®ç°æ¥å£ï¼Œæ˜¯ä¸€ä¸ªåŸºäº XA åè®®çš„ Java æ˜ å°„ï¼Œå„ä¸ªæ•°æ®åº“æä¾›å•†åœ¨æä¾›è®¿é—®è‡ªå·±èµ„æºçš„é©±åŠ¨æ—¶ï¼Œå¿…é¡»å®ç°è¿™æ ·çš„æ¥å£ã€‚</p>
<p>å¦å¤–ï¼Œåœ¨ javax.sql åŒ…ä¸­è¿˜å­˜åœ¨å‡ ä¸ªä¸ XA ç›¸å…³çš„æ ¸å¿ƒç±»ï¼Œå³ä»£è¡¨è¿æ¥çš„ XAConnectionã€ä»£è¡¨æ•°æ®æºçš„ XADataSourceï¼Œä»¥åŠä»£è¡¨äº‹åŠ¡ç¼–å·çš„ Xidã€‚</p>
<p>æˆ‘ä»¬é‡‡ç”¨ä¸Šè¿°æ ¸å¿ƒç±»æ¥ç®€å•æ¨¡æ‹Ÿä¸€ä¸‹åŸºäº XA çš„åˆ†å¸ƒå¼äº‹åŠ¡çš„å¸¸è§å®ç°è¿‡ç¨‹çš„ä¼ªä»£ç ã€‚å¯¹äºä¸€ä¸ªè·¨åº“æ“ä½œè€Œè¨€ï¼Œä¸€èˆ¬æˆ‘ä»¬å¯ä»¥åŸºäº UserTransaction æ¥å£å®ç°å¦‚ä¸‹çš„æ“ä½œæµç¨‹ï¼š</p>
<pre tabindex="0"><code>UserTransaction userTransaction = null; 
Connection connA = null; 
Connection connB = null; 
try{
    userTransaction.begin(); 
    //å®ç°è·¨åº“æ“ä½œ
     connA.execute(&quot;sql1&quot;)
     connB.execute(&quot;sql2&quot;) 
    userTransaction.commit();
}catch(){
    userTransaction.rollback();
}
</code></pre><p>è¦æƒ³ä¸Šè¿°ä»£ç å‘æŒ¥ä½œç”¨ï¼Œè¿™é‡Œçš„è¿æ¥å¯¹è±¡ Connection å°±å¾—æ”¯æŒ XAResource æ¥å£ï¼Œä¹Ÿå°±æ¶‰åŠä¸€ç³»åˆ—å…³äº XADataSource å’Œ XAConnection çš„å¤„ç†è¿‡ç¨‹ã€‚</p>
<p>è®©æˆ‘ä»¬å›åˆ° ShardingSphereï¼Œæ¥çœ‹ XAShardingTransactionManager ç±»ï¼Œè¯¥ç±»æ˜¯åˆ†å¸ƒå¼äº‹åŠ¡çš„ XA å®ç°ç±»ï¼Œå®ƒä¸»è¦è´Ÿè´£å¯¹å®é™…çš„ DataSource è¿›è¡Œç®¡ç†å’Œé€‚é…ï¼Œå¹¶ä¸”å°†æ¥å…¥ç«¯äº‹åŠ¡çš„ begin/commit/rollback æ“ä½œå§”æ‰˜ç»™å…·ä½“çš„ XA äº‹åŠ¡ç®¡ç†å™¨ï¼Œä¾‹å¦‚ XAShardingTransactionManager å°±ä¼šä½¿ç”¨ XATransactionManager ä¸­çš„ TransactionManager å®Œæˆ commit æ“ä½œï¼š</p>
<pre tabindex="0"><code>@Override
public void commit() {
    xaTransactionManager.getTransactionManager().commit();
}
</code></pre><p>è¿™é‡Œçš„ XATransactionManager å°±æ˜¯å¯¹å„ç§ç¬¬ä¸‰æ–¹ XA äº‹åŠ¡ç®¡ç†å™¨çš„ä¸€ç§æŠ½è±¡ï¼Œå°è£…äº†å¯¹</p>
<p>Atomikosã€Bitronix ç­‰ç¬¬ä¸‰æ–¹å·¥å…·çš„å®ç°æ–¹å¼ã€‚æˆ‘ä»¬ä¼šåœ¨ä¸‹ä¸€è¯¾æ—¶ä¸­å¯¹è¿™ä¸ª XATransactionManager ä»¥åŠ XAShardingTransactionManager è¿›è¡Œå…·ä½“å±•å¼€ã€‚</p>
<p>ä½œä¸ºæ€»ç»“ï¼Œæˆ‘ä»¬æ¢³ç†åœ¨ ShardingSphere ä¸­ä¸ XA ä¸¤é˜¶æ®µæäº¤ç›¸å…³çš„æ ¸å¿ƒç±»ä¹‹é—´çš„å…³ç³»ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/ShardingSphere%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2-%E5%AE%8C/assets/Ciqc1F9fO-GALidCAABl39blOv8975.png" alt="Drawing 2.png"></p>
<h4 id="2seataatshardingtransactionmanager">2.SeataATShardingTransactionManager</h4>
<p>ä»‹ç»å®Œ XAShardingTransactionManager ä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸Šå›¾ä¸­ ShardingTransactionManager æ¥å£çš„å¦ä¸€ä¸ªå®ç°ç±» SeataATShardingTransactionManagerã€‚å› ä¸ºåŸºäºä¸åŒæŠ€æœ¯ä½“ç³»å’Œå·¥ä½œåŸç†ï¼Œæ‰€ä»¥ SeataATShardingTransactionManager ä¸­çš„å®ç°æ–¹æ³•ä¹Ÿå®Œå…¨ä¸åŒï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ã€‚</p>
<p>åœ¨ä»‹ç» SeataATShardingTransactionManager ä¹‹å‰ï¼Œæˆ‘ä»¬åŒæ ·æœ‰å¿…è¦å¯¹ Seata æœ¬èº«åšä¸€äº›å±•å¼€ã€‚ä¸ XA ä¸åŒï¼Œ<strong>Seata æ¡†æ¶</strong>ä¸­ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡åŒ…å«ä¸‰ç§è§’è‰²ï¼Œé™¤äº† XA ä¸­åŒæ ·å…·å¤‡çš„ TransactionManagerï¼ˆTMï¼‰å’Œ ResourceManagerï¼ˆRMï¼‰ ä¹‹å¤–ï¼Œè¿˜å­˜åœ¨ä¸€ä¸ªäº‹åŠ¡åè°ƒå™¨ TransactionCoordinator (TC)ï¼Œç»´æŠ¤å…¨å±€äº‹åŠ¡çš„è¿è¡ŒçŠ¶æ€ï¼Œè´Ÿè´£åè°ƒå¹¶é©±åŠ¨å…¨å±€äº‹åŠ¡çš„æäº¤æˆ–å›æ»šã€‚</p>
<p>å…¶ä¸­ï¼ŒTM æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡çš„å‘èµ·è€…å’Œç»ˆç»“è€…ï¼ŒTC è´Ÿè´£ç»´æŠ¤åˆ†å¸ƒå¼äº‹åŠ¡çš„è¿è¡ŒçŠ¶æ€ï¼Œè€Œ RM åˆ™è´Ÿè´£æœ¬åœ°äº‹åŠ¡çš„è¿è¡Œã€‚</p>
<p>Seata çš„æ•´ä½“æ¶æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/ShardingSphere%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2-%E5%AE%8C/assets/Ciqc1F9fO-uAZyMCAAEoW9aLAuQ436.png" alt="Drawing 4.png"></p>
<p>Seata åˆ†å¸ƒå¼äº‹åŠ¡ç»„æˆç»“æ„å›¾ï¼ˆæ¥è‡ª Seata å®˜ç½‘ï¼‰</p>
<p>åŸºäºSeata æ¡†æ¶ï¼Œä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡çš„æ‰§è¡Œæµç¨‹åŒ…å«å¦‚ä¸‹äº”ä¸ªæ­¥éª¤ï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/ShardingSphere%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2-%E5%AE%8C/assets/Ciqc1F9fO_WAHRyqAACL8p3Fa_E119.png" alt="Drawing 5.png"></p>
<p>æˆ‘ä»¬åŒæ ·ä¼šåœ¨ä¸‹ä¸€è¯¾æ—¶ä¸­å¯¹è¿™äº›æ­¥éª¤ï¼Œä»¥åŠå…¶ä¸­æ¶‰åŠçš„æ ¸å¿ƒç±»è¿›è¡Œå…·ä½“å±•å¼€ã€‚</p>
<h3 id="ä»æºç è§£æåˆ°æ—¥å¸¸å¼€å‘">ä»æºç è§£æåˆ°æ—¥å¸¸å¼€å‘</h3>
<p>ä»Šå¤©çš„å†…å®¹æˆ‘ä»¬ä¸»è¦å…³æ³¨äº ShardingSphere ä¸­å¯¹åˆ†å¸ƒå¼äº‹åŠ¡çš„æŠ½è±¡è¿‡ç¨‹ï¼Œæœ¬èº«æ²¡æœ‰æ¶‰åŠè¿‡å¤šçš„æºç åˆ†æã€‚æˆ‘ä»¬å­¦ä¹ çš„å…³æ³¨ç‚¹åœ¨äºæŒæ¡ XA åè®®çš„ç‰¹ç‚¹å’Œæ ¸å¿ƒç±»ï¼Œä»¥åŠåŸºäº Seata æ¡†æ¶å®Œæˆä¸€æ¬¡åˆ†å¸ƒå¼äº‹åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ã€‚</p>
<h3 id="å°ç»“ä¸é¢„å‘Š">å°ç»“ä¸é¢„å‘Š</h3>
<p>è¿™æ˜¯ä»‹ç» ShardingSphere åˆ†å¸ƒå¼äº‹åŠ¡å®ç°åŸç†çš„ç¬¬ä¸€ä¸ªè¯¾æ—¶ï¼Œæˆ‘ä»¬é‡ç‚¹è®²è§£äº† ShardingSphere æ˜¯å¦‚ä½•åŸºäºåŒä¸€å¥—ä½“ç³»æ¥å®Œæˆå¯¹ XA å’Œ Seata è¿™ä¸¤ç§ä¸åŒåˆ†å¸ƒå¼äº‹åŠ¡å®ç°æ–¹å¼çš„ç»Ÿä¸€æŠ½è±¡å’Œå°è£…ã€‚</p>
<p>è¿™é‡Œç»™ä½ ç•™ä¸€é“æ€è€ƒé¢˜ï¼šShardingSphere å¯¹ä¸åŒçš„åˆ†å¸ƒå¼äº‹åŠ¡å®ç°æŠ€æœ¯åšäº†å“ªäº›æŠ½è±¡ï¼Ÿæ¬¢è¿ä½ åœ¨ç•™è¨€åŒºä¸å¤§å®¶è®¨è®ºï¼Œæˆ‘å°†é€ä¸€ç‚¹è¯„è§£ç­”ã€‚</p>
<p>åœ¨æ¥ä¸‹æ¥çš„ä¸¤ä¸ªè¯¾æ—¶ä¸­ï¼Œæˆ‘ä»¬å°±å°†åŸºäºä»Šå¤©è®²åˆ°çš„å¾ˆå¤šæ¦‚å¿µå’Œæ­¥éª¤ï¼Œä»æºç è§’åº¦å‡ºå‘æ·±å…¥å‰–æåˆ†å¸ƒå¼äº‹åŠ¡çš„å®ç°åŸç†å’Œè¿‡ç¨‹ã€‚</p>

        </div>
    </article>
</div>
<div class="division-line"></div>
<div class="others">
    <div>æ ‡ç­¾ï¼šğŸ·ï¸<a class="post-tag" href="/tags/sharding/">sharding</a>&nbsp;</div>
    <div>åˆ†ç±»ï¼š ğŸ“’<a class="post-category" href="/categories/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/">ShardingSphereæ ¸å¿ƒåŸç†ç²¾è®²</a>&nbsp; </div>
</div>

    </main>
    <footer>
        <div id="pagination">
            
<div class="paginator">
    <div class="prev">
        
        <a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/26-%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E6%99%AE%E9%80%9A%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%92%8C%E5%88%86%E7%89%87%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%88%86%E5%88%AB%E6%98%AF%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%9A%84/"><span>26 è¯»å†™åˆ†ç¦»ï¼šæ™®é€šä¸»ä»æ¶æ„å’Œåˆ†ç‰‡ä¸»ä»æ¶æ„åˆ†åˆ«æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</span></a>
    </div>
    <div class="next">
        
        <a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/28-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1shardingsphere-%E4%B8%AD%E5%A6%82%E4%BD%95%E9%9B%86%E6%88%90%E5%BC%BA%E4%B8%80%E8%87%B4%E6%80%A7%E4%BA%8B%E5%8A%A1%E5%92%8C%E6%9F%94%E6%80%A7%E4%BA%8B%E5%8A%A1%E6%94%AF%E6%8C%81%E4%B8%8A/"><span>28 åˆ†å¸ƒå¼äº‹åŠ¡ï¼šShardingSphere ä¸­å¦‚ä½•é›†æˆå¼ºä¸€è‡´æ€§äº‹åŠ¡å’ŒæŸ”æ€§äº‹åŠ¡æ”¯æŒï¼Ÿï¼ˆä¸Šï¼‰</span></a>
    </div>
</div>

        </div>
        <div id="float">
            <ul class="float-button-bar">
    <li>
        <button class="float-button top" onclick="scrollToTop(this);">UP</button>
    </li>
    <li>
        <button class="float-button toggler" onclick="changeSkin(this);">DARK</button>
    </li>
</ul>
        </div>
        <div id="copyright" style="display: none;">
    
    
    <p>&copy; 2020 <a href="/"></a>, powered by Hugo and Qiao</p>
</div>
    </footer>
    
<script>
    const changeSkin = () => {
        document.getElementById('page').classList.toggle('night');
    }
    const scrollToTop = () => {
        window.scrollTo(0, 0);
    }
</script>
</body>

</html>