<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
<meta name="X-UA-Compatible" , content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1.0">

<link rel="icon" type="image/png" href="/%20/favicon.png">

<title>13 å¾®å†…æ ¸æ¶æ„ï¼šShardingSphere å¦‚ä½•å®ç°ç³»ç»Ÿçš„æ‰©å±•æ€§ï¼Ÿ | Yipsen Ye</title>
<meta name="description" content="æˆ‘ä»¬å·²ç»åœ¨è¯¾ç¨‹ä¸­å¤šæ¬¡æåˆ° ShardingSphere ä½¿ç”¨äº†å¾®å†…æ ¸æ¶æ„æ¥å®ç°æ¡†æ¶çš„æ‰©å±•æ€§ã€‚éšç€è¯¾ç¨‹çš„æ¼”è¿›ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œç”¨äºå®ç°é…ç½®ä¸­å¿ƒçš„ ConfigCenterã€ç”¨äºæ•°æ®è„±æ•çš„ ShardingEncryptor ä»¥åŠç”¨äºæ•°æ®åº“æ²»ç†çš„æ³¨å†Œä¸­å¿ƒæ¥å£ RegistryCenter ç­‰å¤§é‡ç»„ä»¶çš„å®ç°ä¹Ÿéƒ½ä½¿ç”¨äº†å¾®å†…æ ¸æ¶æ„ã€‚é‚£ä¹ˆï¼Œç©¶ç«Ÿä»€ä¹ˆæ˜¯å¾®å†…æ ¸æ¶æ„å‘¢ï¼Ÿä»Šå¤©æˆ‘ä»¬å°±æ¥è®¨è®ºè¿™ä¸ªæ¶æ„æ¨¡å¼çš„åŸºæœ¬åŸç†ä»¥åŠåœ¨ ShardingSphere ä¸­çš„åº”ç”¨ã€‚
ä»€ä¹ˆæ˜¯å¾®å†…æ ¸æ¶æ„ï¼Ÿ å¾®å†…æ ¸æ˜¯ä¸€ç§å…¸å‹çš„æ¶æ„æ¨¡å¼ ï¼ŒåŒºåˆ«äºæ™®é€šçš„è®¾è®¡æ¨¡å¼ï¼Œæ¶æ„æ¨¡å¼æ˜¯ä¸€ç§é«˜å±‚æ¨¡å¼ï¼Œç”¨äºæè¿°ç³»ç»Ÿçº§çš„ç»“æ„ç»„æˆã€ç›¸äº’å…³ç³»åŠç›¸å…³çº¦æŸã€‚å¾®å†…æ ¸æ¶æ„åœ¨å¼€æºæ¡†æ¶ä¸­çš„åº”ç”¨ä¹Ÿæ¯”è¾ƒå¹¿æ³›ï¼Œé™¤äº† ShardingSphere ä¹‹å¤–ï¼Œåœ¨ä¸»æµçš„ PRC æ¡†æ¶ Dubbo ä¸­ä¹Ÿå®ç°äº†è‡ªå·±çš„å¾®å†…æ ¸æ¶æ„ã€‚é‚£ä¹ˆï¼Œåœ¨ä»‹ç»ä»€ä¹ˆæ˜¯å¾®å†…æ ¸æ¶æ„ä¹‹å‰ï¼Œæˆ‘ä»¬æœ‰å¿…è¦å…ˆé˜è¿°è¿™äº›å¼€æºæ¡†æ¶ä¼šä½¿ç”¨å¾®å†…æ ¸æ¶æ„çš„åŸå› ã€‚
ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¾®å†…æ ¸æ¶æ„ï¼Ÿ å¾®å†…æ ¸æ¶æ„æœ¬è´¨ä¸Šæ˜¯ä¸ºäº†æé«˜ç³»ç»Ÿçš„æ‰©å±•æ€§ ã€‚æ‰€è°“æ‰©å±•æ€§ï¼Œæ˜¯æŒ‡ç³»ç»Ÿåœ¨ç»å†ä¸å¯é¿å…çš„å˜æ›´æ—¶æ‰€å…·æœ‰çš„çµæ´»æ€§ï¼Œä»¥åŠé’ˆå¯¹æä¾›è¿™æ ·çš„çµæ´»æ€§æ‰€éœ€è¦ä»˜å‡ºçš„æˆæœ¬é—´çš„å¹³è¡¡èƒ½åŠ›ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“åœ¨å¾€ç³»ç»Ÿä¸­æ·»åŠ æ–°ä¸šåŠ¡æ—¶ï¼Œä¸éœ€è¦æ”¹å˜åŸæœ‰çš„å„ä¸ªç»„ä»¶ï¼Œåªéœ€æŠŠæ–°ä¸šåŠ¡å°é—­åœ¨ä¸€ä¸ªæ–°çš„ç»„ä»¶ä¸­å°±èƒ½å®Œæˆæ•´ä½“ä¸šåŠ¡çš„å‡çº§ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™æ ·çš„ç³»ç»Ÿå…·æœ‰è¾ƒå¥½çš„å¯æ‰©å±•æ€§ã€‚
å°±æ¶æ„è®¾è®¡è€Œè¨€ï¼Œæ‰©å±•æ€§æ˜¯è½¯ä»¶è®¾è®¡çš„æ°¸æ’è¯é¢˜ã€‚è€Œè¦å®ç°ç³»ç»Ÿæ‰©å±•æ€§ï¼Œä¸€ç§æ€è·¯æ˜¯æä¾›å¯æ’æ‹”å¼çš„æœºåˆ¶æ¥åº”å¯¹æ‰€å‘ç”Ÿçš„å˜åŒ–ã€‚å½“ç³»ç»Ÿä¸­ç°æœ‰çš„æŸä¸ªç»„ä»¶ä¸æ»¡è¶³è¦æ±‚æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªæ–°çš„ç»„ä»¶æ¥æ›¿æ¢å®ƒï¼Œè€Œæ•´ä¸ªè¿‡ç¨‹å¯¹äºç³»ç»Ÿçš„è¿è¡Œè€Œè¨€åº”è¯¥æ˜¯æ— æ„ŸçŸ¥çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦éšæ—¶å®Œæˆè¿™ç§æ–°æ—§ç»„ä»¶çš„æ›¿æ¢ã€‚
æ¯”å¦‚åœ¨ä¸‹ä¸ªè¯¾æ—¶ä¸­æˆ‘ä»¬å°†è¦ä»‹ç»çš„ ShardingSphere ä¸­æä¾›çš„åˆ†å¸ƒå¼ä¸»é”®åŠŸèƒ½ï¼Œåˆ†å¸ƒå¼ä¸»é”®çš„å®ç°å¯èƒ½æœ‰å¾ˆå¤šç§ï¼Œè€Œæ‰©å±•æ€§åœ¨è¿™ä¸ªç‚¹ä¸Šçš„ä½“ç°å°±æ˜¯ï¼Œ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»æ„ä¸€ç§æ–°çš„åˆ†å¸ƒå¼ä¸»é”®å®ç°æ¥æ›¿æ¢åŸæœ‰çš„å®ç°ï¼Œè€Œä¸éœ€è¦ä¾èµ–åˆ†å¸ƒå¼ä¸»é”®çš„ä¸šåŠ¡ä»£ç åšä»»ä½•çš„æ”¹å˜ ã€‚
å¾®å†…æ ¸æ¶æ„æ¨¡å¼ä¸ºè¿™ç§å®ç°æ‰©å±•æ€§çš„æ€è·¯æä¾›äº†æ¶æ„è®¾è®¡ä¸Šçš„æ”¯æŒï¼ŒShardingSphere åŸºäºå¾®å†…æ ¸æ¶æ„å®ç°äº†é«˜åº¦çš„æ‰©å±•æ€§ã€‚åœ¨ä»‹ç»å¦‚ä½•å®ç°å¾®å†…æ ¸æ¶æ„ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå¯¹å¾®å†…æ ¸æ¶æ„çš„å…·ä½“ç»„æˆç»“æ„å’ŒåŸºæœ¬åŸç†åšç®€è¦çš„é˜è¿°ã€‚
ä»€ä¹ˆæ˜¯å¾®å†…æ ¸æ¶æ„ï¼Ÿ ä»ç»„æˆç»“æ„ä¸Šè®²ï¼Œ å¾®å†…æ ¸æ¶æ„åŒ…å«ä¸¤éƒ¨åˆ†ç»„ä»¶ï¼šå†…æ ¸ç³»ç»Ÿå’Œæ’ä»¶ ã€‚è¿™é‡Œçš„å†…æ ¸ç³»ç»Ÿé€šå¸¸æä¾›ç³»ç»Ÿè¿è¡Œæ‰€éœ€çš„æœ€å°åŠŸèƒ½é›†ï¼Œè€Œæ’ä»¶æ˜¯ç‹¬ç«‹çš„ç»„ä»¶ï¼ŒåŒ…å«è‡ªå®šä¹‰çš„å„ç§ä¸šåŠ¡ä»£ç ï¼Œç”¨æ¥å‘å†…æ ¸ç³»ç»Ÿå¢å¼ºæˆ–æ‰©å±•é¢å¤–çš„ä¸šåŠ¡èƒ½åŠ›ã€‚åœ¨ ShardingSphere ä¸­ï¼Œå‰é¢æåˆ°çš„åˆ†å¸ƒå¼ä¸»é”®å°±æ˜¯æ’ä»¶ï¼Œè€Œ ShardingSphere çš„è¿è¡Œæ—¶ç¯å¢ƒæ„æˆäº†å†…æ ¸ç³»ç»Ÿã€‚
é‚£ä¹ˆè¿™é‡Œçš„æ’ä»¶å…·ä½“æŒ‡çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¿™å°±éœ€è¦æˆ‘ä»¬æ˜ç¡®ä¸¤ä¸ªæ¦‚å¿µï¼Œä¸€ä¸ªæ¦‚å¿µå°±æ˜¯ç»å¸¸åœ¨è¯´çš„ API ï¼Œè¿™æ˜¯ç³»ç»Ÿå¯¹å¤–æš´éœ²çš„æ¥å£ã€‚è€Œå¦ä¸€ä¸ªæ¦‚å¿µå°±æ˜¯ SPIï¼ˆService Provider Interfaceï¼ŒæœåŠ¡æä¾›æ¥å£ï¼‰ï¼Œè¿™æ˜¯æ’ä»¶è‡ªèº«æ‰€å…·å¤‡çš„æ‰©å±•ç‚¹ã€‚å°±ä¸¤è€…çš„å…³ç³»è€Œè¨€ï¼ŒAPI é¢å‘ä¸šåŠ¡å¼€å‘äººå‘˜ï¼Œè€Œ SPI é¢å‘æ¡†æ¶å¼€å‘äººå‘˜ï¼Œä¸¤è€…å…±åŒæ„æˆäº† ShardingSphere æœ¬èº«ã€‚
å¯æ’æ‹”å¼çš„å®ç°æœºåˆ¶è¯´èµ·æ¥ç®€å•ï¼Œåšèµ·æ¥å´ä¸å®¹æ˜“ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸¤æ–¹é¢å†…å®¹ã€‚ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬éœ€è¦æ¢³ç†ç³»ç»Ÿçš„å˜åŒ–å¹¶æŠŠå®ƒä»¬æŠ½è±¡æˆå¤šä¸ª SPI æ‰©å±•ç‚¹ã€‚å¦ä¸€æ–¹é¢ï¼Œ å½“æˆ‘ä»¬å®ç°äº†è¿™äº› SPI æ‰©å±•ç‚¹ä¹‹åï¼Œå°±éœ€è¦æ„å»ºä¸€ä¸ªèƒ½å¤Ÿæ”¯æŒè¿™ç§å¯æ’æ‹”æœºåˆ¶çš„å…·ä½“å®ç°ï¼Œä»è€Œæä¾›ä¸€ç§ SPI è¿è¡Œæ—¶ç¯å¢ƒ ã€‚
é‚£ä¹ˆï¼ŒShardingSphere æ˜¯å¦‚ä½•å®ç°å¾®å†…æ ¸æ¶æ„çš„å‘¢ï¼Ÿè®©æˆ‘ä»¬æ¥ä¸€èµ·çœ‹ä¸€ä¸‹ã€‚
å¦‚ä½•å®ç°å¾®å†…æ ¸æ¶æ„ï¼Ÿ äº‹å®ä¸Šï¼ŒJDK å·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§å¾®å†…æ ¸æ¶æ„çš„å®ç°æ–¹å¼ï¼Œè¿™ç§å®ç°æ–¹å¼é’ˆå¯¹å¦‚ä½•è®¾è®¡å’Œå®ç° SPI æå‡ºäº†ä¸€äº›å¼€å‘å’Œé…ç½®ä¸Šçš„è§„èŒƒï¼ŒShardingSphere ä½¿ç”¨çš„å°±æ˜¯è¿™ç§è§„èŒƒã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è®¾è®¡ä¸€ä¸ªæœåŠ¡æ¥å£ï¼Œå¹¶æ ¹æ®éœ€è¦æä¾›ä¸åŒçš„å®ç°ç±»ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ¨¡æ‹Ÿå®ç°åˆ†å¸ƒå¼ä¸»é”®çš„åº”ç”¨åœºæ™¯ã€‚
åŸºäº SPI çš„çº¦å®šï¼Œåˆ›å»ºä¸€ä¸ªå•ç‹¬çš„å·¥ç¨‹æ¥å­˜æ”¾æœåŠ¡æ¥å£ï¼Œå¹¶ç»™å‡ºæ¥å£å®šä¹‰ã€‚è¯·æ³¨æ„ è¿™ä¸ªæœåŠ¡æ¥å£çš„å®Œæ•´ç±»è·¯å¾„ä¸º com.">
<meta name="author" content="">

<link rel="stylesheet" type="text/css" href="/styles/main.css">

</head>

<body id="page">
    <header>
        <div class="logo-link" style="width: 60px; color: #CA6924;">
    <a href="http://yipsen.github.io/">
        <img style="margin-bottom: -1rem;" src="/images/deer.svg" alt="logo">
        <span style="font-size: 0.5rem; color: #CA6924;">Yipsen Ye</span>
    </a>
</div>
<nav class="navbar justify-content-end">
    <ul class="nav-list">
        
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/posts/">æœ­è®°</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/collections/">é™„è¡¨</a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link"
                href="http://yipsen.github.io/about/">å…³äº</a>
        </li>
        
    </ul>
</nav>
    </header>
    <main id="content">
        
<div class="container"><aside>
    <div>
        
        
            
            
            <div class="post-category-icon"></div>
            <a href="/categories/shardingsphere%e6%a0%b8%e5%bf%83%e5%8e%9f%e7%90%86%e7%b2%be%e8%ae%b2/">ShardingSphereæ ¸å¿ƒåŸç†ç²¾è®²</a>
            <ul>
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/00-%E5%A6%82%E4%BD%95%E6%AD%A3%E7%A1%AE%E5%AD%A6%E4%B9%A0%E4%B8%80%E6%AC%BE%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">00 å¦‚ä½•æ­£ç¡®å­¦ä¹ ä¸€æ¬¾åˆ†åº“åˆ†è¡¨å¼€æºæ¡†æ¶ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/01-%E4%BB%8E%E7%90%86%E8%AE%BA%E5%88%B0%E5%AE%9E%E8%B7%B5%E5%A6%82%E4%BD%95%E8%AE%A9%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E7%9C%9F%E6%AD%A3%E8%90%BD%E5%9C%B0/">01 ä»ç†è®ºåˆ°å®è·µï¼šå¦‚ä½•è®©åˆ†åº“åˆ†è¡¨çœŸæ­£è½åœ°ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/02-%E9%A1%B6%E7%BA%A7%E9%A1%B9%E7%9B%AEshardingsphere-%E6%98%AF%E4%B8%80%E6%AC%BE%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84-apache-%E5%BC%80%E6%BA%90%E8%BD%AF%E4%BB%B6/">02 é¡¶çº§é¡¹ç›®ï¼šShardingSphere æ˜¯ä¸€æ¬¾ä»€ä¹ˆæ ·çš„ Apache å¼€æºè½¯ä»¶ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/03-%E8%A7%84%E8%8C%83%E5%85%BC%E5%AE%B9jdbc-%E8%A7%84%E8%8C%83%E4%B8%8E-shardingsphere-%E6%98%AF%E4%BB%80%E4%B9%88%E5%85%B3%E7%B3%BB/">03 è§„èŒƒå…¼å®¹ï¼šJDBC è§„èŒƒä¸ ShardingSphere æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/04-%E5%BA%94%E7%94%A8%E9%9B%86%E6%88%90%E5%9C%A8%E4%B8%9A%E5%8A%A1%E7%B3%BB%E7%BB%9F%E4%B8%AD%E4%BD%BF%E7%94%A8-shardingsphere-%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9C%89%E5%93%AA%E4%BA%9B/">04 åº”ç”¨é›†æˆï¼šåœ¨ä¸šåŠ¡ç³»ç»Ÿä¸­ä½¿ç”¨ ShardingSphere çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/05-%E9%85%8D%E7%BD%AE%E9%A9%B1%E5%8A%A8shardingsphere-%E4%B8%AD%E7%9A%84%E9%85%8D%E7%BD%AE%E4%BD%93%E7%B3%BB%E6%98%AF%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E7%9A%84/">05 é…ç½®é©±åŠ¨ï¼šShardingSphere ä¸­çš„é…ç½®ä½“ç³»æ˜¯å¦‚ä½•è®¾è®¡çš„ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/09-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%BC%BA%E4%B8%80%E8%87%B4%E6%80%A7%E4%BA%8B%E5%8A%A1%E4%B8%8E%E6%9F%94%E6%80%A7%E4%BA%8B%E5%8A%A1/">09 åˆ†å¸ƒå¼äº‹åŠ¡ï¼šå¦‚ä½•ä½¿ç”¨å¼ºä¸€è‡´æ€§äº‹åŠ¡ä¸æŸ”æ€§äº‹åŠ¡ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/10-%E6%95%B0%E6%8D%AE%E8%84%B1%E6%95%8F%E5%A6%82%E4%BD%95%E7%A1%AE%E4%BF%9D%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E7%9A%84%E5%AE%89%E5%85%A8%E8%AE%BF%E9%97%AE/">10 æ•°æ®è„±æ•ï¼šå¦‚ä½•ç¡®ä¿æ•æ„Ÿæ•°æ®çš„å®‰å…¨è®¿é—®ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/11-%E7%BC%96%E6%8E%92%E6%B2%BB%E7%90%86%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E7%8E%AF%E5%A2%83%E4%B8%8B%E7%9A%84%E5%8A%A8%E6%80%81%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86/">11 ç¼–æ’æ²»ç†ï¼šå¦‚ä½•å®ç°åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„åŠ¨æ€é…ç½®ç®¡ç†ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/12-%E4%BB%8E%E5%BA%94%E7%94%A8%E5%88%B0%E5%8E%9F%E7%90%86%E5%A6%82%E4%BD%95%E9%AB%98%E6%95%88%E9%98%85%E8%AF%BB-shardingsphere-%E6%BA%90%E7%A0%81/">12 ä»åº”ç”¨åˆ°åŸç†ï¼šå¦‚ä½•é«˜æ•ˆé˜…è¯» ShardingSphere æºç ï¼Ÿ</a></li>
                
                
                
                    <li>13 å¾®å†…æ ¸æ¶æ„ï¼šShardingSphere å¦‚ä½•å®ç°ç³»ç»Ÿçš„æ‰©å±•æ€§ï¼Ÿ</li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/14-%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%BB%E9%94%AEshardingsphere-%E4%B8%AD%E6%9C%89%E5%93%AA%E4%BA%9B%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%BB%E9%94%AE%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F/">14 åˆ†å¸ƒå¼ä¸»é”®ï¼šShardingSphere ä¸­æœ‰å“ªäº›åˆ†å¸ƒå¼ä¸»é”®å®ç°æ–¹å¼ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/15-%E8%A7%A3%E6%9E%90%E5%BC%95%E6%93%8Esql-%E8%A7%A3%E6%9E%90%E6%B5%81%E7%A8%8B%E5%BA%94%E8%AF%A5%E5%8C%85%E6%8B%AC%E5%93%AA%E4%BA%9B%E6%A0%B8%E5%BF%83%E9%98%B6%E6%AE%B5%E4%B8%8A/">15 è§£æå¼•æ“ï¼šSQL è§£ææµç¨‹åº”è¯¥åŒ…æ‹¬å“ªäº›æ ¸å¿ƒé˜¶æ®µï¼Ÿï¼ˆä¸Šï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/16-%E8%A7%A3%E6%9E%90%E5%BC%95%E6%93%8Esql-%E8%A7%A3%E6%9E%90%E6%B5%81%E7%A8%8B%E5%BA%94%E8%AF%A5%E5%8C%85%E6%8B%AC%E5%93%AA%E4%BA%9B%E6%A0%B8%E5%BF%83%E9%98%B6%E6%AE%B5%E4%B8%8B/">16 è§£æå¼•æ“ï¼šSQL è§£ææµç¨‹åº”è¯¥åŒ…æ‹¬å“ªäº›æ ¸å¿ƒé˜¶æ®µï¼Ÿï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/17-%E8%B7%AF%E7%94%B1%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E5%88%86%E7%89%87%E8%B7%AF%E7%94%B1%E6%A0%B8%E5%BF%83%E7%B1%BB-shardingrouter-%E7%9A%84%E8%BF%90%E4%BD%9C%E6%9C%BA%E5%88%B6/">17 è·¯ç”±å¼•æ“ï¼šå¦‚ä½•ç†è§£åˆ†ç‰‡è·¯ç”±æ ¸å¿ƒç±» ShardingRouter çš„è¿ä½œæœºåˆ¶ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/18-%E8%B7%AF%E7%94%B1%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E7%9A%84%E5%88%86%E7%89%87%E8%B7%AF%E7%94%B1%E5%92%8C%E5%B9%BF%E6%92%AD%E8%B7%AF%E7%94%B1/">18 è·¯ç”±å¼•æ“ï¼šå¦‚ä½•å®ç°æ•°æ®è®¿é—®çš„åˆ†ç‰‡è·¯ç”±å’Œå¹¿æ’­è·¯ç”±ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/19-%E8%B7%AF%E7%94%B1%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E5%9C%A8%E8%B7%AF%E7%94%B1%E8%BF%87%E7%A8%8B%E4%B8%AD%E9%9B%86%E6%88%90%E5%A4%9A%E7%A7%8D%E8%B7%AF%E7%94%B1%E7%AD%96%E7%95%A5%E5%92%8C%E8%B7%AF%E7%94%B1%E7%AE%97%E6%B3%95/">19 è·¯ç”±å¼•æ“ï¼šå¦‚ä½•åœ¨è·¯ç”±è¿‡ç¨‹ä¸­é›†æˆå¤šç§è·¯ç”±ç­–ç•¥å’Œè·¯ç”±ç®—æ³•ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/20-%E6%94%B9%E5%86%99%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F%E4%B8%8B%E7%9A%84-sql-%E6%94%B9%E5%86%99%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6/">20 æ”¹å†™å¼•æ“ï¼šå¦‚ä½•ç†è§£è£…é¥°å™¨æ¨¡å¼ä¸‹çš„ SQL æ”¹å†™å®ç°æœºåˆ¶ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/21-%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E%E5%88%86%E7%89%87%E7%8E%AF%E5%A2%83%E4%B8%8B-sql-%E6%89%A7%E8%A1%8C%E7%9A%84%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B%E5%BA%94%E8%AF%A5%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E6%8A%BD%E8%B1%A1/">21 æ‰§è¡Œå¼•æ“ï¼šåˆ†ç‰‡ç¯å¢ƒä¸‹ SQL æ‰§è¡Œçš„æ•´ä½“æµç¨‹åº”è¯¥å¦‚ä½•è¿›è¡ŒæŠ½è±¡ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/22-%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E6%8A%8A%E6%8F%A1-shardingsphere-%E4%B8%AD%E7%9A%84-executor-%E6%89%A7%E8%A1%8C%E6%A8%A1%E5%9E%8B%E4%B8%8A/">22 æ‰§è¡Œå¼•æ“ï¼šå¦‚ä½•æŠŠæ¡ ShardingSphere ä¸­çš„ Executor æ‰§è¡Œæ¨¡å‹ï¼Ÿï¼ˆä¸Šï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/23-%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E6%8A%8A%E6%8F%A1-shardingsphere-%E4%B8%AD%E7%9A%84-executor-%E6%89%A7%E8%A1%8C%E6%A8%A1%E5%9E%8B%E4%B8%8B/">23 æ‰§è¡Œå¼•æ“ï¼šå¦‚ä½•æŠŠæ¡ ShardingSphere ä¸­çš„ Executor æ‰§è¡Œæ¨¡å‹ï¼Ÿï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/24-%E5%BD%92%E5%B9%B6%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E6%95%B0%E6%8D%AE%E5%BD%92%E5%B9%B6%E7%9A%84%E7%B1%BB%E5%9E%8B%E4%BB%A5%E5%8F%8A%E7%AE%80%E5%8D%95%E5%BD%92%E5%B9%B6%E7%AD%96%E7%95%A5%E7%9A%84%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B/">24 å½’å¹¶å¼•æ“ï¼šå¦‚ä½•ç†è§£æ•°æ®å½’å¹¶çš„ç±»å‹ä»¥åŠç®€å•å½’å¹¶ç­–ç•¥çš„å®ç°è¿‡ç¨‹ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/25-%E5%BD%92%E5%B9%B6%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E6%B5%81%E5%BC%8F%E5%BD%92%E5%B9%B6%E5%92%8C%E5%86%85%E5%AD%98%E5%BD%92%E5%B9%B6%E5%9C%A8%E5%A4%8D%E6%9D%82%E5%BD%92%E5%B9%B6%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%9A%84%E5%BA%94%E7%94%A8%E6%96%B9%E5%BC%8F/">25 å½’å¹¶å¼•æ“ï¼šå¦‚ä½•ç†è§£æµå¼å½’å¹¶å’Œå†…å­˜å½’å¹¶åœ¨å¤æ‚å½’å¹¶åœºæ™¯ä¸‹çš„åº”ç”¨æ–¹å¼ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/26-%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E6%99%AE%E9%80%9A%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%92%8C%E5%88%86%E7%89%87%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%88%86%E5%88%AB%E6%98%AF%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%9A%84/">26 è¯»å†™åˆ†ç¦»ï¼šæ™®é€šä¸»ä»æ¶æ„å’Œåˆ†ç‰‡ä¸»ä»æ¶æ„åˆ†åˆ«æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/27-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3-shardingsphere-%E4%B8%AD%E5%AF%B9%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%9A%84%E6%8A%BD%E8%B1%A1%E8%BF%87%E7%A8%8B/">27 åˆ†å¸ƒå¼äº‹åŠ¡ï¼šå¦‚ä½•ç†è§£ ShardingSphere ä¸­å¯¹åˆ†å¸ƒå¼äº‹åŠ¡çš„æŠ½è±¡è¿‡ç¨‹ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/28-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1shardingsphere-%E4%B8%AD%E5%A6%82%E4%BD%95%E9%9B%86%E6%88%90%E5%BC%BA%E4%B8%80%E8%87%B4%E6%80%A7%E4%BA%8B%E5%8A%A1%E5%92%8C%E6%9F%94%E6%80%A7%E4%BA%8B%E5%8A%A1%E6%94%AF%E6%8C%81%E4%B8%8A/">28 åˆ†å¸ƒå¼äº‹åŠ¡ï¼šShardingSphere ä¸­å¦‚ä½•é›†æˆå¼ºä¸€è‡´æ€§äº‹åŠ¡å’ŒæŸ”æ€§äº‹åŠ¡æ”¯æŒï¼Ÿï¼ˆä¸Šï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/29-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1shardingsphere-%E4%B8%AD%E5%A6%82%E4%BD%95%E9%9B%86%E6%88%90%E5%BC%BA%E4%B8%80%E8%87%B4%E6%80%A7%E4%BA%8B%E5%8A%A1%E5%92%8C%E6%9F%94%E6%80%A7%E4%BA%8B%E5%8A%A1%E6%94%AF%E6%8C%81%E4%B8%8B/">29 åˆ†å¸ƒå¼äº‹åŠ¡ï¼šShardingSphere ä¸­å¦‚ä½•é›†æˆå¼ºä¸€è‡´æ€§äº‹åŠ¡å’ŒæŸ”æ€§äº‹åŠ¡æ”¯æŒï¼Ÿï¼ˆä¸‹ï¼‰</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/30-%E6%95%B0%E6%8D%AE%E8%84%B1%E6%95%8F%E5%A6%82%E4%BD%95%E5%9F%BA%E4%BA%8E%E6%94%B9%E5%86%99%E5%BC%95%E6%93%8E%E5%AE%9E%E7%8E%B0%E4%BD%8E%E4%BE%B5%E5%85%A5%E6%80%A7%E6%95%B0%E6%8D%AE%E8%84%B1%E6%95%8F%E6%96%B9%E6%A1%88/">30 æ•°æ®è„±æ•ï¼šå¦‚ä½•åŸºäºæ”¹å†™å¼•æ“å®ç°ä½ä¾µå…¥æ€§æ•°æ®è„±æ•æ–¹æ¡ˆï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/31-%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E5%A6%82%E4%BD%95%E5%9F%BA%E4%BA%8E%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E5%AE%9E%E7%8E%B0%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E7%9A%84%E5%8A%A8%E6%80%81%E5%8C%96%E7%AE%A1%E7%90%86/">31 é…ç½®ä¸­å¿ƒï¼šå¦‚ä½•åŸºäºé…ç½®ä¸­å¿ƒå®ç°é…ç½®ä¿¡æ¯çš„åŠ¨æ€åŒ–ç®¡ç†ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/32-%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E5%A6%82%E4%BD%95%E5%9F%BA%E4%BA%8E%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BF%E9%97%AE%E7%86%94%E6%96%AD%E6%9C%BA%E5%88%B6/">32 æ³¨å†Œä¸­å¿ƒï¼šå¦‚ä½•åŸºäºæ³¨å†Œä¸­å¿ƒå®ç°æ•°æ®åº“è®¿é—®ç†”æ–­æœºåˆ¶ï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/33-%E9%93%BE%E8%B7%AF%E8%B7%9F%E8%B8%AA%E5%A6%82%E4%BD%95%E5%9F%BA%E4%BA%8E-hook-%E6%9C%BA%E5%88%B6%E4%BB%A5%E5%8F%8A-opentracing-%E5%8D%8F%E8%AE%AE%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E9%93%BE%E8%B7%AF%E8%B7%9F%E8%B8%AA/">33 é“¾è·¯è·Ÿè¸ªï¼šå¦‚ä½•åŸºäº Hook æœºåˆ¶ä»¥åŠ OpenTracing åè®®å®ç°æ•°æ®è®¿é—®é“¾è·¯è·Ÿè¸ªï¼Ÿ</a></li>
                
                
                
                    <li><a href="http://yipsen.github.io/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/35-%E7%BB%93%E8%AF%ADshardingsphere-%E6%80%BB%E7%BB%93%E5%8F%8A%E5%B1%95%E6%9C%9B/">35 ç»“è¯­ï¼šShardingSphere æ€»ç»“åŠå±•æœ›</a></li>
                
                
            </ul>
        
    </div>
</aside>

<style>
    aside {
        position: fixed;
        left: 20px;
        background: #ffdee3;
        border-radius: 6px;
        padding: 20px;
        padding-top: 60px;
        box-shadow: 5px 10px #888;
        list-style-type: none;
        display: none;
    }

    .post-category-icon {
        position: absolute;
        width: 80px;
        height: 80px;
        top: -40px;
        left: 50%;
        margin-left: -40px;
        text-align: center;
        font-size: 36px;
        content: 'J';
        background: #ffdee3;
        border-radius: 100%;
        border: 10px solid #fff;
        box-shadow: 5px 10px #888;
    }
</style><article class="post-block">
        <h1 class="post-title">13 å¾®å†…æ ¸æ¶æ„ï¼šShardingSphere å¦‚ä½•å®ç°ç³»ç»Ÿçš„æ‰©å±•æ€§ï¼Ÿ</h1>
        <div class="post-info">
            <div> 
                <span class="post-date">ğŸ“…&nbsp;2021-12-22 01:55:52</span>ğŸ·ï¸&nbsp;<a class="post-tag" href="/tags/sharding/">sharding</a></div><div class="post-category">
                
                ğŸ“š&nbsp;<a href="/categories/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/">ShardingSphereæ ¸å¿ƒåŸç†ç²¾è®²</a>
                
            </div></div>
        <div class="post-content">
            <p>æˆ‘ä»¬å·²ç»åœ¨è¯¾ç¨‹ä¸­å¤šæ¬¡æåˆ° ShardingSphere ä½¿ç”¨äº†å¾®å†…æ ¸æ¶æ„æ¥å®ç°æ¡†æ¶çš„æ‰©å±•æ€§ã€‚éšç€è¯¾ç¨‹çš„æ¼”è¿›ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œç”¨äºå®ç°é…ç½®ä¸­å¿ƒçš„ ConfigCenterã€ç”¨äºæ•°æ®è„±æ•çš„ ShardingEncryptor ä»¥åŠç”¨äºæ•°æ®åº“æ²»ç†çš„æ³¨å†Œä¸­å¿ƒæ¥å£ RegistryCenter ç­‰å¤§é‡ç»„ä»¶çš„å®ç°ä¹Ÿéƒ½ä½¿ç”¨äº†å¾®å†…æ ¸æ¶æ„ã€‚é‚£ä¹ˆï¼Œç©¶ç«Ÿä»€ä¹ˆæ˜¯å¾®å†…æ ¸æ¶æ„å‘¢ï¼Ÿä»Šå¤©æˆ‘ä»¬å°±æ¥è®¨è®ºè¿™ä¸ªæ¶æ„æ¨¡å¼çš„åŸºæœ¬åŸç†ä»¥åŠåœ¨ ShardingSphere ä¸­çš„åº”ç”¨ã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯å¾®å†…æ ¸æ¶æ„">ä»€ä¹ˆæ˜¯å¾®å†…æ ¸æ¶æ„ï¼Ÿ</h3>
<p><strong>å¾®å†…æ ¸æ˜¯ä¸€ç§å…¸å‹çš„æ¶æ„æ¨¡å¼</strong> ï¼ŒåŒºåˆ«äºæ™®é€šçš„è®¾è®¡æ¨¡å¼ï¼Œæ¶æ„æ¨¡å¼æ˜¯ä¸€ç§é«˜å±‚æ¨¡å¼ï¼Œç”¨äºæè¿°ç³»ç»Ÿçº§çš„ç»“æ„ç»„æˆã€ç›¸äº’å…³ç³»åŠç›¸å…³çº¦æŸã€‚å¾®å†…æ ¸æ¶æ„åœ¨å¼€æºæ¡†æ¶ä¸­çš„åº”ç”¨ä¹Ÿæ¯”è¾ƒå¹¿æ³›ï¼Œé™¤äº† ShardingSphere ä¹‹å¤–ï¼Œåœ¨ä¸»æµçš„ PRC æ¡†æ¶ Dubbo ä¸­ä¹Ÿå®ç°äº†è‡ªå·±çš„å¾®å†…æ ¸æ¶æ„ã€‚é‚£ä¹ˆï¼Œåœ¨ä»‹ç»ä»€ä¹ˆæ˜¯å¾®å†…æ ¸æ¶æ„ä¹‹å‰ï¼Œæˆ‘ä»¬æœ‰å¿…è¦å…ˆé˜è¿°è¿™äº›å¼€æºæ¡†æ¶ä¼šä½¿ç”¨å¾®å†…æ ¸æ¶æ„çš„åŸå› ã€‚</p>
<h4 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¾®å†…æ ¸æ¶æ„">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¾®å†…æ ¸æ¶æ„ï¼Ÿ</h4>
<p><strong>å¾®å†…æ ¸æ¶æ„æœ¬è´¨ä¸Šæ˜¯ä¸ºäº†æé«˜ç³»ç»Ÿçš„æ‰©å±•æ€§</strong> ã€‚æ‰€è°“æ‰©å±•æ€§ï¼Œæ˜¯æŒ‡ç³»ç»Ÿåœ¨ç»å†ä¸å¯é¿å…çš„å˜æ›´æ—¶æ‰€å…·æœ‰çš„çµæ´»æ€§ï¼Œä»¥åŠé’ˆå¯¹æä¾›è¿™æ ·çš„çµæ´»æ€§æ‰€éœ€è¦ä»˜å‡ºçš„æˆæœ¬é—´çš„å¹³è¡¡èƒ½åŠ›ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“åœ¨å¾€ç³»ç»Ÿä¸­æ·»åŠ æ–°ä¸šåŠ¡æ—¶ï¼Œä¸éœ€è¦æ”¹å˜åŸæœ‰çš„å„ä¸ªç»„ä»¶ï¼Œåªéœ€æŠŠæ–°ä¸šåŠ¡å°é—­åœ¨ä¸€ä¸ªæ–°çš„ç»„ä»¶ä¸­å°±èƒ½å®Œæˆæ•´ä½“ä¸šåŠ¡çš„å‡çº§ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™æ ·çš„ç³»ç»Ÿå…·æœ‰è¾ƒå¥½çš„å¯æ‰©å±•æ€§ã€‚</p>
<p>å°±æ¶æ„è®¾è®¡è€Œè¨€ï¼Œæ‰©å±•æ€§æ˜¯è½¯ä»¶è®¾è®¡çš„æ°¸æ’è¯é¢˜ã€‚è€Œè¦å®ç°ç³»ç»Ÿæ‰©å±•æ€§ï¼Œä¸€ç§æ€è·¯æ˜¯æä¾›å¯æ’æ‹”å¼çš„æœºåˆ¶æ¥åº”å¯¹æ‰€å‘ç”Ÿçš„å˜åŒ–ã€‚å½“ç³»ç»Ÿä¸­ç°æœ‰çš„æŸä¸ªç»„ä»¶ä¸æ»¡è¶³è¦æ±‚æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªæ–°çš„ç»„ä»¶æ¥æ›¿æ¢å®ƒï¼Œè€Œæ•´ä¸ªè¿‡ç¨‹å¯¹äºç³»ç»Ÿçš„è¿è¡Œè€Œè¨€åº”è¯¥æ˜¯æ— æ„ŸçŸ¥çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦éšæ—¶å®Œæˆè¿™ç§æ–°æ—§ç»„ä»¶çš„æ›¿æ¢ã€‚</p>
<p>æ¯”å¦‚åœ¨ä¸‹ä¸ªè¯¾æ—¶ä¸­æˆ‘ä»¬å°†è¦ä»‹ç»çš„ ShardingSphere ä¸­æä¾›çš„åˆ†å¸ƒå¼ä¸»é”®åŠŸèƒ½ï¼Œåˆ†å¸ƒå¼ä¸»é”®çš„å®ç°å¯èƒ½æœ‰å¾ˆå¤šç§ï¼Œè€Œæ‰©å±•æ€§åœ¨è¿™ä¸ªç‚¹ä¸Šçš„ä½“ç°å°±æ˜¯ï¼Œ <strong>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»æ„ä¸€ç§æ–°çš„åˆ†å¸ƒå¼ä¸»é”®å®ç°æ¥æ›¿æ¢åŸæœ‰çš„å®ç°ï¼Œè€Œä¸éœ€è¦ä¾èµ–åˆ†å¸ƒå¼ä¸»é”®çš„ä¸šåŠ¡ä»£ç åšä»»ä½•çš„æ”¹å˜</strong> ã€‚</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/ShardingSphere%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2-%E5%AE%8C/assets/CgqCHl8esVaAVlUFAACJmGjQZDA482.png" alt="image.png"></p>
<p>å¾®å†…æ ¸æ¶æ„æ¨¡å¼ä¸ºè¿™ç§å®ç°æ‰©å±•æ€§çš„æ€è·¯æä¾›äº†æ¶æ„è®¾è®¡ä¸Šçš„æ”¯æŒï¼ŒShardingSphere åŸºäºå¾®å†…æ ¸æ¶æ„å®ç°äº†é«˜åº¦çš„æ‰©å±•æ€§ã€‚åœ¨ä»‹ç»å¦‚ä½•å®ç°å¾®å†…æ ¸æ¶æ„ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå¯¹å¾®å†…æ ¸æ¶æ„çš„å…·ä½“ç»„æˆç»“æ„å’ŒåŸºæœ¬åŸç†åšç®€è¦çš„é˜è¿°ã€‚</p>
<h4 id="ä»€ä¹ˆæ˜¯å¾®å†…æ ¸æ¶æ„-1">ä»€ä¹ˆæ˜¯å¾®å†…æ ¸æ¶æ„ï¼Ÿ</h4>
<p>ä»ç»„æˆç»“æ„ä¸Šè®²ï¼Œ <strong>å¾®å†…æ ¸æ¶æ„åŒ…å«ä¸¤éƒ¨åˆ†ç»„ä»¶ï¼šå†…æ ¸ç³»ç»Ÿå’Œæ’ä»¶</strong> ã€‚è¿™é‡Œçš„å†…æ ¸ç³»ç»Ÿé€šå¸¸æä¾›ç³»ç»Ÿè¿è¡Œæ‰€éœ€çš„æœ€å°åŠŸèƒ½é›†ï¼Œè€Œæ’ä»¶æ˜¯ç‹¬ç«‹çš„ç»„ä»¶ï¼ŒåŒ…å«è‡ªå®šä¹‰çš„å„ç§ä¸šåŠ¡ä»£ç ï¼Œç”¨æ¥å‘å†…æ ¸ç³»ç»Ÿå¢å¼ºæˆ–æ‰©å±•é¢å¤–çš„ä¸šåŠ¡èƒ½åŠ›ã€‚åœ¨ ShardingSphere ä¸­ï¼Œå‰é¢æåˆ°çš„åˆ†å¸ƒå¼ä¸»é”®å°±æ˜¯æ’ä»¶ï¼Œè€Œ ShardingSphere çš„è¿è¡Œæ—¶ç¯å¢ƒæ„æˆäº†å†…æ ¸ç³»ç»Ÿã€‚</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/ShardingSphere%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2-%E5%AE%8C/assets/CgqCHl8esWOAJ-5cAACfxz06p_E616.png" alt="image"></p>
<p>é‚£ä¹ˆè¿™é‡Œçš„æ’ä»¶å…·ä½“æŒ‡çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¿™å°±éœ€è¦æˆ‘ä»¬æ˜ç¡®ä¸¤ä¸ªæ¦‚å¿µï¼Œä¸€ä¸ªæ¦‚å¿µå°±æ˜¯ç»å¸¸åœ¨è¯´çš„ <strong>API</strong> ï¼Œè¿™æ˜¯ç³»ç»Ÿå¯¹å¤–æš´éœ²çš„æ¥å£ã€‚è€Œå¦ä¸€ä¸ªæ¦‚å¿µå°±æ˜¯ <strong>SPI</strong>ï¼ˆService Provider Interfaceï¼ŒæœåŠ¡æä¾›æ¥å£ï¼‰ï¼Œè¿™æ˜¯æ’ä»¶è‡ªèº«æ‰€å…·å¤‡çš„æ‰©å±•ç‚¹ã€‚å°±ä¸¤è€…çš„å…³ç³»è€Œè¨€ï¼ŒAPI é¢å‘ä¸šåŠ¡å¼€å‘äººå‘˜ï¼Œè€Œ SPI é¢å‘æ¡†æ¶å¼€å‘äººå‘˜ï¼Œä¸¤è€…å…±åŒæ„æˆäº† ShardingSphere æœ¬èº«ã€‚</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/ShardingSphere%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2-%E5%AE%8C/assets/Ciqc1F8esXOADonEAACE9HEUTJc298.png" alt="image"></p>
<p>å¯æ’æ‹”å¼çš„å®ç°æœºåˆ¶è¯´èµ·æ¥ç®€å•ï¼Œåšèµ·æ¥å´ä¸å®¹æ˜“ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸¤æ–¹é¢å†…å®¹ã€‚ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬éœ€è¦æ¢³ç†ç³»ç»Ÿçš„å˜åŒ–å¹¶æŠŠå®ƒä»¬æŠ½è±¡æˆå¤šä¸ª SPI æ‰©å±•ç‚¹ã€‚å¦ä¸€æ–¹é¢ï¼Œ <strong>å½“æˆ‘ä»¬å®ç°äº†è¿™äº› SPI æ‰©å±•ç‚¹ä¹‹åï¼Œå°±éœ€è¦æ„å»ºä¸€ä¸ªèƒ½å¤Ÿæ”¯æŒè¿™ç§å¯æ’æ‹”æœºåˆ¶çš„å…·ä½“å®ç°ï¼Œä»è€Œæä¾›ä¸€ç§ SPI è¿è¡Œæ—¶ç¯å¢ƒ</strong> ã€‚</p>
<p>é‚£ä¹ˆï¼ŒShardingSphere æ˜¯å¦‚ä½•å®ç°å¾®å†…æ ¸æ¶æ„çš„å‘¢ï¼Ÿè®©æˆ‘ä»¬æ¥ä¸€èµ·çœ‹ä¸€ä¸‹ã€‚</p>
<h3 id="å¦‚ä½•å®ç°å¾®å†…æ ¸æ¶æ„">å¦‚ä½•å®ç°å¾®å†…æ ¸æ¶æ„ï¼Ÿ</h3>
<p>äº‹å®ä¸Šï¼ŒJDK å·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§å¾®å†…æ ¸æ¶æ„çš„å®ç°æ–¹å¼ï¼Œè¿™ç§å®ç°æ–¹å¼é’ˆå¯¹å¦‚ä½•è®¾è®¡å’Œå®ç° SPI æå‡ºäº†ä¸€äº›å¼€å‘å’Œé…ç½®ä¸Šçš„è§„èŒƒï¼ŒShardingSphere ä½¿ç”¨çš„å°±æ˜¯è¿™ç§è§„èŒƒã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è®¾è®¡ä¸€ä¸ªæœåŠ¡æ¥å£ï¼Œå¹¶æ ¹æ®éœ€è¦æä¾›ä¸åŒçš„å®ç°ç±»ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ¨¡æ‹Ÿå®ç°åˆ†å¸ƒå¼ä¸»é”®çš„åº”ç”¨åœºæ™¯ã€‚</p>
<p>åŸºäº SPI çš„çº¦å®šï¼Œåˆ›å»ºä¸€ä¸ªå•ç‹¬çš„å·¥ç¨‹æ¥å­˜æ”¾æœåŠ¡æ¥å£ï¼Œå¹¶ç»™å‡ºæ¥å£å®šä¹‰ã€‚è¯·æ³¨æ„ <strong>è¿™ä¸ªæœåŠ¡æ¥å£çš„å®Œæ•´ç±»è·¯å¾„ä¸º com.tianyilan.KeyGenerator</strong> ï¼Œæ¥å£ä¸­åªåŒ…å«ä¸€ä¸ªè·å–ç›®æ ‡ä¸»é”®çš„ç®€å•ç¤ºä¾‹æ–¹æ³•ã€‚</p>
<pre tabindex="0"><code>package com.tianyilan; 

public interface KeyGenerator{ 

    String getKey(); 
}
</code></pre><p>é’ˆå¯¹è¯¥æ¥å£ï¼Œæä¾›ä¸¤ä¸ªç®€å•çš„å®ç°ç±»ï¼Œåˆ†åˆ«æ˜¯åŸºäº UUID çš„ UUIDKeyGenerator å’ŒåŸºäºé›ªèŠ±ç®—æ³•çš„ SnowflakeKeyGeneratorã€‚ä¸ºäº†è®©æ¼”ç¤ºè¿‡ç¨‹æ›´ç®€å•ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥è¿”å›ä¸€ä¸ªæ¨¡æ‹Ÿçš„ç»“æœï¼ŒçœŸå®çš„å®ç°è¿‡ç¨‹æˆ‘ä»¬ä¼šåœ¨ä¸‹ä¸€è¯¾æ—¶ä¸­è¯¦ç»†ä»‹ç»ã€‚</p>
<pre tabindex="0"><code>public class UUIDKeyGenerator implements KeyGenerator { 

    @Override 
    public String getKey() { 

       return &quot;UUIDKey&quot;; 
    } 
} 

public class SnowflakeKeyGenerator implements KeyGenerator { 

    @Override 
    public String getKey() { 

       return &quot;SnowflakeKey&quot;; 
    } 
}
</code></pre><p>æ¥ä¸‹æ¥çš„è¿™ä¸ªæ­¥éª¤å¾ˆå…³é”®ï¼Œ <strong>åœ¨è¿™ä¸ªä»£ç å·¥ç¨‹çš„ META-INF/services/ ç›®å½•ä¸‹ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªä»¥æœåŠ¡æ¥å£å®Œæ•´ç±»è·¯å¾„ com.tianyilan.KeyGenerator å‘½åçš„æ–‡ä»¶</strong> ï¼Œæ–‡ä»¶çš„å†…å®¹æ˜¯æŒ‡å‘è¯¥æ¥å£æ‰€å¯¹åº”çš„ä¸¤ä¸ªå®ç°ç±»çš„å®Œæ•´ç±»è·¯å¾„ com.tianyilan.UUIDKeyGenerator å’Œ com.tianyilan. SnowflakeKeyGeneratorã€‚</p>
<p>æˆ‘ä»¬æŠŠè¿™ä¸ªä»£ç å·¥ç¨‹æ‰“æˆä¸€ä¸ª jar åŒ…ï¼Œç„¶åæ–°å»ºå¦ä¸€ä¸ªä»£ç å·¥ç¨‹ï¼Œè¯¥ä»£ç å·¥ç¨‹éœ€è¦è¿™ä¸ª jar åŒ…ï¼Œå¹¶å®Œæˆå¦‚ä¸‹æ‰€ç¤ºçš„ Main å‡½æ•°ã€‚</p>
<pre tabindex="0"><code>import java.util.ServiceLoader; 
import com.tianyilan. KeyGenerator; 

public class Main { 
    public static void main(String[] args) { 

       ServiceLoader&lt;KeyGenerator&gt; generators = ServiceLoader.load(KeyGenerator.class); 

       for (KeyGenerator generator : generators) { 
           System.out.println(generator.getClass()); 
           String key = generator.getKey(); 
           System.out.println(key); 
       } 
    } 
}
</code></pre><p>ç°åœ¨ï¼Œè¯¥å·¥ç¨‹çš„è§’è‰²æ˜¯ SPI æœåŠ¡çš„ä½¿ç”¨è€…ï¼Œè¿™é‡Œä½¿ç”¨äº† JDK æä¾›çš„ ServiceLoader å·¥å…·ç±»æ¥è·å–æ‰€æœ‰ KeyGenerator çš„å®ç°ç±»ã€‚ç°åœ¨åœ¨ jar åŒ…çš„ META-INF/services/com.tianyilan.KeyGenerator æ–‡ä»¶ä¸­æœ‰ä¸¤ä¸ª KeyGenerator å®ç°ç±»çš„å®šä¹‰ã€‚æ‰§è¡Œè¿™æ®µ Main å‡½æ•°ï¼Œæˆ‘ä»¬å°†å¾—åˆ°çš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p>
<pre tabindex="0"><code>class com.tianyilan.UUIDKeyGenerator 
UUIDKey 
class com.tianyilan.SnowflakeKeyGenerator 
SnowflakeKey
</code></pre><p>å¦‚æœæˆ‘ä»¬è°ƒæ•´ META-INF/services/com.tianyilan.KeyGenerator æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œå»æ‰ com.tianyilan.UUIDKeyGenerator çš„å®šä¹‰ï¼Œå¹¶é‡æ–°æ‰“æˆ jar åŒ…ä¾› SPI æœåŠ¡çš„ä½¿ç”¨è€…è¿›è¡Œå¼•ç”¨ã€‚å†æ¬¡æ‰§è¡Œ Main å‡½æ•°ï¼Œåˆ™åªä¼šå¾—åˆ°åŸºäº SnowflakeKeyGenerator çš„è¾“å‡ºç»“æœã€‚</p>
<p>è‡³æ­¤ï¼Œ å®Œæ•´ çš„ SPI æä¾›è€…å’Œä½¿ç”¨è€…çš„å®ç°è¿‡ç¨‹æ¼”ç¤ºå®Œæ¯•ã€‚æˆ‘ä»¬é€šè¿‡ä¸€å¼ å›¾ï¼Œæ€»ç»“åŸºäº JDK çš„ SPI æœºåˆ¶å®ç°å¾®å†…æ ¸æ¶æ„çš„å¼€å‘æµç¨‹ï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/ShardingSphere%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2-%E5%AE%8C/assets/Ciqc1F8esYqAdXABAADVVh6mYnA926.png" alt="image"></p>
<p>è¿™ä¸ªç¤ºä¾‹éå¸¸ç®€å•ï¼Œä½†å´æ˜¯ ShardingSphere ä¸­å®ç°å¾®å†…æ ¸æ¶æ„çš„åŸºç¡€ã€‚æ¥ä¸‹æ¥ï¼Œå°±è®©æˆ‘ä»¬æŠŠè¯é¢˜è½¬åˆ° ShardingSphereï¼Œçœ‹çœ‹ ShardingSphere ä¸­åº”ç”¨ SPI æœºåˆ¶çš„å…·ä½“æ–¹æ³•ã€‚</p>
<h3 id="shardingsphere-å¦‚ä½•åŸºäºå¾®å†…æ ¸æ¶æ„å®ç°æ‰©å±•æ€§">ShardingSphere å¦‚ä½•åŸºäºå¾®å†…æ ¸æ¶æ„å®ç°æ‰©å±•æ€§ï¼Ÿ</h3>
<p>ShardingSphere ä¸­å¾®å†…æ ¸æ¶æ„çš„å®ç°è¿‡ç¨‹å¹¶ä¸å¤æ‚ï¼ŒåŸºæœ¬å°±æ˜¯å¯¹ JDK ä¸­ SPI æœºåˆ¶çš„å°è£…ã€‚è®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€ä¸‹ã€‚</p>
<h4 id="shardingsphere-ä¸­çš„å¾®å†…æ ¸æ¶æ„åŸºç¡€å®ç°æœºåˆ¶">ShardingSphere ä¸­çš„å¾®å†…æ ¸æ¶æ„åŸºç¡€å®ç°æœºåˆ¶</h4>
<p>æˆ‘ä»¬å‘ç°ï¼Œåœ¨ ShardingSphere æºç çš„æ ¹ç›®å½•ä¸‹ï¼Œå­˜åœ¨ä¸€ä¸ªç‹¬ç«‹çš„å·¥ç¨‹ shardingsphere-spiã€‚æ˜¾ç„¶ï¼Œä»å‘½åä¸Šçœ‹ï¼Œè¿™ä¸ªå·¥ç¨‹ä¸­åº”è¯¥åŒ…å«äº† ShardingSphere å®ç° SPI çš„ç›¸å…³ä»£ç ã€‚æˆ‘ä»¬å¿«é€Ÿæµè§ˆè¯¥å·¥ç¨‹ï¼Œå‘ç°é‡Œé¢åªæœ‰ä¸€ä¸ªæ¥å£å®šä¹‰å’Œä¸¤ä¸ªå·¥å…·ç±»ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹è¿™ä¸ªæ¥å£å®šä¹‰ TypeBasedSPIï¼š</p>
<pre tabindex="0"><code>public interface TypeBasedSPI { 

    //è·å–SPIå¯¹åº”çš„ç±»å‹ 
    String getType(); 

    //è·å–å±æ€§ 
    Properties getProperties(); 

    //è®¾ç½®å±æ€§ 
    void setProperties(Properties properties); 
}
</code></pre><p>ä»å®šä½ä¸Šçœ‹ï¼Œè¿™ä¸ªæ¥å£åœ¨ ShardingSphere ä¸­åº”è¯¥æ˜¯ä¸€ä¸ªé¡¶å±‚æ¥å£ï¼Œæˆ‘ä»¬å·²ç»åœ¨ä¸Šä¸€è¯¾æ—¶ç»™å‡ºäº†è¿™ä¸€æ¥å£çš„å®ç°ç±»ç±»å±‚ç»“æ„ã€‚æ¥ä¸‹æ¥å†çœ‹ä¸€ä¸‹ NewInstanceServiceLoader ç±»ï¼Œä»å‘½åä¸Šçœ‹ï¼Œä¸éš¾æƒ³è±¡è¯¥ç±»çš„ä½œç”¨ç±»ä¼¼äºä¸€ç§ ServiceLoaderï¼Œç”¨äºåŠ è½½æ–°çš„ç›®æ ‡å¯¹è±¡å®ä¾‹ï¼š</p>
<pre tabindex="0"><code>public final class NewInstanceServiceLoader { 

    private static final Map&lt;Class, Collection&lt;Class&lt;?&gt;&gt;&gt; SERVICE_MAP = new HashMap&lt;&gt;(); 

    //é€šè¿‡ServiceLoaderè·å–æ–°çš„SPIæœåŠ¡å®ä¾‹å¹¶æ³¨å†Œåˆ°SERVICE_MAPä¸­
    public static &lt;T&gt; void register(final Class&lt;T&gt; service) { 
        for (T each : ServiceLoader.load(service)) { 
            registerServiceClass(service, each); 
        } 
    } 

    @SuppressWarnings(&quot;unchecked&quot;) 
    private static &lt;T&gt; void registerServiceClass(final Class&lt;T&gt; service, final T instance) { 
        Collection&lt;Class&lt;?&gt;&gt; serviceClasses = SERVICE_MAP.get(service); 
        if (null == serviceClasses) { 
            serviceClasses = new LinkedHashSet&lt;&gt;(); 
        } 
        serviceClasses.add(instance.getClass()); 
        SERVICE_MAP.put(service, serviceClasses); 
    } 

    @SneakyThrows 
    @SuppressWarnings(&quot;unchecked&quot;) 
    public static &lt;T&gt; Collection&lt;T&gt; newServiceInstances(final Class&lt;T&gt; service) { 
        Collection&lt;T&gt; result = new LinkedList&lt;&gt;(); 
        if (null == SERVICE_MAP.get(service)) { 
            return result; 
        } 
        for (Class&lt;?&gt; each : SERVICE_MAP.get(service)) { 
            result.add((T) each.newInstance()); 
        } 
        return result; 
    } 
}
</code></pre><p>åœ¨ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œ é¦–å…ˆçœ‹åˆ°äº†ç†Ÿæ‚‰çš„ ServiceLoader.load(service) æ–¹æ³•ï¼Œè¿™æ˜¯ JDK ä¸­ ServiceLoader å·¥å…·ç±»çš„å…·ä½“åº”ç”¨ã€‚åŒæ—¶ï¼Œæ³¨æ„åˆ° ShardingSphere ä½¿ç”¨äº†ä¸€ä¸ª HashMap æ¥ä¿å­˜ç±»çš„å®šä¹‰ä»¥åŠç±»çš„å®ä¾‹ä¹‹ é—´ çš„ä¸€å¯¹å¤šå…³ç³»ï¼Œå¯ä»¥è®¤ä¸ºï¼Œè¿™æ˜¯ä¸€ç§ç”¨äºæé«˜è®¿é—®æ•ˆç‡çš„ç¼“å­˜æœºåˆ¶ã€‚</p>
<p>æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ TypeBasedSPIServiceLoader çš„å®ç°ï¼Œè¯¥ç±»ä¾èµ–äºå‰é¢ä»‹ç»çš„ NewInstanceServiceLoader ç±»ã€‚ ä¸‹é¢è¿™æ®µä»£ç æ¼”ç¤ºäº† åŸºäº NewInstanceServiceLoader è·å–å®ä¾‹ç±»åˆ—è¡¨ï¼Œå¹¶æ ¹æ®æ‰€ä¼ å…¥çš„ç±»å‹åšè¿‡æ»¤ï¼š</p>
<pre tabindex="0"><code>    //ä½¿ç”¨NewInstanceServiceLoaderè·å–å®ä¾‹ç±»åˆ—è¡¨ï¼Œå¹¶æ ¹æ®ç±»å‹åšè¿‡æ»¤ 
    private Collection&lt;T&gt; loadTypeBasedServices(final String type) { 
        return Collections2.filter(NewInstanceServiceLoader.newServiceInstances(classType), new Predicate&lt;T&gt;() { 

            @Override 
            public boolean apply(final T input) { 
                return type.equalsIgnoreCase(input.getType()); 
            } 
        }); 
    }
</code></pre><p>TypeBasedSPIServiceLoader å¯¹å¤–æš´éœ²äº†æœåŠ¡çš„æ¥å£ï¼Œå¯¹é€šè¿‡ loadTypeBasedServices æ–¹æ³•è·å–çš„æœåŠ¡å®ä¾‹è®¾ç½®å¯¹åº”çš„å±æ€§ç„¶åè¿”å›ï¼š</p>
<pre tabindex="0"><code>//åŸºäºç±»å‹é€šè¿‡SPIåˆ›å»ºå®ä¾‹ 
    public final T newService(final String type, final Properties props) { 
        Collection&lt;T&gt; typeBasedServices = loadTypeBasedServices(type); 
        if (typeBasedServices.isEmpty()) { 
            throw new RuntimeException(String.format(&quot;Invalid `%s` SPI type `%s`.&quot;, classType.getName(), type)); 
        } 
        T result = typeBasedServices.iterator().next(); 
        result.setProperties(props); 
        return result; 
}
</code></pre><p>åŒæ—¶ï¼ŒTypeBasedSPIServiceLoader ä¹Ÿå¯¹å¤–æš´éœ²äº†ä¸éœ€è¦ä¼ å…¥ç±»å‹çš„ newService æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä½¿ç”¨äº† loadFirstTypeBasedService å·¥å…·æ–¹æ³•æ¥è·å–ç¬¬ä¸€ä¸ªæœåŠ¡å®ä¾‹ï¼š</p>
<pre tabindex="0"><code>//åŸºäºé»˜è®¤ç±»å‹é€šè¿‡SPIåˆ›å»ºå®ä¾‹ 
    public final T newService() { 
        T result = loadFirstTypeBasedService(); 
        result.setProperties(new Properties()); 
        return result; 
} 

    private T loadFirstTypeBasedService() { 
        Collection&lt;T&gt; instances = NewInstanceServiceLoader.newServiceInstances(classType); 
        if (instances.isEmpty()) { 
            throw new RuntimeException(String.format(&quot;Invalid `%s` SPI, no implementation class load from SPI.&quot;, classType.getName())); 
        } 
        return instances.iterator().next(); 
}
</code></pre><p>è¿™æ ·ï¼Œshardingsphere-spi ä»£ç å·¥ç¨‹ä¸­çš„å†…å®¹å°±ä»‹ç»å®Œæ¯•ã€‚ <strong>è¿™éƒ¨åˆ†å†…å®¹ç›¸å½“äºæ˜¯ ShardingSphere ä¸­æ‰€æä¾›çš„æ’ä»¶è¿è¡Œæ—¶ç¯å¢ƒ</strong> ã€‚ä¸‹é¢æˆ‘ä»¬åŸºäº ShardingSphere ä¸­æä¾›çš„å‡ ä¸ªå…¸å‹åº”ç”¨åœºæ™¯æ¥è®¨è®ºè¿™ä¸ªè¿è¡Œæ—¶ç¯å¢ƒçš„å…·ä½“ä½¿ç”¨æ–¹æ³•ã€‚</p>
<h4 id="å¾®å†…æ ¸æ¶æ„åœ¨-shardingsphere-ä¸­çš„åº”ç”¨">å¾®å†…æ ¸æ¶æ„åœ¨ ShardingSphere ä¸­çš„åº”ç”¨</h4>
<ul>
<li>SQL è§£æå™¨ SQLParser</li>
</ul>
<p>æˆ‘ä»¬å°†åœ¨ 15 è¯¾æ—¶ä¸­ä»‹ç» SQLParser ç±»ï¼Œè¯¥ç±»è´Ÿè´£å°†å…·ä½“æŸä¸€æ¡ SQL è§£ææˆä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘çš„æ•´ä¸ªè¿‡ç¨‹ã€‚è€Œè¿™ä¸ª SQLParser çš„ç”Ÿæˆç”± SQLParserFactory è´Ÿè´£ï¼š</p>
<pre tabindex="0"><code>public final class SQLParserFactory { 

    public static SQLParser newInstance(final String databaseTypeName, final String sql) { 
     //é€šè¿‡SPIæœºåˆ¶åŠ è½½æ‰€æœ‰æ‰©å±• 
     for (SQLParserEntry each : NewInstanceServiceLoader.newServiceInstances(SQLParserEntry.class)) { 
        â€¦ 
    } 
}
</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œå¹¶æ²¡æœ‰ä½¿ç”¨å‰é¢ä»‹ç»çš„ TypeBasedSPIServiceLoader æ¥åŠ è½½å®ä¾‹ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨æ›´ä¸ºåº•å±‚çš„ NewInstanceServiceLoaderã€‚</p>
<p>è¿™é‡Œå¼•å…¥çš„ SQLParserEntry æ¥å£å°±ä½äº shardingsphere-sql-parser-spi å·¥ç¨‹çš„ org.apache.shardingsphere.sql.parser.spi åŒ…ä¸­ã€‚æ˜¾ç„¶ï¼Œä»åŒ…çš„å‘½åä¸Šçœ‹ï¼Œè¯¥æ¥å£æ˜¯ä¸€ä¸ª SPI æ¥å£ã€‚åœ¨ SQLParserEntry ç±»å±‚ç»“æ„æ¥å£ä¸­åŒ…å«ä¸€æ‰¹å®ç°ç±»ï¼Œåˆ†åˆ«å¯¹åº”å„ä¸ªå…·ä½“çš„æ•°æ®åº“ï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/ShardingSphere%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2-%E5%AE%8C/assets/Ciqc1F8ed26ANXCOAAArBJH3uDs890.png" alt="Drawing 4.png"></p>
<p>SQLParserEntry å®ç°ç±»å›¾</p>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹é’ˆå¯¹ MySQL çš„ä»£ç å·¥ç¨‹ shardingsphere-sql-parser-mysqlï¼Œåœ¨ META-INF/services ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ª org.apache.shardingsphere.sql.parser.spi.SQLParserEntry æ–‡ä»¶:</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/ShardingSphere%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2-%E5%AE%8C/assets/CgqCHl8ed3aABqWdAABTnSG89Jg177.png" alt="Drawing 5.png"></p>
<p>MySQL ä»£ç å·¥ç¨‹ä¸­çš„ SPI é…ç½®</p>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡ŒæŒ‡å‘äº† org.apache.shardingsphere.sql.parser.MySQLParserEntry ç±»ã€‚å†æ¥åˆ° Oracle çš„ä»£ç å·¥ç¨‹ shardingsphere-sql-parser-oracleï¼Œåœ¨ META-INF/services ç›®å½•ä¸‹ï¼ŒåŒæ ·æ‰¾åˆ°äº†ä¸€ä¸ª org.apache.shardingsphere.sql.parser.spi.SQLParserEntry æ–‡ä»¶ï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/ShardingSphere%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2-%E5%AE%8C/assets/Ciqc1F8ed4GABKlZAABTzlYzJvc755.png" alt="Drawing 6.png"></p>
<p>Oracle ä»£ç å·¥ç¨‹ä¸­çš„ SPI é…ç½®</p>
<p>æ˜¾ç„¶ï¼Œè¿™é‡Œåº”è¯¥æŒ‡å‘ org.apache.shardingsphere.sql.parser.OracleParserEntry ç±»ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œç³»ç»Ÿåœ¨è¿è¡Œæ—¶å°±ä¼šæ ¹æ®ç±»è·¯å¾„åŠ¨æ€åŠ è½½ SPIã€‚</p>
<p>å¯ä»¥æ³¨æ„åˆ°ï¼Œåœ¨ SQLParserEntry æ¥å£çš„ç±»å±‚ç»“æ„ä¸­ï¼Œå®é™…å¹¶æ²¡æœ‰ä½¿ç”¨åˆ° TypeBasedSPI æ¥å£ ï¼Œè€Œæ˜¯å®Œå…¨é‡‡ç”¨äº† JDK åŸç”Ÿçš„ SPI æœºåˆ¶ã€‚</p>
<ul>
<li>é…ç½®ä¸­å¿ƒ ConfigCenter</li>
</ul>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥æ‰¾ä¸€ä¸ªä½¿ç”¨ TypeBasedSPI çš„ç¤ºä¾‹ï¼Œæ¯”å¦‚ä»£è¡¨é…ç½®ä¸­å¿ƒçš„ ConfigCenterï¼š</p>
<pre tabindex="0"><code>public interface ConfigCenter extends TypeBasedSPI
</code></pre><p>æ˜¾ç„¶ï¼ŒConfigCenter æ¥å£ç»§æ‰¿äº† TypeBasedSPI æ¥å£ï¼Œè€Œåœ¨ ShardingSphere ä¸­ä¹Ÿå­˜åœ¨ä¸¤ä¸ª ConfigCenter æ¥å£çš„å®ç°ç±»ï¼Œä¸€ä¸ªæ˜¯ ApolloConfigCenterï¼Œä¸€ä¸ªæ˜¯ CuratorZookeeperConfigCenterã€‚</p>
<p>åœ¨ sharding-orchestration-core å·¥ç¨‹çš„ org.apache.shardingsphere.orchestration.internal.configcenter ä¸­ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº† ConfigCenterServiceLoader ç±»ï¼Œè¯¥ç±»æ‰©å±•äº†å‰é¢æåˆ°çš„ TypeBasedSPIServiceLoader ç±»ï¼š</p>
<pre tabindex="0"><code>public final class ConfigCenterServiceLoader extends TypeBasedSPIServiceLoader&lt;ConfigCenter&gt; { 

    static { 
        NewInstanceServiceLoader.register(ConfigCenter.class); 
    } 

    public ConfigCenterServiceLoader() { 
        super(ConfigCenter.class); 
    } 

    //åŸºäºSPIåŠ è½½ConfigCenter 
    public ConfigCenter load(final ConfigCenterConfiguration configCenterConfig) { 
        Preconditions.checkNotNull(configCenterConfig, &quot;Config center configuration cannot be null.&quot;); 
        ConfigCenter result = newService(configCenterConfig.getType(), configCenterConfig.getProperties()); 
        result.init(configCenterConfig); 
        return result; 
    } 
}
</code></pre><p>é‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ é¦–å…ˆï¼ŒConfigCenterServiceLoader ç±»é€šè¿‡ NewInstanceServiceLoader.register(ConfigCenter.class) è¯­å¥å°†æ‰€æœ‰ ConfigCenter æ³¨å†Œåˆ°ç³»ç»Ÿä¸­ï¼Œè¿™ä¸€æ­¥ä¼šé€šè¿‡ JDK çš„ ServiceLoader å·¥å…·ç±»åŠ è½½ç±»è·¯å¾„ä¸­çš„æ‰€æœ‰ ConfigCenter å®ä¾‹ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ä¸Šé¢çš„ load æ–¹æ³•ä¸­ï¼Œé€šè¿‡çˆ¶ç±» TypeBasedSPIServiceLoader çš„ newService æ–¹æ³•ï¼ŒåŸºäºç±»å‹åˆ›å»ºäº† SPI å®ä¾‹ã€‚</p>
<p>ä»¥ ApolloConfigCenter ä¸ºä¾‹ï¼Œæˆ‘ä»¬æ¥çœ‹å®ƒçš„ä½¿ç”¨æ–¹æ³•ã€‚åœ¨ sharding-orchestration-config-apollo å·¥ç¨‹çš„ META-INF/services ç›®å½•ä¸‹ï¼Œåº”è¯¥å­˜åœ¨ä¸€ä¸ªåä¸º org.apache.shardingsphere.orchestration.config.api.ConfigCenter çš„é…ç½®æ–‡ä»¶ï¼ŒæŒ‡å‘ ApolloConfigCenter ç±»ï¼š</p>
<p><img src="http://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/ShardingSphere%20%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2-%E5%AE%8C/assets/CgqCHl8eekGAa88DAABIbz4-Q20783.png" alt="Drawing 7.png"></p>
<p>Apollo ä»£ç å·¥ç¨‹ä¸­çš„ SPI é…ç½®</p>
<p>å…¶ä»–çš„ ConfigCenter å®ç°ä¹Ÿæ˜¯ä¸€æ ·ï¼Œä½ å¯ä»¥è‡ªè¡ŒæŸ¥é˜… sharding-orchestration-config-zookeeper-curator ç­‰å·¥ç¨‹ä¸­çš„ SPI é…ç½®æ–‡ä»¶ã€‚</p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å…¨é¢äº†è§£äº† ShardingSphere ä¸­çš„å¾®å†…æ ¸æ¶æ„ï¼Œä¹Ÿå°±å¯ä»¥åŸºäº ShardingSphere æ‰€æä¾›çš„å„ç§ SPI æ‰©å±•ç‚¹æä¾›æ»¡è¶³è‡ªèº«éœ€æ±‚çš„å…·ä½“å®ç°ã€‚</p>
<h3 id="ä»æºç è§£æåˆ°æ—¥å¸¸å¼€å‘">ä»æºç è§£æåˆ°æ—¥å¸¸å¼€å‘</h3>
<p>åœ¨æ—¥å¸¸å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬å¯ä»¥ç›´æ¥ä½¿ç”¨ JDK çš„ ServiceLoader ç±»æ¥å®ç° SPI æœºåˆ¶ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é‡‡ç”¨åƒ ShardingSphere çš„æ–¹å¼å¯¹ ServiceLoader ç±»è¿›è¡Œä¸€å±‚ç®€å•çš„å°è£…ï¼Œå¹¶æ·»åŠ å±æ€§è®¾ç½®ç­‰è‡ªå®šä¹‰åŠŸèƒ½ã€‚</p>
<p>åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥æ³¨æ„åˆ°ï¼ŒServiceLoader è¿™ç§å®ç°æ–¹æ¡ˆä¹Ÿæœ‰ä¸€å®šç¼ºç‚¹ï¼š</p>
<ul>
<li>ä¸€æ–¹é¢ï¼ŒMETA/services è¿™ä¸ªé…ç½®æ–‡ä»¶çš„åŠ è½½åœ°å€æ˜¯å†™æ­»åœ¨ä»£ç ä¸­ï¼Œç¼ºä¹çµæ´»æ€§ã€‚</li>
<li>å¦ä¸€æ–¹é¢ï¼ŒServiceLoader å†…éƒ¨é‡‡ç”¨äº†åŸºäºè¿­ä»£å™¨çš„åŠ è½½æ–¹æ³•ï¼Œä¼šæŠŠé…ç½®æ–‡ä»¶ä¸­çš„æ‰€æœ‰ SPI å®ç°ç±»éƒ½åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œæ•ˆç‡ä¸é«˜ã€‚</li>
</ul>
<p>æ‰€ä»¥å¦‚æœéœ€è¦æä¾›æ›´é«˜çš„çµæ´»æ€§å’Œæ€§èƒ½ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åŸºäº ServiceLoader çš„å®ç°æ–¹æ³•è‡ªå·±å¼€å‘é€‚åˆè‡ªèº«éœ€æ±‚çš„ SPI åŠ è½½ æœºåˆ¶ã€‚</p>
<h3 id="æ€»ç»“">æ€»ç»“</h3>
<p>å¾®å†…æ ¸æ¶æ„æ˜¯ ShardingSphere ä¸­æœ€æ ¸å¿ƒçš„åŸºç¡€æ¶æ„ï¼Œä¸ºè¿™ä¸ªæ¡†æ¶æä¾›äº†é«˜åº¦çš„çµæ´»åº¦ï¼Œä»¥åŠå¯æ’æ‹”çš„æ‰©å±•æ€§ã€‚å¾®å†…æ ¸æ¶æ„ä¹Ÿæ˜¯ä¸€ç§åŒæ ·çš„æ¶æ„æ¨¡å¼ï¼Œæœ¬è¯¾æ—¶æˆ‘ä»¬å¯¹è¿™ä¸ªæ¶æ„æ¨¡å¼çš„ç‰¹ç‚¹å’Œç»„æˆç»“æ„åšäº†ä»‹ç»ï¼Œå¹¶åŸºäº JDK ä¸­æä¾›çš„ SPI æœºåˆ¶ç»™å‡ºäº†å®ç°è¿™ä¸€æ¶æ„æ¨¡å¼çš„å…·ä½“æ–¹æ¡ˆã€‚</p>
<p>ShardingSphere ä¸­å¤§é‡ä½¿ç”¨äº†å¾®å†…æ ¸æ¶æ„æ¥è§£è€¦ç³»ç»Ÿå†…æ ¸å’Œå„ä¸ªç»„ä»¶ä¹‹é—´çš„å…³è”å…³ç³»ï¼Œæˆ‘ä»¬åŸºäºè§£æå¼•æ“å’Œé…ç½®ä¸­å¿ƒç»™å‡ºäº†å…·ä½“çš„å®ç°æ¡ˆä¾‹ã€‚åœ¨å­¦ä¹ è¿™äº›æ¡ˆä¾‹æ—¶ <strong>ï¼Œé‡ç‚¹åœ¨äºæŒæ¡ ShardingSphere ä¸­å¯¹ JDK ä¸­ SPIçš„å°è£…æœºåˆ¶ã€‚</strong></p>
<p>è¿™é‡Œç»™ä½ ç•™ä¸€é“æ€è€ƒé¢˜ï¼šShardingSphere ä¸­ä½¿ç”¨å¾®å†…æ ¸æ¶æ„æ—¶å¯¹ JDK ä¸­çš„ SPI æœºåˆ¶åšäº†å“ªäº›å°è£…ï¼Ÿ</p>
<p>æœ¬è¯¾æ—¶çš„å†…å®¹å°±åˆ°è¿™é‡Œï¼Œä¸‹ä¸€è¯¾æ—¶ï¼Œæˆ‘ä»¬å°†ç»§ç»­æ¢ç´¢ ShardingSphere ä¸­çš„åŸºç¡€è®¾æ–½ï¼Œå¹¶ç»™å‡ºåˆ†å¸ƒå¼ä¸»é”®çš„è®¾è®¡åŸç†å’Œå¤šç§å®ç°æ–¹æ¡ˆï¼Œè®°å¾—æŒ‰æ—¶æ¥å¬è¯¾ã€‚</p>

        </div>
    </article>
</div>

    </main>
    <footer>
        <div id="pagination">
            
<div class="paginator">
    <div class="prev">
        
        <a href="/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/12-%E4%BB%8E%E5%BA%94%E7%94%A8%E5%88%B0%E5%8E%9F%E7%90%86%E5%A6%82%E4%BD%95%E9%AB%98%E6%95%88%E9%98%85%E8%AF%BB-shardingsphere-%E6%BA%90%E7%A0%81/"><span>12 ä»åº”ç”¨åˆ°åŸç†ï¼šå¦‚ä½•é«˜æ•ˆé˜…è¯» ShardingSphere æºç ï¼Ÿ</span></a>
    </div>
    <div class="next">
        
        <a href="/documents/columns/sharding/shardingsphere%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E7%B2%BE%E8%AE%B2/14-%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%BB%E9%94%AEshardingsphere-%E4%B8%AD%E6%9C%89%E5%93%AA%E4%BA%9B%E5%88%86%E5%B8%83%E5%BC%8F%E4%B8%BB%E9%94%AE%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F/"><span>14 åˆ†å¸ƒå¼ä¸»é”®ï¼šShardingSphere ä¸­æœ‰å“ªäº›åˆ†å¸ƒå¼ä¸»é”®å®ç°æ–¹å¼ï¼Ÿ</span></a>
    </div>
</div>

        </div>
        <div class="toggler" onclick="toggleLight(this);">ğŸ’¡</div>
        <div id="copyright" style="display: none;">
    
    
    <p>&copy; 27270 <a href="/"></a>, powered by Hugo and Qiao</p>
</div>
    </footer>
    
<script>
    function toggleLight() {
        document.getElementById('page').classList.toggle('night');
    }
</script>
</body>

</html>